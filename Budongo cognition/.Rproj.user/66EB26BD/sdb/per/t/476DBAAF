{
    "contents" : "# this file requires:\n\n\n# currently this file cannot be Source'd\n\n\n### engagement ideas\n\n# never involved {0}\n# RE, SO, HE, LI, DA, LU, KD\n\n# approach but never complete session {1}\n# EM, LO, PA, PE, Q, EV\n\n# complete session {2}\n# ED, LB, CI, KL, FK\n\n# based on this...\nparticipat = as.factor(c(2,0,2,1,1,2,0,2,0,0,2,1,0,1,1,1,0,0))\naggPers = cbind(aggPers, participat)\n\n\n# GLM(?)\n\nmod.ord.e1 <- polr(participat ~ dom + neu, data = aggPers)\n\n\ntm <- aggregate(aggPers, by=list(aggPers$participat), FUN=mean)\nts <- aggregate(aggPers, by=list(aggPers$participat), FUN=sd)\n\n\nlibrary(rpanel)\nrp.ancova(aggPers$dom, aggPers$participat)\n\n\n\nmp = barplot(height=as.matrix(tm[3:8]),beside=TRUE)\nlibrary(Hmisc)\nerrbar(ts)\n\nsegments(c(mp), c(t(t(tm[3:8] - ts[3:8]))), c(mp),c(t(t(tm[3:8] + ts[3:8]))), lwd=2)\n\nvioplot(aggPers[,2:7],aggPers[,8])\n\nwith(aggPers[,2:7],vioplot(aggPers[,aggPers$participat==0],aggPers[,aggPers$participat==1],aggPers[,aggPers$participat==2]))\nhead(aggPers[,2:7])\naggPers[participat==0]\n\nlibrary(beanplot)\nbeanplot(data=t(aggPers[,2:7]),names=aggPers[,8])\n\n\n# Ordinal Regression\n\n# is this (polr) appropriate?\nlibrary(MASS)\nmod.polr.d <- polr(participat ~ dom, data=aggPers)\nmod.polr.2.d <- polr(participat ~ I(dom^2), data=aggPers)\nmod.polr.all <- polr(participat ~ dom + con + neu + ext + agr + opn, data=aggPers)\nmod.polr.2.all <- polr(participat ~ I(dom^2) + con + I(neu^2) + ext + agr + opn, data=aggPers)\n\n\nlibrary(rms)\nmod.orm <- orm(participat ~ dom + con + neu + ext + agr + opn, data=aggPers)\nmod.orm.2 <- orm(participat ~ I(dom^2) + con + I(neu^2) + ext + agr + opn, data=aggPers)\n\n\n\nlibrary(ordinal)\n#cm.1 <- ...\ncm.2 <- clm(participat ~ I(dom^2) + con + I(neu^2) + ext + agr + opn, data=aggPers)\ncm.2a <- clm(participat ~ I(dom^2) + dom + con + I(neu^2) + neu + ext + agr + opn, data=aggPers)\n# something is wrong above - how can Agr be the only sig predictor?\ncm.agr <- clm(participat ~ agr, data=aggPers)\n# Nothing. Is there an interaction? (or should I just drop it)\ncm.aint <- clm(participat ~ con + ext + I(dom^2) + I(neu^2) + opn, data=aggPers)\n# check with vif()\n# in order to that, need to use lm() since clm() doesn't have functionality\nvif(lm(as.numeric(participat) ~ dom + con + neu + ext + agr + opn, data=aggPers))\n# dom      con      neu      ext      agr      opn \n# 6.401741 3.181492 7.307849 1.786007 1.737412 1.756628\n\n#cm.2.nom <- clm(participat ~ I(dom^2) + con + I(neu^2) + ext + agr + opn, nominal = ~ I(dom^2) + con + I(neu^2) + ext + agr + opn, data=aggPers)\n\n# step(s)\ncm.2.stp <- step(cm.2)\n#AIC 39.35\ncm.2a.stp <- step(cm.2a)\n#AIC 39.55\n#\n# best model features dom^2, neu^2, agr, opn\nanova(cm.2.stp,cm.2a.stp)\n\n\ncm.naint <- clm(participat ~ I(dom^2), data=aggPers)\ncm.naint.stp <- step(cm.naint, direction=\"forward\")\n\n\n# Tukey attempts using aov() based on best model (above)\ndom.aov = aov(dom ~ participat, data = aggPers)\npers.aov = aov(aggPers$participat ~ I(aggPers$dom^2) + I(aggPers$neu^2) + aggPers$agr + aggPers$opn)\nTukeyHSD(dom.aov)\n\nagr.aov = aov(agr ~ participat, data = aggPers)\nsummary(agr.aov)\nTukeyHSD(agr.aov)\n\nsummary(fm1 <- aov(breaks ~ wool + tension, data = warpbreaks))\nTukeyHSD(fm1, \"tension\", ordered = TRUE)\n\n# Multinomial regression before Tukey'ing?\nlibrary(glmnet)\nmultm.a <- glmnet(as.matrix(aggPers[,2:7]),aggPers[,8],family=\"multinomial\")\nplot(cv.glmnet(as.matrix(aggPers[,2:7]),aggPers[,8],family=\"multinomial\"))\n#TukeyHSD(multm.1) # doesn't work\n\nlibrary(nnet)\nmultim.b1 <- multinom(participat ~ dom + con + neu + ext + agr + opn, data=aggPers)\nmultim.b2 <- multinom(participat ~ I(dom^2) + con + I(neu^2) + ext + agr + opn, data=aggPers)\nTukeyHSD(multim.b2)\n\n# Scheffe etc tests\nlibrary(multcomp)\n#glht(cm.2.stp)\nglht(multim.b1)\n\n\n#t-tests\nlibrary(BSDA)\n# Dominance\ntsum.test(tm$dom[1],ts$dom[1],7,tm$dom[2],ts$dom[2],6)\ntsum.test(tm$dom[3],ts$dom[3],5,tm$dom[2],ts$dom[2],6)\ntsum.test(tm$dom[1],ts$dom[1],7,tm$dom[3],ts$dom[3],5)\n# Neuroticism\ntsum.test(tm$neu[1],ts$neu[1],7,tm$neu[2],ts$neu[2],6)\ntsum.test(tm$neu[3],ts$neu[3],5,tm$neu[2],ts$neu[2],6)\ntsum.test(tm$neu[1],ts$neu[1],7,tm$neu[3],ts$neu[3],5)\n\n# Agreeableness\ntsum.test(tm$agr[1],ts$agr[1],7,tm$agr[2],ts$agr[2],6)\ntsum.test(tm$agr[3],ts$agr[3],5,tm$agr[2],ts$agr[2],6)\ntsum.test(tm$agr[1],ts$agr[1],7,tm$agr[3],ts$agr[3],5)\n\n# Openness\ntsum.test(tm$opn[1],ts$opn[1],7,tm$opn[2],ts$opn[2],6)\ntsum.test(tm$opn[3],ts$opn[3],5,tm$opn[2],ts$opn[2],6)\ntsum.test(tm$opn[1],ts$opn[1],7,tm$opn[3],ts$opn[3],5)\n\naggPers[order(aggPers[,8],decreasing=FALSE),]\n\n\n\n#ultimately with BEST and JAGS\n\n\n\n\n\n",
    "created" : 1433412461516.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2315439046",
    "id" : "476DBAAF",
    "lastKnownWriteTime" : 1433425592,
    "path" : "C:/Users/s1229179/git-repos/R/Budongo cognition/engage_assoc.R",
    "project_path" : "engage_assoc.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}