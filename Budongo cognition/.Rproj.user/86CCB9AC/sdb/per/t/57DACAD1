{
    "contents" : "# this file requires the running of:\n# fileLoader.R\n# perscoring_chimp.R\n\ns <- function(x) {scale(x)}\n\n###\n#some correlations\n\n\n# first we need an average performance matrix\n\n# need to deal with Frek later\n\naccuracy <- data.frame(chimp = character(0), acc_mean = numeric(0), acc_sd = numeric(0))\naccuracy <- data.frame(\n  rbind.data.frame(accuracy, cbind.data.frame(chimp='Cindy',acc_mean=mean(CIdata$Accuracy),acc_sd=sd(CIdata$Accuracy)),\n                  cbind.data.frame(chimp='David',acc_mean=mean(DAdata$Accuracy),acc_sd=sd(DAdata$Accuracy)),\n                  cbind.data.frame(chimp='Edith',acc_mean=mean(EDdata$Accuracy),acc_sd=sd(EDdata$Accuracy)),\n                  cbind.data.frame(chimp='Emma',acc_mean=mean(EMdata$Accuracy),acc_sd=sd(EMdata$Accuracy)),\n                  cbind.data.frame(chimp='Eva',acc_mean=mean(EVdata$Accuracy),acc_sd=sd(EVdata$Accuracy)),\n                  cbind.data.frame(chimp='Freek',acc_mean=mean(FKdata$Accuracy),acc_sd=sd(FKdata$Accuracy)),\n                  #cbind.data.frame(chimp='Heleen',acc_mean=mean(HLdata$Accuracy),acc_sd=sd(HLdata$Accuracy)),\n                  cbind.data.frame(chimp='Kilimi',acc_mean=mean(KLdata$Accuracy),acc_sd=sd(KLdata$Accuracy)),\n                  cbind.data.frame(chimp='Kindia',acc_mean=mean(KDdata$Accuracy),acc_sd=sd(KDdata$Accuracy)),\n                  #cbind.data.frame(chimp='Lianne',acc_mean=mean(LIdata$Accuracy),acc_sd=sd(LIdata$Accuracy)),\n                  cbind.data.frame(chimp='Liberius',acc_mean=mean(LBdata$Accuracy),acc_sd=sd(LBdata$Accuracy)),\n                  cbind.data.frame(chimp='Louis',acc_mean=mean(LOdata$Accuracy),acc_sd=sd(LOdata$Accuracy)),\n                #  cbind.data.frame(chimp='Lucy',acc_mean=mean(LUdata$Accuracy),acc_sd=sd(LUdata$Accuracy)),\n                  cbind.data.frame(chimp='Paul',acc_mean=mean(PAdata$Accuracy),acc_sd=sd(PAdata$Accuracy)),\n                  cbind.data.frame(chimp='Pearl',acc_mean=mean(PEdata$Accuracy),acc_sd=sd(PEdata$Accuracy)),\n                  cbind.data.frame(chimp='Qafzeh',acc_mean=mean(Qdata$Accuracy),acc_sd=sd(Qdata$Accuracy))\n                  #cbind.data.frame(chimp='Rene',acc_mean=mean(REdata$Accuracy),acc_sd=sd(REdata$Accuracy)),\n                  #cbind.data.frame(chimp='Sophie',acc_mean=mean(SOdata$Accuracy),acc_sd=sd(SOdata$Accuracy))\n                                \n                  \n), stringsAsFactors = FALSE\n                  )\n\n# add personality\naccu_pers <- cbind(accuracy,aggPers[c(-7,-10,-13,-17,-18),2:7])\n#accu_pers[2:3] <- cbind(as.numeric(accu_pers[2]))\n  \n#some stupid model(s)\nurr <- lm(acc_mean ~ s(dom) + s(ext) + s(con) + s(neu) + s(opn) + s(agr), data=accu_pers )\nuurrrr <- lm(acc_sd ~ s(dom) + s(ext) + s(con) + s(neu) + s(opn) + s(agr), data=accu_pers )\n\n\n\nrunif(10,0,1)\n\nLBlong <- 1:length(LBdata$Accuracy)\n\nplot(1:length(CIdata$Accuracy),CIdata$Accuracy)\nplot(LBdata$Accuracy ~ LBlong)\nplot(1:length(EDdata$Accuracy),EDdata$Accuracy)\nplot(1:length(KLdata$Accuracy),KLdata$Accuracy)\nplot(1:length(PEdata$Accuracy),PEdata$Accuracy)\n\n\n\n\n\n# GLM (first attempt)\nLBlong <- 1:length(LBdata$Accuracy)\nmod.g <- glm(LBdata$Accuracy ~ LBlong, family = binomial(link = 'probit'))\n\n\n# GLMMs\n\nmod.gm1 <- glmer(Accuracy ~ dom + neu + agr + ext + con + opn + (1 | Group.1),\n                 family = binomial, data=cz_bin_pers \n)\n\nmod.gm2 <- glmer(Accuracy ~ dom + neu + agr + ext + con + opn + Trial + (1 | Group.1),\n  family = binomial, data=cz_bin_pers \n  )\n\n\nmod.gm3 <- glmer(Accuracy ~ Trial + (1 | Group.1),\n                 family = binomial, data=cz_bin_pers \n)\nmod.gm4 <- glmer(Accuracy ~ Trial + (1 + Trial | Group.1),\n                 family = binomial, data=cz_bin_pers \n)\n\nmod.gm3a <- glmer(Accuracy ~ Trial + s(SessionStart) + (1 | Group.1),\n                             family = binomial, data=cz_bin_pers \n)\n\nmod.gm2a <- glmer(Accuracy ~ dom + neu + agr + ext + con + opn + Trial + s(SessionStart) + (1 | Group.1),\n                  family = binomial, data=cz_bin_pers \n)\n\n\nanova(mod.gm1,mod.gm2,mod.gm3,mod.gm4\n      #,mod.gm2a\n      ) # so gm2 is the best model\n# stepwise it\nlibrary(lmerTest)\n#mod.gm2s <- step(mod.gm2) # errrrgggh this would be awful nice\nmod.gm2.1 <- glmer(Accuracy ~ dom + con + Trial + (1 | Group.1),\n                               family = binomial, data=cz_bin_pers \n)\nmod.gm2.2 <- glmer(Accuracy ~ dom + neu + ext + Trial + (1 | Group.1),\n                   family = binomial, data=cz_bin_pers \n)\nmod.gm2.3 <- glmer(Accuracy ~ dom + neu + Trial + (1 | Group.1),\n                   family = binomial, data=cz_bin_pers \n)\nmod.gm2.4 <- glmer(Accuracy ~ dom + Trial + (1 | Group.1),\n                   family = binomial, data=cz_bin_pers \n)\nanova(mod.gm2,mod.gm2.1,mod.gm2.2,mod.gm2.3,mod.gm2.4)\n\n\n### testing some BLUP stuff from gm4\n# mostly garbage\nblup.gm4 = ranef(mod.gm4)\n\ncor(blup.gm4$Group.1[,1], accu_pers$agr[c(1,3:12)])\ncor.test(blup.gm4$Group.1[,1], accu_pers$dom[c(1,3:12)])\ncor.test(blup.gm4$Group.1[,1], accu_pers$neu[c(1,3:12)])\ncor(blup.gm4$Group.1[,1], accu_pers$opn[c(1,3:12)])\ncor.test(blup.gm4$Group.1[,1], accu_pers$con[c(1,3:12)])\ncor.test(blup.gm4$Group.1[,1], accu_pers$ext[c(1,3:12)])\n\ncor(blup.gm4$Group.1[,2], accu_pers$agr[c(1,3:12)])\ncor(blup.gm4$Group.1[,2], accu_pers$dom[c(1,3:12)])\ncor(blup.gm4$Group.1[,2], accu_pers$neu[c(1,3:12)])\ncor(blup.gm4$Group.1[,2], accu_pers$opn[c(1,3:12)])\ncor(blup.gm4$Group.1[,2], accu_pers$con[c(1,3:12)])\ncor.test(blup.gm4$Group.1[,2], accu_pers$ext[c(1,3:12)])\n\n### cor checks of accuracy vs. personality\ncor.test(accu_pers$acc_mean, accu_pers$dom)\ncor(accu_pers$acc_mean, accu_pers$agr)\ncor(accu_pers$acc_mean, accu_pers$ext)\ncor.test(accu_pers$acc_mean, accu_pers$neu)\ncor(accu_pers$acc_mean, accu_pers$opn)\ncor.test(accu_pers$acc_mean, accu_pers$con)\n\n# LDA\nboxM(accu_pers[,-1], accu_pers[,1])\n#mod.l <- lda(LBdata$Accuracy ~ LBlong)\nmod.l <- lda()\n",
    "created" : 1423071318167.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "632482902",
    "id" : "57DACAD1",
    "lastKnownWriteTime" : 1423160634,
    "path" : "C:/Users/s1229179/git-repos/R/Budongo cognition/perf_associat.R",
    "project_path" : "perf_associat.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}