{
    "contents" : "# segment for entering and sorting the 6 factor weighting matrix\n\n# (dom, ext, con, agr, neur, open)\nwmat <- rbind(cbind(\"FEARFUL\",-1,0,0,0,0,0),cbind(\"SUBMISSIVE\",-1,0,0,0,0,0),\n              cbind(\"TIMID\",-1,0,0,0,0,0),cbind(\"CAUTIOUS\",-1,0,0,0,0,0),\n              cbind(\"STABLE\",0,0,0,0,-1,0),cbind(\"DISTRACTIBLE\",0,0,-1,0,0,0),\n              cbind(\"DISORGANIZED\",0,0,-1,0,0,0),cbind(\"DEPENDENT/FOLLOWER\",-1,0,0,0,0,0),\n              cbind(\"VULNERABLE\",-1,0,0,0,0,0),cbind(\"INQUISITIVE\",0,0,0,0,0,1),\n              cbind(\"THOUGHTLESS\",0,0,-1,0,0,0),cbind(\"INNOVATIVE\",0,0,0,0,0,1),\n              cbind(\"INVENTIVE\",0,0,0,0,0,1),cbind(\"CURIOUS\",0,0,0,0,0,1),\n              cbind(\"IMITATIVE\",0,1,0,0,0,0),cbind(\"IMPULSIVE\",0,0,-1,0,0,0),\n              cbind(\"BULLYING\",1,0,0,0,0,0),cbind(\"STINGY/GREEDY\",1,0,0,0,0,0),\n              cbind(\"AGRESSIVE\",0,0,-1,0,0,0),cbind(\"IRRITABLE\",0,0,-1,0,0,0),\n              cbind(\"MANIPULATIVE\",1,0,0,0,0,0),cbind(\"DEFIANT\",0,0,-1,0,0,0),\n              cbind(\"EXCITABLE\",0,0,0,0,1,0),cbind(\"RECKLESS\",0,0,-1,0,0,0),\n              cbind(\"GENTLE\",0,0,0,1,0,0),cbind(\"DOMINANT\",1,0,0,0,0,0),\n              cbind(\"INDEPENDENT\",1,0,0,0,0,0),cbind(\"INDIVIDUALISTIC\",0,-1,0,0,0,0),\n              cbind(\"HELPFUL\",0,0,0,1,0,0),cbind(\"FRIENDLY\",0,1,0,0,0,0),\n              cbind(\"AFFECTIONATE\",0,1,0,0,0,0),cbind(\"SOCIABLE\",0,1,0,0,0,0),\n              cbind(\"SENSITIVE\",0,0,0,1,0,0),cbind(\"DEPRESSED\",0,-1,0,0,0,0),\n              cbind(\"PROTECTIVE\",0,0,0,1,0,0),cbind(\"SOLITARY\",0,-1,0,0,0,0),\n              cbind(\"SYMPATHETIC\",0,0,0,1,0,0),cbind(\"INTELLIGENT\",1,0,0,0,0,0),\n              cbind(\"PERSISTENT\",1,0,0,0,0,0),cbind(\"DECISIVE\",1,0,0,0,0,0),\n              cbind(\"CONVENTIONAL\",0,0,0,1,0,0),cbind(\"PREDICTABLE\",0,0,1,0,0,0),\n              cbind(\"LAZY\",0,-1,0,0,0,0),cbind(\"ACTIVE\",0,1,0,0,0,0),\n              cbind(\"CLUMSY\",0,0,-1,0,0,0),cbind(\"PLAYFUL\",0,1,0,0,0,0),\n              cbind(\"COOL\",0,0,0,0,-1,0),cbind(\"QUITTING\",0,0,-1,0,0,0),\n              cbind(\"ANXIOUS\",-1,0,0,0,0,0),cbind(\"ERRATIC\",0,0,-1,0,0,0),\n              cbind(\"UNEMOTIONAL\",0,0,0,0,0,0),cbind(\"JEALOUS\",0,0,-1,0,0,0))\n\ncompare_data <- NULL\n\ncompare_data <- data.frame(chimp = pers$chimpname)\n\ncompare_data$dom <-\n  (pers$Dom - pers$Fear - pers$Subm - pers$Tim - pers$Caut - pers$Depd + pers$Indp - pers$Vuln + \n     pers$Decs + pers$Intll + pers$Pers + pers$Buly + pers$Stngy + pers$Manp - pers$Anx \n   + 7*8\n   ) / 15\n\ncompare_data$con <-\n  (pers$Pred - pers$Impl - pers$Defn - pers$Reckl - pers$Errc - pers$Irri - pers$Aggr - pers$Jeals\n   - pers$Dsor - pers$Thotl - pers$Dist - pers$Unper - pers$Quit - pers$Clmy\n   + 13*8\n  ) / 14\n#  (-dmdob$impl.z-dmdob$defn.z-dmdob$reckl.z-dmdob$errc.z-dmdob$irri.z+dmdob$pred.z-dmdob$aggr.z-dmdob$jeals.z-dmdob$dsor.z+64)/9\n\ncompare_data$opn <-\n  (pers$Inqs + pers$Invt + pers$Curious + pers$Innov\n  ) / 4\n#(dmdob$inqs.z+dmdob$invt.z)/2\n\ncompare_data$neu <-\n  (pers$Exct + pers$Aut - pers$Stbl - pers$Cool - pers$Unem\n   + 3*8\n  ) / 5\n#(-dmdob$stbl.z+dmdob$exct.z-dmdob$unem.z+16)/3\n\ncompare_data$agr <-\n  (pers$Symp + pers$Help + pers$Sens + pers$Prot + pers$Gntl + pers$Conv\n  ) / 6\n#(dmdob$symp.z+dmdob$help.z+dmdob$sens.z+dmdob$prot.z+dmdob$gntl.z)/5\n\ncompare_data$ext <-\n  (pers$Actv + pers$Play + pers$Soc + pers$Frdy + pers$Affc + pers$Imit \n   - pers$Sol - pers$Lazy - pers$Indv - pers$Depr     \n   + 4*8\n     ) / 10\n  \n\n\n# ddply(compare_data,~chimp,summarise,mean=\n#           na.action = na.omit)\n\n# remove data from 2005 sampling\ncompare_data = compare_data[25:99,]\n\naggPers <- aggregate(compare_data, by=list(compare_data$chimp), FUN=mean, na.rm=TRUE,na.action = na.omit)\n\n# removing dead chimps :((((\nrownames(aggPers) <- aggPers$Group.1\naggPers<-aggPers[c(-1,-2,-4,-17,-22),]\naggPers<-aggPers[,-2]\n\ncolnames(aggPers) <- c(\"Chimp\",'Dominance','Conscientiousness','Openness','Neuroticism',\n                       'Agreeableness','Extraversion')\n\n\n### adding pers to trial by trial data\nCIdata <- cbind.data.frame(CIdata,aggPers[1,])\nEMdata <- cbind.data.frame(EMdata,aggPers[4,])\nEDdata <- cbind.data.frame(EDdata,aggPers[3,])\nEVdata <- cbind.data.frame(EVdata,aggPers[5,])\nFKdata <- cbind.data.frame(FKdata,aggPers[6,])\nKLdata <- cbind.data.frame(KLdata,aggPers[8,])\nLOdata <- cbind.data.frame(LOdata,aggPers[12,])\nLBdata <- cbind.data.frame(LBdata,aggPers[11,])\nPAdata <- cbind.data.frame(PAdata,aggPers[14,])\nQdata <- cbind.data.frame(Qdata,aggPers[16,])\nPEdata <- cbind.data.frame(PEdata,aggPers[15,])\n\ncz_bin_pers <- rbind.data.frame(CIdata,EMdata,EDdata,EVdata,FKdata,KLdata,LOdata,LBdata,PAdata,Qdata,PEdata)\n \ncz_bin_pers$Accuracy <- as.factor(cz_bin_pers$Accuracy)\ncz_bin_pers$Trial <- as.integer(cz_bin_pers$Trial)\n\n\n####### old code #######\n\nwmat <- wmat[order(wmat[,1],decreasing=FALSE),]\nwm <- apply(wmat[,2:7],1,as.numeric)\n\nfullset = apply(pers,c(1,3),mean)\n\n\n\n# autistic and unpredictable should both be removed from the data set\nfullset = fullset[,c(-5,-53)]\n\n# combine matrices to find components\n\nscores1 <- wm %o% fullset\nscores2 <- fullset %o% wm\n\nscores=array(0,c(9,6))\n\nfor (i in 1:52){\n  for (j in 1:6){\n    scores[1:9,j] <- scores[1:9,j]+wm[j,i]*fullset[,i]\n  }\t\t\n}\n\n\n\n\n\n####\n# stuff below is what I'd like to convert back over for macaques\n\n# wmat <- rbind(cbind(\"FEARFUL\",-1,0,0,0,0,0),cbind(\"SUBMISSIVE\",-1,0,0,0,0,0),\n#               cbind(\"TIMID\",-1,0,0,0,0,0),cbind(\"CAUTIOUS\",-1,0,0,0,0,0),\n#               cbind(\"STABLE\",0,0,0,0,-1,0),cbind(\"DISTRACTIBLE\",0,0,-1,0,0,0),\n#               cbind(\"DISORGANIZED\",0,0,-1,0,0,0),cbind(\"DEPENDENT/FOLLOWER\",-1,0,0,0,0,0),\n#               cbind(\"VULNERABLE\",-1,0,0,0,0,0),cbind(\"INQUISITIVE\",0,0,0,0,0,1),\n#               cbind(\"THOUGHTLESS\",0,0,-1,0,0,0),cbind(\"INNOVATIVE\",0,0,0,0,0,1),\n#               cbind(\"INVENTIVE\",0,0,0,0,0,1),cbind(\"CURIOUS\",0,0,0,0,0,1),\n#               cbind(\"IMITATIVE\",0,1,0,0,0,0),cbind(\"IMPULSIVE\",0,0,-1,0,0,0),\n#               cbind(\"BULLYING\",1,0,0,0,0,0),cbind(\"STINGY/GREEDY\",1,0,0,0,0,0),\n#               cbind(\"AGRESSIVE\",0,0,-1,0,0,0),cbind(\"IRRITABLE\",0,0,-1,0,0,0),\n#               cbind(\"MANIPULATIVE\",1,0,0,0,0,0),cbind(\"DEFIANT\",0,0,-1,0,0,0),\n#               cbind(\"EXCITABLE\",0,0,0,0,1,0),cbind(\"RECKLESS\",0,0,-1,0,0,0),\n#               cbind(\"GENTLE\",0,0,0,1,0,0),cbind(\"DOMINANT\",1,0,0,0,0,0),\n#               cbind(\"INDEPENDENT\",1,0,0,0,0,0),cbind(\"INDIVIDUALISTIC\",0,-1,0,0,0,0),\n#               cbind(\"HELPFUL\",0,0,0,1,0,0),cbind(\"FRIENDLY\",0,1,0,0,0,0),\n#               cbind(\"AFFECTIONATE\",0,1,0,0,0,0),cbind(\"SOCIABLE\",0,1,0,0,0,0),\n#               cbind(\"SENSITIVE\",0,0,0,1,0,0),cbind(\"DEPRESSED\",0,-1,0,0,0,0),\n#               cbind(\"PROTECTIVE\",0,0,0,1,0,0),cbind(\"SOLITARY\",0,-1,0,0,0,0),\n#               cbind(\"SYMPATHETIC\",0,0,0,1,0,0),cbind(\"INTELLIGENT\",1,0,0,0,0,0),\n#               cbind(\"PERSISTENT\",1,0,0,0,0,0),cbind(\"DECISIVE\",1,0,0,0,0,0),\n#               cbind(\"CONVENTIONAL\",0,0,0,1,0,0),cbind(\"PREDICTABLE\",0,0,1,0,0,0),\n#               cbind(\"LAZY\",0,-1,0,0,0,0),cbind(\"ACTIVE\",0,1,0,0,0,0),\n#               cbind(\"CLUMSY\",0,0,-1,0,0,0),cbind(\"PLAYFUL\",0,1,0,0,0,0),\n#               cbind(\"COOL\",0,0,0,0,-1,0),cbind(\"QUITTING\",0,0,-1,0,0,0),\n#               cbind(\"ANXIOUS\",-1,0,0,0,0,0),cbind(\"ERRATIC\",0,0,-1,0,0,0),\n#               cbind(\"UNEMOTIONAL\",0,0,0,0,0,0),cbind(\"JEALOUS\",0,0,-1,0,0,0))",
    "created" : 1433956262259.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4212316616",
    "id" : "AB541790",
    "lastKnownWriteTime" : 1433956574,
    "path" : "C:/Users/s1229179/GitHub/R/Budongo cognition/perscoring_chimp.R",
    "project_path" : "perscoring_chimp.R",
    "properties" : {
    },
    "relative_order" : 5,
    "source_on_save" : false,
    "type" : "r_source"
}