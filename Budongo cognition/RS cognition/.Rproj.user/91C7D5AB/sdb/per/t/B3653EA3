{
    "collab_server" : "",
    "contents" : "### Analysis of Ruth Sonnweber's cognitive data\n\n# 1. Distinguish between Interaction levels\n#   a. chimps who did not participate\n#   b. chimps who were trained but did not proceed to testing (EM, LB, ED, LO, DA)\n#   c. chimps who were tested but did not complete all stages (CI, EV, PA)\n#   d. chimps who finished all tasks (FK, KL, PE)\n# 2. Look at the number of trials taken to complete each stage of training\n#     discrete-time hazard model\n# 3. Model accuracy across all trials\n#   - all training trials? (etc...)\n# 4. Model RT\n#   - number of touches\n\n#######\n\nlibrary(optimx)\nlibrary(nloptr)\nlibrary(bbmle)\nlibrary(lme4)\n\nlibrary(Hmisc)\n\n### [0] Correlations among personality domains\n\n# dependent on [1] code\n\n\nrcorr(as.matrix(intLvlPers2[,c(4:9)]), type=\"spearman\")\n\n\n\n### [1] Interaction levels\n\n# this section may be doomed to failure, and ought to be only used for visualization\n# see [2] for replacement\n\n# a. HE, LI, RE, Q, KD, LU, SO\n# b. EM, LB, ED, LO, DA\n# c. CI, EV, PA\n# d. FK, KL, PE \n\n# RSpartic = as.ordered(c(2,1,1,1,2,3,0,3,0,0,1,1,0,2,3,0,0,0))\n# intLvlPers = cbind(aggPers,RSpartic)\n# \n# RStm <- aggregate(intLvlPers, by=list(intLvlPers$RSpartic), FUN=mean)\n# RSts <- aggregate(intLvlPers, by=list(intLvlPers$RSpartic), FUN=sd)\n# \n# mp = barplot(height=as.matrix(RStm[4:9]),beside=TRUE,\n#              #legend.text=c('Never participated','Incomplete participation','Completed full sessions')\n#              ,ylim=c(0,7))\n# \n# segments(c(mp), c(t(t(RStm[4:9] - RSts[4:9]))), c(mp),c(t(t(RStm[4:9] + RSts[4:9]))), lwd=2)\n\n\n### addition:\n### compare individuals who never participated, to those who did (to some degree)\n\n## also... Lyndsey was alive\n## this will have impact on how we calculate Z scores for pers\n\nRSpartic = as.ordered(c(1,1,1,1,1,1,0,1,0,0,1,1,0,1,1,0,0,0,0))\nintLvlPers2 = cbind(RSpartic, aggPers)\n\nRStm <- aggregate(intLvlPers2, by=list(intLvlPers2$RSpartic), FUN=mean)\nRSts <- aggregate(intLvlPers2, by=list(intLvlPers2$RSpartic), FUN=sd)\n\nmp = barplot(height=as.matrix(RStm[5:10]),beside=TRUE,\n             #legend.text=c('Never participated','Incomplete participation','Completed full sessions')\n             ,ylim=c(0,7),\n             names.arg=c('Dominance','Extraversion','Conscientiousness',\n                         'Agreeableness','Neuroticism','Openness'))\n\nsegments(c(mp), c(t(t(RStm[5:10] - RSts[5:10]))), c(mp),c(t(t(RStm[5:10] + RSts[5:10]))), lwd=2)\n\n\nc.t = t.test(intLvlPers2$Conscientiousness[intLvlPers2$RSpartic==1],intLvlPers2$Conscientiousness[intLvlPers2$RSpartic==0])\n# definitely\nn.t = t.test(intLvlPers2$Neuroticism[intLvlPers2$RSpartic==1],intLvlPers2$Neuroticism[intLvlPers2$RSpartic==0])\n# yes\no.t = t.test(intLvlPers2$Openness[intLvlPers2$RSpartic==1],intLvlPers2$Openness[intLvlPers2$RSpartic==0])\n# yes\nd.t = t.test(intLvlPers2$Dominance[intLvlPers2$RSpartic==1],intLvlPers2$Dominance[intLvlPers2$RSpartic==0])\n# yes\n\np.adjust(c(0.002396, 0.02227, 0.03598, 0.04071), 'BH', 4)\n# okay, all pass, post correction\n\nlibrary(lsr)\ncohensD(intLvlPers2$Conscientiousness[intLvlPers2$RSpartic==1],intLvlPers2$Conscientiousness[intLvlPers2$RSpartic==0])\ncohensD(intLvlPers2$Neuroticism[intLvlPers2$RSpartic==1],intLvlPers2$Neuroticism[intLvlPers2$RSpartic==0])\ncohensD(intLvlPers2$Openness[intLvlPers2$RSpartic==1],intLvlPers2$Openness[intLvlPers2$RSpartic==0])\ncohensD(intLvlPers2$Dominance[intLvlPers2$RSpartic==1],intLvlPers2$Dominance[intLvlPers2$RSpartic==0])\n\n# starting from 'scratch'\n\n\n# booterLvl <- NULL\n# for (i in 1:500){\n#   booterLvl = rbind(booterLvl,intLvlPers)\n# }\n# \n#   \n#   \n# library(nnet)\n# RS.mult.lvl.0 <- multinom(RSpartic ~ Dominance + Conscientiousness + Openness + Neuroticism +\n#                             Agreeableness + Extraversion,  data = intLvlPers)\n# # this doesn't _really_ seem lke it has worked\n# \n# \n# #polr doesn't work for all predictors\n# library(MASS)\n# RS.om.lvl.0 <- polr(RSpartic ~ Dominance + Conscientiousness + Openness + Neuroticism +\n#                       #Agreeableness + \n#                       Extraversion,\n#                     data = intLvlPers, model = \"probit\"\n#                     )\n# \n# # nor does clm...\n# library(ordinal)\n# RS.om.lvl.b0 <- clm(RSpartic ~ Dominance + Conscientiousness + Openness + Neuroticism +\n#        Agreeableness + Extraversion,\n#      data = booterLvl #, link = \"probit\"\n# )\n# \n# saveB = Boot(RS.om.lvl.0, R = 1000, method = 'case') # doens't work\n# \n# \n# # ... nope\n# library(rms)\n# RS.om.lvl.0 <- #orm # is original\n#   lrm(RSpartic ~ Dominance + Conscientiousness + Openness + Neuroticism +\n#                      Agreeableness + Extraversion,\n#                    data = intLvlPers #, model = \"probit\"\n# )\n# \n# \n# # \n# library(glmnet)\n# \n# fit3=glmnet(as.matrix(intLvlPers[,3:8]),\n#             as.double(intLvlPers$RSpartic)-1,\n#             #lapply(intLvlPers$RSpartic,as.numeric),\n#             family=\"multinomial\")\n# \n# \n# # I have no idea\n# library(VGAM)\n# RS.v.0 <- vglm(RSpartic ~ Dominance + Conscientiousness + Openness + Neuroticism +\n#                  Agreeableness + Extraversion,\n#                data = intLvlPers,\n#                family=cumulative(link=\"multilogit\", parallel=TRUE)\n# )\n# \n# \n# # let's do this first with the Tukey tests\n# #library(multcomp)\n# library(DTK)\n# RlvlS.dtk.d = DTK.test(intLvlPers$Dominance, intLvlPers$RSpartic)\n# RlvlS.dtk.c = DTK.test(intLvlPers$Conscientiousness, intLvlPers$RSpartic)\n# RlvlS.dtk.n = DTK.test(intLvlPers$Neuroticism, intLvlPers$RSpartic)\n# RlvlS.dtk.o = DTK.test(intLvlPers$Openness, intLvlPers$RSpartic)\n# \n# library(MASS)\n# mod.polr.o <- polr(RSpartic ~ Openness + I(Openness^2), data=intLvlPers)\n# mod.polr.c <- polr(RSpartic ~ Conscientiousness + I(Conscientiousness^2), data=intLvlPers)\n# mod.polr.d <- polr(RSpartic ~ Dominance + I(Dominance^2), data=intLvlPers) # + I(Dominance^2)\n# mod.polr.n <- polr(RSpartic ~ Neuroticism + I(Neuroticism^2), data=intLvlPers)\n# \n# # below is consistent with above\n# mod.polr.ce <- polr(RSpartic ~ Extraversion + Conscientiousness, data=intLvlPers)\n# mod.polr.oa <- polr(RSpartic ~ Openness + Agreeableness, data=intLvlPers)\n# \n# \n# mod.polr.odnc <- polr(RSpartic ~ Openness + Dominance + Neuroticism + Conscientiousness, data=intLvlPers)\n# mod.polr.all <- polr(RSpartic ~ Extraversion + Openness + Dominance + Neuroticism + Conscientiousness, data=intLvlPers)\n\n\n\n# [2] Trials before drop-out\n#     \n  \n# should be able to model each training stage / individual with Surv\n# with frailty for each stage, and individual\n# ending in either completion of the training or dropout\n\n\nTraTri = RStemp[RStemp$stage!='test',]\nTraTri.1 = TraTri[TraTri$Correctness==' Correct',]\n\nlibrary(plyr)\n#TraTri = aggregate(TraTri, by=list('chimp','stage'), FUN=count)\n\n##### I don't think anything other the line below is needed\naggTraTri = count(RStemp, c(\"chimp\",\"stage\"))\n\naggTraTri.1 = count(TraTri.1, c(\"chimp\",\"stage\"))\naggTraTri$correct = NA\naggTraTri[aggTraTri$stage!='test',]$correct = aggTraTri.1$freq\n\n# TODO fix below\naggTraTri$prop = aggTraTri$correct / aggTraTri$freq\n#####\n\n# adding a column for whether the chimp dropped out or not (0: in, 1: dropped)\n# the below seems to be more wrong than it should be ... this may be an aggregation effect\n#TraTri = cbind(TraTri, dropped = c(0,0,0,1,1,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,1,0,0,0,0,1,0,0,1))\n\n#TraTri = cbind(TraTri, dropped = c(0,0,0,1,1,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,1,0,0,0,0,1))\naggTraTri = cbind(aggTraTri, dropped = \n                 c(0,0,0,0,1,0,0,0,1,0,\n                   0,0,0,0,0,0,1,0,0,0,\n                   1,0,0,0,0,1,0,0,0,0,\n                   1,0,0,0,0,0,0,0,1,0,\n                   0,0,0,0,1,1,1,1))\n\naggTraTri = merge(aggTraTri,aggPers, by.x= \"chimp\", \"Chimp\")\n\nlibrary(survival)\ndOut = Surv(aggTraTri$freq, aggTraTri$dropped, type='right')\n\n# which distribution should we use?\nthemodel <- (dOut ~ aggTraTri$Dominance + aggTraTri$Conscientiousness + aggTraTri$Openness + \n               aggTraTri$Neuroticism + aggTraTri$Agreeableness + aggTraTri$Extraversion\n             + frailty.gaussian(aggTraTri$chimp))\nthedistributions<-c(\"weibull\",\"exponential\",\"lognormal\",\"loglogistic\")\n\ndistlist = 0\nLLlist1 = 0\nLLlist2 = 0\nestimates = 0\nfor (i in 1:length(thedistributions)) {\n  thisdist = thedistributions[i]\n  fit = survreg(themodel, dist = thisdist)\n  distlist[i] = thisdist\n  LLlist1[i] = -2*(fit$loglik[1])\n  LLlist2[i] = -2*(fit$loglik[2])\n  estimates[i] = exp(as.numeric(fit$coefficients[2]))  }\nResult = data.frame(distlist, LLlist1, LLlist2, estimates, LLlist1 - LLlist2)\nnames(Result) = c(\"Distribution\", \"-2*LL(Baseline)\", \"-2*LL(Full)\",\"Estimate\")\nResult = Result[order(Result[,3]),]\nResult\n\n\n# basic continuous right censored survival model\n\nRS.drop.aft <- survreg(dOut ~ Dominance + Conscientiousness + Openness + Neuroticism +\n                      Agreeableness + Extraversion, data = aggTraTri, dist='lognormal')\n\nRS.drop.aft.frail <- survreg(dOut ~ Dominance + Conscientiousness + Openness + Neuroticism +\n                     Agreeableness + Extraversion +\n                       frailty.gaussian(chimp)\n                       , data = aggTraTri, dist='weibull')\n\nsummary(RS.drop.aft.frail)\nci.drop = confint(RS.drop.aft.frail, method='profile')\n# Significant effect for Conscientiousness\n# high Conscientious chimps stay in the task for more trials\n\n# perhaps, for consistency\nlibrary(coxme)\nRS.drop.cox.f <- coxme(dOut ~ Dominance + Conscientiousness + Openness + Neuroticism +\n                               Agreeableness + Extraversion +\n                               (1 | stage) + (1 | chimp)\n                             , data = aggTraTri)\nconfint.merMod(RS.drop.cox.f, method='Wald') # how to make this work?\nsummary(RS.drop.cox.f)\n# yes, the Cox ME {TODO}\n# probably just need to do the CIs by hand\n\nlibrary(MuMIn)\nu.cox = updateable(coxme)\nu.cox.RS = u.cox(dOut ~ Dominance + Conscientiousness + Openness + Neuroticism +\n                   Agreeableness + Extraversion +\n                   (1 | stage) + (1 | chimp)\n                 , data = aggTraTri)\nu.ci = model.avg(u.cox.RS, u.cox.RS)\nconfint(u.ci)\n# boom\n\nAICtab(RS.drop.cox.f, RS.drop.aft.frail,\n       weights=T, delta=T, base=T, logLik=T, sort=T) \n\npchisq(2*(-63.1+25), 7.78-7.72   ,lower.tail=F)\n\n\n\nlibrary(texreg)\n\next.RSdaf=extract(RS.drop.aft.frail, include.aic = FALSE, include.bic=FALSE, include.dic=FALSE,\n                include.deviance=FALSE, include.loglik=FALSE,include.nobs=FALSE,\n                include.groups=FALSE,include.variance=FALSE)\n\nRS2surv.tbl = htmlreg(list(ext.RSdaf), custom.model.names=c('Std. Estimate'), ci.force=TRUE,\n                  caption = \"\", groups=NULL, digits=3, ci.force.level = 0.95, ci.test=NULL,\n                  bold=TRUE, custom.note = '')#, reorder.coef = c(1:5,8,9,6,11,10,7),\n                  #custom.coef.names=c(NA,\"Age\",\"Age<sup>2</sup>\",\"Sex\",NA,NA,NA,NA,NA,NA,NA))\nwrite(RS2surv.tbl,\"../presentation images/RS2surv.html\")\n\n\n# how about just the test trials?\nTestTri = aggTraTri[aggTraTri$stage=='test',]\ndOuTst = Surv(TestTri$freq, TestTri$dropped, type='right')\n\nRS.drop.aft.f.tst <- survreg(dOut ~ Dominance + Conscientiousness + Openness + Neuroticism +\n                               Agreeableness + Extraversion +\n                               frailty(stage)\n                             , data = TestTri, dist='lognormal')\n# not enough df... oh well\n\n\n\n\n\n### [2'-prime] - WIP\n\n# Rate of learning from stage to stage, revisited\n\n# say we remove the testing sessions\n\nTrainOnlyTri <- aggTraTri[aggTraTri$stage!='test',]\nhist(log(TrainOnlyTri$freq), breaks = 20)\n\n\nRS.trial.lmm.tot <- lmer(log(freq) ~ Dominance + Conscientiousness + Openness + Neuroticism +\n                           Agreeableness + Extraversion +\n                           (1 | chimp) + (1 | stage)\n                         , data = TrainOnlyTri)\n\nRS.trial.glmm.tot <- glmer(freq ~ Dominance + Conscientiousness + Openness + Neuroticism +\n                           Agreeableness + Extraversion +\n                           (1 | chimp) + (1 | stage), family = 'poisson'\n                         , data = TrainOnlyTri)\nsummary(RS.trial.glmm.tot)\nconfint(RS.trial.lmm.tot)\n\n# the below model shouldn't be formulated quite like this,\n# and won't produce meaningful results\nRS.trial.lmm.prop <- lmer(prop ~ Dominance + Conscientiousness + Openness + Neuroticism +\n                            Agreeableness + Extraversion +\n                            (1 | chimp) + (1 | stage)\n                          , data = TrainOnlyTri)\n\n# again, for rerunning:\nTrainOnlyTri <- aggTraTri[aggTraTri$stage!='test',]\n# # and how about removing the training sessions where individuals dropped out\n# TrainOnlyTri <- TrainOnlyTri[TrainOnlyTri$dropped == 0,]\n# # and some custom removals\n# # # dropping just the 0 adds\nTrainOnlyTri <- TrainOnlyTri[-c(1,2,4,8,11,12,13,14,19,21,22,24,26,27,29,32,36,38,40,42),] # 21 is Frek's outlier\n# # these blocks were not trained to criterion\n\n\nRS.trial.lmm.tot <- lmer(log(freq) ~ Dominance + Conscientiousness + Openness + Neuroticism +\n                           Agreeableness + Extraversion +\n                           (1 | chimp) + (1 | stage)\n                         , data = TrainOnlyTri)\n\nRS.trial.glmm.tot <- glmer(freq ~ Dominance + Conscientiousness + Openness + Neuroticism +\n                             Agreeableness + Extraversion\n                             + (1 | chimp)\n                             + (1 | stage)\n                           , family = poisson(link = 'log')\n                           , data = TrainOnlyTri, \n                           #control = glmerControl(optimizer='nloptwrap')\n                           control = glmerControl(optimizer='Nelder_Mead')\n                           ) \nsummary(RS.trial.glmm.tot)\n#confint(RS.trial.lmm.tot)\nci.RS.toCompletion = confint(RS.trial.glmm.tot, method = 'Wald')\n\n\n\n## an entirely different *kind* of survival analysis\n# whoever reached criterion by the end of the block, is given status\n# everyone else is censorsed out\n\nTrainOnlyTri$crit = c(1,1,1,0,1,\n                      0,\n                      1,0,0,\n                      0,0,0,0, # maybe flip :3: (back to/from 0) \n                      0,1,1,1,  # Eva switches conditions too...\n                      1,0,1,\n                      1,0,1,\n                      0,\n                      0,0,\n                      1,1,0,1,0,\n                      0,\n                      1,1,1,\n                      1,1,1,1,0,1,\n                      0)\n# this will also be useful for filtering\n\ndCrit = Surv(TrainOnlyTri$freq, TrainOnlyTri$crit, type='right')\n\n# tested, lognormal is good\n\nRS.crit.aft.frail <- survreg(dCrit ~ Dominance + Conscientiousness + Openness + Neuroticism +\n                               Agreeableness + Extraversion +\n                               frailty(stage)\n                             , data = TrainOnlyTri, dist='lognormal')\nconfint(RS.crit.aft.frail)\n# nothing there... Cox to check:\n\nRS.crit.cox <- coxme(dCrit ~ Dominance + Conscientiousness + Openness + Neuroticism +\n                       Agreeableness + Extraversion\n                     + (1 | stage) + (1 | chimp)\n                     , data = TrainOnlyTri)\nsummary(RS.crit.cox)\n# Nope.\nu.cox.RS.crit = u.cox(dCrit ~ Dominance + Conscientiousness + Openness + Neuroticism +\n                   Agreeableness + Extraversion\n                 + (1 | stage) + (1 | chimp)\n                 , data = TrainOnlyTri)\nu.ci.crit = model.avg(u.cox.RS.crit, u.cox.RS.crit)\nconfint(u.ci.crit)\n\n\nRS.crit.lmm <- lmer(log(freq) ~ Dominance + Conscientiousness + Openness + Neuroticism +\n                           Agreeableness + Extraversion +\n                           (1 | chimp) + (1 | stage)\n                         , data = TrainOnlyTri[TrainOnlyTri$crit == 1,])\nsummary(RS.crit.lmm)\n\nRS.crit.glmm <- glmer(freq ~ Dominance + Conscientiousness + Openness + Neuroticism +\n                             Agreeableness + Extraversion +\n                             (1 | chimp) + (1 | stage), family = 'poisson'\n                           , data = TrainOnlyTri[TrainOnlyTri$crit == 1,])\nsummary(RS.crit.glmm)\n# uuuuuhhhhh what??\n# this can't be right\nconfint(RS.crit.glmm, method = 'Wald')\n\n# looks like there's nothing here\n# probably too few data points\n\n\n\n### [3] Accuracy\n\n# \"simple\" GLMM of accuracy predicted by personality\n\nrs.glm1 <- glmer(Correctness ~ Dominance + Conscientiousness + Openness + Neuroticism +\n                   Agreeableness + Extraversion +\n                   (1 | chimp) + (1 | stage/TrialType)  #(1 | Section) + (1 | TrialType) + ,\n                 , data = RStemp, family = binomial\n)\n\n# library(arm)\n# standardize() # converts everything to 2SE coefficients\n\nrs.glm1.0 <- glmer(Correctness ~ Dominance + Conscientiousness + Openness + Neuroticism +\n                     Agreeableness + Extraversion + \n                     #Trial +  # adding this does... well, nothing.\n                     (1 | chimp) + (1 | stage) + (1 | TrialType) #+ (1 | Section) + (1 | depend)\n                   # last two look degenerate\n                   , data = RStemp, family = binomial\n)\n\n# confint(rs.glm1.0, method=\"boot\")\n# annoying, Wald is the only one which works\nrs.accu.ci = confint(rs.glm1.0, method=\"Wald\")\n\next.RSaccu=extract(rs.glm1.0, include.aic = FALSE, include.bic=FALSE, include.dic=FALSE,\n                  include.deviance=FALSE, include.loglik=FALSE,include.nobs=FALSE,\n                  include.groups=FALSE,include.variance=FALSE)\n\nRS2accu.tbl = htmlreg(list(ext.RSaccu), custom.model.names=c('Std. Estimate'), ci.force=TRUE,\n                      caption = \"\", groups=NULL, digits=3, ci.force.level = 0.95, ci.test=NULL,\n                      bold=TRUE, custom.note = '')\n\nwrite(RS2accu.tbl,\"../presentation images/RS2accu.html\")\n\n# improve grouping with regards to AB,AA and training stages\n# turns out not to be helpful\n\n# what about just at testing\n# rs.glm1.tstOnly <- glmer(Correctness ~ Dominance + Conscientiousness + Openness + Neuroticism +\n#                        Agreeableness + Extraversion +\n#                        (1 | chimp) #+ (1 | TrialType)  #(1 | Section) + (1 | TrialType) + ,\n#                      , data = temp[temp$TrialType==' Test',], family = binomial\n# )\n## there are multicolinearity / rank deficiency issues with the above, so just leave it\n\n\nrs.glm2.0 <- glmer(Correctness ~ Dominance + Conscientiousness + Openness + Neuroticism +\n                     Agreeableness + Extraversion +\n                     scale(Trial) +  # adding this does... well, very little.\n                     (1 | chimp) + (1 | stage) + (1 | TrialType) #+ (1 | Section) + (1 | depend)\n                   # last two look degenerate\n                   , data = RStemp, family = binomial\n)\n# shall we make trial more cumulative?\n\nrs.glm3.0 <- glmer(Correctness ~ Dominance + Conscientiousness + Openness + Neuroticism +\n                     Agreeableness + Extraversion +\n                     scale(day) +  \n                     (1 | chimp) + (1 | stage) + (1 | TrialType) #+ (1 | Section) + (1 | depend)\n                   # last two look degenerate\n                   , data = RStemp, family = binomial\n)\nconfint(rs.glm3.0, method='Wald')\n\n\n\nrs.glm3.td <- glmer(Correctness ~ Dominance + Conscientiousness + Openness + Neuroticism +\n                     Agreeableness + Extraversion +\n                     scale(day) +  scale(Trial) +\n                     (1 | chimp) + (1 | stage) + (1 | TrialType) #+ (1 | Section) + (1 | depend)\n                   # last two look degenerate\n                   , data = RStemp, family = binomial\n)\nsummary(rs.glm3.td)\nconfint(rs.glm3.td, method = 'Wald')\n\nrs.glm3.ints <- glmer(Correctness ~ Dominance*day + Conscientiousness*day + Openness*day + Neuroticism*day +\n                     Agreeableness*day + Extraversion*day +\n                      \n                     (1 | chimp) + (1 | stage) + (1 | TrialType) #+ (1 | Section) + (1 | depend)\n                   # last two look degenerate\n                   , data = RStemp, family = binomial\n)\nrs.glm3.iA <- glmer(Correctness ~ Dominance + Conscientiousness + Openness + Neuroticism +\n                        Agreeableness*day + Extraversion +\n                        (1 | chimp) + (1 | stage) + (1 | TrialType) #+ (1 | Section) + (1 | depend)\n                      # last two look degenerate\n                      , data = RStemp, family = binomial\n)\n\n# individual other interactions didn't work out\n\nAICtab(rs.glm2.0, rs.glm1.0,rs.glm3.0, rs.glm3.td, weights=T, delta=T, base=T, logLik=T, sort=T) \n\nAICtab(rs.glm3.iA, rs.glm3.ints,rs.glm3.0, rs.glm3.td, weights=T, delta=T, base=T, logLik=T, sort=T) \n\nsummary(rs.glm3.iA)\n\n# including date\npchisq(2*(-8808.6+8836.8),11-10,lower.tail=F)\n# including trial, on top of date\npchisq(2*(-8808.604+8808.625),12-11,lower.tail=F)\n\n\n### Learning\n# after 33/48 trials, chimps progressed to next stage\n\n# how can we get a handle on this?\nsetwd(\"training/2-choice AA1 black/\")\n\n\n### [4] Touches & RT\n\n\n## Number of touches:\n\n\n# 738 (?)\n# 728\n\ngrep(\"/\",as.character(temp$Coordinates[728]))\n\nfor (i in 1:dim(RStemp)[1]){\n  RStemp$touches[i] = countCharOccurrences('/', as.character(RStemp$Coordinates[i]))\n  \n}\n# okay that function makes it work\n#countCharOccurrences('/', as.character(temp$Coordinates[728]))\n\n# below is the most consistently defined model, I think.\nrs.touch.lmm <- glmer(touches ~ Dominance + Conscientiousness + Openness + Neuroticism +\n                      Agreeableness + Extraversion +\n                      (1 | chimp) + (1 | stage) + (1 | TrialType) #+ (1 | Section) + (1 | depend)\n                    , data = RStemp[RStemp$touches > 0,]\n                    #, data = temp[temp$Correctness==' Correct',]\n                    , family = poisson(link = \"log\"), control = glmerControl(optimizer='nloptwrap')\n)\nrs.touch.lmm.d <- glmer(touches ~ Dominance + Conscientiousness + Openness + Neuroticism +\n                        Agreeableness + Extraversion + day +\n                        (1 | chimp) + (1 | stage) + (1 | TrialType) #+ (1 | Section) + (1 | depend)\n                      , data = RStemp[RStemp$touches > 0,]\n                      #, data = temp[temp$Correctness==' Correct',]\n                      , family = poisson(link = \"log\"), control = glmerControl(optimizer='Nelder_Mead')\n)\n\n\nrs.touch.lmm.1 <- glmer(touches ~ Dominance + Conscientiousness + Openness + Neuroticism +\n                        Agreeableness + Extraversion +\n                        (1 | chimp) + (1 | stage) + (1 | TrialType) #+ (1 | Section) + (1 | depend)\n                      #, data = temp\n                      , data = RStemp[(RStemp$Correctness==' Correct' & RStemp$touches > 0),]\n                      , family = poisson(link = \"log\"), control = glmerControl(optimizer='Nelder_Mead')\n)\nrs.touch.lmm.1.d <- glmer(touches ~ Dominance + Conscientiousness + Openness + Neuroticism +\n                          Agreeableness + Extraversion + day +\n                          (1 | chimp) + (1 | stage) + (1 | TrialType) #+ (1 | Section) + (1 | depend)\n                        #, data = temp\n                        , data = RStemp[(RStemp$Correctness==' Correct' & RStemp$touches > 0),]\n                        , family = poisson(link = \"log\"), control = glmerControl(optimizer='Nelder_Mead')\n)\n\n\nrs.touch.lmm.0 <- glmer(touches ~ Dominance + Conscientiousness + Openness + Neuroticism +\n                        Agreeableness + Extraversion +\n                        (1 | chimp) + (1 | stage) + (1 | TrialType) #+ (1 | Section) + (1 | depend)\n                      #, data = temp\n                      ,  data = RStemp[(RStemp$Correctness==' Incorrect' & RStemp$touches > 0),]\n                      , family = poisson(link = \"log\"), control = glmerControl(optimizer='Nelder_Mead')\n)\nrs.touch.lmm.0.d <- glmer(touches ~ Dominance + Conscientiousness + Openness + Neuroticism +\n                          Agreeableness + Extraversion + day + \n                          (1 | chimp) + (1 | stage) + (1 | TrialType) #+ (1 | Section) + (1 | depend)\n                        #, data = temp\n                        ,  data = RStemp[(RStemp$Correctness==' Incorrect' & RStemp$touches > 0),]\n                        , family = poisson(link = \"log\"), control = glmerControl(optimizer='Nelder_Mead')\n)\n\n\nAICtab(rs.touch.lmm, rs.touch.lmm.d, rs.touch.lmm.1,\n       rs.touch.lmm.1.d,# rs.touch.lmm.0, rs.touch.lmm.0.d, \n       weights=T, delta=T, base=T, logLik=T, sort=T) \n\n\n# won't complete with N_M\n# probably just have to deal with Wald\nci.touches <- confint(rs.touch.lmm, method='Wald')\n#ci.touches.0 <- confint(rs.touch.lmm.0, method='profile')\n#ci.touches.1 <- confint(rs.touch.lmm.1, method='profile')\nci.touches.d <- confint(rs.touch.lmm.d, method='Wald')\n#ci.touches.0.d <- confint(rs.touch.lmm.0.d, method='Wald')\n#ci.touches.1.d <- confint(rs.touch.lmm.1.d, method='Wald')\n\n\n# All - adding date\npchisq(2*(-9050.7+9052.5),11-10,lower.tail=F)\n\n\n\n### RT now\n\n# convergence problems with CIs can be fixed\n# the best solution at this point seems to be thru Nelder_Mead\n\nrs.rt.lmm.pers <- lmer(log(RT) ~ Dominance + Conscientiousness + Openness + Neuroticism +\n                         Agreeableness + Extraversion +\n                         (1 | chimp) + (1 | stage) + (1 | TrialType) #+ (1 | Section) + (1 | depend)\n                       , data = RStemp\n)\n\nrs.rt.lmm.pers.day <- lmer(log(RT) ~ Dominance + Conscientiousness + Openness + Neuroticism +\n                             Agreeableness + Extraversion + scale(day) + \n                             (1 | chimp) + (1 | stage) + (1 | TrialType) #+ (1 | Section) + (1 | depend)\n                           , data = RStemp, control = lmerControl(optimizer='Nelder_Mead')\n)\n\nrs.rt.lmm.pers.td <- lmer(log(RT) ~ Dominance + Conscientiousness + Openness + Neuroticism +\n                             Agreeableness + Extraversion + scale(day) + scale(Trial) + \n                             (1 | chimp) + (1 | stage) + (1 | TrialType) #+ (1 | Section) + (1 | depend)\n                           , data = RStemp, control = lmerControl(optimizer='Nelder_Mead')\n)\n\n\n\nrs.rt.lmm.1 <- lmer(log(RT) ~ Dominance + Conscientiousness + Openness + Neuroticism +\n                      Agreeableness + Extraversion +\n                      (1 | chimp) + (1 | stage) + (1 | TrialType) #+ (1 | Section) + (1 | depend)\n                    , data = RStemp[RStemp$Correctness==' Correct',],\n                    control = lmerControl(optimizer='Nelder_Mead')\n)\n\n\nrs.rt.lmm.1.day <- lmer(log(RT) ~ Dominance + Conscientiousness + Openness + Neuroticism +\n                          Agreeableness + Extraversion + scale(day) +\n                          (1 | chimp) + (1 | stage) + (1 | TrialType) #+ (1 | Section) + (1 | depend)\n                        , data = RStemp[RStemp$Correctness==' Correct',],\n                        control = lmerControl(optimizer='Nelder_Mead' #\"nloptwrap\"\n                          # lmerControl(optimizer = \"optimx\", \n                          #                     optCtrl=list(#maxfun=1000, \n                          #                                  #method='nlminb'\n                          #                                  method='L-BFGS-G' )\n                                              ))\n\nrs.rt.lmm.1.td <- lmer(log(RT) ~ Dominance + Conscientiousness + Openness + Neuroticism +\n                          Agreeableness + Extraversion + scale(day) + scale(Trial) + \n                          (1 | chimp) + (1 | stage) + (1 | TrialType) #+ (1 | Section) + (1 | depend)\n                        , data = RStemp[RStemp$Correctness==' Correct',],\n                        control = lmerControl(optimizer='Nelder_Mead'))\n\n\n\nci.RT.1 = confint(rs.rt.lmm.1, method='profile')\nci.RT.1.d = confint(rs.rt.lmm.1.day, method='profile')\nci.RT.1.td = confint(rs.rt.lmm.1.td, method='profile')\n\n\nci.RT = confint(rs.rt.lmm.pers)\nci.RT.d = confint(rs.rt.lmm.pers.day, method='profile')\nci.RT.td = confint(rs.rt.lmm.pers.td, method='profile')\n\nAICtab(rs.rt.lmm.pers, rs.rt.lmm.pers.day, rs.rt.lmm.pers.td,\n      #rs.rt.lmm.1, rs.rt.lmm.1.day, rs.rt.lmm.1.td,\n       weights=T, delta=T, base=T, logLik=T, sort=T) \n\n# All - including date\npchisq(2*(-19647.4+19647.2),12-11,lower.tail=F)\n# All - including date + trial : not a valid test\npchisq(2*(-19643.5+19647.2),13-12,lower.tail=F)\n\n# Correct - including date\npchisq(2*(-11753.0+11759.8),12-11,lower.tail=F)\n# Correct - including date + trial\npchisq(2*(-11751.6+11753.0),13-12,lower.tail=F)\n\n\n\n\n# let's try with just the single touches\n\nrs.rt.lmm.1.1tch <- lmer(log(RT) ~ Dominance + Conscientiousness + Openness + Neuroticism +\n                      Agreeableness + Extraversion +\n                      (1 | chimp) + (1 | stage) + (1 | TrialType) #+ (1 | Section) + (1 | depend)\n                    , data = RStemp[(RStemp$Correctness==' Correct' & RStemp$touches == 1),]\n)\nrs.rt.lmm.1.day.1tch <- lmer(log(RT) ~ Dominance + Conscientiousness + Openness + Neuroticism +\n                          Agreeableness + Extraversion + day +\n                          (1 | chimp) + (1 | stage) + (1 | TrialType) #+ (1 | Section) + (1 | depend)\n                        , data = RStemp[(RStemp$Correctness==' Correct' & RStemp$touches == 1),]\n)\n# They don't seem to help. Probably due to the reduced sample size.\n\n\n\ncountCharOccurrences <- function(char, s) {\n  s2 <- gsub(char,\"\",s)\n  return (nchar(s) - nchar(s2))\n}\n",
    "created" : 1445529063931.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "90823162",
    "id" : "B3653EA3",
    "lastKnownWriteTime" : 1465320583,
    "last_content_update" : 1465320583646,
    "path" : "C:/Users/s1229179/GitHub/R/Budongo cognition/RS cognition/RS_analysis.R",
    "project_path" : "RS_analysis.R",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}