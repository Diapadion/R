{
    "contents" : "### Analysis of Ruth Sonnweber's cognitive data\n\n# 1. Distinguish between Interaction levels\n#   a. chimps who did not participate\n#   b. chimps who were trained but did not proceed to testing (EM, LB, ED, LO, DA)\n#   c. chimps who were tested but did not complete all stages (CI, EV, PA)\n#   d. chimps who finished all tasks (FK, KL, PE)\n# 2. Model accuracy across all trials\n#   - all training trials? (etc...)\n# 3. Look at the number of trials taken to complete each stage of training\n# 4. Model RT\n#   - number of touches\n\n#######\n\n### [1] Interaction levels\n\n# a. HE, LI, RE, Q, KD, LU, SO\n# b. EM, LB, ED, LO, DA\n# c. CI, EV, PA\n# d. FK, KL, PE \n\nRSpartic = as.ordered(c(2,1,1,1,2,3,0,3,0,0,1,1,0,2,3,0,0,0))\nintLvlPers = cbind(aggPers,RSpartic)\n\nRStm <- aggregate(intLvlPers, by=list(intLvlPers$RSpartic), FUN=mean)\nRSts <- aggregate(intLvlPers, by=list(intLvlPers$RSpartic), FUN=sd)\n\nmp = barplot(height=as.matrix(RStm[4:9]),beside=TRUE,\n             #legend.text=c('Never participated','Incomplete participation','Completed full sessions')\n             ,ylim=c(0,7))\n\nsegments(c(mp), c(t(t(RStm[4:9] - RSts[4:9]))), c(mp),c(t(t(RStm[4:9] + RSts[4:9]))), lwd=2)\n\n#polr doesn't work for all predictors\nlibrary(MASS)\nRS.om.lvl.0 <- polr(RSpartic ~ Dominance + Conscientiousness + Openness + Neuroticism +\n                      Agreeableness + Extraversion,\n                    data = intLvlPers, model = \"probit\"\n                    )\n\n# nor does clm...\nlibrary(ordinal)\nRS.om.lvl.0 <- clm(RSpartic ~ Dominance + Conscientiousness + Openness + Neuroticism +\n       Agreeableness + Extraversion,\n     data = intLvlPers , link = \"probit\"\n)\n\n# ... nope\nlibrary(rms)\nRS.om.lvl.0 <- #orm # is original\n  lrm(RSpartic ~ Dominance + Conscientiousness + Openness + Neuroticism +\n                     Agreeableness + Extraversion,\n                   data = intLvlPers #, model = \"probit\"\n)\n\n\n# \nlibrary(glmnet)\n\nfit3=glmnet(as.matrix(intLvlPers[,3:8]),\n            as.double(intLvlPers$RSpartic)-1,\n            #lapply(intLvlPers$RSpartic,as.numeric),\n            family=\"multinomial\")\n\n\n# I have no idea\nlibrary(VGAM)\nRS.v.0 <- vglm(RSpartic ~ Dominance + Conscientiousness + Openness + Neuroticism +\n                 Agreeableness + Extraversion,\n               data = intLvlPers,\n               family=cumulative(link=\"multilogit\", parallel=TRUE)\n)\n\n\n# let's do this first with the Tukey tests\n#library(multcomp)\nlibrary(DTK)\nRlvlS.dtk.d = DTK.test(intLvlPers$Dominance, intLvlPers$RSpartic)\nRlvlS.dtk.c = DTK.test(intLvlPers$Conscientiousness, intLvlPers$RSpartic)\nRlvlS.dtk.n = DTK.test(intLvlPers$Neuroticism, intLvlPers$RSpartic)\nRlvlS.dtk.o = DTK.test(intLvlPers$Openness, intLvlPers$RSpartic)\n\nlibrary(MASS)\nmod.polr.o <- polr(RSpartic ~ Openness + I(Openness^2), data=intLvlPers)\nmod.polr.c <- polr(RSpartic ~ Conscientiousness + I(Conscientiousness^2), data=intLvlPers)\nmod.polr.d <- polr(RSpartic ~ Dominance + I(Dominance^2), data=intLvlPers) # + I(Dominance^2)\nmod.polr.n <- polr(RSpartic ~ Neuroticism + I(Neuroticism^2), data=intLvlPers)\n\n# below is consistent with above\nmod.polr.ce <- polr(RSpartic ~ Extraversion + Conscientiousness, data=intLvlPers)\nmod.polr.oa <- polr(RSpartic ~ Openness + Agreeableness, data=intLvlPers)\n\n\nmod.polr.odnc <- polr(RSpartic ~ Openness + Dominance + Neuroticism + Conscientiousness, data=intLvlPers)\nmod.polr.all <- polr(RSpartic ~ Extraversion + Openness + Dominance + Neuroticism + Conscientiousness, data=intLvlPers)\n\n\n### [2] Accuracy\n\n# \"simple\" GLMM of accuracy predicted by personality\nlibrary(lme4)\nrs.glm1 <- glmer(Correctness ~ Dominance + Conscientiousness + Openness + Neuroticism +\n                   Agreeableness + Extraversion +\n                   (1 | chimp) + (1 | stage/TrialType)  #(1 | Section) + (1 | TrialType) + ,\n                 , data = temp, family = binomial\n)\n# library(arm)\n# standardize() # converts everything to 2SE coefficients\n\nrs.glm1.0 <- glmer(Correctness ~ Dominance + Conscientiousness + Openness + Neuroticism +\n                     Agreeableness + Extraversion + \n                     #Trial +  # adding this does... well, nothing.\n                     (1 | chimp) + (1 | stage) + (1 | TrialType) #+ (1 | Section) + (1 | depend)\n                                      # last two look degenerate\n                   , data = temp, family = binomial\n)\n\nconfint(rs.glm1.0, method=\"boot\")\nrs.accu.ci = confint(rs.glm1.0, method=\"prof\")\n\n# improve grouping with regards to AB,AA and training stages\n\n# what about just at testing\n# rs.glm1.tstOnly <- glmer(Correctness ~ Dominance + Conscientiousness + Openness + Neuroticism +\n#                        Agreeableness + Extraversion +\n#                        (1 | chimp) #+ (1 | TrialType)  #(1 | Section) + (1 | TrialType) + ,\n#                      , data = temp[temp$TrialType==' Test',], family = binomial\n# )\n## there are multicolinearity / rank deficiency issues with the above, so just leave it\n\n\n\n### Learning\n# after 33/48 trials, chimps progressed to next stage\n\n# how can we get a handle on this?\nsetwd(\"training/2-choice AA1 black/\")\n\n\n# [3] Trials to reach criterion \n#     (or prematurely stop?)\n\n#? - Incorrect out of total trials?\n\n\n\nTraTri = temp[temp$stage!='test',]\nTraTri.1 = TraTri[TraTri$Correctness==' Correct',]\n\nlibrary(plyr)\n#TraTri = aggregate(TraTri, by=list('chimp','stage'), FUN=count)\n\nTraTri = count(TraTri, c(\"chimp\",\"stage\"))\nTraTri.1 = count(TraTri.1, c(\"chimp\",\"stage\"))\nTraTri$correct = TraTri.1$freq\n\nTraTri$prop = TraTri$correct / TraTri$freq\n\nTraTri = merge(TraTri,aggPers, by.x= \"chimp\", \"Chimp\")\n\nhead(TraTri)\n\n\n# sketch model\n\nRS.trial.lmm.tot <- lmer(log(freq) ~ Dominance + Conscientiousness + Openness + Neuroticism +\n                       Agreeableness + Extraversion +\n                       (1 | chimp) + (1 | stage)\n                     , data = TraTri)\n                       \nRS.trial.lmm.prop <- lmer(prop ~ Dominance + Conscientiousness + Openness + Neuroticism +\n                       Agreeableness + Extraversion +\n                       (1 | chimp) + (1 | stage)\n                     , data = TraTri)\n\n# I don't think there is anything here for this kind of model\n\n## Can we model the cumulative functions? Is that what the GLMs do?\n\n\n# [4] RT\n\nlibrary(car)\n\nrs.rt.lmm.all <- lmer(log(RT) ~ Dominance + Conscientiousness + Openness + Neuroticism +\n                   Agreeableness + Extraversion +\n                     (1 | chimp) + (1 | stage)+ (1 | TrialType) #+ (1 | Section) + (1 | depend)\n                 , data = temp\n)\n\nrs.rt.lmm.1 <- lmer(log(RT) ~ Dominance + Conscientiousness + Openness + Neuroticism +\n                        Agreeableness + Extraversion +\n                        (1 | chimp) + (1 | stage) + (1 | TrialType) #+ (1 | Section) + (1 | depend)\n                      , data = temp[temp$Correctness==' Correct',]\n)\n\n# No effects.\n\n## Number of touches:\n\n\n# 738 (?)\n# 728\n\ngrep(\"/\",as.character(temp$Coordinates[728]))\n\nfor (i in 1:dim(temp)[1]){\n  temp$touches[i] = countCharOccurrences('/', as.character(temp$Coordinates[i]))\n  \n}\n# okay that function makes it work\n#countCharOccurrences('/', as.character(temp$Coordinates[728]))\n\n\nrs.touch.lmm <- glmer(touches ~ Dominance + Conscientiousness + Openness + Neuroticism +\n                      Agreeableness + Extraversion +\n                      (1 | chimp) + (1 | stage) + (1 | Section) + (1 | TrialType) + (1 | depend)\n                    , data = temp\n                    #, data = temp[temp$Correctness==' Correct',]\n                    , family = poisson(link = \"log\")\n)\nconfint(rs.touch.lmm)\n\nrs.touch.lmm.0 <- glmer(touches ~ Dominance + Conscientiousness + Openness + Neuroticism +\n                        Agreeableness + Extraversion +\n                        (1 | chimp) + (1 | stage) + (1 | Section) + (1 | TrialType) + (1 | depend)\n                      #, data = temp\n                      , data = temp[temp$Correctness==' Correct',]\n                      , family = poisson(link = \"log\")\n)\n\nrs.touch.lmm.1 <- glmer(touches ~ Dominance + Conscientiousness + Openness + Neuroticism +\n                        Agreeableness + Extraversion +\n                        (1 | chimp) + (1 | stage) + (1 | Section) + (1 | TrialType) + (1 | depend)\n                      #, data = temp\n                      , data = temp[temp$Correctness==' Incorrect',]\n                      , family = poisson(link = \"log\")\n)\n\n\ncountCharOccurrences <- function(char, s) {\n  s2 <- gsub(char,\"\",s)\n  return (nchar(s) - nchar(s2))\n}\n",
    "created" : 1445529063931.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3100638516",
    "id" : "B3653EA3",
    "lastKnownWriteTime" : 1446564631,
    "path" : "C:/Users/s1229179/GitHub/R/Budongo cognition/RS cognition/RS_analysis.R",
    "project_path" : "RS_analysis.R",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_source"
}