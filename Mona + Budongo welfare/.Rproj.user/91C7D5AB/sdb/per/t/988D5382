{
    "collab_server" : "",
    "contents" : "### generalizeability theory \n### to see what's what with our ratings\n\n\n\nswbwel=read.csv(\"Chimp welfare ratings.scrubbed.5.csv\")\n\n\n\n\nlibrary(lme4)\n\n\n# WHY HAS PHI STOPPED WORKING\n\n## I think because of all the missing data for Time\n## ^ seems not\n##\n## Maybe because Time only has two values?\n\n\n\n  ################################################\n  # Getting started\n  ################################################\n  \n\n  # need to make this long, by Items\n\nlibrary(reshape2)\n\nmelted <- melt(swbwel[,c(1,2,10:22,26:29)], id.vars=c('Chimp','Rater','Time'))\n\nmelted.a <- melt(swbwel[,c(1,2,11:22,26:29)], id.vars=c('Chimp','Rater'))\n\n\ncolnames(melted) <- c('Chimp','Rater','Time','Item','Score')\ncolnames(melted.a)<- c('Chimp','Rater','Item','Score')\n  \n\n    # in case of \"p x r x i\"\n  \n      melted$Chimp <- factor(melted$Chimp)\n      melted$Rater <- factor(melted$Rater)\n      melted$Item <- factor(melted$Item)\n      melted$Time <- factor(melted$Time)\n      \n      \n      model.a <- lmer(Score ~ 1 + (1|Rater) + (1|Chimp) + (1|Item) + \n                      (1|Chimp:Rater) + (1|Chimp:Item) + (1|Item:Rater), data=melted.a)\n      \n      \n    # in case of p x r x i x t\n      \n      # warning: takes forever\n      model <- lmer(Score ~ 1 + (1|Rater) + (1|Chimp) + (1|Item) + (1|Time) +\n                      (1|Chimp:Rater) + (1|Chimp:Item) + (1|Chimp:Time) + \n                      (1|Rater:Item) + (1|Rater:Time) + (1|Item:Time) +\n                      (1|Rater:Time:Chimp) + (1|Rater:Time:Item) + \n                      (1|Time:Chimp:Item) + (1|Rater:Chimp:Item)\n                    , data=melted)\n      \n    \n    list(model = model) # To be used later\n    \n\n    \n  ################################################\n  # Variance components (Sorted)\n  ################################################\n  \n\n\n   #   model <- lmer(Score ~ (1|Chimp) + (1|Rater) + (1|Item) + (1|Chimp:Rater) + (1|Chimp:Item) + (1|Item:Rater), melted)\n      \n      # 3 facets\n      counts <- list(length(levels(melted.a$Rater)),length(levels(melted.a$Item)))\n      names(counts) <- c(\"Rater\",\"Item\")\n    \n      vcomp <- VarCorr(model.a)\n      vcompLbls <- c(\"Rater\",\"Chimp\",\"Item\",\"Chimp:Rater\",\"Chimp:Item\",\"Item:Rater\")\n      \n      # 4 facets      \n      counts <- list(length(levels(melted$Rater)),length(levels(melted$Item)))\n      names(counts) <- c(\"Rater\",\"Item\")\n      \n      vcomp <- VarCorr(model)\n      vcompLbls <- c(\"Rater\",\"Chimp\",\"Item\",'Time',\n                     \"Chimp:Rater\",\"Chimp:Item\",'Chimp:Time',\n                     \"Rater:Item\",'Rater:Time','Item:Time',\n                     'Rater:Time:Chimp','Rater:Time:Item',\n                     'Time:Chimp:Item','Rater:Chimp:Item')\n      \n    \n    \n    varCompTable <- function(vcomp,vcompLbls) {\n      compOut <- c()\n      lbl <- c()\n      for(i in 1:length(vcomp)){\n        compOut[i] <- vcomp[[vcompLbls[i]]][,1]\n        lbl[i] <- vcompLbls[i]\n      }\n      compOut[length(vcomp)+1] <- attr(vcomp, \"sc\")[[1]]^2\n      lbl[length(vcomp)+1] <- \"Residual\"\n      \n      compTbl <- data.frame(round(compOut,3),round(compOut/sum(compOut),3)*100)\n      #rownames(compTbl) <- lbl\n      rownames(compTbl) <- gsub(\":\",\"*\",lbl)\n      colnames(compTbl) <- c(\"VarComp\",\"%\")\n      \n      compTblTemp <- compTbl[1:(nrow(compTbl)-1),]\n      compTblTemp <- compTblTemp[order(compTblTemp[,1],decreasing=T),]\n      compTblOrderd <- rbind(compTblTemp,compTbl[nrow(compTbl),])\n      cat(\"Variance components\\n\\n\")\n      print(compTbl)\n      cat(\"\\nVariance components (Sorted)\\n\\n\")\n      print(compTblOrderd)\n    }\n    \n    varCompTable(vcomp, vcompLbls)\n    \n\n  \n  \n  \n  ################################################\n  # G-coefficient\n  ################################################\n  \n   # in case of \"pri\"\n\n      \n\n    calcGCoefficient <- function(uniVal,vcomp,vcompLbls,ids,counts) {\n      denoms <- c()\n      denomsVal <- c()\n      denoms[1] <- \"as.numeric(vcomp[[uniVal]])\"\n      denomsVal[1] <- as.numeric(vcomp[[uniVal]])\n      if (length(ids) > 0) {\n        for(i in 1:length(ids)) {\n          denomItem <- gsub(paste(\":\",uniVal,\"|\",uniVal,\":\",sep=\"\"),\"\",vcompLbls[ids[i]])\n          if (length(grep(\":\",denomItem)) > 0){\n            items <- strsplit(denomItem,\":\")\n            countNums <- c()\n            for (j in 1:length(items[[1]])) {\n              countNums[j] <- counts[[items[[1]][j]]]\n            }\n            denoms[i+1] <- paste('(as.numeric(vcomp[[vcompLbls[ids[',i,']]]]) / ',prod(countNums),')',sep=\"\")\n            denomsVal[i+1] <- as.numeric(vcomp[[vcompLbls[ids[i]]]]) / prod(countNums)\n          } else {\n            denoms[i+1] <- paste('(as.numeric(vcomp[[vcompLbls[ids[',i,']]]]) / counts[[gsub(paste(\":\",uniVal,\"|\",uniVal,\":\",sep=\"\"),\"\",vcompLbls[ids[',i,']])]])',sep=\"\")\n            denomsVal[i+1] <- as.numeric(vcomp[[vcompLbls[ids[i]]]]) / counts[[gsub(paste(\":\",uniVal,\"|\",uniVal,\":\",sep=\"\"),\"\",vcompLbls[ids[i]])]]\n          }\n        }\n      }\n      \n      countNums <- c()\n      for (i in 1:length(counts)) {\n        countNums[i] <- counts[[i]]\n      }\n      denoms[length(denoms) + 1] <- '(attr(vcomp, \"sc\")[[1]]^2 / prod(countNums))'\n      denomsVal[length(denomsVal) + 1] <- attr(vcomp, \"sc\")[[1]]^2 / prod(countNums)\n      return(eval(parse(text=paste(denoms[1],\"/ (\",paste(denoms,collapse=\" + \"),\")\"))))\n   }\n    \n    gcoeff <- calcGCoefficient(\"Chimp\",vcomp,vcompLbls,grep(\":Chimp\\\\b|\\\\bChimp:\",vcompLbls),counts)\n    \n    cat(\"G =\", substr(sprintf(\"%.3f\", round(gcoeff, 3)), 2, 5))\n    \n  \n  \n  \n  \n  \n  ################################################\n  # Phi\n  ################################################\n  \n\n    \n    calcPhiCoefficient <- function(uniVal,vcomp,vcompLbls,counts) {\n      denoms <- c()\n      denomsVal <- c()\n      denoms[1] <- \"as.numeric(vcomp[[uniVal]])\"\n      denomsVal[1] <- as.numeric(vcomp[[uniVal]])\n      if (length(vcompLbls) > 2) {\n        for(i in 2:length(vcompLbls)) {\n          denomItem <- gsub(paste(\":\",uniVal,\"|\",uniVal,\":\",sep=\"\"),\"\",vcompLbls[i])\n          if (length(grep(\":\",denomItem)) > 0){\n            items <- strsplit(denomItem,\":\")\n            countNums <- c()\n            for (j in 1:length(items[[1]])) {\n              countNums[j] <- counts[[items[[1]][j]]]\n            }\n            denoms[i] <- paste('(as.numeric(vcomp[[vcompLbls[',i,']]]) / ',prod(countNums),')',sep=\"\")\n            denomsVal[i] <- as.numeric(vcomp[[vcompLbls[i]]]) / prod(countNums)\n          } else {\n            denoms[i] <- paste('(as.numeric(vcomp[[vcompLbls[',i,']]]) / counts[[gsub(paste(\":\",uniVal,\"|\",uniVal,\":\",sep=\"\"),\"\",vcompLbls[',i,'])]])',sep=\"\")\n              ### this denominator below is where the problem is\n            denomsVal[i] <- as.numeric(vcomp[[vcompLbls[i]]]) / counts[[gsub(paste(\":\",uniVal,\"|\",uniVal,\":\",sep=\"\"),\"\",vcompLbls[i])]]\n          }\n        }\n      } else {\n        denoms[2] <- paste('(as.numeric(vcomp[[vcompLbls[2]]]) / ',prod(counts[[1]]),')',sep=\"\")\n        denomsVal[2] <- as.numeric(vcomp[[vcompLbls[2]]]) / prod(counts[[1]])\n      }\n      countNums <- c()\n      for (i in 1:length(counts)) {\n        countNums[i] <- counts[[i]]\n      }\n      denoms[length(denoms) + 1] <- '(attr(vcomp, \"sc\")[[1]]^2 / prod(countNums))'\n      denomsVal[length(denomsVal) + 1] <- attr(vcomp, \"sc\")[[1]]^2 / prod(countNums)\n      return(eval(parse(text=paste(denoms[1],\"/ (\",paste(denoms,collapse=\" + \"),\")\"))))\n    }\n    \n    phi <- calcPhiCoefficient(\"Chimp\",vcomp,vcompLbls,counts)\n    cat(\"Î¦ =\", substr(sprintf(\"%.3f\",round(phi,3)),2,5))\n    \n\n  \n    counts[[gsub(paste(\":\",uniVal,\"|\",uniVal,\":\",sep=\"\"),\"\",vcompLbls[i])]]\n  \n  \n  ################################################\n  # D study\n  ################################################\n  \n    \n   # in case of \"pri\"\n      \n    \n    length(unique(melted$Rater))\n    \n      n.raters <- length(unique(melted$Rater))\n      n.items <- length(unique(melted$Item))\n      \n      ival <- 1:n.raters\n      ival <- as.numeric(ival)\n      jval <- 1:n.items\n      jval <- as.numeric(jval)\n      \n      if(length(counts) > 1) {\n        plotValsG <- matrix(nrow=length(ival),ncol=length(jval))\n        for(i in 1:length(ival)) {\n          for(j in 1:length(jval)) {\n            counts[[1]] <- ival[i]\n            counts[[2]] <- jval[j]\n            plotValsG[i,j] <- calcGCoefficient(\"Chimp\",vcomp,vcompLbls,grep(\":Chimp\\\\b|\\\\bChimp:\",vcompLbls),counts)\n          }\n        }\n        \n        cat(\"G-coefficients (row: Rater, column: Item)\\n\\n\")\n        gvals <- data.frame(substr(matrix(sprintf(\"%.3f\",round(plotValsG,3)),ncol=ncol(plotValsG)),2,5))\n        colnames(gvals) <- jval\n        rownames(gvals) <- paste(\"Rater\",\"=\",ival)\n        print(gvals)\n        \n      }\n      \n\n    \n\n  \n  \n  \n  \n  ################################################\n  # plot\n  ################################################\n  \n  \n      model <- mod()$model\n      \n      vcomp <- VarCorr(model)\n      \n      counts <- list(length(levels(melted$Rater)),length(levels(melted$Item)))\n      names(counts) <- c(\"Rater\",\"Item\")\n      \n      vcompLbls <- c(\"Chimp\",\"Rater\",\"Item\",\"Chimp:Rater\",\"Chimp:Item\",\"Item:Rater\")\n      \n      varCompTable(vcomp, vcompLbls)\n    \n    \n    \n    \n    \n \n      \n      plotValsG <- matrix(nrow=length(ival),ncol=length(jval))\n      for(i in 1:length(ival)) {\n        for(j in 1:length(jval)) {\n          counts[[1]] <- ival[i]\n          counts[[2]] <- jval[j]\n          plotValsG[i,j] <- calcGCoefficient(\"Chimp\",vcomp,vcompLbls,grep(\":Chimp\\\\b|\\\\bChimp:\",vcompLbls),counts)\n        }\n      }\n      \n      cat(\"G-coefficients (row: Rater, column: Item)\\n\\n\")\n      gvals <- data.frame(substr(matrix(sprintf(\"%.3f\",round(plotValsG,3)),ncol=ncol(plotValsG)),2,5))\n      colnames(gvals) <- jval\n      rownames(gvals) <- paste(\"Rater\",\"=\",ival)\n      \n      lbls <- c()\n      for (i in 1:n.raters) {\n        lbls[i] <- paste(\"Rater =\",i)\n      }\n      \n      plot(c(0,0),xlim=c(min(jval),max(jval)),ylim=c(0, 1),type=\"n\",xlab=\"Items\",ylab=\"G-coefficients\")\n      axis(side=2, at=c(0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1))\n      axis(side=1, at=jval)\n      legend(\"topleft\", cex=0.7, legend = lbls, lty = c(1:n.raters), pch = c(1:n.raters), col = c(1:n.raters))\n      for(i in 1:nrow(plotValsG)) {\n        points(plotValsG[i,], pch=i, col=i);lines(plotValsG[i,], col=i, lty=i)\n      }\n      \n\n    \n\n  \n\n  \n#### my additions\n      \n      randos <- ranef(model)\n      \n      randos$Item\n  \n      \n## for the items, individually\n      \n      m.1 <- lmer(Score ~ 1 + (1|Rater) + (1|Chimp) + (1|Time) + \n                      (1|Chimp:Rater) + (1|Chimp:Time) + (1|Time:Rater), data=melted[melted$Item=='Q1',])\n      counts <- list(length(levels(melted$Rater)),length(levels(melted$Time)))\n      names(counts) <- c(\"Rater\",\"Time\")\n      vcomp <- VarCorr(m.1)\n      vcompLbls <- c(\"Rater\",\"Chimp\",\"Time\",\"Chimp:Rater\",\"Chimp:Time\",\"Time:Rater\")\n\n      varCompTable(vcomp, vcompLbls)\n      \n      gcoeff <- calcGCoefficient(\"Chimp\",vcomp,vcompLbls,grep(\":Chimp\\\\b|\\\\bChimp:\",vcompLbls),counts)\n      cat(\"G =\", substr(sprintf(\"%.3f\", round(gcoeff, 3)), 2, 5))\n      \n      phi <- calcPhiCoefficient(\"Chimp\",vcomp,vcompLbls,counts)\n      cat(\"Î¦ =\", substr(sprintf(\"%.3f\",round(phi,3)),2,5))\n      \n      mduse = melted[melted$Item=='Q2',]\n      m.2 <- lmer(Score ~ 1 + (1|Rater) + (1|Chimp) + (1|Time) + \n                    (1|Chimp:Rater) + (1|Chimp:Time) + (1|Time:Rater), data=mduse)\n      counts <- list(length(levels(mduse$Rater)),length(levels(mduse$Time)))\n      names(counts) <- c(\"Rater\",\"Time\")\n      vcomp <- VarCorr(m.2)\n      vcompLbls <- c(\"Rater\",\"Chimp\",\"Time\",\"Chimp:Rater\",\"Chimp:Time\",\"Time:Rater\")\n      \n      varCompTable(vcomp, vcompLbls)\n      \n      gcoeff <- calcGCoefficient(\"Chimp\",vcomp,vcompLbls,grep(\":Chimp\\\\b|\\\\bChimp:\",vcompLbls),counts)\n      cat(\"G =\", substr(sprintf(\"%.3f\", round(gcoeff, 3)), 2, 5))\n      \n      phi <- calcPhiCoefficient(\"Chimp\",vcomp,vcompLbls,counts)\n      cat(\"Î¦ =\", substr(sprintf(\"%.3f\",round(phi,3)),2,5))\n  \n      \n      mduse = melted[melted$Item=='Q3',]\n      m.3 <- lmer(Score ~ 1 + (1|Rater) + (1|Chimp) + (1|Time) + \n                    (1|Chimp:Rater) + (1|Chimp:Time) + (1|Time:Rater), data=mduse)\n      counts <- list(length(levels(mduse$Rater)),length(levels(mduse$Time)))\n      names(counts) <- c(\"Rater\",\"Time\")\n      vcomp <- VarCorr(m.3)\n      vcompLbls <- c(\"Rater\",\"Chimp\",\"Time\",\"Chimp:Rater\",\"Chimp:Time\",\"Time:Rater\")\n      \n      varCompTable(vcomp, vcompLbls)\n      \n      gcoeff <- calcGCoefficient(\"Chimp\",vcomp,vcompLbls,grep(\":Chimp\\\\b|\\\\bChimp:\",vcompLbls),counts)\n      cat(\"G =\", substr(sprintf(\"%.3f\", round(gcoeff, 3)), 2, 5))\n      \n      phi <- calcPhiCoefficient(\"Chimp\",vcomp,vcompLbls,counts)\n      cat(\"Î¦ =\", substr(sprintf(\"%.3f\",round(phi,3)),2,5))\n      \n      \n      mduse = melted[melted$Item=='Q4.1',]\n      m.4.1 <- lmer(Score ~ 1 + (1|Rater) + (1|Chimp) + (1|Time) + \n                    (1|Chimp:Rater) + (1|Chimp:Time) + (1|Time:Rater), data=mduse)\n      counts <- list(length(levels(mduse$Rater)),length(levels(mduse$Time)))\n      names(counts) <- c(\"Rater\",\"Time\")\n      vcomp <- VarCorr(m.4.1)\n      vcompLbls <- c(\"Rater\",\"Chimp\",\"Time\",\"Chimp:Rater\",\"Chimp:Time\",\"Time:Rater\")\n      \n      varCompTable(vcomp, vcompLbls)\n      \n      gcoeff <- calcGCoefficient(\"Chimp\",vcomp,vcompLbls,grep(\":Chimp\\\\b|\\\\bChimp:\",vcompLbls),counts)\n      cat(\"G =\", substr(sprintf(\"%.3f\", round(gcoeff, 3)), 2, 5))\n      \n      phi <- calcPhiCoefficient(\"Chimp\",vcomp,vcompLbls,counts)\n      cat(\"Î¦ =\", substr(sprintf(\"%.3f\",round(phi,3)),2,5))\n      \n      \n      mduse = melted[melted$Item=='Q4.2',]\n      m.4.2 <- lmer(Score ~ 1 + (1|Rater) + (1|Chimp) + (1|Time) + \n                      (1|Chimp:Rater) + (1|Chimp:Time) + (1|Time:Rater), data=mduse)\n      counts <- list(length(levels(mduse$Rater)),length(levels(mduse$Time)))\n      names(counts) <- c(\"Rater\",\"Time\")\n      vcomp <- VarCorr(m.4.2)\n      vcompLbls <- c(\"Rater\",\"Chimp\",\"Time\",\"Chimp:Rater\",\"Chimp:Time\",\"Time:Rater\")\n      \n      varCompTable(vcomp, vcompLbls)\n      \n      gcoeff <- calcGCoefficient(\"Chimp\",vcomp,vcompLbls,grep(\":Chimp\\\\b|\\\\bChimp:\",vcompLbls),counts)\n      cat(\"G =\", substr(sprintf(\"%.3f\", round(gcoeff, 3)), 2, 5))\n      \n      phi <- calcPhiCoefficient(\"Chimp\",vcomp,vcompLbls,counts)\n      cat(\"Î¦ =\", substr(sprintf(\"%.3f\",round(phi,3)),2,5))\n  \n      \n      mduse = melted[melted$Item=='Q5',]\n      m.5 <- lmer(Score ~ 1 + (1|Rater) + (1|Chimp) + (1|Time) + \n                    (1|Chimp:Rater) + (1|Chimp:Time) + (1|Time:Rater), data=mduse)\n      counts <- list(length(levels(mduse$Rater)),length(levels(mduse$Time)))\n      names(counts) <- c(\"Rater\",\"Time\")\n      vcomp <- VarCorr(m.5)\n      vcompLbls <- c(\"Rater\",\"Chimp\",\"Time\",\"Chimp:Rater\",\"Chimp:Time\",\"Time:Rater\")\n      \n      varCompTable(vcomp, vcompLbls)\n      \n      gcoeff <- calcGCoefficient(\"Chimp\",vcomp,vcompLbls,grep(\":Chimp\\\\b|\\\\bChimp:\",vcompLbls),counts)\n      cat(\"G =\", substr(sprintf(\"%.3f\", round(gcoeff, 3)), 2, 5))\n      \n      phi <- calcPhiCoefficient(\"Chimp\",vcomp,vcompLbls,counts)\n      cat(\"Î¦ =\", substr(sprintf(\"%.3f\",round(phi,3)),2,5))\n      \n      \n      mduse = melted[melted$Item=='Q6.1',]\n      m.6.1 <- lmer(Score ~ 1 + (1|Rater) + (1|Chimp) + (1|Time) + \n                    (1|Chimp:Rater) + (1|Chimp:Time) + (1|Time:Rater), data=mduse)\n      counts <- list(length(levels(mduse$Rater)),length(levels(mduse$Time)))\n      names(counts) <- c(\"Rater\",\"Time\")\n      vcomp <- VarCorr(m.6.1)\n      vcompLbls <- c(\"Rater\",\"Chimp\",\"Time\",\"Chimp:Rater\",\"Chimp:Time\",\"Time:Rater\")\n      \n      varCompTable(vcomp, vcompLbls)\n      \n      gcoeff <- calcGCoefficient(\"Chimp\",vcomp,vcompLbls,grep(\":Chimp\\\\b|\\\\bChimp:\",vcompLbls),counts)\n      cat(\"G =\", substr(sprintf(\"%.3f\", round(gcoeff, 3)), 2, 5))\n      \n      phi <- calcPhiCoefficient(\"Chimp\",vcomp,vcompLbls,counts)\n      cat(\"Î¦ =\", substr(sprintf(\"%.3f\",round(phi,3)),2,5))\n      \n      \n      mduse = melted[melted$Item=='Q6.2',]\n      m.6.2 <- lmer(Score ~ 1 + (1|Rater) + (1|Chimp) + (1|Time) + \n                      (1|Chimp:Rater) + (1|Chimp:Time) + (1|Time:Rater), data=mduse)\n      counts <- list(length(levels(mduse$Rater)),length(levels(mduse$Time)))\n      names(counts) <- c(\"Rater\",\"Time\")\n      vcomp <- VarCorr(m.6.2)\n      vcompLbls <- c(\"Rater\",\"Chimp\",\"Time\",\"Chimp:Rater\",\"Chimp:Time\",\"Time:Rater\")\n      \n      varCompTable(vcomp, vcompLbls)\n      \n      gcoeff <- calcGCoefficient(\"Chimp\",vcomp,vcompLbls,grep(\":Chimp\\\\b|\\\\bChimp:\",vcompLbls),counts)\n      cat(\"G =\", substr(sprintf(\"%.3f\", round(gcoeff, 3)), 2, 5))\n      \n      \n      mduse = melted[melted$Item=='Q7',]\n      m.7 <- lmer(Score ~ 1 + (1|Rater) + (1|Chimp) + (1|Time) + \n                    (1|Chimp:Rater) + (1|Chimp:Time) + (1|Time:Rater), data=mduse)\n      counts <- list(length(levels(mduse$Rater)),length(levels(mduse$Time)))\n      names(counts) <- c(\"Rater\",\"Time\")\n      vcomp <- VarCorr(m.7)\n      vcompLbls <- c(\"Rater\",\"Chimp\",\"Time\",\"Chimp:Rater\",\"Chimp:Time\",\"Time:Rater\")\n      \n      varCompTable(vcomp, vcompLbls)\n      \n      gcoeff <- calcGCoefficient(\"Chimp\",vcomp,vcompLbls,grep(\":Chimp\\\\b|\\\\bChimp:\",vcompLbls),counts)\n      cat(\"G =\", substr(sprintf(\"%.3f\", round(gcoeff, 3)), 2, 5))\n      \n      phi <- calcPhiCoefficient(\"Chimp\",vcomp,vcompLbls,counts)\n      cat(\"Î¦ =\", substr(sprintf(\"%.3f\",round(phi,3)),2,5))\n      \n      \n      mduse = melted[melted$Item=='Q8',]\n      m.8 <- lmer(Score ~ 1 + (1|Rater) + (1|Chimp) + (1|Time) + \n                    (1|Chimp:Rater) + (1|Chimp:Time) + (1|Time:Rater), data=mduse)\n      counts <- list(length(levels(mduse$Rater)),length(levels(mduse$Time)))\n      names(counts) <- c(\"Rater\",\"Time\")\n      vcomp <- VarCorr(m.8)\n      vcompLbls <- c(\"Rater\",\"Chimp\",\"Time\",\"Chimp:Rater\",\"Chimp:Time\",\"Time:Rater\")\n      \n      varCompTable(vcomp, vcompLbls)\n      \n      gcoeff <- calcGCoefficient(\"Chimp\",vcomp,vcompLbls,grep(\":Chimp\\\\b|\\\\bChimp:\",vcompLbls),counts)\n      cat(\"G =\", substr(sprintf(\"%.3f\", round(gcoeff, 3)), 2, 5))\n      \n      phi <- calcPhiCoefficient(\"Chimp\",vcomp,vcompLbls,counts)\n      cat(\"Î¦ =\", substr(sprintf(\"%.3f\",round(phi,3)),2,5))\n      \n      \n      mduse = melted[melted$Item=='Q9',]\n      m.9 <- lmer(Score ~ 1 + (1|Rater) + (1|Chimp) + (1|Time) + \n                    (1|Chimp:Rater) + (1|Chimp:Time) + (1|Time:Rater), data=mduse)\n      counts <- list(length(levels(mduse$Rater)),length(levels(mduse$Time)))\n      names(counts) <- c(\"Rater\",\"Time\")\n      vcomp <- VarCorr(m.9)\n      vcompLbls <- c(\"Rater\",\"Chimp\",\"Time\",\"Chimp:Rater\",\"Chimp:Time\",\"Time:Rater\")\n      \n      varCompTable(vcomp, vcompLbls)\n      \n      gcoeff <- calcGCoefficient(\"Chimp\",vcomp,vcompLbls,grep(\":Chimp\\\\b|\\\\bChimp:\",vcompLbls),counts)\n      cat(\"G =\", substr(sprintf(\"%.3f\", round(gcoeff, 3)), 2, 5))\n      \n      phi <- calcPhiCoefficient(\"Chimp\",vcomp,vcompLbls,counts)\n      cat(\"Î¦ =\", substr(sprintf(\"%.3f\",round(phi,3)),2,5))\n      \n      \n      mduse = melted[melted$Item=='Q10',]\n      m.10 <- lmer(Score ~ 1 + (1|Rater) + (1|Chimp) + (1|Time) + \n                    (1|Chimp:Rater) + (1|Chimp:Time) + (1|Time:Rater), data=mduse)\n      counts <- list(length(levels(mduse$Rater)),length(levels(mduse$Time)))\n      names(counts) <- c(\"Rater\",\"Time\")\n      vcomp <- VarCorr(m.10)\n      vcompLbls <- c(\"Rater\",\"Chimp\",\"Time\",\"Chimp:Rater\",\"Chimp:Time\",\"Time:Rater\")\n      \n      varCompTable(vcomp, vcompLbls)\n      \n      gcoeff <- calcGCoefficient(\"Chimp\",vcomp,vcompLbls,grep(\":Chimp\\\\b|\\\\bChimp:\",vcompLbls),counts)\n      cat(\"G =\", substr(sprintf(\"%.3f\", round(gcoeff, 3)), 2, 5))\n      \n      phi <- calcPhiCoefficient(\"Chimp\",vcomp,vcompLbls,counts)\n      cat(\"Î¦ =\", substr(sprintf(\"%.3f\",round(phi,3)),2,5))\n      \n      \n      mduse = melted[melted$Item=='SWB.Q1',]\n      m.wb.1 <- lmer(Score ~ 1 + (1|Rater) + (1|Chimp) + (1|Time) + \n                    (1|Chimp:Rater) + (1|Chimp:Time) + (1|Time:Rater), data=mduse)\n      counts <- list(length(levels(mduse$Rater)),length(levels(mduse$Time)))\n      names(counts) <- c(\"Rater\",\"Time\")\n      vcomp <- VarCorr(m.wb.1)\n      vcompLbls <- c(\"Rater\",\"Chimp\",\"Time\",\"Chimp:Rater\",\"Chimp:Time\",\"Time:Rater\")\n      \n      varCompTable(vcomp, vcompLbls)\n      \n      gcoeff <- calcGCoefficient(\"Chimp\",vcomp,vcompLbls,grep(\":Chimp\\\\b|\\\\bChimp:\",vcompLbls),counts)\n      cat(\"G =\", substr(sprintf(\"%.3f\", round(gcoeff, 3)), 2, 5))\n      \n      phi <- calcPhiCoefficient(\"Chimp\",vcomp,vcompLbls,counts)\n      cat(\"Î¦ =\", substr(sprintf(\"%.3f\",round(phi,3)),2,5))\n      \n      \n      mduse = melted[melted$Item=='SWB.Q2',]\n      m.wb.2 <- lmer(Score ~ 1 + (1|Rater) + (1|Chimp) + (1|Time) + \n                       (1|Chimp:Rater) + (1|Chimp:Time) + (1|Time:Rater), data=mduse)\n      counts <- list(length(levels(mduse$Rater)),length(levels(mduse$Time)))\n      names(counts) <- c(\"Rater\",\"Time\")\n      vcomp <- VarCorr(m.wb.2)\n      vcompLbls <- c(\"Rater\",\"Chimp\",\"Time\",\"Chimp:Rater\",\"Chimp:Time\",\"Time:Rater\")\n      \n      varCompTable(vcomp, vcompLbls)\n      \n      gcoeff <- calcGCoefficient(\"Chimp\",vcomp,vcompLbls,grep(\":Chimp\\\\b|\\\\bChimp:\",vcompLbls),counts)\n      cat(\"G =\", substr(sprintf(\"%.3f\", round(gcoeff, 3)), 2, 5))\n      \n      phi <- calcPhiCoefficient(\"Chimp\",vcomp,vcompLbls,counts)\n      cat(\"Î¦ =\", substr(sprintf(\"%.3f\",round(phi,3)),2,5))\n \n      \n      \n      mduse = melted[melted$Item=='SWB.Q3',]\n      m.wb.3 <- lmer(Score ~ 1 + (1|Rater) + (1|Chimp) + (1|Time) + \n                       (1|Chimp:Rater) + (1|Chimp:Time) + (1|Time:Rater), data=mduse)\n      counts <- list(length(levels(mduse$Rater)),length(levels(mduse$Time)))\n      names(counts) <- c(\"Rater\",\"Time\")\n      vcomp <- VarCorr(m.wb.3)\n      vcompLbls <- c(\"Rater\",\"Chimp\",\"Time\",\"Chimp:Rater\",\"Chimp:Time\",\"Time:Rater\")\n      \n      varCompTable(vcomp, vcompLbls)\n      \n      gcoeff <- calcGCoefficient(\"Chimp\",vcomp,vcompLbls,grep(\":Chimp\\\\b|\\\\bChimp:\",vcompLbls),counts)\n      cat(\"G =\", substr(sprintf(\"%.3f\", round(gcoeff, 3)), 2, 5))\n      \n      phi <- calcPhiCoefficient(\"Chimp\",vcomp,vcompLbls,counts)\n      cat(\"Î¦ =\", substr(sprintf(\"%.3f\",round(phi,3)),2,5))\n      \n      \n      mduse = melted[melted$Item=='SWB.Q4',]\n      m.wb.4 <- lmer(Score ~ 1 + (1|Rater) + (1|Chimp) + (1|Time) + \n                       (1|Chimp:Rater) + (1|Chimp:Time) + (1|Time:Rater), data=mduse)\n      counts <- list(length(levels(mduse$Rater)),length(levels(mduse$Time)))\n      names(counts) <- c(\"Rater\",\"Time\")\n      vcomp <- VarCorr(m.wb.4)\n      vcompLbls <- c(\"Rater\",\"Chimp\",\"Time\",\"Chimp:Rater\",\"Chimp:Time\",\"Time:Rater\")\n      \n      varCompTable(vcomp, vcompLbls)\n      \n      gcoeff <- calcGCoefficient(\"Chimp\",vcomp,vcompLbls,grep(\":Chimp\\\\b|\\\\bChimp:\",vcompLbls),counts)\n      cat(\"G =\", substr(sprintf(\"%.3f\", round(gcoeff, 3)), 2, 5))\n      \n      phi <- calcPhiCoefficient(\"Chimp\",vcomp,vcompLbls,counts)\n      cat(\"Î¦ =\", substr(sprintf(\"%.3f\",round(phi,3)),2,5))\n      ",
    "created" : 1462875529471.000,
    "dirty" : true,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4161250361",
    "id" : "988D5382",
    "lastKnownWriteTime" : 1454953112,
    "last_content_update" : 1462877275567,
    "path" : "C:/Users/s1229179/GitHub/R/Mona + Budongo welfare/gT.R",
    "project_path" : "gT.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}