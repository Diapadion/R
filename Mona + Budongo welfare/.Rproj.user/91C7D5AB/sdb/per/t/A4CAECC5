{
    "contents" : "#Chimp welfare\n\nlibrary(corpcor)\nlibrary(GPArotation)\nlibrary(psych)\n#library(paran)\nlibrary(MASS)\n\n#setwd(\"rercode/\")\n\nswbwel=read.csv(\"Chimp welfare ratings.scrubbed.4.csv\")\n\n\nnum_observations <- as.data.frame(table(swbwel$Chimp))\nnum_observations\nnames(num_observations)[1] <- \"Chimp\"\nswbwel2 <- merge(swbwel,num_observations,by=\"Chimp\")\nnames(swbwel2)\nitems<-c(names(swbwel2[10:21]), (names(swbwel2[25:28])))\nitems\n#source('~/Dropbox/PhD/R/R stats steps/ICC/icc3.R', chdir = TRUE)\n#icc3.reliability(swbwel2[swbwel2$Freq!=1,], items, \"Chimp\", \"Rater\")\n\n\ndata_meanreplace <- swbwel2\nfor(var in names(data_meanreplace[,10:21])) {\n  m <- mean(data_meanreplace[,var], na.rm=T)\n  is.missing <- is.na(data_meanreplace[,var])\n  data_meanreplace[is.missing,var] <- m\n}\nfor(var in names(data_meanreplace[,25:28])) {\n  m <- mean(data_meanreplace[,var], na.rm=T)\n  is.missing <- is.na(data_meanreplace[,var])\n  data_meanreplace[is.missing,var] <- m\n}\nsummary(data_meanreplace)\n\n\n\n#There's probably a better way to do the above than the two step, I just couldn't get it to work.\n# means<-data_meanreplace\n# icc=icc3.reliability(means[means$Freq!=1,], items, \"Chimp\", \"Rater\")\n# \n# \n# mean(icc$icc31[1:12])\n# mean(icc$icc31[13:16])\n# attach(means)\n# welfareagg <- aggregate(means, by=list(Chimp), FUN = mean, na.rm = TRUE)\n# detach(means)\n\n\n#library(paran)\nlibrary(psych)\nitems2=items<-c(names(swbwel2[,c(10, 12:21)]), (names(swbwel2[25:28])))\n  \n  \nnfactors(welfareagg[items2])\nfa.parallel(welfareagg[items2])\n#paran(welfareagg[items2], graph = TRUE,centile=95)\npc_1_none <- principal(welfareagg[items2], nfactors=1, rotate = \"none\")\n\n\nitems2=items<-c(names(welfareagg[,c(10:14, 16:21)]), (names(swbwel2[25:28])))\npc_1_none <- principal(welfareagg[items2], nfactors=1, rotate = \"none\")\n\n\nwelfareitems=items<-c(names(welfareagg[,c(10:14, 16:21)]))\npc_welfare_none <- principal(welfareagg[welfareitems], nfactors=1, rotate = \"none\")\n\n\ncomponents=welfareagg\nattach(components)\ncomponents$totalwelfare=(Q3 +Q4.1 +Q4.2+ Q5 +Q6.1 +Q6.2 +Q7 -Q8 +Q9 +Q10)\ncomponents$totalswb=(SWB.Q1 + SWB.Q2 + SWB.Q3 + SWB.Q4)\ncomponents$welfareswb=(Q3 +Q4.1 +Q4.2+ Q5 +Q6.1 +Q6.2 +Q7 -Q8 +Q9 +Q10+SWB.Q1 + SWB.Q2 + SWB.Q3 + SWB.Q4)\ndetach(components)\nnames(components)\n\n\npersonality=read.csv(\"Edinburgh and Mona Eysneck ratings.1.csv\")\nnum_observations2 <- as.data.frame(table(personality$Animal))\nnum_observations2\nnames(num_observations2)[1] <- \"Animal\"\npersonality2 <- merge(personality,num_observations2,by=\"Animal\")\nnames(personality2)\nitems3<-c(names(personality2[3:14]))\nitems3\n# source('~/Dropbox/PhD/R/R stats steps/ICC/icc3.R', chdir = TRUE)\n# icc3.reliability(personality2[personality2$Freq!=1,], items3, \"Animal\", \"Rater\")\n# summary(is.na(personality2))\n\n# pers=personality2\n\nattach(pers)\neysitems=aggregate(pers, by=list(Animal), FUN = mean, na.rm = TRUE)\ndetach(pers)\n\n\n\n\nattach(eysitems)\neysitems$F1=(Spontaneous..1. + Active..1. + Sociable..1. - Happy..cheerful..1. +8)/4\neysitems$F2=(Not.aggressive..1. + Calm..1. + Cautious..1. + Empathic..1. + Good.tempered..1.)/5\neysitems$F3= (Dominant..1.)\ndetach(eysitems)\n\nmerged=merge(eysitems, components, by=\"Group.1\")\n\ndob=read.csv(\"general chimp info.csv\")\ndob$Q.Date=as.Date(ISOdate(dob$Q.year, dob$Q.month, dob$Q.day))\ndob$dob.Date=as.Date(ISOdate(dob$dob.year, dob$dob.month, dob$dob.day))\ndob$age= dob$Q.Date - dob$dob.Date\nclass(dob$age)\ndob$agenum=dob$age\ndob$agenum=as.numeric(dob$agenum)\nclass(dob$agenum)\n\nattach(dob)\ngeninfo=aggregate(dob, by=list(dob$Chimp), FUN = mean, na.rm = TRUE)\ndetach(dob)\n\nmerged2=merge(merged, geninfo, by=\"Group.1\")\n\norigin=read.csv(\"chimp origin.csv\")\nmerged3=merge(merged2, origin, by.x=\"Group.1\", by.y=\"Chimp\")\n\nmodel1=lm(welfareswb ~ F1 + F2 + F3 + agenum + Sex, data=merged3)\nmodel2=lm(totalwelfare ~ F1 + F2 + F3 + agenum + Sex, data=merged3)\nmodel3=lm(totalswb ~ F1 + F2 + F3 + agenum + Sex, data=merged3)\nsummary(model1)\nsummary(model2)\nsummary(model3)\n\n\npers =read.csv('/Users/s1143245/Dropbox/PhD/All projects/Chimp welfare/Data sets/edinpersonality.csv',header=TRUE)\n\ncompare_data <- NULL\n\ncompare_data <- data.frame(chimp = pers$chimpname)\n\ncompare_data$dom <-\n  (pers$Dom - pers$Fear - pers$Subm - pers$Tim - pers$Caut - pers$Depd + pers$Indp - pers$Vuln + \n     pers$Decs + pers$Intll + pers$Pers + pers$Buly + pers$Stngy + pers$Manp - pers$Anx \n   + 7*8\n  ) / 15\n\ncompare_data$ext <-\n  (pers$Actv + pers$Play + pers$Soc + pers$Frdy + pers$Affc + pers$Imit \n   - pers$Sol - pers$Lazy - pers$Indv - pers$Depr     \n   + 4*8\n  ) / 10\n\ncompare_data$con <-\n  (#pers$Pred - pers$Impl \n    - pers$Defn - pers$Reckl - pers$Errc - pers$Irri - pers$Aggr - pers$Jeals\n    - pers$Dsor - pers$Thotl - pers$Dist - pers$Unper - pers$Quit #- pers$Clmy\n    + 11*8\n  ) / 11\n\ncompare_data$agr <-\n  (pers$Symp + pers$Help + pers$Sens + pers$Prot + pers$Gntl + pers$Conv\n  ) / 6\n\ncompare_data$neu <-\n  (pers$Exct + pers$Aut - pers$Stbl - pers$Cool - pers$Unem\n   + 3*8\n  ) / 5\n\ncompare_data$opn <-\n  (pers$Inqs + pers$Invt + pers$Curious + pers$Innov\n  ) / 4\ncompare_data = compare_data[25:95,]\n\naggPers <- aggregate(compare_data, by=list(compare_data$chimp), FUN=mean, na.rm=TRUE,na.action = na.omit)\n\n# removing dead chimps :((((\nrownames(aggPers) <- aggPers$Group.1\naggPers<-aggPers[c(-1,-2,-4,-17,-22),]\naggPers<-aggPers[,-2]\n\ncolnames(aggPers) <- c(\"Chimp\",'Dominance','Extraversion','Conscientiousness',\n                       'Agreeableness','Neuroticism','Openness')\n\nedinHPQ=merge(merged3, aggPers, by.x=\"Group.1\", by.y=\"Chimp\")\nsetdiff(merged3$Group.1, aggPers$Chimp)\ndim(edinHPQ)\n\nHPQ1=lm(welfareswb ~ Dominance + Extraversion\t+ Conscientiousness\t+ Agreeableness +\tNeuroticism\t+ Openness + agenum + Sex , data=edinHPQ)\nHPQ2=lm(totalwelfare ~ Dominance + Extraversion  + Conscientiousness\t+ Agreeableness +\tNeuroticism\t+ Openness + agenum + Sex , data=edinHPQ)\nHPQ3=lm(totalswb ~ Dominance + Extraversion  + Conscientiousness\t+ Agreeableness +\tNeuroticism\t+ Openness + agenum + Sex , data=edinHPQ)\nsummary(HPQ1)\nsummary(HPQ2)\nsummary(HPQ3)\ndrop1(HPQ1)\ndrop1(HPQ2)\ndrop1(HPQ3)\n\npercorr=corr.test(edinHPQ[,c(17:19, 64:66, 81:86)], method=\"spearman\")\nallcorr2=corr.test(sofar[,c(6:9,20:31,89:96)],method=\"spearman\")\n\nsecondratings=read.csv(\"Budongo welfare 2nd ratings.csv\")\nnum_observations2nd <- as.data.frame(table(secondratings$Chimp))\nnum_observations2nd\nnames(num_observations2nd)[1] <- \"Chimp\"\nitems<-c(names(secondratings[3:18]))\nitems\nseconddata <- merge(secondratings,num_observations2nd,by=\"Chimp\")\n#source('~/Dropbox/PhD/R/R stats steps/ICC/icc3.R', chdir = TRUE)\nicc3.reliability(seconddata[seconddata$Freq!=1,], items, \"Chimp\", \"Rater\")\n\n\ndata_meanreplace <- seconddata\nfor(var in names(data_meanreplace[,3:18])) {\n  m <- mean(data_meanreplace[,var], na.rm=T)\n  is.missing <- is.na(data_meanreplace[,var])\n  data_meanreplace[is.missing,var] <- m\n}\n\n\n\n\n#There's probably a better way to do the above than the two step, I just couldn't get it to work.\n# means<-data_meanreplace\n# icc=icc3.reliability(means[means$Freq!=1,], items, \"Chimp\", \"Rater\")\n# mean(icc$icc3k)\n",
    "created" : 1445448381485.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4035764019",
    "id" : "A4CAECC5",
    "lastKnownWriteTime" : 1454498738,
    "path" : "C:/Users/s1229179/GitHub/R/Mona + Budongo welfare/rercode/Chimp welfare.4.R",
    "project_path" : "rercode/Chimp welfare.4.R",
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "type" : "r_source"
}