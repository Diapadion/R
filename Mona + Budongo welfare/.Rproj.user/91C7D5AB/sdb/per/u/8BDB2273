{
    "collab_server" : "",
    "contents" : "\nmodel <- lmer(Score ~ 1 + (1|Rater) + (1|Chimp) + (1|Item) + \n                (1|Chimp:Rater) + (1|Chimp:Item) + (1|Item:Rater), data=melted)\n\ncounts <- list(length(levels(melted$Rater)),length(levels(melted$Item)))\nnames(counts) <- c(\"Rater\",\"Item\")\n#model <- lmer(Score ~ (1|Chimp) + (1|Rater) + (1|Item) + (1|Chimp:Rater) + (1|Chimp:Item) + (1|Item:Rater), melted)\nvcomp <- VarCorr(model)\n\nvcompLbls <- c(\"Rater\",\"Chimp\",\"Item\",\"Chimp:Rater\",\"Chimp:Item\",\"Item:Rater\")\n\nvarCompTable(vcomp, vcompLbls)\n\n\n\nphi <- calcPhiCoefficient(\"Chimp\",vcomp,vcompLbls,counts)\ncat(\"Î¦ =\", substr(sprintf(\"%.3f\",round(phi,3)),2,5))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ncalcPhiCoefficient <- function(uniVal,vcomp,vcompLbls,counts) {\n  \n  uniVal = 'Chimp'\n  \n  denoms <- c()\n  denomsVal <- c()\n  denoms[1] <- \"as.numeric(vcomp[[uniVal]])\"\n  denomsVal[1] <- as.numeric(vcomp[[uniVal]])\n  if (length(vcompLbls) > 2) {\n    for(i in 2:length(vcompLbls)) {\n      denomItem <- gsub(paste(\":\",uniVal,\"|\",uniVal,\":\",sep=\"\"),\"\",vcompLbls[i])\n      if (length(grep(\":\",denomItem)) > 0){\n        items <- strsplit(denomItem,\":\")\n        countNums <- c()\n        for (j in 1:length(items[[1]])) {\n          countNums[j] <- counts[[items[[1]][j]]]\n        }\n        denoms[i] <- paste('(as.numeric(vcomp[[vcompLbls[',i,']]]) / ',prod(countNums),')',sep=\"\")\n        denomsVal[i] <- as.numeric(vcomp[[vcompLbls[i]]]) / prod(countNums)\n      } else {\n        denoms[i] <- paste('(as.numeric(vcomp[[vcompLbls[',i,']]]) / counts[[gsub(paste(\":\",uniVal,\"|\",uniVal,\":\",sep=\"\"),\"\",vcompLbls[',i,'])]])',sep=\"\")\n        # this denominator below is the problem\n        denomsVal[i] <- as.numeric(vcomp[[vcompLbls[i]]]) / counts[[gsub(paste(\":\",uniVal,\"|\",uniVal,\":\",sep=\"\"),\"\",vcompLbls[i])]]\n      }\n    }\n  } else {\n    denoms[2] <- paste('(as.numeric(vcomp[[vcompLbls[2]]]) / ',prod(counts[[1]]),')',sep=\"\")\n    denomsVal[2] <- as.numeric(vcomp[[vcompLbls[2]]]) / prod(counts[[1]])\n  }\n  countNums <- c()\n  for (i in 1:length(counts)) {\n    countNums[i] <- counts[[i]]\n  }\n  denoms[length(denoms) + 1] <- '(attr(vcomp, \"sc\")[[1]]^2 / prod(countNums))'\n  denomsVal[length(denomsVal) + 1] <- attr(vcomp, \"sc\")[[1]]^2 / prod(countNums)\n  return(eval(parse(text=paste(denoms[1],\"/ (\",paste(denoms,collapse=\" + \"),\")\"))))\n}\n\n",
    "created" : 1454692637333.000,
    "dirty" : true,
    "encoding" : "",
    "folds" : "",
    "hash" : "2782524246",
    "id" : "8BDB2273",
    "lastKnownWriteTime" : 7011605692497750387,
    "last_content_update" : 0,
    "path" : null,
    "project_path" : null,
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 8,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}