{
    "collab_server" : "",
    "contents" : "require(lme4)\nrequire(metafor)\n\n#H1. # We predict that, if previous responses to the outcomes were based only on the emotional valence of the footage, \n# and not on the continuity of the footage with the prior scenario, then for the current experiment, \n# differences in looking time between the emotional and non-emotional victim outcomes should be consistent with what we found previously.\n\n# H2. # We predict that, if the chimpanzeesâ€™ response to the outcomes is based only on the emotional valence of the footage, \n# and is not influenced by prior footage, then differences in both looking time and temperature changes between\n# the outcomes should be matched between seeing them with no prior footage, and seeing them with prior, unrelated footage. \n\n\nvideos.new <- read.csv(\"Data compiled.csv\", header = T, na.strings = \"NA\")\nlevels(videos.new$Outcome)\n\n\n# Pre-model checks:\n# where indivs saw scene twice, decide which one to use:\n# if they didn't watch scenario or outcome the first time, exclude (see list below)\ntable(videos.new$Chimp)\nvideos.new[videos.new$Chimp == (\"SO\"),]\n# ed2 = 2\n# ev2 = 2\n# lb2 = 1 # drop LB 2\n# pa2 = 3 # drop PA2 emotional.novel.horses, PA unemotional.novel.horses\n# re2 = 1 # drop RE emotional outcome horses\n# so2 = 2 # drop SO unemotional.victim, SO victim.masked\n\n### FOR NOW: include original views unless they are 0\n### LATER: CHECK diffs in views with LT > 0\n# if they watched the first time but were interrupted, compare LT with second time to check for sign. diffs. in LT\n\ndrop1 <- subset(videos.new, Chimp != \"LB2\")\ndrop2 <- subset(drop1, Chimp != \"ED2\")\ndrop3 <- subset(drop2, Chimp != \"EV2\")\ndrop4 <- drop3[-which(drop3$Chimp == \"PA\" \n                          & drop3$Scenario == \"Unemotional.novel.horses\"),]\ndrop5 <- drop4[-which(drop4$Chimp == \"PA2\" \n                      & drop4$Scenario == \"Emotional.novel.horses\"),]\ndrop6 <- drop5[-which(drop5$Chimp == \"PA2\" \n                      & drop5$Scenario == \"Unemotional.victim.horses\"),]\ndrop7 <- drop6[-which(drop6$Chimp == \"RE\" \n                      & drop6$Scenario == \"Emotional.outcome.horses\"),]\ndrop8 <- drop7[-which(drop7$Chimp == \"SO\" \n                      & drop7$Scenario == \"Carlos Unexpected\"),]\ndrop9 <- drop8[-which(drop8$Chimp == \"SO\" \n                      & drop8$Outcome == \"Victim.masked\" & drop8$Horses == \"N\"),]\n# 310 rows, removed 11\n\n\n# change old data names to new data names:\n# Carlos unexpected = Unemotional.victim\n# Carlos expected = Emotional.victim\n# Eric unexpected = Unemotional.outcome\n# Eric expected = Emotional.outcome\n\n# subset variables to exclude those with NAs\n# # Remove NAs from data for multilevel models\ndrop10 <- drop9[c(1:3, 5:9, 11)]\nvid.full <- na.omit(drop10)\n# 273 rows\n\n# proportion data is not normal, arcsine transform it for model\n# retain zeros\nhist(vid.full$Proportion.LT.Outcome)\nhist(transf.arcsin(vid.full$Proportion.LT.Outcome)\n, breaks = 20)                       \n                       \n# LT.Outcome has a lot of zeros which skews data, drop zeros, and log transform\nvid.full[vid.full$LT.Outcome == 0,]\nvidfulldrop <- vid.full[-which(vid.full$LT.Outcome == 0),]\n# 259 rows\n\n### 1. compare LT between old data and new data:\n# - does LT to outcomes differ depending on whether they first see (1) chimp conflict(old), (2) horse conflict, or (3) no scenario\n# long format\n# Proportion LT[outcome lengths differ, proportions needed] to each outcome ~ chimp conflict[saw: Y/N] + horse conflict[saw: Y/N] + no scenario[saw: Y/N]\n# repeated measures, run mlm (lmer)\n# 4 models, 1 for each outcome type (1. Eric expected, 2. Eric unexpected, 3. Carlos expected, 4. Carlos unexpected)\n# subset data to exclude new views of chimp conflict scenes\ncomp <- vid.full[-which(vid.full$Horses == \"N\" & vid.full$No.scenario == \"N\" & vid.full$New == \"Y\"),]\n\nm1 <- lmer(transf.arcsin(Proportion.LT.Outcome) ~ Scenario\n           + (1|Chimp), data = comp[which(comp$Outcome == \"Emotional.victim\"),])\nm2 <- lmer(transf.arcsin(Proportion.LT.Outcome) ~ Scenario\n           + (1|Chimp), data = comp[which(comp$Outcome == \"Unemotional.victim\"),])\ncomp$Scenario <- relevel(comp$Scenario, ref = \"Eric Expected\")\nm3 <- lmer(transf.arcsin(Proportion.LT.Outcome) ~ Scenario\n           + (1|Chimp), data = comp[which(comp$Outcome == \"Emotional.outcome\"),])\n# LT differs between horses & chimps\nm4 <- lmer(transf.arcsin(Proportion.LT.Outcome) ~ Scenario\n           + (1|Chimp), data = comp[which(comp$Outcome == \"Unemotional.outcome\"),])\n# LT differs between horses & chimps, only\n\ncoefs <- data.frame(coef(summary(m1)))\ncoefs$p.z <- 2 * (1 - pnorm(abs(coefs$t.value)))\ncoefs\n\n\n### 2. compare LT within new data\n# For *new data*, compare LT (raw, not proportion: outcome lengths are the same) between (2) horse conflict and (3) no scenario\n# long format\n# Raw LT ~ scene[column that specifices horses or no scenario]\n# 8 models, 1 for each scenario (1. Eric expected, 2. Eric unexpected, 3. Victim masked, 4. Bystander masked, 5. Carlos expected, 6. Carlos unexpected, 7. Novel victim, 8. Novel unemotional)\nfm1 <- lmer(log(LT.Outcome) ~ Scenario + (1|Chimp), data = vidfulldrop[which(vidfulldrop$Outcome == \"Victim.masked\"),])\nfm2 <- lmer(log(LT.Outcome) ~ Scenario + (1|Chimp), data = vidfulldrop[which(vidfulldrop$Outcome == \"Bystander.masked\"),])\n# LT higher to outcome after no scenario than horses\nfm3 <- lmer(log(LT.Outcome) ~ Scenario + (1|Chimp), data = vidfulldrop[which(vidfulldrop$Outcome == \"Emotional.novel\"),])\nfm6 <- lmer(log(LT.Outcome) ~ Scenario + (1|Chimp), data = vidfulldrop[which(vidfulldrop$Outcome == \"Unemotional.novel\"),])\n# this one p ~ .05\n\n## for below models I need to subset Scenario to exclude 'Carlos Expected' or whatever chimp conflict scene\nsub1 <- vidfulldrop[-which(vidfulldrop$Scenario == \"Eric Unexpected\" \n                      | vidfulldrop$Scenario == \"Carlos Unexpected\" | vidfulldrop$Scenario == \"Carlos Expected\" \n                      | vidfulldrop$Scenario == \"Eric Expected\"),]\nfm7 <- lmer(log(LT.Outcome) ~ Scenario + (1|Chimp), data = sub1[which(sub1$Outcome == \"Unemotional.outcome\"),])\n# signif\nfm8 <- lmer(log(LT.Outcome) ~ Scenario + (1|Chimp), data = sub1[which(sub1$Outcome == \"Unemotional.victim\"),])\nfm4 <- lmer(log(LT.Outcome) ~ Scenario + (1|Chimp), data = sub1[which(sub1$Outcome == \"Emotional.victim\"),])\nfm5 <- lmer(log(LT.Outcome) ~ Scenario + (1|Chimp), data = sub1[which(sub1$Outcome == \"Emotional.outcome\"),])\n# p = 0.05\n\n\ncoefs <- data.frame(coef(summary(fm1)))\ncoefs$p.z <- 2 * (1 - pnorm(abs(coefs$t.value)))\ncoefs\n\n\n### 3. for new data, compare LT between outcomes to examine diffs in response to victim vs. novel\n# 2 models (emotional & unemotional) for horses scenario Carlos outcomes (using raw data, outcomes all the same length) including novel scenes\n# 2 models for no scenario Carlos outcomes (using raw data, outcomes all the same length) including novel scenes\n# LT ~ outcome[factor with 4 levels]\n\n# subset data to include only Carlos emotional outcomes\ncarlos.em <- vidfulldrop[which(vidfulldrop$Outcome == \"Emotional.novel\" | vidfulldrop$Outcome == \"Emotional.victim\"),]\nmm1 <- lmer(log(LT.Outcome) ~ Outcome + (1|Chimp), data = carlos.em[carlos.em$Horses == \"N\",])\n# not signif\n#mm2 <- lmer(log(LT.Outcome) ~ Outcome + (1|Chimp), data = carlos.em[carlos.em$Horses == \"Y\"])\n# too few cases to run this model; instead run model including horses and no horses\nmm2 <- lmer(log(LT.Outcome) ~ Outcome + (1|Chimp), data = carlos.em)\n\n# subset data to include only Carlos unemotional outcomes\ncarlos.un <- vidfulldrop[which(vidfulldrop$Outcome == \"Unemotional.novel\" | vidfulldrop$Outcome == \"Unemotional.victim\"),]\nmm3 <- lmer(log(LT.Outcome) ~ Outcome + (1|Chimp), data = carlos.un[carlos.un$Horses == \"N\",])\n# signif\nmm4 <- lmer(log(LT.Outcome) ~ Outcome + (1|Chimp), data = carlos.un)\n# signif\n\ncoefs <- data.frame(coef(summary(mm1)))\ncoefs$p.z <- 2 * (1 - pnorm(abs(coefs$t.value)))\ncoefs\n\n\n### 4. for new data, compare LT between outcomes to examine diffs in response to masked vs. unmasked scenes\n# 1 model for horses scenario Eric outcomes (using prop. data, unemotional outcome differs in length) including novel scenes\n# 1 model for no scenario Eric outcomes (using prop. data, unemotional outcome differs in length) including novel scenes\n# LT ~ outcome[factor with 4 levels]\n# subset data to include only Eric emotional outcomes\neric <- vidfulldrop[which(vidfulldrop$Outcome == \"Bystander.masked\" | vidfulldrop$Outcome == \"Emotional.outcome\" \n                           | vidfulldrop$Outcome == \"Victim.masked\"),]\neric$Outcome <- relevel(eric$Outcome, ref = \"Emotional.outcome\")\n# compare emotional masked scenes to unmasked emotional scene\nmm5 <- lmer(log(LT.Outcome) ~ Outcome + (1|Chimp), data = eric)\n\n# subset data to include all 4 Eric outcomes\neric2 <- vidfulldrop[which(vidfulldrop$Outcome == \"Bystander.masked\" | vidfulldrop$Outcome == \"Emotional.outcome\" \n                          | vidfulldrop$Outcome == \"Unemotional.outcome\"\n                          | vidfulldrop$Outcome == \"Victim.masked\"),]\n# compare emotional scenes to unemotional scene\neric2$Outcome <- relevel(eric2$Outcome, ref = \"Unemotional.outcome\")\nmm6 <- lmer(log(LT.Outcome) ~ Outcome + (1|Chimp), data = eric2)\n# LT to victim masked is significantly higher than unemotional\n\ncoefs <- data.frame(coef(summary(mm5)))\ncoefs$p.z <- 2 * (1 - pnorm(abs(coefs$t.value)))\ncoefs\n\n# compare emotional masked scenes to unmasked emotional scenes for horses only\nmm7 <- lmer(log(LT.Outcome) ~ Outcome + (1|Chimp), data = eric[eric$Horses == \"Y\",])\n# LT for bystander masked signif lower than emotional scene\n\n# compare emotional masked scenes to unmasked emotional scenes for no horses \nmm8 <- lmer(log(LT.Outcome) ~ Outcome + (1|Chimp), data = eric[eric$Horses == \"N\",])\n# LT for bystander masked signif higher than emotional scene\n\n# compare emotional scenes to unemotional scene for horses only\nmm9 <- lmer(log(LT.Outcome) ~ Outcome + (1|Chimp), data = eric2[eric$Horses == \"Y\",])\n\n# compare emotional scenes to unemotional scene for horses only\nmm10 <- lmer(log(LT.Outcome) ~ Outcome + (1|Chimp), data = eric2[eric$Horses == \"N\",])\n# LT for masked scenes signif higher than umemot outcome \n\n### 5. For individuals that saw chimp conflict scenes on both occasions (old and new) compare raw LT between outcomes\n# long format\n# paired t test, 1 for each outcome\n# raw LT ~ year[column which specifices when each scene was viewed, ie with 1 or 2]\n\n\nhist(ar)",
    "created" : 1457710077839.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3574508151",
    "id" : "F6F455E9",
    "lastKnownWriteTime" : 1457712778,
    "last_content_update" : 1457712778559,
    "path" : "C:/Users/s1229179/GitHub/R/VADW Budongo emotion/Video analyses exp 2-1.R",
    "project_path" : "Video analyses exp 2-1.R",
    "properties" : {
    },
    "relative_order" : 5,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}