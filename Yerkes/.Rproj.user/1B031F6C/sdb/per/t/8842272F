{
    "contents" : "#fulldata <- read.csv(\"final_data.csv\")\n# just use import, then attach what it gives you...\nattach(fulldata)\n\n# temporary fixes:\n\n# - remove non personality rated individuals, or rather, individual with no DOB\n\n\n\nas.numeric(fulldata$DOB.y,na.rm=TRUE)+as.numeric(fulldata$DOB.x,na.rm=TRUE)\n\n     \nDOBrm <- (!is.na(fulldata$DOB.x))|(!is.na(fulldata$DOB.y))\n\ndmdob <- fulldata[DOBrm,]\n\nDoB <- as.Date(as.character(dmdob$DOB.x),format = \"%m/%d/%Y\")\n\n\n\n\n\nbchemt1 <- structure(numeric(dim(dmdob)[1]), class=\"Date\")\nbchemt2 <- structure(numeric(dim(dmdob)[1]), class=\"Date\")\nbchemt3 <- structure(numeric(dim(dmdob)[1]), class=\"Date\")\nbchemt4 <- structure(numeric(dim(dmdob)[1]), class=\"Date\")\n\nbcellt1 <- structure(numeric(dim(dmdob)[1]), class=\"Date\")\nbcellt2 <- structure(numeric(dim(dmdob)[1]), class=\"Date\")\nbcellt3 <- structure(numeric(dim(dmdob)[1]), class=\"Date\")\n\nfor (i in 1:(dim(dmdob)[1])){\n  yeart <- as.character(dmdob$Year1[i])\n  if(nchar(yeart)==10){\n    bchemt1[i] <- as.Date(yeart,format = \"%m/%d/%Y\")\n    \n  }\n  else bchemt1[i] <- as.Date(yeart,format = \"%m/%d/%y\")\n  \n  yeart <- as.character(dmdob$Year2[i])\n  if(nchar(yeart)==10){\n    bchemt2[i] <- as.Date(yeart,format = \"%m/%d/%Y\")\n    \n  }\n  else bchemt2[i] <- as.Date(yeart,format = \"%m/%d/%y\")\n    \n  yeart <- as.character(dmdob$Year3[i])\n  if(nchar(yeart)==10){\n    bchemt3[i] <- as.Date(yeart,format = \"%m/%d/%Y\")\n    \n  }\n  else bchemt3[i] <- as.Date(yeart,format = \"%m/%d/%y\")\n  \n  yeart <- as.character(dmdob$Year4[i])\n  if(nchar(yeart)==10){\n    bchemt4[i] <- as.Date(yeart,format = \"%m/%d/%Y\")\n    \n  }\n  else bchemt4[i] <- as.Date(yeart,format = \"%m/%d/%y\")\n  \n  #\n  \n  yeart <- as.character(dmdob$date1[i])\n  if(nchar(yeart)==10){\n    bcellt1[i] <- as.Date(yeart,format = \"%d/%m/%Y\")\n    \n  }\n  else bcellt1[i] <- as.Date(yeart,format = \"%d/%m/%y\")\n  \n  yeart <- as.character(dmdob$date2[i])\n  if(nchar(yeart)==10){\n    bcellt2[i] <- as.Date(yeart,format = \"%d/%m/%Y\")\n    \n  }\n  else bcellt2[i] <- as.Date(yeart,format = \"%d/%m/%y\")\n  \n  yeart <- as.character(dmdob$date3[i])\n  if(nchar(yeart)==10){\n    bcellt3[i] <- as.Date(yeart,format = \"%d/%m/%Y\")\n    \n  }\n  else bcellt3[i] <- as.Date(yeart,format = \"%d/%m/%y\")\n  \n}\n\n\n# sex\n\n#IS THIS NEEDED???\n#dmdob$sex[104]=0 # seems to be lolita - uncelar what problem is\n\nsex = dmdob$Sex.x\n\n# BMI\n\nBMI = dmdob$BMI\n\n\n# blood stuff\n\n# use \"bchem\"\ntrig <- cbind(dmdob$triglicerides,dmdob$triglicerides.1,dmdob$triglicerides.2,dmdob$triglicerides.3)\nchol <- cbind(dmdob$cholesterol,dmdob$cholesterol.1,dmdob$cholesterol.2,dmdob$cholesterol.3)\n\nglucose <- cbind(dmdob$Glucose,dmdob$Glucose.1,dmdob$Glucose.2,dmdob$Glucose.3)\n\n# use \"bcell\"\nmono <- cbind(dmdob$monos,dmdob$mono2,dmdob$mono3)\nlymph <- cbind(dmdob$lymph,dmdob$lymp2,dmdob$lymp3)\nwbc <- cbind(dmdob$wbc,dmdob$wbc2,dmdob$wbc3)\n\n\n#as.Date(as.character(dmdob$DOB.x[10]),format = \"%m/%d/%y\")\n\n#as.Date(as.character(dmdob$DOB.x[25]),format = \"%m/%d/%y\")\n\n# personality\n\ncompare_data <- NULL\n\ncompare_data$chimp_Dom_CZ <-\n  (dmdob$dom.z-dmdob$subm.z-dmdob$depd.z+dmdob$indp.z-dmdob$fear.z+dmdob$decs.z-dmdob$tim.z-dmdob$caut.z+\n     dmdob$intll.z+dmdob$pers.z+dmdob$buly.z+dmdob$stngy.z+40)/12\n\ncompare_data$chimp_Ext_CZ <-\n  (-dmdob$sol.z-dmdob$lazy.z+dmdob$actv.z+dmdob$play.z+dmdob$soc.z-dmdob$depr.z+dmdob$frdy.z+dmdob$affc.z+dmdob$imit.z+24)/9\n\ncompare_data$chimp_Con_CZ <-\n  (-dmdob$impl.z-dmdob$defn.z-dmdob$reckl.z-dmdob$errc.z-dmdob$irri.z+dmdob$pred.z-dmdob$aggr.z-dmdob$jeals.z-dmdob$dsor.z+64)/9\n\ncompare_data$chimp_Agr_CZ <-\n  (dmdob$symp.z+dmdob$help.z+dmdob$sens.z+dmdob$prot.z+dmdob$gntl.z)/5\n\ncompare_data$chimp_Neu_CZ <-\n  (-dmdob$stbl.z+dmdob$exct.z-dmdob$unem.z+16)/3\n\ncompare_data$chimp_Opn_CZ <-\n  (dmdob$inqs.z+dmdob$invt.z)/2\n\n\n\nsystolic.1 <- NULL\nsystolic.3 <- NULL\nsystolic.2 <- NULL\ndiastolic.1 <- NULL\ndiastolic.2 <- NULL\ndiastolic.3 <- NULL\n\nsystolic <- NULL\ndiastolic <- NULL\n\n\n# fucking removing the slashes from systolic diastolic\n# putting them in their own vars\n\nbps <- strsplit(as.character(dmdob$BP.1),\"[/]\")\nfor (i in 1:dim(dmdob)[1]){\n  bps <- strsplit(as.character(dmdob$BP.1),\"[/]\")\n  if (!is.na(bps)[[i]]){\n    \n    systolic.1[i] = as.numeric(bps[[i]][1])\n    diastolic.1[i] = as.numeric(bps[[i]][2]) \n    \n  }\n  else{\n    systolic.1[i] = NA\n    diastolic.1[i] = NA    \n  }\n  bps <- strsplit(as.character(dmdob$BP.2),\"[/]\")\n  if (!is.na(bps)[[i]]){\n    \n    systolic.2[i] = as.numeric(bps[[i]][1])\n    diastolic.2[i] = as.numeric(bps[[i]][2]) \n    \n  }\n  else{\n    systolic.2[i] = NA\n    diastolic.2[i] = NA    \n  }\n  bps <- strsplit(as.character(dmdob$BP.3),\"[/]\")\n  if (!is.na(bps)[[i]]){\n    \n    systolic.3[i] = as.numeric(bps[[i]][1])\n    diastolic.3[i] = as.numeric(bps[[i]][2]) \n    \n  }\n  else{\n    systolic.3[i] = NA\n    diastolic.3[i] = NA    \n  }\n  \n  \n}\n\nsystolic <- cbind(systolic.1,systolic.2,systolic.3)\ndiastolic <- cbind(diastolic.1,diastolic.2,diastolic.3)\n\n\n\n# putting it all together\n\nmmdat <- data.frame(dmdob$chimp,sex,BMI,DoB,(as.Date(\"2014-04-15\")-DoB), # to get current age\n                    compare_data$chimp_Dom_CZ,compare_data$chimp_Ext_CZ,compare_data$chimp_Con_CZ,\n                    compare_data$chimp_Agr_CZ,compare_data$chimp_Neu_CZ,compare_data$chimp_Opn_CZ,\n                    trig[,1], chol[,1], glucose[,1],\n                    mono[,1],lymph[,1],wbc[,1],\n                    trig[,2], chol[,2], glucose[,2],\n                    mono[,2],lymph[,2],wbc[,2],\n                    trig[,3], chol[,3], glucose[,3],\n                    mono[,3],lymph[,3],wbc[,3],\n                    #trig[,4], chol[,4], glucose[,4],\n                           \n                    \n                    apply(systolic,1,mean,na.rm=TRUE),\n                    apply(diastolic,1,mean,na.rm=TRUE)\n                    )\n\ncolnames(mmdat) <- c('chimp','sex','BMI','DoB','age','dom','ext','con','agr','neu','opn',\n                     'trig.1','chol.1','glucose.1','mono.1','lymph.1','wbc.1',\n                     'trig.2','chol.2','glucose.2','mono.2','lymph.2','wbc.2',\n                     'trig.3','chol.3','glucose.3','mono.3','lymph.3','wbc.3',\n                     #'trig.4','chol.4','glucose.4',                   \n                     'sys','dias')\n\nmeandat <- data.frame(dmdob$chimp,dmdob$sex,dmdob$BMI,DoB,(as.Date(\"2014-04-15\")-DoB), # to get current age\n                    compare_data$chimp_Dom_CZ,compare_data$chimp_Ext_CZ,compare_data$chimp_Con_CZ,\n                    compare_data$chimp_Agr_CZ,compare_data$chimp_Neu_CZ,compare_data$chimp_Opn_CZ,\n                      apply(trig,1,mean,na.rm=TRUE),\n                      apply(chol,1,mean,na.rm=TRUE),\n                      apply(lymph,1,mean,na.rm=TRUE),\n                      apply(mono,1,mean,na.rm=TRUE),\n                      apply(wbc,1,mean,na.rm=TRUE),\n                      apply(glucose,1,mean,na.rm=TRUE),\n                      apply(systolic,1,mean,na.rm=TRUE),\n                      apply(diastolic,1,mean,na.rm=TRUE)\n)\n\ncolnames(meandat) <- c('chimp','sex','BMI','DoB','age','dom','ext','con','agr','neu','opn',\n                     'trig','chol','lymph','mono','wbc','glucose',                                       \n                     'sys','dias')\n\n\n\ndetach(fulldata)\n             \noutput <- reshape(mmdat, \n                  idvar = \"chimp\",\n                  #idvar=c(colnames(mmdat)[1:11],'sys','dias'), \n                  varying=colnames(mmdat)[12:29], \n                  v.names=c(\"trig\",\"chol\",\"glucose\",\"wbc\",\"mono\",\"lymph\"),\n                  #sep=\".\",\n                  direction=\"long\")\nattach(output)\n# model1 <- lmer(sys ~ chimp + time + sex + BMI + age + dom + ext + con + agr + neu + opn +\n#      #(time | trig) + \n#      (time | chol) + (time | glucose) + (time | wbc) + (time | mono) + (time | lymph),\n#      data=output,\n#      control = lmerControl(check.nobs.vs.nRE = \"warning\"))\n\n#\nsex=output$sex \n#\n\nmodel2 <- lmer (dias ~ age + time + (1 | chimp), data = output)\n\n# model3 <- lm(dias ~ age + dom + ext + con + agr + neu + opn \n#              + BMI + trig + chol + glucose + wbc + mono + lymph, na.action = na.exclude)\n\nmodel4 <- lm(sys ~ age + dom + ext + con + agr + neu + opn)\n\nmodel5 <- lmer(dias ~ time + age + dom + ext + con + agr + neu + opn + BMI +\n                 (1 + time | chimp) + (1 + time|chol), data = output)\n\nmodel6 <- lmer(dias ~ time + age + (dom | chimp) + (ext | chimp) + (agr | chimp), data = output) \n\n\nmodel7 <- lmer(dias ~ time + sex + dom + ext + agr + neu + opn + con + BMI +\n                 chol + trig + glucose + (chol|chimp) +\n                 (1|chimp), data = output)\n\nmodel8 <- lmer(dias ~ time + output$sex + age + (1 + time|chimp) + (BMI|chimp)\n              # + (chimp|BMI)        \n               + dom + ext + agr + neu + opn + con\n              , data = output)\n\n# model9 <- lme(chol ~ age + sex + dom + ext + agr + neu + opn + con, random= ~1 | chimp,  na.action = na.exclude)\n\n\n# model10 <- lmer(chol ~ time + age + sex + BMI + (1 | chimp), data = output)\n\nwith(meandat, {\n  model11 <- lmer(sys ~ DoB + BMI + sex\n                +dom+ext+agr+neu+opn+con\n                +(1 | chimp)\n                  )\n  Anova(model11)\n  })\n\n\n#######\n\n# from slightly older code\n# model_null <- lmer(dias ~ age + sex + BMI + (1 | chimp), data = output)\n# \n# model_a <- lmer(dias ~ age + sex + BMI + dom + ext + agr + neu + opn + con + (1 | chimp), data = output)\n# model_aa <- lmer(sys ~ age + sex + BMI + dom + ext + agr + neu + opn + con + (1 | chimp), data = output)\n\nmodel_null <- lmer(dias ~ age + sex + BMI + (1 | chimp), data = meandat)\n\nmodel_a <- lmer(dias ~ age + sex + BMI + dom + ext + agr + neu + opn + con + (1 | chimp), data = output)\nmodel_aa <- lmer(sys ~ age + sex + BMI + dom + ext + agr + neu + opn + con + (1 | chimp), data = output)\n\n\n# some CI math, from results borrowed from poster... \n# Beta +/- Z95 * S.E.\n# z95 = 1.96\n\n3.96+1.10*1.96\n3.96-1.10*1.96\n-7.76+1.91*1.96\n-7.76-1.91*1.96\n\n\n\n\n# model99 <- lme(dias ~ time + sex + age,\n#               random = ~ time|chimp, data = output, na.action=na.omit)\n\n# longmmdat <- reshape(mmdat, idvar = \"chimp\", ids = mmdat[,1], \n#                      direction='long')\n\n#varying = list(12:32),\n\n#colnames(mmdat)[1:11]\n\n#meltedat <- melt(mmdat, id.vars=c(colnames(mmdat)[1:11],'sys','dias'))\n\n#longmmdat <- reshape(meltedat, idvar = colnames(meltedat)[1:13], direction = 'wide',varying = 14 )\n\ndetach(output)\n\n#attach(meandat)\n\nmodel_b <- lmer(chol ~ dom + ext + neu + con + opn + agr + age + BMI + sex + (1 | chimp), \n                data = output)\n                #data = meandat)\n\nmodel_c <- lmer(trig ~ dom + ext + neu + con + opn + agr + age + BMI + sex + (1 | chimp), data = output)\n                #data = meandat)\n\n#model_c <- lmer(trig ~ dom + ext + neu + con + opn + agr + (1 | chimp), data = output) # shit\n\n#model_b <- lmer(chol ~  age + sex + BMI + dom + ext + agr + neu + opn + con + (1 | chimp) + glucose + wbc + mono + lymph, data = meandat)\n\nmodel_c <- lmer(trig ~ age + sex + BMI + dom + ext + agr + neu + opn + con + (1 | chimp) + chol + glucose + wbc + mono + lymph, data = output)\n\nmodel_d <- lmer(glucose ~ dom + ext + neu + con + opn + agr + age + BMI + sex + (1 | chimp), data = output)\n\nmodel_e <- lmer(lymph ~ dom + ext + neu + con + opn + agr + age + BMI + sex + (1 | chimp), data = output)\n\nmodel_fu <- lmer(trig ~ dom + ext + neu + con + opn + agr + age + BMI + (1 | sex), data = meandat)\nsummary(model_fu)\nconfint(model_fu)\n# pay close attention to what is going on in the above models\n\n\n\n#model_e <- lmer(dias ~ age + BMI + dom + ext + agr + neu + opn + con + (1 | sex), data = output)\n#model_e <- lmer(dias ~ DoB + BMI + dom + ext + agr + neu + opn + con + (1 | sex), data = output)\n\n\n#detach(meandat)\n\n",
    "created" : 1397386622745.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1715290537",
    "id" : "8842272F",
    "lastKnownWriteTime" : 1410118148,
    "path" : "C:/Users/s1229179/Dropbox/R/blood chemistry/Drew version/shapeUp.R",
    "project_path" : "Drew version/shapeUp.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}