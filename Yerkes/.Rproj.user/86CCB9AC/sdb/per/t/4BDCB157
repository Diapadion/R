{
    "contents" : "#fulldata <- read.csv(\"final_data.csv\")\n# just use import, then attach what it gives you...\nattach(fulldata)\n\n# temporary fixes:\n\n# - remove non personality rated individuals, or rather, individual with no DOB\n\n\n\nas.numeric(fulldata$DOB.y,na.rm=TRUE)+as.numeric(fulldata$DOB.x,na.rm=TRUE)\n\n     \nDOBrm <- (!is.na(fulldata$DOB.x))|(!is.na(fulldata$DOB.y))\n\ndmdob <- fulldata[DOBrm,]\n\nDoB <- as.Date(as.character(dmdob$DOB.x),format = \"%m/%d/%Y\")\n\n\nbchemt1 <- structure(numeric(dim(dmdob)[1]), class=\"Date\")\nbchemt2 <- structure(numeric(dim(dmdob)[1]), class=\"Date\")\nbchemt3 <- structure(numeric(dim(dmdob)[1]), class=\"Date\")\nbchemt4 <- structure(numeric(dim(dmdob)[1]), class=\"Date\")\n\nbcellt1 <- structure(numeric(dim(dmdob)[1]), class=\"Date\")\nbcellt2 <- structure(numeric(dim(dmdob)[1]), class=\"Date\")\nbcellt3 <- structure(numeric(dim(dmdob)[1]), class=\"Date\")\n\nfor (i in 1:(dim(dmdob)[1])){\n  yeart <- as.character(dmdob$Year1[i])\n  if(nchar(yeart)==10){\n    bchemt1[i] <- as.Date(yeart,format = \"%m/%d/%Y\")\n    \n  }\n  else bchemt1[i] <- as.Date(yeart,format = \"%m/%d/%y\")\n  \n  yeart <- as.character(dmdob$Year2[i])\n  if(nchar(yeart)==10){\n    bchemt2[i] <- as.Date(yeart,format = \"%m/%d/%Y\")\n    \n  }\n  else bchemt2[i] <- as.Date(yeart,format = \"%m/%d/%y\")\n    \n  yeart <- as.character(dmdob$Year3[i])\n  if(nchar(yeart)==10){\n    bchemt3[i] <- as.Date(yeart,format = \"%m/%d/%Y\")\n    \n  }\n  else bchemt3[i] <- as.Date(yeart,format = \"%m/%d/%y\")\n  \n  yeart <- as.character(dmdob$Year4[i])\n  if(nchar(yeart)==10){\n    bchemt4[i] <- as.Date(yeart,format = \"%m/%d/%Y\")\n    \n  }\n  else bchemt4[i] <- as.Date(yeart,format = \"%m/%d/%y\")\n  \n  #\n  \n  yeart <- as.character(dmdob$date1[i])\n  if(nchar(yeart)==10){\n    bcellt1[i] <- as.Date(yeart,format = \"%d/%m/%Y\")\n    \n  }\n  else bcellt1[i] <- as.Date(yeart,format = \"%d/%m/%y\")\n  \n  yeart <- as.character(dmdob$date2[i])\n  if(nchar(yeart)==10){\n    bcellt2[i] <- as.Date(yeart,format = \"%d/%m/%Y\")\n    \n  }\n  else bcellt2[i] <- as.Date(yeart,format = \"%d/%m/%y\")\n  \n  yeart <- as.character(dmdob$date3[i])\n  if(nchar(yeart)==10){\n    bcellt3[i] <- as.Date(yeart,format = \"%d/%m/%Y\")\n    \n  }\n  else bcellt3[i] <- as.Date(yeart,format = \"%d/%m/%y\")\n  \n}\n\n\n#age <- as.numeric(as.Date(dmdob$DOPR.x,format=\"%m/%d/%Y\")-DoB)\n#age <- as.numeric(as.Date('01/01/2000')-DoB)\n\nlibrary(pastecs)\nage <- as.numeric(bchemt1-DoB)\n\n\n# sex\n\n#IS THIS NEEDED???\n#dmdob$sex[104]=0 # seems to be lolita - unclear what problem is\n# 31/03/15 - fixed???\n\nsex = dmdob$Sex.x\n# sex factor is 0 for females, 1 for males\n# this needs to be changed to 2 and 1 to jive with MIDUS etc\nsex[sex==0]=2\n\n\n# BMI\nBMI = dmdob$BMI\n\n# blood stuff\n\n# use \"bchem\"\ntrig <- cbind(dmdob$triglicerides,dmdob$triglicerides.1,dmdob$triglicerides.2,dmdob$triglicerides.3)\nchol <- cbind(dmdob$cholesterol,dmdob$cholesterol.1,dmdob$cholesterol.2,dmdob$cholesterol.3)\nglucose <- cbind(dmdob$Glucose,dmdob$Glucose.1,dmdob$Glucose.2,dmdob$Glucose.3)\n\n# use \"bcell\"\nmono <- cbind(dmdob$monos,dmdob$mono2,dmdob$mono3)\nlymph <- cbind(dmdob$lymph,dmdob$lymp2,dmdob$lymp3)\nwbc <- cbind(dmdob$wbc,dmdob$wbc2,dmdob$wbc3)\n\n# more (added 01/09/15)\nprotein <- cbind(dmdob$Protein,dmdob$Protein.1,dmdob$Protein.2,dmdob$Protein.3)\nalbumin <- cbind(dmdob$Albumn,dmdob$Albumn.1,dmdob$Albumn.2,dmdob$Albumn.3)\ncalcium <- cbind(dmdob$calcium,dmdob$calcium.1,dmdob$calcium.2,dmdob$calcium.3)\nphos <- cbind(dmdob$phosphate,dmdob$phosphate.1,dmdob$phosphate.2,dmdob$phosphate.3)\nsodium <- cbind(dmdob$sodium,dmdob$sodium.1,dmdob$sodium.2,dmdob$sodium.3)\npotas <- cbind(dmdob$potassium,dmdob$potassium.1,dmdob$potassium.2,dmdob$potassium.3)\nchlor <- cbind(dmdob$chloride,dmdob$chloride.1,dmdob$chloride.2,dmdob$chloride.3)\nglobulin <- cbind(dmdob$globulin,dmdob$globulin.1,dmdob$globulin.2,dmdob$globulin.3)\nGGT <- cbind(dmdob$ggtp,dmdob$ggtp.1,dmdob$ggtp.2,dmdob$ggtp.3)\nosmolality <- cbind(dmdob$osmolal,dmdob$osmolal.1,dmdob$osmolal.2,dmdob$osmolal.3)\nALP <- cbind(dmdob$alkphos,dmdob$alkphos.1,dmdob$alkphos.2,dmdob$alkphos.3)\ncreatinine <- cbind(dmdob$Creatine,dmdob$Creatin.1,dmdob$Creatin.2,dmdob$Creatin.3)\nBUN <- cbind(dmdob$BUN,dmdob$BUN.1,dmdob$BUN.2,dmdob$BUN.3)\n#A/G ratio?\nhct <- cbind(dmdob$hct,dmdob$hct2,dmdob$hct3)\nhgb <- cbind(dmdob$hgb,dmdob$hgb2,dmdob$hgb3)\neos <- cbind(dmdob$eos,dmdob$eos2,dmdob$eos3)\nrbc <- cbind(dmdob$rbc,dmdob$rbc2,dmdob$rbc3)\n\n\n# outliers (added 24/03/15)\nBMI[outliers(BMI,3.5)]<-NA\ntrig[outliers(trig,3.5)]<-NA\nchol[outliers(chol,3.5)]<-NA\nglucose[outliers(glucose,3.5)]<-NA\nmono[outliers(mono,3.5)]<-NA\nlymph[outliers(lymph,3.5)]<-NA\neos[outliers(eos,3.5)]<-NA\nwbc[outliers(wbc,3.5)]<-NA\nrbc[outliers(rbc,3.5)]<-NA\nhgb[outliers(hgb,3.5)]<-NA\nhct[outliers(hct,3.5)]<-NA\nBUN[outliers(BUN,3.5)]<-NA\ncreatinine[outliers(creatinine,3.5)]<-NA\nALP[outliers(ALP,3.5)]<-NA\nosmolality[outliers(osmolality,3.5)]<-NA\nGGT[outliers(GGT,3.5)]<-NA\nglobulin[outliers(globulin,3.5)]<-NA\nchlor[outliers(chlor,3.5)]<-NA\npotas[outliers(potas,3.5)]<-NA\nsodium[outliers(sodium,3.5)]<-NA\nphos[outliers(phos,3.5)]<-NA\ncalcium[outliers(calcium,3.5)]<-NA\nalbumin[outliers(albumin,3.5)]<-NA\nprotein[outliers(protein,3.5)]<-NA\n\n#as.Date(as.character(dmdob$DOB.x[10]),format = \"%m/%d/%y\")\n\n#as.Date(as.character(dmdob$DOB.x[25]),format = \"%m/%d/%y\")\n\n# personality\n\ncompare_data <- NULL\n\ncompare_data$chimp_Dom_CZ <-\n  (dmdob$dom.z-dmdob$subm.z-dmdob$depd.z+dmdob$indp.z-dmdob$fear.z+dmdob$decs.z-dmdob$tim.z-dmdob$caut.z+\n     dmdob$intll.z+dmdob$pers.z+dmdob$buly.z+dmdob$stngy.z+40)/12\n\ncompare_data$chimp_Ext_CZ <-\n  (-dmdob$sol.z-dmdob$lazy.z+dmdob$actv.z+dmdob$play.z+dmdob$soc.z-dmdob$depr.z+dmdob$frdy.z+dmdob$affc.z+dmdob$imit.z+24)/9\n\ncompare_data$chimp_Con_CZ <-\n  (-dmdob$impl.z-dmdob$defn.z-dmdob$reckl.z-dmdob$errc.z-dmdob$irri.z+dmdob$pred.z-dmdob$aggr.z-dmdob$jeals.z-dmdob$dsor.z+64)/9\n\ncompare_data$chimp_Agr_CZ <-\n  (dmdob$symp.z+dmdob$help.z+dmdob$sens.z+dmdob$prot.z+dmdob$gntl.z)/5\n\ncompare_data$chimp_Neu_CZ <-\n  (-dmdob$stbl.z+dmdob$exct.z-dmdob$unem.z+16)/3\n\ncompare_data$chimp_Opn_CZ <-\n  (dmdob$inqs.z+dmdob$invt.z)/2\n\n\n\nsystolic.1 <- NULL\nsystolic.3 <- NULL\nsystolic.2 <- NULL\ndiastolic.1 <- NULL\ndiastolic.2 <- NULL\ndiastolic.3 <- NULL\n\nsystolic <- NULL\ndiastolic <- NULL\n\n\n# fucking removing the slashes from systolic diastolic\n# putting them in their own vars\n\nbps <- strsplit(as.character(dmdob$BP.1),\"[/]\")\nfor (i in 1:dim(dmdob)[1]){\n  bps <- strsplit(as.character(dmdob$BP.1),\"[/]\")\n  if (!is.na(bps)[[i]]){\n    \n    systolic.1[i] = as.numeric(bps[[i]][1])\n    diastolic.1[i] = as.numeric(bps[[i]][2]) \n    \n  }\n  else{\n    systolic.1[i] = NA\n    diastolic.1[i] = NA    \n  }\n  bps <- strsplit(as.character(dmdob$BP.2),\"[/]\")\n  if (!is.na(bps)[[i]]){\n    \n    systolic.2[i] = as.numeric(bps[[i]][1])\n    diastolic.2[i] = as.numeric(bps[[i]][2]) \n    \n  }\n  else{\n    systolic.2[i] = NA\n    diastolic.2[i] = NA    \n  }\n  bps <- strsplit(as.character(dmdob$BP.3),\"[/]\")\n  if (!is.na(bps)[[i]]){\n    \n    systolic.3[i] = as.numeric(bps[[i]][1])\n    diastolic.3[i] = as.numeric(bps[[i]][2]) \n    \n  }\n  else{\n    systolic.3[i] = NA\n    diastolic.3[i] = NA    \n  }\n  \n  \n}\n\nsystolic <- cbind(systolic.1,systolic.2,systolic.3)\nsystolic[outliers(systolic,3.5)]<-NA\ndiastolic <- cbind(diastolic.1,diastolic.2,diastolic.3)\ndiastolic[outliers(diastolic,3.5)]<-NA\n#\ndiastolic[diastolic==8]<-NA\n\n\n\n# putting it all together\n\n#age <- as.numeric(as.Date(dmdob$DOPR.x,format=\"%m/%d/%Y\")-DoB)\n#age <- as.numeric(as.Date('01/01/2000')-DoB) # adjusted - see above if issues\n\nmmdat <- data.frame(dmdob$chimp,sex,BMI,DoB,age, # to get current age\n                    compare_data$chimp_Dom_CZ,compare_data$chimp_Ext_CZ,compare_data$chimp_Con_CZ,\n                    compare_data$chimp_Agr_CZ,compare_data$chimp_Neu_CZ,compare_data$chimp_Opn_CZ,\n                    trig[,1], chol[,1], glucose[,1],\n                    mono[,1],lymph[,1],wbc[,1],\n                    protein[,1],albumin[,1],calcium[,1],phos[,1],sodium[,1],potas[,1],\n                    chlor[,1],globulin[,1],GGT[,1],osmolality[,1],ALP[,1],creatinine[,1],\n                    BUN[,1],rbc[,1],hct[,1],hgb[,1],eos[,1],systolic[,1],diastolic[,1],\n                    trig[,2], chol[,2], glucose[,2],\n                    mono[,2],lymph[,2],wbc[,2],\n                    protein[,2],albumin[,2],calcium[,2],phos[,2],sodium[,2],potas[,2],\n                    chlor[,2],globulin[,2],GGT[,2],osmolality[,2],ALP[,2],creatinine[,2],\n                    BUN[,2],rbc[,2],hct[,2],hgb[,2],eos[,2],systolic[,2],diastolic[,2],\n                    trig[,3], chol[,3], glucose[,3],\n                    mono[,3],lymph[,3],wbc[,3],\n                    protein[,3],albumin[,3],calcium[,3],phos[,3],sodium[,3],potas[,3],\n                    chlor[,3],globulin[,3],GGT[,3],osmolality[,3],ALP[,3],creatinine[,3],\n                    BUN[,3],rbc[,3],hct[,3],hgb[,3],eos[,3],systolic[,3],diastolic[,3],\n                    #trig[,4], chol[,4], glucose[,4],\n                    dmdob$depr.z\n                    \n                    #apply(systolic,1,mean,na.rm=TRUE),apply(diastolic,1,mean,na.rm=TRUE)\n                    )\n\ncolnames(mmdat) <- c('chimp','sex','BMI','DoB','age','dom','extra','cons','agree','neuro','open',\n                     'trig.1','chol.1','glucose.1','mono.1','lymph.1','wbc.1',\n                     'protein.1','albumin.1','calcium,1','phos.1','sodium.1','potas.1',\n                     'chlor.1','globulin.1','GGT.1','osmolality.1','ALP.1','creatinine.1',\n                     'BUN.1','rbc.1','hct.1','hgb.1','eos.1','sys.1','dias.1',\n                     'trig.2','chol.2','glucose.2','mono.2','lymph.2','wbc.2',\n                     'protein.2','albumin.2','calcium,2','phos.2','sodium.2','potas.2',\n                     'chlor.2','globulin.2','GGT.2','osmolality.2','ALP.2','creatinine.2',\n                     'BUN.2','rbc.2','hct.2','hgb.2','eos.2','sys.2','dias.2',\n                     'trig.3','chol.3','glucose.3','mono.3','lymph.3','wbc.3',\n                     'protein.3','albumin.3','calcium,3','phos.3','sodium.3','potas.3',\n                     'chlor.3','globulin.3','GGT.3','osmolality.3','ALP.3','creatinine.3',\n                     'BUN.3','rbc.3','hct.3','hgb.3','eos.3','sys.3','dias.3',\n                     'depressed'\n                     #'trig.4','chol.4','glucose.4',                   \n                     #'sys','dias'\n                     )\n\nmeandat <- data.frame(dmdob$chimp,sex,age,DoB, # to get current age\n                    compare_data$chimp_Dom_CZ,compare_data$chimp_Ext_CZ,compare_data$chimp_Opn_CZ,\n                    compare_data$chimp_Con_CZ,compare_data$chimp_Agr_CZ,compare_data$chimp_Neu_CZ, \n                    BMI,\n                    apply(chol,1,mean,na.rm=TRUE),\n                    apply(creatinine,1,mean,na.rm=TRUE),\n                    apply(trig,1,mean,na.rm=TRUE),                                      \n                      apply(systolic,1,mean,na.rm=TRUE),\n                      apply(diastolic,1,mean,na.rm=TRUE),\n                    apply(ALP,1,mean,na.rm=TRUE),\n                    apply(glucose,1,mean,na.rm=TRUE),\n                    apply(lymph,1,mean,na.rm=TRUE),\n                    apply(mono,1,mean,na.rm=TRUE),\n                    apply(wbc,1,mean,na.rm=TRUE)                    \n                    \n)\n\ncolnames(meandat) <- c('Chimp','sex','age','DoB','Dominance','Extraversion','Openness',\n                       'Conscientiousness','Agreeableness','Neuroticism','BMI',\n                       'chol','creat','trig','sys','dias',\n                       'ALP','glucose',\n                     'lymph','mono','wbc'\n                     )\n\n\ndetach(fulldata)\n\n### Imputation\n### (so far, this is just used for having BMI be a dependent var in regressions)\nlibrary(Amelia)\n\n\n#imp_mean = mice(meandat[,c(-4)])\nimp_mean = amelia(meandat[,c(-4)],idvars=\"Chimp\",m=100, p2s=0)\nimp_mm = amelia(mmdat[,c(-4,-(12:87))],idvars=\"chimp\",m=100,p2s=0)\n\n\n             ### see just below\noutput <- reshape(mmdat[,1:86], \n                  idvar = \"chimp\",\n                  #idvar=c(colnames(mmdat)[1:11],'sys','dias'), \n                  varying=colnames(mmdat)[12:86], \n                  v.names=c(\"trig\",\"chol\",\"glucose\",\"wbc\",\"mono\",\"lymph\",\"protein\",\"albumin\",\"calcium\",\"phos\",\"sodium\",\"potas\",\n                           \"chlor\",\"globulin\",\"GGT\",\"osmolality\",\"ALP\",\"creatinine\",\"BUN\",\"rbc\",\"hct\",\"hgb\",\"eos\",\"sys\",\"dias\"\n                  ),\n                  sep=\".\",\n                  direction=\"long\")\n# \n# tout <- reshape(data.frame(mmdat$chimp,mmdat$dom,\n#                            dias.1=mmdat$dias.1,dias.2=mmdat$dias.2,dias.3=mmdat$dias.3),\n#                 idvar=\"chimp\",varying=list('dias.1','dias.2','dias.3'),\n#                 v.names=c('dias'),\n#                 direction='long')\n\n# so reshape is fucking broken, and messing up my systolic and diastolic variables\n# we need a new package \nlibrary(reshape2)\nmelt_dat <- melt(mmdat, id.vars = c(\"chimp\",'dom','extra','neuro','agree','open','cons',\n                                  'age','sex','BMI','DoB')\n               #,measure.vars=c(\"trig\",\"chol\",\"glucose\",\"wbc\",\"mono\",\"lymph\",\"protein\",\"albumin\",\"calcium\",\"phos\",\"sodium\",\"potas\",\n              #           \"chlor\",\"globulin\",\"GGT\",\"osmolality\",\"ALP\",\"creatinine\",\"BUN\",\"rbc\",\"hct\",\"hgb\",\"eos\",\"sys\",\"dias\"\n            #  )\n          )\n\n# 'Dominance','Extraversion','Openness','Agreeableness','Conscientiousness','Neuroticism',\n                \n               \n           \n\n# fucking balls we'll do it live\noutput$trig = c(mmdat$trig.1,mmdat$trig.2,mmdat$trig.3)\noutput$dias = c(mmdat$dias.1,mmdat$dias.2,mmdat$dias.3)\noutput$sys = c(mmdat$sys.1,mmdat$sys.2,mmdat$sys.3)\noutput$chol = c(mmdat$chol.1,mmdat$chol.2,mmdat$chol.3)\noutput$creatinine = c(mmdat$creatinine.1,mmdat$creatinine.2,mmdat$creatinine.3)\n#output$age2 = (output$age)^2\n# I'm not sure what the problem is with doing it this way, but it's not good\n# this needs to be applied in the other data sets as well\n\n\n# now scale and center it\nscoutput <- cbind(output[,1:2],scale(output[,3]),output[,4],scale(output[,5:12]),\n                              #  output[,13],\n                  scale(output[,13:38]))\n\ncolnames(scoutput)[3] <- 'BMI'\ncolnames(scoutput)[6:11]<- c('Dominance','Extraversion','Conscientiousness',\n                             'Agreeableness','Neuroticism','Openness')\n\n#slongput <- reshape(scoutput, idvar = \"chimp\"\n#                    )\n\nattach(scoutput)\n# model1 <- lmer(sys ~ chimp + time + sex + BMI + age + dom + ext + con + agr + neu + opn +\n#      #(time | trig) + \n#      (time | chol) + (time | glucose) + (time | wbc) + (time | mono) + (time | lymph),\n#      data=output,\n#      control = lmerControl(check.nobs.vs.nRE = \"warning\"))\n\n#\n# sex=output$sex \n#\n\nmodel2 <- lmer (dias ~ age + time + (1 | chimp), data = output)\n\n# model3 <- lm(dias ~ age + dom + extra + cons + agree + neuro + open \n#              + BMI + trig + chol + glucose + wbc + mono + lymph, na.action = na.exclude)\n\nmodel4 <- lm(sys ~ age + dom + extra + cons + agree + neuro + open)\n\nmodel5 <- lmer(dias ~ time + age + dom + extra + cons + agree + neuro + open + BMI +\n                 (1 + time | chimp) + (1 + time|chol), data = output)\n\nmodel6 <- lmer(dias ~ time + age + (dom | chimp) + (extra | chimp) + (agree | chimp), data = output) \n\n\nmodel7 <- lmer(dias ~ time + sex + dom + extra + agree + neuro + open + cons + BMI +\n                 chol + trig + glucose + (chol|chimp) +\n                 (1|chimp), data = output)\n\nmodel8 <- lmer(dias ~ time + output$sex + age + (1 + time|chimp) + (BMI|chimp)\n              # + (chimp|BMI)        \n               + dom + extra + agree + neuro + open + cons\n              , data = output)\n\n# model9 <- lme(chol ~ age + sex + dom + extra + agree + neuro + open + cons, random= ~1 | chimp,  na.action = na.exclude)\n\n\n# model10 <- lmer(chol ~ time + age + sex + BMI + (1 | chimp), data = output)\n\nwith(meandat, {\n  model11 <- lmer(sys ~ DoB + BMI + sex\n                +dom+extra+agree+neuro+open+cons\n                +(1 | chimp)\n                  )\n  Anova(model11)\n  })\n\n\n#######\n\n# from slightly older code\n# model_null <- lmer(dias ~ age + sex + BMI + (1 | chimp), data = output)\n# \n# model_a <- lmer(dias ~ age + sex + BMI + dom + extra + agree + neuro + open + cons + (1 | chimp), data = output)\n# model_aa <- lmer(sys ~ age + sex + BMI + dom + extra + agree + neuro + open + cons + (1 | chimp), data = output)\n\nmodel_null <- lmer(dias ~ age + sex + BMI + (1 | chimp), data = meandat)\n\nmodel_a <- lmer(dias ~ age + sex + BMI + dom + extra + agree + neuro + open + cons + (1 | chimp), data = output)\nmodel_aa <- lmer(sys ~ age + sex + BMI + dom + extra + agree + neuro + open + cons + (1 | chimp), data = output)\n\n\n# some CI math, from results borrowed from poster... \n# Beta +/- Z95 * S.E.\n# z95 = 1.96\n\n3.96+1.10*1.96\n3.96-1.10*1.96\n-7.76+1.91*1.96\n-7.76-1.91*1.96\n\n\n\n\n# model99 <- lme(dias ~ time + sex + age,\n#               random = ~ time|chimp, data = output, na.action=na.omit)\n\n# longmmdat <- reshape(mmdat, idvar = \"chimp\", ids = mmdat[,1], \n#                      direction='long')\n\n#varying = list(12:32),\n\n#colnames(mmdat)[1:11]\n\n#meltedat <- melt(mmdat, id.vars=c(colnames(mmdat)[1:11],'sys','dias'))\n\n#longmmdat <- reshape(meltedat, idvar = colnames(meltedat)[1:13], direction = 'wide',varying = 14 )\n\ndetach(scoutput)\n\n#attach(meandat)\n\nmodel_b <- lmer(chol ~ dom + extra + neuro + cons + open + agree + age + BMI + sex + (1 | chimp), \n                data = output)\n                #data = meandat)\n\nmodel_c <- lmer(trig ~ dom + extra + neuro + cons + open + agree + age + BMI + sex + (1 | chimp), data = output)\n                #data = meandat)\n\n#model_c <- lmer(trig ~ dom + extra + neuro + cons + open + agree + (1 | chimp), data = output) # shit\n\n#model_b <- lmer(chol ~  age + sex + BMI + dom + extra + agree + neuro + open + cons + (1 | chimp) + glucose + wbc + mono + lymph, data = meandat)\n\nmodel_c <- lmer(trig ~ age + sex + BMI + dom + extra + agree + neuro + open + cons + (1 | chimp) + chol + glucose + wbc + mono + lymph, data = output)\n\nmodel_d <- lmer(glucose ~ dom + extra + neuro + cons + open + agree + age + BMI + sex + (1 | chimp), data = output)\n\nmodel_e <- lmer(lymph ~ dom + extra + neuro + cons + open + agree + age + BMI + sex + (1 | chimp), data = output)\n\nmodel_fu <- lmer(trig ~ dom + extra + neuro + cons + open + agree + age + BMI + (1 | sex) + (1 | chimp), data = output)\nsummary(model_fu)\nconsfint(model_fu)\n# pay close attention to what is going on in the above models\n\n\n\n#model_e <- lmer(dias ~ age + BMI + dom + extra + agree + neuro + open + cons + (1 | sex), data = output)\n#model_e <- lmer(dias ~ DoB + BMI + dom + extra + agree + neuro + open + cons + (1 | sex), data = output)\n\n\n#detach(meandat)\n\ndetach(scoutput)\n\n#######\n# 01/09/15 - fresh models for The Burn presentation\n\n# BP: according to FHS 1971, sys is generally a better predictor of heart disease\n\n\n# sys is a better predictor here (there's nothing to see with dias)... wonder why (see below)\nm_1 <- lmer(sys ~ dom + extra + neuro + cons + open + agree + age + BMI + sex + (1 | chimp), \n                                   data = scoutput)\n# open: 0.48 (+), agree: 0.001 (-)\nvif.mer(m_1)\n\n# interactions?\nm1a <- lmer(sys ~ dom + extra + neuro + cons + agree:open + age + BMI + sex + (1 | chimp), \n            data = scoutput)\n# ... no, none here\n\nm1d <- lmer(sys ~ depressed + dom + neuro + cons + open + agree + age + BMI + sex + (1 | chimp), \n             data = scoutput)\n\n# but wait, what about the direct effects on BMI?\nm_1z <- lmer(BMI ~ dom + extra + neuro + cons + open + agree + age +  sex + (1 | chimp), \n             data = scoutput)\n\nrelgrad <- with(m_1a@optinfo$derivs,solve(Hessian,gradient))\nmax(abs(relgrad))\n# Nope.\n\nm_2a <- lmer(chol ~ dom + extra + neuro + cons + open + agree + age + BMI + sex + (1 | chimp), \n            data = scoutput)\n# dom: 0.00866 (-), extra: 0.022 (+), agree: 0.007 (-)\n# cholesterol is diet influenced, but other factors are more important\n# again, interactions?\nm2a1 <- lmer(chol ~ dom:agree + dom + extra + neuro + cons + open + agree + age + BMI + sex + (1 | chimp), \n             data = scoutput)\n#Nope.\nm2a2 <- lmer(chol ~ depressed + dom + neuro + cons + open + agree + age + BMI + sex + (1 | chimp), \n             data = scoutput)\n\n\nsummary(m2a1)\nAIC(m_2a,m2a1)\nvif.mer(m_2a)\nvif.mer(m2a1)\n\nm_2b <- lmer(trig ~ dom + extra + neuro + cons + open + agree + age + BMI + sex + (1 | chimp), \n            data = scoutput) # there's nothing here...\n# triglycerides indicate immediate diet\n\n\nm_2c <- lmer(glucose ~ dom + extra + neuro + cons + open + agree + age + BMI + sex + (1 | chimp), \n            data = scoutput)\n# neuro: 0.0045 (-), cons: 0.011 (+)\n\n# ... some model fit tests\nm2c0 <- lmer(glucose ~ dom + extra + cons:neuro + cons + neuro +\n                open + agree + age + BMI + sex + (1 | chimp), \n              data = scoutput)\n\nm2c1 <- lmer(glucose ~ dom + extra + neuro + \n                       open + agree + age + BMI + sex + (1 | chimp), \n                     data = scoutput)\nm2c2 <- lmer(glucose ~ dom + extra + cons + \n                       open + agree + age + BMI + sex + (1 | chimp), \n                     data = scoutput)\nAIC(m_2c,m2c1,m2c2)\n# first model is a better fir than both... so there's something legit here\nm2c3 <- lmer(glucose ~ dom + extra + cons:neuro + \n                           open + agree + age + BMI + sex + (1 | chimp), \n                         data = scoutput)\nAIC(m_2c,m2c1,m2c2,m2c3)\n\n# residuals and vif\n# resid(m_2c) # probably not needed with vif's\n# vif requires mer-utils.R\nvif.mer(m_2c)\nvif.mer(m2c1)\nvif.mer(m2c2)\nvif.mer(m2c3)\n\nm2c4 <- lmer(glucose ~ depressed + dom + extra + neuro:cons + open + agree + age + BMI + sex + (1 | chimp), \n              data = scoutput)\n\nAIC(m2c3,m2c4)\nvif.mer(m2c4)\n\nm2c5 <- lmer(glucose ~ depressed + dom + neuro:cons + open + agree + age + BMI + sex + (1 | chimp), \n             data = scoutput)\n\n\n# hematology - no effect from blood factors\n\nm_2d <- lmer(wbc ~ dom + extra + neuro + cons + open + agree + age + BMI + sex + (1 | chimp), \n                            data = scoutput)\n\nm_2e <- lmer(lymph ~ dom + extra + neuro + cons + open + agree + age + BMI + sex + (1 | chimp), \n            data = scoutput)\n\nm_2f <- lmer(mono ~ dom + extra + neuro + cons + open + agree + age + BMI + sex + (1 | chimp), \n            data = scoutput)\n\nm_2g <- lmer(eos ~ dom + extra + neuro + cons + open + agree + age + BMI + sex + (1 | chimp), \n             data = scoutput)\n\nm2h <- lmer(hgb ~ dom + extra + neuro + cons + open + agree + age + BMI + sex + (1 | chimp), \n            data = scoutput)\n\nm2i <- lmer(hct ~ dom + extra + neuro + cons + open + agree + age + BMI + sex + (1 | chimp), \n            data = scoutput)\n\nm2j <- lmer(rbc ~ dom + extra + neuro + cons + open + agree + age + BMI + sex + (1 | chimp), \n                 data = scoutput)\n\n# ions\nm2k <- lmer(potas ~ dom + extra + neuro + cons + open + agree + age + BMI + sex + (1 | chimp), \n            data = scoutput)\n\nm2l <- lmer(calcium ~ dom + extra + neuro + cons + open + agree + age + BMI + sex + (1 | chimp), \n            data = scoutput)\n\nm2m <- lmer(chlor ~ dom + extra + neuro + cons + open + agree + age + BMI + sex + (1 | chimp), \n            data = scoutput)\n\nm2n <- lmer(sodium ~ dom + extra + neuro + cons + open + agree + age + BMI + sex + (1 | chimp), \n            data = scoutput)\n\nm2o <- lmer(osmolality ~ dom + extra + neuro + cons + open + agree + age + BMI + sex + (1 | chimp), \n            data = scoutput)\n\nm2p <- lmer(phos ~ dom + extra + neuro + cons + open + agree + age + BMI + sex + (1 | chimp), \n            data = scoutput)\n\n#proteins\nm2q <- lmer(protein ~ dom + extra + neuro + cons + open + agree + age + BMI + sex + (1 | chimp), \n            data = scoutput)\n\nm2r <- lmer(BUN ~ dom + extra + neuro + cons + open + agree + age + BMI + sex + (1 | chimp), \n            data = scoutput)\n\nm2s <- lmer(albumin ~ dom + extra + neuro + cons + open + agree + age + BMI + sex + (1 | chimp), \n            data = scoutput)\n\nm2t <- lmer(GGT ~ dom + extra + neuro + cons + open + agree + age + BMI + sex + (1 | chimp), \n            data = scoutput)\n\nm2u <- lmer(creatinine ~ dom + extra + neuro + cons + open + agree + age + BMI + sex + (1 | chimp), \n            data = scoutput)\n\nm2v <- lmer(globulin ~ dom + extra + neuro + cons + open + agree + age + BMI + sex + (1 | chimp), \n            data = scoutput)\n\nm2w <- lmer(ALP ~ dom + extra + neuro + cons + open + agree + age + BMI + sex + (1 | chimp), \n            data = scoutput)\n\n\n\n\n\n# dias works better here... sort of/not really (after scaling)\nm_3dias <- lmer(dias ~ trig + chol + wbc + lymph + mono + glucose + \n              BUN + protein + albumin + calcium + phos + sodium + potas + chlor + globulin + GGT + osmolality +\n              ALP + creatinine + rbc + hct + hgb + eos +\n              age + sex + BMI + (1 | chimp), \n                data = scoutput)\n\nm_3sys <- lmer(sys ~ trig + chol + wbc + lymph + mono + glucose + \n                  #BUN + protein + albumin + calcium + phos + sodium + potas + chlor + globulin + GGT + osmolality +\n                  #ALP + creatinine + rbc + hct + hgb + eos +\n                  age + sex + BMI + (1 | chimp), \n                data = scoutput)\n\nm_3a <- lmer(sys ~ chol + trig + glucose + age + sex + BMI + (1 | chimp), data = scoutput) \n\n\n# reverse BP biomarker\nm_4a <- lmer(glucose ~ sys + BMI + age + sex + (1|chimp),\n                              data = scoutput)\n\n# useful correlation checks\ncor(output$cons,output$neuro, use='complete')\ncor(output$chol,output$glucose, use='complete')\n\n\n# scatterplot3d(output$cons, output$neuro, output$glucose)\n\nplot(effect(term=\"cons:neuro\",mod=m2c3,multiline = TRUE))\n          \n",
    "created" : 1421077535515.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2546135491",
    "id" : "4BDCB157",
    "lastKnownWriteTime" : 1428339720,
    "path" : "C:/Users/s1229179/git-repos/R/blood chemistry/Drew version/shapeUp.R",
    "project_path" : "Drew version/shapeUp.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}