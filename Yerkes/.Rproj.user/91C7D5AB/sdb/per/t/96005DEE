{
    "collab_server" : "",
    "contents" : "# 3 group SEMs\n# MiDUS, MIDJA, Yerkes\n\n\n\n### Standardization:\n# Pers - across all groups\n#      > within groups may be the  better option\n# Age - chimps * 1.5\n# BMs - across all groups\n# BMI - within species\n#       - make a model with, and without\n\n### Medication adjustment:\n# (before standardization)\n# Blood Pressure\ntable(midja_c$J2MBPD)\ntable(midus_c$B4XBPD)\n# 1 is Yes, 2 is No\n# for 1, add 10 mmHg and 5 mmHg to Sys and Dias, respectively\n#\n# Cholesterol\ntable(midus_c$B4XCHD)\ntable(midja_c$J2MCHD)\n# for 1, add 21.24 mg/dL to Chol\n\n\nall1 <- with(midja_c,data.frame(MIDJA_IDS, sex=J1SQ1, age=J2CAGE, age2=J2CAGE2,\n                                    # Dominance=J1SAGENC,Extraversion=J1SEXTRA,Openness=J1SOPEN,\n                                    # Conscientiousness=J1SCONS2,Agreeableness=J1SAGREE,Neuroticism=J1SNEURO,\n                                # this needs to be tried with within sample standardization\n                                Dominance=s(J1SAGENC),Extraversion=s(J1SEXTRA),Openness=s(J1SOPEN),\n                                Conscientiousness=s(J1SCONS2),Agreeableness=s(J1SAGREE),Neuroticism=s(J1SNEURO),\n                                    BMI=J2CBMI,chol=J2BCHOL,creat=J2BSCREA,trig=J2CTRIG,#gluc=NA,\n                                    sys=J2CBPS23,dias=J2CBPD23\n                                ))\ncolnames(all1)[1] <- 'M2ID'\nall1 <- cbind(all1,'Japanese')\ncolnames(all1)[17] <- 'country'\nall1 <- cbind(all1,'Human')\ncolnames(all1)[18] <- 'species'\nall1 <- cbind(all1,'MIDJA')\ncolnames(all1)[19] <- 'sample'\n\nall1$dias = all1$dias + 5*(midja_c$J2MBPD==1)\nall1$sys = all1$sys + 10*(midja_c$J2MBPD==1)\nall1$chol = all1$chol + 21.24*(midja_c$J2MCHD==1)\n\n\nall2 <- with(midus_c,data.frame(M2ID,sex=B1PRSEX, age=B4ZAGE, age2=B4ZAGE2,\n                        # Dominance=B1SAGENC,Extraversion=B1SEXTRA,Openness=B1SOPEN,\n                        # Conscientiousness=B1SCONS2,Agreeableness=B1SAGREE,Neuroticism=B1SNEURO,   \n                        # this needs to be tried with within sample standardization\n                        Dominance=s(B1SAGENC),Extraversion=s(B1SEXTRA),Openness=s(B1SOPEN),\n                        Conscientiousness=s(B1SCONS2),Agreeableness=s(B1SAGREE),Neuroticism=s(B1SNEURO),\n                        BMI=B4PBMI,chol=B4BCHOL,creat=B4BSCREA,trig=B4BTRIGL,#gluc=B4BGLUC\n                        sys=B4P1GS23,dias=B4P1GD23))\nall2 <- cbind(all2[,c(1:16)],'American')\ncolnames(all2)[17] <- 'country'\nall2 <- cbind(all2,'Human')\ncolnames(all2)[18] <- 'species'\nall2 <- cbind(all2,'MIDUS')\ncolnames(all2)[19] <- 'sample'\n\nall2$dias = all2$dias + 5*(midus_c$B4XBPD==1)\nall2$sys = all2$sys + 10*(midus_c$B4XBPD==1)\nall2$chol = all2$chol + 21.24*(midus_c$B4XCHD==1)\n\n\n# fixing the damn age\nsmeandat = meandat\nsmeandat$age <- 1.5*as.numeric(as.Date('01/01/2007', format = \"%m/%d/%Y\")-DoB)/365\ncolnames(smeandat)[4] <- 'age2'\nsmeandat$age2 <- as.numeric(smeandat$age2)\nsmeandat$age2 <- smeandat$age^2\n\n\nsmeandat <- with(smeandat,data.frame(Chimp,sex=sex, age=age, age2=age2,\n                        # Dominance=(((Dominance - 1) / 2) + 1),\n                        # Extraversion=(((Extraversion - 1) / 2) + 1),\n                        # Openness=(((Openness - 1) / 2) + 1),\n                        # Conscientiousness=(((Conscientiousness - 1) / 2) + 1),\n                        # Agreeableness=(((Agreeableness - 1) / 2) + 1),\n                        # Neuroticism=(((Neuroticism - 1) / 2) + 1),         \n                        Dominance=s(Dominance),\n                        Extraversion=s(Extraversion),\n                        Openness=s(Openness),\n                        Conscientiousness=s(Conscientiousness),\n                        Agreeableness=s(Agreeableness),\n                        Neuroticism=s(Neuroticism), \n                        BMI=s(BMI),chol=chol,creat=creat,trig=trig,#gluc=glucose\n                        sys=sys,dias=dias\n))\n                       \ncolnames(smeandat)[1] <- \"M2ID\"\nsmeandat <- cbind(smeandat, 'American')\ncolnames(smeandat)[17] <- 'country'\nsmeandat <- cbind(smeandat,'Chimp')\ncolnames(smeandat)[18] <- 'species'  \nsmeandat <- cbind(smeandat,'YNPRC')\ncolnames(smeandat)[19] <- 'sample'\n\nall3 <- rbind(all1,all2)\nall3$BMI <- s(all3$BMI) \n\nall2 <- all3 # need to save this for later\n\n\nall3 <- rbind(all3, smeandat)\n\nall3$age <- s(all3$age)\nall3$age2 <- s(all3$age2)\nall3$Dominance <- s(all3$Dominance)\nall3$Extraversion <- s(all3$Extraversion)\nall3$Conscientiousness <- s(all3$Conscientiousness)\nall3$Openness <- s(all3$Openness)\nall3$Neuroticism <- s(all3$Neuroticism)\nall3$Agreeableness <- s(all3$Agreeableness)\nall3$sys <- s(all3$sys)\nall3$dias <- s(all3$dias)\nall3$chol <- s(all3$chol)\nall3$trig <- s(all3$trig)\nall3$creat <- s(all3$creat)\n\n#summary(all3)\n\n\ns <- function(x) {scale(x)}\n\n\n\n### Data suitability\n\nlibrary(psych)\n\ncortest.bartlett(all3[all3$sample=='MIDUS',3:16])\ncortest.bartlett(all3[all3$sample=='MIDJA',3:16])\ncortest.bartlett(all3[all3$sample=='YNPRC',3:16])\n\n#KMO(all3[all3$sample=='MIDJA',3:16])\n\n\n### SEM\n\nlibrary(lavaan)\nlibrary(semPlot)\nlibrary(semTools)\n\n\n\nsem.0 <- '\n\nAL =~ 1*chol + 1*trig + 1*sys + 1*dias + 1*BMI\n#AL =~ chol + trig + sys + dias + BMI\n\nAL ~ sex + age + age2 + Dominance + Extraversion + Openness + Conscientiousness + Agreeableness + Neuroticism\n\nsys ~~ dias\nsys ~~ trig\nsys ~~ BMI\nsys ~~ chol\ndias ~~ trig\ndias ~~ BMI\ndias ~~ chol\ntrig ~~ BMI\ntrig ~~ chol\nBMI ~~ chol\n\n'\n\nRegressions:\n  Estimate  Std.Err  z-value  P(>|z|)\nAL ~                                                \n  sex               0.039    0.068    0.568    0.570\nage              -0.066    0.187   -0.352    0.725\nage2              0.191    0.208    0.917    0.359\nDominance         0.142    0.056    2.524    0.012\nExtraversion     -0.029    0.075   -0.380    0.704\nOpenness         -0.043    0.044   -0.980    0.327\nConscientisnss    0.092    0.055    1.664    0.096\nAgreeableness    -0.062    0.064   -0.959    0.337\nNeuroticism      -0.079    0.048   -1.658    0.097\n\n\n# Constrain negative variances to 0\n\n# separately for pers variables?\n\n\n\nf3.0 <- lavaan(sem.0, data = all3, missing=\"ML\", model.type='sem',\n               std.lv = F, int.ov.free = TRUE, int.lv.free = FALSE, auto.fix.first = TRUE,\n               auto.fix.single = TRUE, auto.var = TRUE, auto.cov.lv.x = TRUE, auto.th = TRUE, auto.delta = TRUE,\n               auto.cov.y = TRUE\n)\nf3.0b <- lavaan(sem.0, data = all3, missing=\"ML\", model.type='sem',\n               group.equal = c(\"regressions\"),\n               group.partial = c(\"AL ~ sex\",\"AL ~ age\",\"AL ~ age2\"),\n               int.ov.free = TRUE, int.lv.free = FALSE, auto.fix.first = TRUE,\n               auto.fix.single = TRUE, auto.var = TRUE, auto.cov.lv.x = TRUE, auto.th = TRUE, auto.delta = TRUE,\n               auto.cov.y = TRUE\n)\nsemPaths(f3.0, what='mod', whatLabels = 'par')\nfitMeasures(f3.0, c(\"chisq\", \"df\", \"pvalue\", \"cfi\", \"rmsea\",\"srmr\",'AIC','BIC'))\nfitMeasures(f3.0b, c(\"chisq\", \"df\", \"pvalue\", \"cfi\", \"rmsea\",\"srmr\",'AIC','BIC'))\n# Neither of the above models are useful because they don't allow sex, age, and age^2 to vary by group\n\n\nf3.1b <- lavaan(sem.1, data = all3, missing=\"ML\", model.type='sem', group = 'species',\n               group.equal = c(\"regressions\"),\n               group.partial = c(\"AL ~ sex\",\"AL ~ age\",\"AL ~ age2\"),\n               int.ov.free = TRUE, int.lv.free = FALSE, auto.fix.first = TRUE, \n               auto.fix.single = TRUE, auto.var = TRUE, auto.cov.lv.x = TRUE, auto.th = TRUE, auto.delta = TRUE, \n               auto.cov.y = TRUE\n               )\n\nsemPaths(f3.1, what='mod', whatLabels = 'par')\nsummary(f3.1)\nfitMeasures(f3.1, c(\"chisq\", \"df\", \"pvalue\", \"cfi\", \"rmsea\",\"srmr\",'AIC','BIC'))\n\nmeasurementInvariance(sem.1, data = all3, missing=\"ML\", group = 'species')\n\n\n\nf3.2b <- lavaan(sem.1, data = all3, missing=\"ML\", model.type='sem', group = 'country',\n               group.equal = c(\"regressions\"),\n               group.partial = c(\"AL ~ sex\",\"AL ~ age\",\"AL ~ age2\"),\n               int.ov.free = TRUE, int.lv.free = FALSE, auto.fix.first = TRUE, \n               auto.fix.single = TRUE, auto.var = TRUE, auto.cov.lv.x = TRUE, auto.th = TRUE, auto.delta = TRUE, \n               auto.cov.y = TRUE\n)\n\nsemPaths(f3.2, what='mod', whatLabels = 'par')\nsummary(f3.2)\nfitMeasures(f3.2, c(\"chisq\", \"df\", \"pvalue\", \"cfi\", \"rmsea\",\"srmr\",'AIC','BIC'))\n\nmeasurementInvariance(sem.1, data = all3, missing=\"ML\", group = 'country')\n\n\n\n\n\n\n\n# mod_ind <- modificationindices(f3.1)\n# head(mod_ind[order(mod_ind$mi, decreasing=TRUE), ], 10)\n# subset(mod_ind[order(mod_ind$mi, decreasing=TRUE), ], mi > 5)\n\n\nsex              -0.193    0.032   -6.013    0.000\nage               0.626    0.104    6.046    0.000\nage2             -0.570    0.103   -5.515    0.000\nDominance         0.088    0.021    4.227    0.000\nExtraversion     -0.042    0.025   -1.722    0.085\nOpenness         -0.027    0.023   -1.170    0.242\nConscientisnss    0.003    0.019    0.147    0.883\nAgreeableness     0.091    0.024    3.813    0.000\nNeuroticism       0.015    0.016    0.944    0.345\n\n\n\n\n### Contraints by group\n\n# The order of samples is \n# 1. Japanese\n# 2. Americans\n# 3. Chimps\n\n# *** should std.lv = FALSE?\n\nsem.0.ALov0 <- '\n\nAL =~ 1*chol + 1*trig + 1*sys + 1*dias + 1*BMI\n\nAL ~ sex + age + age2 + Dominance + Extraversion + Openness + Conscientiousness + Agreeableness + Neuroticism\n\nsys ~~ dias\nsys ~~ trig\nsys ~~ BMI\nsys ~~ chol\ndias ~~ trig\ndias ~~ BMI\ndias ~~ chol\ntrig ~~ BMI\ntrig ~~ chol\nBMI ~~ chol\n\n## across sample, these variances tend to go negative with f3.3b, so we set them = to 0\ntrig ~~ c(vTrigJ,vTrigA,vTrigC)*trig\nBMI ~~ c(vBMIJ,vBMIA,vBMIC)*BMI\n\nvTrigC > 0\nvBMIJ > 0\nvChol > 0\n\n'\n\n# Pers regs jointly estimated across groups (null model)\n# (variance of Trig and BMI adjusted)\nf3.3b <- lavaan(sem.0.ALov0, data = all3, missing=\"ML\", group = 'sample', \n                group.equal = c(\"regressions\"),\n                group.partial = c(\"AL ~ sex\",\"AL ~ age\",\"AL ~ age2\")\n                ,model.type='sem', std.lv=T,int.ov.free = TRUE, int.lv.free = FALSE, auto.fix.first = F,\n                auto.fix.single = TRUE, auto.var = TRUE, auto.cov.lv.x = TRUE, auto.th = TRUE, auto.delta = TRUE,\n                auto.cov.y = TRUE#, se = \"boot\", bootstrap = 100\n                , estimator = 'MLR'\n)\n\n\n# All parameters freely estimated within groups\n# (this model has the same variance issues as f3.3b)\nf3.3 <- lavaan(sem.0.ALov0, data = all3, missing=\"ML\", model.type='sem', group = 'sample',\n               std.lv=T,int.ov.free = TRUE, int.lv.free = FALSE, auto.fix.first = F, \n               auto.fix.single = TRUE, auto.var = TRUE, auto.cov.lv.x = TRUE, auto.th = TRUE, auto.delta = TRUE, \n               auto.cov.y = TRUE\n)\n\n\n\n\nsem.1 <- ' # model 1 groups the sample by species\n\nAL =~ 1*chol + 1*trig + 1*sys + 1*dias + 1*BMI\n#AL =~ chol + trig + sys + dias + BMI\n\nAL ~ sex + age + age2 + c(d1,d1,d2)*Dominance + c(e1,e1,e2)* Extraversion + c(o1,o1,o2)*Openness + \nc(c1,c1,c2)*Conscientiousness + c(a1,a1,a2)*Agreeableness + c(n1,n1,n2)*Neuroticism\n\nsys ~~ dias\nsys ~~ trig\nsys ~~ BMI\nsys ~~ chol\ndias ~~ trig\ndias ~~ BMI\ndias ~~ chol\ntrig ~~ BMI\ntrig ~~ chol\nBMI ~~ chol\n\n# within particular samples these variances tend to go negative with f3.3b, so we set them = to 0\ntrig ~~ c(vTrigJ,vTrigA,vTrigC)*trig\nBMI ~~ c(vBMIJ,vBMIA,vBMIC)*BMI\n\nvTrigC > 0\nvBMIJ > 0\n\n'\n\nf3.1x <- lavaan(sem.1, data = all3, missing=\"ML\", model.type='sem', group = 'sample',\n                #                group.equal = c(\"regressions\"),\n                #                group.partial = c(\"AL ~ sex\",\"AL ~ age\",\"AL ~ age2\"),\n                std.lv = T, int.ov.free = TRUE, int.lv.free = FALSE, auto.fix.first = F, \n                auto.fix.single = TRUE, auto.var = TRUE, auto.cov.lv.x = TRUE, auto.th = TRUE, auto.delta = TRUE, \n                auto.cov.y = TRUE\n)\n\n\n\nsem.2 <- ' # model 2 groups the sample by country\n\nAL =~ 1*chol + 1*trig + 1*sys + 1*dias + 1*BMI\n#AL =~ chol + trig + sys + dias + BMI\n\nAL ~ sex + age + age2 + c(d1,d2,d2)*Dominance + c(e1,e2,e2)* Extraversion + c(o1,o2,o2)*Openness + \nc(c1,c2,c2)*Conscientiousness + c(a1,a2,a2)*Agreeableness + c(n1,n2,n2)*Neuroticism\n\nsys ~~ dias\nsys ~~ trig\nsys ~~ BMI\nsys ~~ chol\ndias ~~ trig\ndias ~~ BMI\ndias ~~ chol\ntrig ~~ BMI\ntrig ~~ chol\nBMI ~~ chol\n\n# within particular samples these variances tend to go negative with f3.3b, so we set them = to 0\ntrig ~~ c(vTrigJ,vTrigA,vTrigC)*trig\nBMI ~~ c(vBMIJ,vBMIA,vBMIC)*BMI\n\nvTrigC > 0\nvBMIJ > 0\n\n'\n\nf3.2x <- lavaan(sem.2, data = all3, missing=\"ML\", model.type='sem', group = 'sample',\n#                group.equal = c(\"regressions\"),\n#                group.partial = c(\"AL ~ sex\",\"AL ~ age\",\"AL ~ age2\"),\n                std.lv = T, int.ov.free = TRUE, int.lv.free = FALSE, auto.fix.first = F, \n                auto.fix.single = TRUE, auto.var = TRUE, auto.cov.lv.x = TRUE, auto.th = TRUE, auto.delta = TRUE, \n                auto.cov.y = TRUE\n)\n\nsemPaths(f3.2x, what='mod', whatLabels = 'par')\nsummary(f3.2x)\nfitMeasures(f3.2x, c(\"chisq\", \"df\", \"pvalue\", \"cfi\", \"rmsea\",\"srmr\",'AIC','BIC')) # country\n\nfitMeasures(f3.1x, c(\"chisq\", \"df\", \"pvalue\", \"cfi\", \"rmsea\",\"srmr\",'AIC','BIC')) # species\n\nfitMeasures(f3.3, c(\"chisq\", \"df\", \"pvalue\", \"cfi\", \"rmsea\",\"srmr\",'AIC','BIC')) # sample\nfitMeasures(f3.3b, c(\"chisq\", \"df\", \"pvalue\", \"cfi\", \"rmsea\",\"srmr\",'AIC','BIC')) # all as one\n\ncompareFit(f3.2x,f3.1x,f3.3,f3.3b)\n\n\n\nsummary(f3.3b)\nsemPaths(f3.3, what='mod', intercepts=F,residuals=F, thresholds=F,exoCov=F\n         , whatLabels = 'par')\n\n\n\n### What if we do this the other remaining, unexpected way?\n\nsem.4 <- ' # model 4 groups the samples by Japanese & Chimps\n\nAL =~ 1*chol + 1*trig + 1*sys + 1*dias + 1*BMI\n\nAL ~ sex + age + age2 + c(d2,d1,d2)*Dominance + c(e2,e1,e2)* Extraversion + c(o2,o1,o2)*Openness + \nc(c2,c1,c2)*Conscientiousness + c(a2,a1,a2)*Agreeableness + c(n2,n1,n2)*Neuroticism\n\nsys ~~ dias\nsys ~~ trig\nsys ~~ BMI\nsys ~~ chol\ndias ~~ trig\ndias ~~ BMI\ndias ~~ chol\ntrig ~~ BMI\ntrig ~~ chol\nBMI ~~ chol\n\n# within particular samples these variances tend to go negative with f3.3b, so we set them = to 0\ntrig ~~ c(vTrigJ,vTrigA,vTrigC)*trig\nBMI ~~ c(vBMIJ,vBMIA,vBMIC)*BMI\n\nvTrigC > 0\nvBMIJ > 0\n\n'\n\nf3.4 <- lavaan(sem.4, data = all3, missing=\"ML\", model.type='sem', group = 'sample',\n                #                group.equal = c(\"regressions\"),\n                #                group.partial = c(\"AL ~ sex\",\"AL ~ age\",\"AL ~ age2\"),\n                std.lv = F, int.ov.free = TRUE, int.lv.free = FALSE, auto.fix.first = TRUE, \n                auto.fix.single = TRUE, auto.var = TRUE, auto.cov.lv.x = TRUE, auto.th = TRUE, auto.delta = TRUE, \n                auto.cov.y = TRUE\n)\n\nfitMeasures(f3.4, c(\"chisq\", \"df\", \"pvalue\", \"cfi\", \"rmsea\",\"srmr\",'AIC','BIC')) # \n\n\n\nsem.5 <- ' # group based on where personality is similar\n\nAL =~ 1*chol + 1*trig + 1*sys + 1*dias + 1*BMI\n\nAL ~ sex + age + age2 + c(dJ,dAC,dAC)*Dominance + c(eJC,eA,eJC)* Extraversion + c(oJC,oA,oJC)*Openness + \nc(cJC,cA,cJC)*Conscientiousness + c(aJC,aA,aJC)*Agreeableness + c(nJA,nJA,nC)*Neuroticism\n\nsys ~~ dias\nsys ~~ trig\nsys ~~ BMI\nsys ~~ chol\ndias ~~ trig\ndias ~~ BMI\ndias ~~ chol\ntrig ~~ BMI\ntrig ~~ chol\nBMI ~~ chol\n\n# within particular samples these variances tend to go negative with f3.3b, so we set them = to 0\ntrig ~~ c(vTrigJ,vTrigA,vTrigC)*trig\nBMI ~~ c(vBMIJ,vBMIA,vBMIC)*BMI\n\nvTrigC > 0\nvBMIJ > 0\n\n'\n\nf3.5 <- lavaan(sem.5, data = all3, missing=\"ML\", model.type='sem', group = 'sample',\n               #                group.equal = c(\"regressions\"),\n               #                group.partial = c(\"AL ~ sex\",\"AL ~ age\",\"AL ~ age2\"),\n               std.lv = F, int.ov.free = TRUE, int.lv.free = FALSE, auto.fix.first = TRUE, \n               auto.fix.single = TRUE, auto.var = TRUE, auto.cov.lv.x = TRUE, auto.th = TRUE, auto.delta = TRUE, \n               auto.cov.y = TRUE\n)\n\nfitMeasures(f3.5, c(\"chisq\", \"df\", \"pvalue\", \"cfi\", \"rmsea\",\"srmr\",'AIC','BIC')) # \n\n\n\n\n### Freeing the LV loadings ###\n# (but, keeping them the same across groups)\n\nsem.1.free <- ' # model 1 groups the sample by species\n\nAL =~ chol + trig + sys + dias + BMI\n\nAL ~ sex + age + age2 + c(d1,d1,d2)*Dominance + c(e1,e1,e2)* Extraversion + c(o1,o1,o2)*Openness + \nc(c1,c1,c2)*Conscientiousness + c(a1,a1,a2)*Agreeableness + c(n1,n1,n2)*Neuroticism\n\nsys ~~ dias\nsys ~~ trig\nsys ~~ BMI\nsys ~~ chol\ndias ~~ trig\ndias ~~ BMI\ndias ~~ chol\ntrig ~~ BMI\ntrig ~~ chol\nBMI ~~ chol\n\n# within particular samples these variances tend to go negative with f3.3b, so we set them = to 0\n# trig ~~ c(vTrigJ,vTrigA,vTrigC)*trig\n# BMI ~~ c(vBMIJ,vBMIA,vBMIC)*BMI\n# \n# vTrigC > 0\n# vBMIJ > 0\n\n'\n\nsem.2.free <- ' # model 2 groups the sample by country\n\nAL =~ chol + trig + sys + dias + BMI\n\nAL ~ sex + age + age2 + c(d1,d2,d2)*Dominance + c(e1,e2,e2)* Extraversion + c(o1,o2,o2)*Openness + \nc(c1,c2,c2)*Conscientiousness + c(a1,a2,a2)*Agreeableness + c(n1,n2,n2)*Neuroticism\n\nsys ~~ dias\nsys ~~ trig\nsys ~~ BMI\nsys ~~ chol\ndias ~~ trig\ndias ~~ BMI\ndias ~~ chol\ntrig ~~ BMI\ntrig ~~ chol\nBMI ~~ chol\n\n# within particular samples these variances tend to go negative with f3.3b, so we set them = to 0\ntrig ~~ c(vTrigJ,vTrigA,vTrigC)*trig\nBMI ~~ c(vBMIJ,vBMIA,vBMIC)*BMI\n\nvTrigC > 0\nvBMIJ > 0\n\n'\n\nsem.0.free <- '\n\nAL =~ chol + trig + sys + dias + BMI\n\nAL ~ sex + age + age2 + Dominance + Extraversion + Openness + Conscientiousness + Agreeableness + Neuroticism\n\nsys ~~ dias\nsys ~~ trig\nsys ~~ BMI\nsys ~~ chol\ndias ~~ trig\ndias ~~ BMI\ndias ~~ chol\ntrig ~~ BMI\ntrig ~~ chol\nBMI ~~ chol\n\n## across sample, these variances tend to go negative with f3.3b, so we set them = to 0\n# trig ~~ c(vTrigJ,vTrigA,vTrigC)*trig\n# BMI ~~ c(vBMIJ,vBMIA,vBMIC)*BMI\n# chol ~~ vChol*chol\n# sys ~~ vSys*sys\n#dias ~~ vDias*dias\n\n# vTrigC > 0\n# vBMIJ > 0\n# vChol > 0\n# vSys > 0\n# vDias > 0\n\n'\n\n\nf3.3b.free <- lavaan(sem.0.free, data = all3, missing=\"ML\", group = 'sample', \n                group.equal = c(\"regressions\",\"loadings\")\n                group.partial = c(\"AL ~ sex\",\"AL ~ age\",\"AL ~ age2\")\n                ,model.type='sem', std.lv=T,int.ov.free = TRUE, int.lv.free = FALSE, auto.fix.first = F,\n                auto.fix.single = TRUE, auto.var = TRUE, auto.cov.lv.x = TRUE, auto.th = TRUE, auto.delta = TRUE,\n                auto.cov.y = TRUE#, se = \"boot\", bootstrap = 100\n                , estimator = 'MLR')\n\nf3.3.free <- lavaan(sem.0.free, data = all3, missing=\"ML\", group = 'sample', \n                     group.equal = c(\"loadings\")\n                     ,model.type='sem', std.lv=T,int.ov.free = TRUE, int.lv.free = FALSE, auto.fix.first = F,\n                     auto.fix.single = TRUE, auto.var = TRUE, auto.cov.lv.x = TRUE, auto.th = TRUE, auto.delta = TRUE,\n                     auto.cov.y = TRUE#, se = \"boot\", bootstrap = 100\n                     , estimator = 'MLR')\n\nf3.1.free <- lavaan(sem.1.free, data = all3, missing=\"ML\", group = 'sample', \n                     group.equal = c(\"loadings\")\n                     ,model.type='sem', std.lv=T,int.ov.free = TRUE, int.lv.free = FALSE, auto.fix.first = F,\n                     auto.fix.single = TRUE, auto.var = TRUE, auto.cov.lv.x = TRUE, auto.th = TRUE, auto.delta = TRUE,\n                     auto.cov.y = TRUE#, se = \"boot\", bootstrap = 100\n                     , estimator = 'MLR')\n\nf3.2.free <- lavaan(sem.2.free, data = all3, missing=\"ML\", group = 'sample', \n                    group.equal = c(\"loadings\")\n                    ,model.type='sem', std.lv=T,int.ov.free = TRUE, int.lv.free = FALSE, auto.fix.first = F,\n                    auto.fix.single = TRUE, auto.var = TRUE, auto.cov.lv.x = TRUE, auto.th = TRUE, auto.delta = TRUE,\n                    auto.cov.y = TRUE#, se = \"boot\", bootstrap = 100\n                    , estimator = 'MLR')\n\nfitMeasures(f3.1.free, c(\"chisq\", \"df\", \"pvalue\", \"cfi\", \"rmsea\",\"srmr\",'AIC','BIC')) #\nfitMeasures(f3.2.free, c(\"chisq\", \"df\", \"pvalue\", \"cfi\", \"rmsea\",\"srmr\",'AIC','BIC')) #\nfitMeasures(f3.3b.free, c(\"chisq\", \"df\", \"pvalue\", \"cfi\", \"rmsea\",\"srmr\",'AIC','BIC')) #\nfitMeasures(f3.3.free, c(\"chisq\", \"df\", \"pvalue\", \"cfi\", \"rmsea\",\"srmr\",'AIC','BIC')) #\n\nsummary(f3.1.free)\n\n\n\n### What if we just use the AL variable composed at the top?\n\nsem.0.aggrd <- '\nAL ~ sex + age + age2 + Dominance + Extraversion + Openness + Conscientiousness + Agreeableness + Neuroticism\n\n'\nsem.1.aggrd <- ' # model 1 groups the sample by species\n\nAL ~ sex + age + age2 + c(d1,d1,d2)*Dominance + c(e1,e1,e2)* Extraversion + c(o1,o1,o2)*Openness + \nc(c1,c1,c2)*Conscientiousness + c(a1,a1,a2)*Agreeableness + c(n1,n1,n2)*Neuroticism\n\n'\nsem.2.aggrd <- ' # model 2 groups the sample by country\n\nAL ~ sex + age + age2 + c(d1,d2,d2)*Dominance + c(e1,e2,e2)* Extraversion + c(o1,o2,o2)*Openness + \nc(c1,c2,c2)*Conscientiousness + c(a1,a2,a2)*Agreeableness + c(n1,n2,n2)*Neuroticism\n'\n\nf3.3b.aggrd <- lavaan(sem.0.aggrd, data = all3, missing=\"ML\", group = 'sample', \n                     group.equal = c(\"regressions\",\"loadings\"),\n                     group.partial = c(\"AL ~ sex\",\"AL ~ age\",\"AL ~ age2\")\n                     ,model.type='sem', std.lv=T,int.ov.free = TRUE, int.lv.free = FALSE, auto.fix.first = F,\n                     auto.fix.single = TRUE, auto.var = TRUE, auto.cov.lv.x = TRUE, auto.th = TRUE, auto.delta = TRUE,\n                     auto.cov.y = TRUE#, se = \"boot\", bootstrap = 100\n                     , estimator = 'MLR')\nf3.3.aggrd <- lavaan(sem.0.aggrd, data = all3, missing=\"ML\", group = 'sample', \n                    group.equal = c(\"loadings\")\n                    ,model.type='sem', std.lv=T,int.ov.free = TRUE, int.lv.free = FALSE, auto.fix.first = F,\n                    auto.fix.single = TRUE, auto.var = TRUE, auto.cov.lv.x = TRUE, auto.th = TRUE, auto.delta = TRUE,\n                    auto.cov.y = TRUE#, se = \"boot\", bootstrap = 100\n                    , estimator = 'MLR')\nf3.1.aggrd <- lavaan(sem.1.aggrd, data = all3, missing=\"ML\", group = 'sample', \n                    group.equal = c(\"loadings\")\n                    ,model.type='sem', std.lv=T,int.ov.free = TRUE, int.lv.free = FALSE, auto.fix.first = F,\n                    auto.fix.single = TRUE, auto.var = TRUE, auto.cov.lv.x = TRUE, auto.th = TRUE, auto.delta = TRUE,\n                    auto.cov.y = TRUE#, se = \"boot\", bootstrap = 100\n                    , estimator = 'MLR')\nf3.2.aggrd <- lavaan(sem.2.aggrd, data = all3, missing=\"ML\", group = 'sample', \n                    group.equal = c(\"loadings\")\n                    ,model.type='sem', std.lv=T,int.ov.free = TRUE, int.lv.free = FALSE, auto.fix.first = F,\n                    auto.fix.single = TRUE, auto.var = TRUE, auto.cov.lv.x = TRUE, auto.th = TRUE, auto.delta = TRUE,\n                    auto.cov.y = TRUE#, se = \"boot\", bootstrap = 100\n                    , estimator = 'MLR')\n\nfitMeasures(f3.1.aggrd, c(\"chisq\", \"df\", \"pvalue\", \"cfi\", \"rmsea\",\"srmr\",'AIC','BIC')) #\nfitMeasures(f3.2.aggrd, c(\"chisq\", \"df\", \"pvalue\", \"cfi\", \"rmsea\",\"srmr\",'AIC','BIC')) #\nfitMeasures(f3.3b.aggrd, c(\"chisq\", \"df\", \"pvalue\", \"cfi\", \"rmsea\",\"srmr\",'AIC','BIC')) #\nfitMeasures(f3.3.aggrd, c(\"chisq\", \"df\", \"pvalue\", \"cfi\", \"rmsea\",\"srmr\",'AIC','BIC')) #\n\nsummary(f3.3.aggrd)\n\n### inconclusive\n\n",
    "created" : 1484840502535.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "672008424",
    "id" : "96005DEE",
    "lastKnownWriteTime" : 1494426608,
    "last_content_update" : 1494426608851,
    "path" : "C:/Users/s1229179/GitHub/R/Yerkes/Drew version/3groupSEMs.R",
    "project_path" : "Drew version/3groupSEMs.R",
    "properties" : {
        "tempName" : "Untitled3"
    },
    "relative_order" : 6,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}