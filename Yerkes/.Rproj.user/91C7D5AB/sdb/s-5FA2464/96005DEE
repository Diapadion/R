{
    "collab_server" : "",
    "contents" : "# 3 group SEMs\n# MiDUS, MIDJA, Yerkes\n\n\n### Standardization:\n# Pers - across all groups\n# Age - chimps * 1.8 (?) *** LOOK INTO\n# BMs - across all groups\n# BMI - within species\n#       - make a model with, and without\n\n\n\n\n\n\nall1 <- with(midja_c,data.frame(MIDJA_IDS, sex=J1SQ1, age=J2CAGE, age2=J2CAGE2,\n                                    Dominance=J1SAGENC,Extraversion=J1SEXTRA,Openness=J1SOPEN,\n                                    Conscientiousness=J1SCONS2,Agreeableness=J1SAGREE,Neuroticism=J1SNEURO,\n                                    BMI=J2CBMI,chol=J2BCHOL,creat=J2BSCREA,trig=J2CTRIG,\n                                    sys=J2CBPS23,dias=J2CBPD23))\ncolnames(all1)[1] <- 'M2ID'\nall1 <- cbind(all1,'Japanese')\ncolnames(all1)[17] <- 'country'\nall1 <- cbind(all1,'Human')\ncolnames(all1)[18] <- 'species'\nall1 <- cbind(all1,'MIDJA')\ncolnames(all1)[19] <- 'sample'\n\nall2 <- with(midus_c,data.frame(M2ID,sex=B1PRSEX, age=B4ZAGE, age2=B4ZAGE2,\n                        Dominance=B1SAGENC,Extraversion=B1SEXTRA,Openness=B1SOPEN,\n                        Conscientiousness=B1SCONS2,Agreeableness=B1SAGREE,Neuroticism=B1SNEURO,                               \n                        BMI=B4PBMI,chol=B4BCHOL,creat=B4BSCREA,trig=B4BTRIGL,\n                        sys=B4P1GS23,dias=B4P1GD23))\nall2 <- cbind(all2[,c(1:16)],'American')\ncolnames(all2)[17] <- 'country'\nall2 <- cbind(all2,'Human')\ncolnames(all2)[18] <- 'species'\nall2 <- cbind(all2,'MIDUS')\ncolnames(all2)[19] <- 'sample'\n\n# fixing the damn age\nsmeandat = meandat\nsmeandat$age <- 1.5*as.numeric(as.Date('01/01/2007', format = \"%m/%d/%Y\")-DoB)/365\ncolnames(smeandat)[4] <- 'age2'\nsmeandat$age2 <- as.numeric(smeandat$age2)\nsmeandat$age2 <- smeandat$age^2\n\n\nsmeandat <- with(smeandat,data.frame(Chimp,sex=sex, age=age, age2=age2,\n                        Dominance=(((Dominance - 1) / 2) + 1),\n                        Extraversion=(((Extraversion - 1) / 2) + 1),\n                        Openness=(((Openness - 1) / 2) + 1),\n                        Conscientiousness=(((Conscientiousness - 1) / 2) + 1),\n                        Agreeableness=(((Agreeableness - 1) / 2) + 1),\n                        Neuroticism=(((Neuroticism - 1) / 2) + 1),                               \n                        BMI=s(BMI),chol=chol,creat=creat,trig=trig,\n                        sys=sys,dias=dias\n))\n                       \ncolnames(smeandat)[1] <- \"M2ID\"\nsmeandat <- cbind(smeandat, 'American')\ncolnames(smeandat)[17] <- 'country'\nsmeandat <- cbind(smeandat,'Chimp')\ncolnames(smeandat)[18] <- 'species'  \nsmeandat <- cbind(smeandat,'YNPRC')\ncolnames(smeandat)[19] <- 'sample'\n\nall3 <- rbind(all1,all2)\nall3$BMI <- s(all3$BMI) \n              \nall3 <- rbind(all3, smeandat)\n\nall3$age <- s(all3$age)\nall3$age2 <- s(all3$age2)\nall3$Dominance <- s(all3$Dominance)\nall3$Extraversion <- s(all3$Extraversion)\nall3$Conscientiousness <- s(all3$Conscientiousness)\nall3$Openness <- s(all3$Openness)\nall3$Neuroticism <- s(all3$Neuroticism)\nall3$Agreeableness <- s(all3$Agreeableness)\nall3$sys <- s(all3$sys)\nall3$dias <- s(all3$dias)\nall3$chol <- s(all3$chol)\nall3$trig <- s(all3$trig)\nall3$creat <- s(all3$creat)\n\n#summary(all3)\n\n\ns <- function(x) {scale(x)}\n\n\nlibrary(lavaan)\nlibrary(semPlot)\nlibrary(semTools)\nlibrary(blavaan)\n\n\nsem.1 <- '\n\nAL =~ 1*chol + 1*trig + 1*sys + 1*dias + 1*BMI\n#AL =~ chol + trig + sys + dias + BMI\n\nAL ~ sex + age + age2 + Dominance + Extraversion + Openness + Conscientiousness + Agreeableness + Neuroticism\n\n# AL ~ sex + age + age2 + Dominance + Extraversion + Openness + Conscientiousness + Agreeableness + Neuroticism\n\nsys ~~ dias\nsys ~~ trig\nsys ~~ BMI\nsys ~~ chol\ndias ~~ trig\ndias ~~ BMI\ndias ~~ chol\ntrig ~~ BMI\ntrig ~~ chol\nBMI ~~ chol\n\n'\n\nRegressions:\n  Estimate  Std.Err  z-value  P(>|z|)\nAL ~                                                \n  sex               0.039    0.068    0.568    0.570\nage              -0.066    0.187   -0.352    0.725\nage2              0.191    0.208    0.917    0.359\nDominance         0.142    0.056    2.524    0.012\nExtraversion     -0.029    0.075   -0.380    0.704\nOpenness         -0.043    0.044   -0.980    0.327\nConscientisnss    0.092    0.055    1.664    0.096\nAgreeableness    -0.062    0.064   -0.959    0.337\nNeuroticism      -0.079    0.048   -1.658    0.097\n\n\n# Constain negative variances to 0\n\n# separately for pers variables?\n\n\n\nf3.0 <- lavaan(sem.1, data = all3, missing=\"ML\", model.type='sem',\n               int.ov.free = TRUE, int.lv.free = FALSE, auto.fix.first = TRUE,\n               auto.fix.single = TRUE, auto.var = TRUE, auto.cov.lv.x = TRUE, auto.th = TRUE, auto.delta = TRUE,\n               auto.cov.y = TRUE\n)\nf3.0b <- lavaan(sem.1, data = all3, missing=\"ML\", model.type='sem',\n               group.equal = c(\"regressions\"),\n               group.partial = c(\"AL ~ sex\",\"AL ~ age\",\"AL ~ age2\"),\n               int.ov.free = TRUE, int.lv.free = FALSE, auto.fix.first = TRUE,\n               auto.fix.single = TRUE, auto.var = TRUE, auto.cov.lv.x = TRUE, auto.th = TRUE, auto.delta = TRUE,\n               auto.cov.y = TRUE\n)\nsemPaths(f3.0, what='mod', whatLabels = 'par')\nfitMeasures(f3.0, c(\"chisq\", \"df\", \"pvalue\", \"cfi\", \"rmsea\",\"srmr\",'AIC','BIC'))\nfitMeasures(f3.0b, c(\"chisq\", \"df\", \"pvalue\", \"cfi\", \"rmsea\",\"srmr\",'AIC','BIC'))\n\n\n\nf3.1b <- lavaan(sem.1, data = all3, missing=\"ML\", model.type='sem', group = 'species',\n               group.equal = c(\"regressions\"),\n               group.partial = c(\"AL ~ sex\",\"AL ~ age\",\"AL ~ age2\"),\n               int.ov.free = TRUE, int.lv.free = FALSE, auto.fix.first = TRUE, \n               auto.fix.single = TRUE, auto.var = TRUE, auto.cov.lv.x = TRUE, auto.th = TRUE, auto.delta = TRUE, \n               auto.cov.y = TRUE\n               )\n\nsemPaths(f3.1, what='mod', whatLabels = 'par')\nsummary(f3.1)\nfitMeasures(f3.1, c(\"chisq\", \"df\", \"pvalue\", \"cfi\", \"rmsea\",\"srmr\",'AIC','BIC'))\n\nmeasurementInvariance(sem.1, data = all3, missing=\"ML\", group = 'species')\n\n\n\nf3.2b <- lavaan(sem.1, data = all3, missing=\"ML\", model.type='sem', group = 'country',\n               group.equal = c(\"regressions\"),\n               group.partial = c(\"AL ~ sex\",\"AL ~ age\",\"AL ~ age2\"),\n               int.ov.free = TRUE, int.lv.free = FALSE, auto.fix.first = TRUE, \n               auto.fix.single = TRUE, auto.var = TRUE, auto.cov.lv.x = TRUE, auto.th = TRUE, auto.delta = TRUE, \n               auto.cov.y = TRUE\n)\n\nsemPaths(f3.2, what='mod', whatLabels = 'par')\nsummary(f3.2)\nfitMeasures(f3.2, c(\"chisq\", \"df\", \"pvalue\", \"cfi\", \"rmsea\",\"srmr\",'AIC','BIC'))\n\nmeasurementInvariance(sem.1, data = all3, missing=\"ML\", group = 'country')\n\n\n\nf3.3 <- lavaan(sem.1, data = all3, missing=\"ML\", model.type='sem', group = 'sample',\n               int.ov.free = TRUE, int.lv.free = FALSE, auto.fix.first = TRUE, \n               auto.fix.single = TRUE, auto.var = TRUE, auto.cov.lv.x = TRUE, auto.th = TRUE, auto.delta = TRUE, \n \n                             auto.cov.y = TRUE\n)\nf3.3b <- lavaan(sem.1, data = all3, missing=\"ML\", model.type='sem', group = 'sample',\n               group.equal = c(\"regressions\"),\n               group.partial = c(\"AL ~ sex\",\"AL ~ age\",\"AL ~ age2\"),\n               int.ov.free = TRUE, int.lv.free = FALSE, auto.fix.first = TRUE, \n               auto.fix.single = TRUE, auto.var = TRUE, auto.cov.lv.x = TRUE, auto.th = TRUE, auto.delta = TRUE, \n               auto.cov.y = TRUE\n)\n\nsemPaths(f3.3, what='mod', whatLabels = 'par')\nsummary(f3.3)\nfitMeasures(f3.3, c(\"chisq\", \"df\", \"pvalue\", \"cfi\", \"rmsea\",\"srmr\",'AIC','BIC'))\n\nsummary(f3.3b)\n\nmeasurementInvariance(sem.1, data = all3, missing=\"ML\", group = 'sample')\n\n\n\n\ncompareFit(f3.0,f3.1,f3.2,f3.3)\n\n\n\n\n# mod_ind <- modificationindices(f3.1)\n# head(mod_ind[order(mod_ind$mi, decreasing=TRUE), ], 10)\n# subset(mod_ind[order(mod_ind$mi, decreasing=TRUE), ], mi > 5)\n\n\nsex              -0.193    0.032   -6.013    0.000\nage               0.626    0.104    6.046    0.000\nage2             -0.570    0.103   -5.515    0.000\nDominance         0.088    0.021    4.227    0.000\nExtraversion     -0.042    0.025   -1.722    0.085\nOpenness         -0.027    0.023   -1.170    0.242\nConscientisnss    0.003    0.019    0.147    0.883\nAgreeableness     0.091    0.024    3.813    0.000\nNeuroticism       0.015    0.016    0.944    0.345\n\n\n\n",
    "created" : 1484840502535.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1066024706",
    "id" : "96005DEE",
    "lastKnownWriteTime" : 1486996598,
    "last_content_update" : 1486996598518,
    "path" : "C:/Users/s1229179/GitHub/R/Yerkes/Drew version/3groupSEMs.R",
    "project_path" : "Drew version/3groupSEMs.R",
    "properties" : {
        "tempName" : "Untitled3"
    },
    "relative_order" : 13,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}