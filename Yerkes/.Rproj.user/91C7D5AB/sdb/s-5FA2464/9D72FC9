{
    "collab_server" : "",
    "contents" : "\nmedian.quartile <- function(x){\n  out <- quantile(x, probs = c(0.25,0.5,0.75))\n  names(out) <- c(\"ymin\",\"y\",\"ymax\")\n  return(out) \n}\nmedian.line <- function(x){\n  out <- quantile(x, probs = 0.5)\n  names(out) <- \"y\"\n  return(out) \n}\n\n\nsetwd(\"./Drew version/\")\nlibrary(texreg)\n\n# Old chimp only models\ntbl1 = htmlreg(m_1)\nprint.texregTable(tbl1)\n\ntbl2a = htmlreg(m_2a)\nprint.texregTable(tbl2a)\n\ntbl2b = htmlreg(m_2b)\nprint.texregTable(tbl2b)\n#---\ntbl2c1 = htmlreg(m_2c)\nprint.texregTable(tbl2c1)\n\ntbl2c2 = htmlreg(c(m_2c,m2c1,m2c2))\nprint.texregTable(tbl2c2)\n\ntbl2c3 = htmlreg(c(m_2c,m2c1,m2c2,m2c0))\nprint.texregTable(tbl2c3)\n\ntbl2c4 = htmlreg(c(m_2c,m2c1,m2c2,m2c0,m2c3))\nprint.texregTable(tbl2c4)\n\n\n\n                   \n### (gg?)plot(s)\n\n#first try - personality dimension distributions, side by side violin/bean plots\n\nvpers<-data.frame(Sample=character(),Dimension=character(),Score=numeric(), Sex=factor)\n\nvpers = rbind(\n  cbind(Sample=\"Yerkes\", Dimension=\"Dominance\", Score=(((output$dom - 1) / 2) + 1),Sex=output$sex),\n  cbind(Sample=\"Yerkes\", Dimension=\"Neuroticism\", Score=(((output$neuro - 1) / 2) + 1),Sex=output$sex),\n  cbind(Sample=\"Yerkes\", Dimension=\"Extraversion\", Score=(((output$extra - 1) / 2) + 1),Sex=output$sex),\n  cbind(Sample=\"Yerkes\", Dimension=\"Agreeableness\", Score=(((output$agree - 1) / 2) + 1),Sex=output$sex),\n  cbind(Sample=\"Yerkes\", Dimension=\"Conscientiousness\", Score=(((output$cons - 1) / 2) + 1),Sex=output$sex),\n  cbind(Sample=\"Yerkes\", Dimension=\"Openness\", Score=(((output$open - 1) / 2) + 1),Sex=output$sex),\n  cbind(Sample=\"Americans\", Dimension=\"Neuroticism\", Score=midus_c$B1SNEURO,Sex=midus_c$B1PRSEX),\n  cbind(Sample=\"Americans\", Dimension=\"Dominance\", Score=midus_c$B1SAGENC,Sex=midus_c$B1PRSEX),\n  cbind(Sample=\"Americans\", Dimension=\"Agreeableness\", Score=midus_c$B1SAGREE,Sex=midus_c$B1PRSEX),\n  cbind(Sample=\"Americans\", Dimension=\"Conscientiousness\", Score=midus_c$B1SCONS2,Sex=midus_c$B1PRSEX),\n  cbind(Sample=\"Americans\", Dimension=\"Extraversion\", Score=midus_c$B1SEXTRA,Sex=midus_c$B1PRSEX),\n  cbind(Sample=\"Americans\", Dimension=\"Openness\", Score=midus_c$B1SOPEN,Sex=midus_c$B1PRSEX),\n  cbind(Sample=\"Japanese\", Dimension=\"Agreeableness\", Score=midja_c$J1SAGREE,Sex=midja_c$J1SQ1),\n  cbind(Sample=\"Japanese\", Dimension=\"Neuroticism\", Score=midja_c$J1SNEURO,Sex=midja_c$J1SQ1),\n  cbind(Sample=\"Japanese\", Dimension=\"Conscientiousness\", Score=midja_c$J1SCONS2,Sex=midja_c$J1SQ1),\n  cbind(Sample=\"Japanese\", Dimension=\"Extraversion\", Score=midja_c$J1SEXTRA,Sex=midja_c$J1SQ1),\n  cbind(Sample=\"Japanese\", Dimension=\"Dominance\", Score=midja_c$J1SAGENC,Sex=midja_c$J1SQ1),\n  cbind(Sample=\"Japanese\", Dimension=\"Openness\", Score=midja_c$J1SOPEN,Sex=midja_c$J1SQ1))\nvpers<-data.frame(Sample=vpers[,1],Dimension=vpers[,2],Score=as.numeric(as.character(vpers[,3])),Sex=as.factor(vpers[,4]))\n\nlibrary(beanplot)\n\nsvg(filename=\"PersBSPID.svg\",            \n    width=10, \n    height=8, \n    pointsize=12,\n    bg='white')\npar(mfrow=c(2,3),\n    oma = c(5,4,0,0) + 0.3,\n    mar = c(0,0,1,1) + 0.5)\nbeanpersD <- with(data=vpers[vpers$Dimension=='Dominance',], beanplot(Score ~ Sex * Sample, side = 'both', bw = 0.3, cutmax = 4, cutmin = 1,\n                                                                     overallline = \"median\", beanlines = 'median', what = c(0,1,1,0), boxwex=0.9,\n                                                                     col = list(\"cadetblue3\", \"cadetblue1\", \"royalblue3\", \"royalblue1\",\"slateblue\",\"slateblue1\"),\n                                                                     main='Dominance' , show.names=FALSE)\n)\n\nbeanpersA <- with(data=vpers[vpers$Dimension=='Agreeableness',], beanplot(Score ~ Sex * Sample, side = 'both', bw = 0.3, cutmax = 4, cutmin = 1,\n                                                                         overallline = \"median\", beanlines = 'median', what = c(0,1,1,0), boxwex=0.9,\n                                                                         col = list(\"cadetblue3\", \"cadetblue1\", \"royalblue3\", \"royalblue1\",\"slateblue\",\"slateblue1\"),\n                                                                         main='Agreeableness' , show.names=FALSE \n                                                                         )\n)\nbeanpersN <- with(data=vpers[vpers$Dimension=='Neuroticism',], beanplot(Score ~ Sex * Sample, side = 'both', bw = 0.3, cutmax = 4, cutmin = 1,\n                                                                       overallline = \"median\", beanlines = 'median', what = c(0,1,1,0), boxwex=0.9,\n                                                                       col = list(\"cadetblue3\", \"cadetblue1\", \"royalblue3\", \"royalblue1\",\"slateblue\",\"slateblue1\"),\n                                                                       main='Neuroticism' , show.names=FALSE)\n)\nbeanpersO <- with(data=vpers[vpers$Dimension=='Openness',], beanplot(Score ~ Sex * Sample, side = 'both', bw = 0.3, cutmax = 4, cutmin = 1,\n                                                                    overallline = \"median\", beanlines = 'median', what = c(0,1,1,0), boxwex=0.9,\n                                                                    col = list(\"cadetblue3\", \"cadetblue1\", \"royalblue3\", \"royalblue1\",\"slateblue\",\"slateblue1\"),\n                                                                    main='Openness' \n                                                                    ))\n\nbeanpersC <- with(data=vpers[vpers$Dimension=='Conscientiousness',], beanplot(Score ~ Sex * Sample, side = 'both', bw = 0.3, cutmax = 4, cutmin = 1,\n                                                                             overallline = \"median\", beanlines = 'median', what = c(0,1,1,0), boxwex=0.9,\n                                                                             col = list(\"cadetblue3\", \"cadetblue1\", \"royalblue3\", \"royalblue1\",\"slateblue\",\"slateblue1\")\n                                                                             , main='Conscientiousness'\n                                                                             )\n)\n\nbeanpersE <- with(data=vpers[vpers$Dimension=='Extraversion',], \n                 beanplot(Score ~ Sex * Sample, side = 'both', bw = 0.3, cutmax = 4, cutmin = 1,\n                          overallline = \"median\", beanlines = 'median', what = c(0,1,1,0), boxwex=0.9,\n                          col = list(\"cadetblue3\", \"cadetblue1\", \"royalblue3\", \"royalblue1\",\"slateblue\",\"slateblue1\")\n                          , main='Extraversion' #, yaxt=''\n                          ))\ndev.off()\n\n\n\n\n\nlibrary(ggplot2)\nviolpers <- ggplot(vpers, aes(x=Sample, y=Score, group=Sample)) + geom_violin(trim=TRUE, aes(fill = factor(Sample))) +\n  facet_wrap(~Dimension) + \n  stat_summary(fun.y=median.quartile,geom='point') + \n  stat_summary(fun.y=median.line,geom='point') +\n  geom_segment(aes(x=Sample-0.1, xend=Sample+0.1, y=Score, yend=Score), colour='white') + theme_bw()\n\nggsave(filename = 'viol_pers.png', plot = violpers, \n       scale = 1, width = 12, height = 10,\n       dpi = 300, limitsize = TRUE)\n\n# some chi sq tests to accompany\nwith(vpers,chisq.test(table(Score[(Dimension=='Dominance')&(Sample=='MIDUS')]),\n                      table(Score[(Dimension=='Dominance')&(Sample=='Yerkes')])))\n                      \n  Score[Dimension=='Dominance'&&Sample=='MIDUS'])\n\n\n### now with the entire data set's worth of personality\nvpersFull<-data.frame(Sample=character(),Dimension=character(),Score=numeric())\n\nvpersFull = rbind(\n  cbind(Sample=\"Yerkes\", Dimension=\"Dominance\", Score=(((output$dom - 1) / 2) + 1)),\n  cbind(Sample=\"Yerkes\", Dimension=\"Neuroticism\", Score=(((output$neuro - 1) / 2) + 1)),\n  cbind(Sample=\"Yerkes\", Dimension=\"Extraversion\", Score=(((output$extra - 1) / 2) + 1)),\n  cbind(Sample=\"Yerkes\", Dimension=\"Agreeableness\", Score=(((output$agree - 1) / 2) + 1)),\n  cbind(Sample=\"Yerkes\", Dimension=\"Conscientiousness\", Score=(((output$cons - 1) / 2) + 1)),\n  cbind(Sample=\"Yerkes\", Dimension=\"Openness\", Score=(((output$open - 1) / 2) + 1)),\n  cbind(Sample=\"MIDUS\", Dimension=\"Neuroticism\", Score=midusP1$B1SNEURO),\n  cbind(Sample=\"MIDUS\", Dimension=\"Dominance\", Score=midusP1$B1SAGENC),\n  cbind(Sample=\"MIDUS\", Dimension=\"Agreeableness\", Score=midusP1$B1SAGREE),\n  cbind(Sample=\"MIDUS\", Dimension=\"Conscientiousness\", Score=midusP1$B1SCONS2),\n  cbind(Sample=\"MIDUS\", Dimension=\"Extraversion\", Score=midusP1$B1SEXTRA),\n  cbind(Sample=\"MIDUS\", Dimension=\"Openness\", Score=midusP1$B1SOPEN),\n  cbind(Sample=\"MIDJA\", Dimension=\"Agreeableness\", Score=midja$J1SAGREE),\n  cbind(Sample=\"MIDJA\", Dimension=\"Neuroticism\", Score=midja$J1SNEURO),\n  cbind(Sample=\"MIDJA\", Dimension=\"Conscientiousness\", Score=midja$J1SCONS2),\n  cbind(Sample=\"MIDJA\", Dimension=\"Extraversion\", Score=midja$J1SEXTRA),\n  cbind(Sample=\"MIDJA\", Dimension=\"Dominance\", Score=midja$J1SAGENC),\n  cbind(Sample=\"MIDJA\", Dimension=\"Openness\", Score=midja$J1SOPEN))\nvpersFull<-data.frame(Sample=vpersFull[,1],Dimension=vpersFull[,2],Score=as.numeric(as.character(vpersFull[,3])))\n\nviolpFull <- ggplot(vpersFull, aes(x=Sample, y=Score, group=Sample)) + geom_violin(trim=TRUE, aes(fill = factor(Sample))) +\n  facet_wrap(~Dimension) + \n  stat_summary(fun.y=median.quartile,geom='point') + \n  stat_summary(fun.y=median.line,geom='point') +\n  geom_segment(aes(x=Sample-0.1, xend=Sample+0.1, y=Score, yend=Score), colour='white') + theme_bw()\n#violpFull\n\nggsave(filename = 'viol_fullpers.png', plot = violpFull, \n       scale = 1, width = 12, height = 10,\n       dpi = 300, limitsize = TRUE)\n\n\n### framing and plotting of biomarker distrs\nvbio <- NULL\nvbio <- rbind(\n  cbind(Sample=\"Yerkes\",Marker=\"Diastolic BP\",Value=output$dias, Sex=output$sex),\n  cbind(Sample=\"Yerkes\",Marker='Systolic BP',Value=output$sys,Sex=output$sex),\n  cbind(Sample=\"Yerkes\",Marker='BMI',Value=output$BMI,Sex=output$sex),\n  cbind(Sample=\"Yerkes\",Marker='Cholesterol',Value=output$chol,Sex=output$sex),\n  cbind(Sample=\"Yerkes\",Marker='Triglycerides',Value=output$trig,Sex=output$sex),\n  cbind(Sample=\"Yerkes\",Marker='Creatinine',Value=output$creatinine, Sex=output$sex),\n  cbind(Sample=\"Americans\",Marker='Diastolic BP',Value=midus_c$B4P1GD,Sex=midus_c$B1PRSEX),\n  cbind(Sample=\"Americans\",Marker='Systolic BP',Value=midus_c$B4P1GS,Sex=midus_c$B1PRSEX),\n  cbind(Sample=\"Americans\",Marker='BMI',Value=midus_c$B4PBMI,Sex=midus_c$B1PRSEX),\n  cbind(Sample=\"Americans\",Marker='Cholesterol',Value=midus_c$B4BCHOL,Sex=midus_c$B1PRSEX),\n  cbind(Sample=\"Americans\",Marker='Triglycerides',Value=midus_c$B4BTRIGL,Sex=midus_c$B1PRSEX),\n  cbind(Sample=\"Americans\",Marker='Creatinine',Value=midus_c$B4BSCREA,Sex=midus_c$B1PRSEX),\n  cbind(Sample=\"Japanese\",Marker='Diastolic BP',Value=midja_c$J2CBPD23,Sex=midja_c$J1SQ1),\n  cbind(Sample=\"Japanese\",Marker='Systolic BP',Value=midja_c$J2CBPS23,Sex=midja_c$J1SQ1),\n  cbind(Sample=\"Japanese\",Marker='BMI',Value=midja_c$J2CBMI,Sex=midja_c$J1SQ1),\n  cbind(Sample=\"Japanese\",Marker='Cholesterol',Value=midja_c$J2BCHOL,Sex=midja_c$J1SQ1),\n  cbind(Sample=\"Japanese\",Marker='Triglycerides',Value=midja_c$J2CTRIG,Sex=midja_c$J1SQ1),\n  cbind(Sample=\"Japanese\",Marker='Creatinine',Value=midja_c$J2BSCREA,Sex=midja_c$J1SQ1)\n  )\nvbio<-data.frame(Sample=vbio[,1],Marker=vbio[,2],Value=as.numeric(as.character(vbio[,3])),Sex=as.factor(vbio[,4]))\n\n\nsvg(filename=\"BiomarkBSPID.svg\",            \n     width=10, \n     height=8, \n     pointsize=12,\n     bg='white')\npar(mfrow=c(2,3),\n    oma = c(5,4,0,0) + 0.3,\n    mar = c(0,0,1,1) + 0.5)\nbeanBioBMI <- with(data=vbio[vbio$Marker=='BMI',], beanplot(Value ~ Sex * Sample, side = 'both', log = '',\n                                                         bw = 5, main='BMI', show.names=FALSE,\n                                                                     overallline = \"median\", beanlines = 'median', what = c(0,1,1,0), boxwex=0.9,\n                                                                     col = list(\"cadetblue3\", \"cadetblue1\", \"royalblue3\", \"royalblue1\",\"slateblue\",\"slateblue1\"))\n)\n\nbeanBioDBP <- with(data=vbio[vbio$Marker=='Diastolic BP',], beanplot(Value ~ Sex * Sample, side = 'both', log = '',\n                                                                  bw = 5, main='Diastolic BP', show.names=FALSE,\n                                                                         overallline = \"median\", beanlines = 'median', what = c(0,1,1,0), boxwex=0.9,\n                                                                         col = list(\"cadetblue3\", \"cadetblue1\", \"royalblue3\", \"royalblue1\",\"slateblue\",\"slateblue1\"))\n)\nbeanBioSBP <- with(data=vbio[vbio$Marker=='Systolic BP',], beanplot(Value ~ Sex * Sample, side = 'both', log = '',\n                                                                 bw = 7, main='Systolic BP', show.names=FALSE,\n                                                                       overallline = \"median\", beanlines = 'median', what = c(0,1,1,0), boxwex=0.9,\n                                                                       col = list(\"cadetblue3\", \"cadetblue1\", \"royalblue3\", \"royalblue1\",\"slateblue\",\"slateblue1\"))\n)\nbeanBioChol <- with(data=vbio[vbio$Marker=='Cholesterol',], beanplot(Value ~ Sex * Sample, side = 'both', log = '',\n                                                                 bw = 10.0, main = 'Cholesterol',\n                                                                    overallline = \"median\", beanlines = 'median', what = c(0,1,1,0), boxwex=0.9,\n                                                                    col = list(\"cadetblue3\", \"cadetblue1\", \"royalblue3\", \"royalblue1\",\"slateblue\",\"slateblue1\"))\n)\n\nbeanBioTrig <- with(data=vbio[vbio$Marker=='Triglycerides',], beanplot(Value ~ Sex * Sample, side = 'both', log = '',\n                                                                   bw = 15.0, main='Triglycerides', \n                                                                             overallline = \"median\", beanlines = 'median', what = c(0,1,1,0), boxwex=0.9,\n                                                                             col = list(\"cadetblue3\", \"cadetblue1\", \"royalblue3\", \"royalblue1\",\"slateblue\",\"slateblue1\"))\n)\n\nbeanBioCreat <- with(data=vbio[vbio$Marker=='Creatinine',], \n                 beanplot(Value ~ Sex * Sample, side = 'both', \n                          bw = 0.07, log = '', main='Creatinine' ,\n                          overallline = \"median\", beanlines = 'median', what = c(0,1,1,0), boxwex=0.9,\n                          col = list(\"cadetblue3\", \"cadetblue1\", \"royalblue3\", \"royalblue1\",\"slateblue\",\"slateblue1\"))\n)\n\n\ndev.off()\n\n\nvbpbio <- ggplot(vbio, aes(x=Sample, y=Value, group=Sample)) + geom_boxplot(trim=TRUE, aes(fill = factor(Sample)))\n  #+ stat_summary(fun.y=median.quartile,geom='point') + \n  stat_summary(fun.y=median.line,geom='point') +\n  geom_segment(aes(x=Sample-0.1, xend=Sample+0.1, y=Value, yend=Value), colour='white')\nvbpbio + facet_wrap(~ Marker, scales = \"free_y\") + theme_bw() \nvbpbio\n\n\n# violtest <- ggplot(diamonds, aes(x=color, y=depth, group=color)) +\n#   geom_boxplot(trim=TRUE, aes(fill = factor(color))) +\n#   facet_wrap(~ clarity, scales = \"free_y\") + theme_bw()\n# \n# violtest\n\n\nlibrary(reshape2)\n# vmregs <- reshape(midus_cs, direction=\"long\", varying=NULL,\n#                   v.names=c('Dominance','Extraversion','Openness',\n#                             'Conscientiousness','Agreeableness','Neuroticism'))\nvmregs <- melt(midus_cs[,1:15], id.vars=c('M2ID','sex','age','chol','creat','trig','BMI','sys','dias'))\nvmregs$Sample = 'MIDUS'\nvjregs <- melt(midja_cs[,1:15], id.vars=c('MIDJA_IDS','sex','age','chol','creat','trig','BMI','sys','dias'))\nvjregs$Sample = 'MIDJA'\ncolnames(vjregs)[1]<-'M2ID'\n#vmjregs <- merge(vmregs,vjregs,by=c('M2ID','age','sex','chol','creat','BMI','sys','dias','trig','variable','value'))\nvmjregs <- rbind(vmregs,vjregs)\n\nsimp_mean=cbind(imp_mean$imputations$imp7[,1:2],apply(imp_mean$imputations$imp7[,3:20], c(2), scale))\n\nvcregs <- melt(simp_mean[,1:15], id.vars=c('Chimp','sex','age','chol','creat','trig','BMI','sys','dias'))\nvcregs$Sample = 'Yerkes'\ncolnames(vcregs)[1]<-'M2ID'\n\nvmjcregs <- rbind(vmjregs,vcregs)\n              \ncolnames(vmjcregs)[2:11]<-c('Sex','Age','Cholesterol','Creatinine','Triglycerides',\n                           'BMI','Systolic BP','Diastolic BP','Personality','Score')\n\n# one each for all the biomarkers ... i.e. long format\n\n# vcregs <- with(data=meandat,data.frame(Chimp=chimp,Sex=sex,Age=age,\n#                                        Cholesterol=chol,Creatinine=creatinine,Triglycerides=trig,\n#                                        BMI=BMI,Systolic=sys,Diastolic=dias,\n#                                        Dominance=dom,Extraversion=extra,Openness=open,\n#                                        Conscientiousness=cons,Agreeableness=agree,Neuroticism=neuro))\n#                                        \n\n\n### let the ggplotting fuck begin\n\n\nvregs <- ggplot(vmjcregs, aes(y=Cholesterol,x=Score,colour=Sample)) + \n  stat_smooth(method=lm \n            #  , formula=\"Cholesterol ~ Dominance + Neuroticism + Agreeableness + Extraversion + Conscientiousness + Openness\n            #  + Sex + BMI + Age + 1\"\n              ) #+ \n  +facet_wrap(~Personality)\nvregs\nvregs + geom_point()\n# vregs + geom_line(data=meandat, \n#               aes(ymin=lwr,ymax=upr)\n  \n#vregs + geom_abline(aes(intercept=coef(m.chol[1])), slope = coef(m.chol[5]))\n\n\n# new predictions for lmer's\n\n\ncForPreds <-  data.frame(scoutput[,6:11]\n  #,scoutput$age,scoutput$BMI,scoutput$sex\n  )\ncForPreds = data.frame(dom=scoutput$dom)\n\ncchol.d.preds = predict(m2.chol\n                        #scoutput[,6:11])\n                        #expand.grid(scoutput[,6:11],scoutput$age,scoutput$BMI,scoutput$sex)) # BE CAREFUL\n    #                    , newdata=cForPreds\n                        )\n\n\n\n\ncchol.preds = data.frame(\n  rbind(\n    cbind(Cholesterol=cchol.preds,lwr=cchol.preds-fixef(m2.chol)[2],upr=cchol.preds+fixef(m2.chol)[2],Dimension=\"Dominance\"),\n    cbind(Cholesterol=cchol.preds,lwr=cchol.preds-fixef(m2.chol)[3],upr=cchol.preds+fixef(m2.chol)[3],Dimension=\"Extraversion\")\n  ))\n\n\nvregs + geom_smooth(data=cchol.preds, aes(ymin=lwr,ymax=upr,fill='Yerkes'),alpha=0.3) #+              \n             \n              \n\nvregs <- ggplot(, aes(y=carat, x=price)) + facet_grid(. ~ cut)\nc + stat_smooth(method=lm, fullrange = TRUE) + geom_point()\nc + stat_smooth(method=lm) + geom_point\n  \n\n\n#library(ez)\n#cchol.preds = ezPredict(m2.chol)\n\nlibrary(effects)\n        \n              \n\nfixed.chol = data.frame(fixef(m2.chol))\n\nvregs + geom_abline(intercept=fixed.chol[1,1],slope=fixed.chol[5,1] + theme_bw())\n\n\nlibrary(arm)\nsim.m2.chol = sim(m2.chol)\ncoefplot(sim.m2.chol)\n\n\ninstall.packages(\"coefplot2\",\n                 repos=\"http://www.math.mcmaster.ca/bolker/R\",\n                 type=\"source\")\n\n\n##### the plots below are where the regression visualization gets decent\n\n\nsample_vect = c((rep(c('Japanese'),9)),(rep(c('Americans'),9)),(rep(c('Yerkes'),9)))\n# 9: +3 for adding age, age^2, and BMI\n\npd <- position_dodge(width=0.2,height=NULL)\n\n# Systolic CF plots\nc.sys.co=fixef(m1a.a2)[c(2:3,5:11)]\nm.sys.co=m.sys.a2$coefficients[c(2:3,5:11)]\nj.sys.co=mj.sys.a2$coefficients[c(2:3,5:11)]\n\nc.sys.prd = confint(m1a.a2, level=0.92, method=\"boot\")[c(4:5,7:13),]\nm.sys.prd = confint(m.sys.a2, level=0.92)[c(2:3,5:11),]\nj.sys.prd = confint(mj.sys.a2, level=0.92)[c(2:3,5:11),]\n\nsys.ci = data.frame(\n  Coefficients=c(j.sys.co,m.sys.co,c.sys.co),rbind(j.sys.prd,m.sys.prd,c.sys.prd),sample_vect,Dimension=rep(rownames(m.sys.prd),3)\n)\ncolnames(sys.ci)<-c(\"Coefficients\",'lower',\"upper\",\"Sample\",\"Dimension\")\n\nlevels(sys.ci$Dimension) <- sub(\"^age$\", \"Age\", levels(sys.ci$Dimension))\nlevels(sys.ci$Dimension)[7] <- 'Age^2' # dunno why the above technique doesn't work\nsys.ci$Dimension <- relevel(sys.ci$Dimension,'BMI')\nsys.ci$Dimension <- relevel(sys.ci$Dimension,'Age^2')\nsys.ci$Dimension <- relevel(sys.ci$Dimension,'Age')\n\n\nsys.ci.gg <- ggplot(sys.ci, aes(Sample,Coefficients, color=Sample)) +\n  geom_point(aes(shape=Sample),size=4, position=pd) + \n  scale_color_manual(name=\"Sample\",values=c(\"cadetblue3\", \"royalblue1\",\"slateblue\")) + \n  theme_bw() + theme(legend.position='none') +\n  #  scale_x_continuous(\"Sample\", breaks=1:length(Sample), labels=Sample) + \n  scale_y_continuous(\"Regression coefficients\")   + \n  geom_errorbar(aes(ymin=lower,ymax=upper),width=0.1,position=pd) + facet_wrap(~ Dimension, ncol=3)\n\nggsave(filename = 'sys.png', plot = sys.ci.gg, \n       scale = 1, width = 7, height = 10,\n       dpi = 300, limitsize = TRUE)\n\n\n# Diastolic CF plots\nc.dias.co=fixef(m1b.a2)[c(2:3,5:11)]\nm.dias.co=m.dias.a2$coefficients[c(2:3,5:11)]\nj.dias.co=mj.dias.a2$coefficients[c(2:3,5:11)]\n\nc.dias.prd = confint(m1b.a2, level=0.92, method=\"boot\")[c(4:5,7:13),]\nm.dias.prd = confint(m.dias.a2, level=0.92)[c(2:3,5:11),]\nj.dias.prd = confint(mj.dias.a2, level=0.92)[c(2:3,5:11),]\n\ndias.ci = data.frame(\n  Coefficients=c(j.dias.co,m.dias.co,c.dias.co),rbind(j.dias.prd,m.dias.prd,c.dias.prd),sample_vect,Dimension=rep(rownames(m.dias.prd),3)\n)\ncolnames(dias.ci)<-c(\"Coefficients\",'lower',\"upper\",\"Sample\",\"Dimension\")\n\nlevels(dias.ci$Dimension) <- sub(\"^age$\", \"Age\", levels(dias.ci$Dimension))\nlevels(dias.ci$Dimension)[7] <- 'Age^2' # dunno why the above technique doesn't work\ndias.ci$Dimension <- relevel(dias.ci$Dimension,'BMI')\ndias.ci$Dimension <- relevel(dias.ci$Dimension,'Age^2')\ndias.ci$Dimension <- relevel(dias.ci$Dimension,'Age')\n\ndias.ci.gg <- ggplot(dias.ci, aes(Sample,Coefficients, color=Sample)) +\n  geom_point(aes(shape=Sample),size=4, position=pd) + \n  scale_color_manual(name=\"Sample\",values=c(\"cadetblue3\", \"royalblue1\",\"slateblue\")) + \n  theme_bw() + theme(legend.position='none') +\n  #  scale_x_continuous(\"Sample\", breaks=1:length(Sample), labels=Sample) + \n  scale_y_continuous(\"Regression coefficients\")   + \n  geom_errorbar(aes(ymin=lower,ymax=upper),width=0.1,position=pd) + facet_wrap(~ Dimension, ncol=3)\n\nggsave(filename = 'dias.png', plot = dias.ci.gg, \n       scale = 1, width = 7, height = 10,\n       dpi = 300, limitsize = TRUE)\n\n\n# Triglyceride CF plots\nc.trig.co=fixef(m2.trig.a2)[c(2:3,5:11)]\nm.trig.co=m.trig.a2$coefficients[c(2:3,5:11)]\nj.trig.co=mj.trig.a2$coefficients[c(2:3,5:11)]\n\nc.trig.prd = confint(m2.trig.a2, level=0.92, method=\"boot\")[c(4:5,7:13),]\nm.trig.prd = confint(m.trig.a2, level=0.92)[c(2:3,5:11),]\nj.trig.prd = confint(mj.trig.a2, level=0.92)[c(2:3,5:11),]\n\ntrig.ci = data.frame(\n  Coefficients=c(j.trig.co,m.trig.co,c.trig.co),rbind(j.trig.prd,m.trig.prd,c.trig.prd),sample_vect,Dimension=rep(rownames(m.trig.prd),3)\n)\ncolnames(trig.ci)<-c(\"Coefficients\",'lower',\"upper\",\"Sample\",\"Dimension\")\n\nlevels(trig.ci$Dimension) <- sub(\"^age$\", \"Age\", levels(trig.ci$Dimension))\nlevels(trig.ci$Dimension)[7] <- 'Age^2' # dunno why the above technique doesn't work\ntrig.ci$Dimension <- relevel(trig.ci$Dimension,'BMI')\ntrig.ci$Dimension <- relevel(trig.ci$Dimension,'Age^2')\ntrig.ci$Dimension <- relevel(trig.ci$Dimension,'Age')\n\n\ntrig.ci.gg <- ggplot(trig.ci, aes(Sample,Coefficients, color=Sample)) +\n  geom_point(aes(shape=Sample),size=4, position=pd) + \n  scale_color_manual(name=\"Sample\",values=c(\"cadetblue3\", \"royalblue1\",\"slateblue\")) + \n  theme_bw() + theme(legend.position='none') +\n  #  scale_x_continuous(\"Sample\", breaks=1:length(Sample), labels=Sample) + \n  scale_y_continuous(\"Regression coefficients\")   + \n  geom_errorbar(aes(ymin=lower,ymax=upper),width=0.1,position=pd) + facet_wrap(~ Dimension, ncol=3)\n\nggsave(filename = 'trig.png', plot = trig.ci.gg, \n       scale = 1, width = 7, height = 10,\n       dpi = 300, limitsize = TRUE)\n\n\n# Cholesterol CF plots\nc.chol.co=fixef(m2.chol.a2)[c(2:3,5:11)]\nm.chol.co=m.chol.a2$coefficients[c(2:3,5:11)]\nj.chol.co=mj.chol.a2$coefficients[c(2:3,5:11)]\n\nc.chol.prd = confint(m2.chol.a2, level=0.92, method=\"boot\")[c(4:5,7:13),]\nm.chol.prd = confint(m.chol.a2, level=0.92)[c(2:3,5:11),]\nj.chol.prd = confint(mj.chol.a2, level=0.92)[c(2:3,5:11),]\n\nchol.ci = data.frame(\n  Coefficients=c(j.chol.co,m.chol.co,c.chol.co),rbind(j.chol.prd,m.chol.prd,c.chol.prd),sample_vect,Dimension=rep(rownames(m.chol.prd),3)\n)\ncolnames(chol.ci)<-c(\"Coefficients\",'lower',\"upper\",\"Sample\",\"Dimension\")\n\nlevels(chol.ci$Dimension) <- sub(\"^age$\", \"Age\", levels(chol.ci$Dimension))\nlevels(chol.ci$Dimension)[7] <- 'Age^2' # dunno why the above technique doesn't work\nchol.ci$Dimension <- relevel(chol.ci$Dimension,'BMI')\nchol.ci$Dimension <- relevel(chol.ci$Dimension,'Age^2')\nchol.ci$Dimension <- relevel(chol.ci$Dimension,'Age')\n\nchol.ci.gg <- ggplot(chol.ci, aes(Sample,Coefficients, color=Sample)) +\n  geom_point(aes(shape=Sample),size=4, position=pd) + \n  scale_color_manual(name=\"Sample\",values=c(\"cadetblue3\", \"royalblue1\",\"slateblue\")) + \n  theme_bw() + theme(legend.position='none') +\n  #  scale_x_continuous(\"Sample\", breaks=1:length(Sample), labels=Sample) + \n  scale_y_continuous(\"Regression coefficients\")   + \n  geom_errorbar(aes(ymin=lower,ymax=upper),width=0.1,position=pd) + facet_wrap(~ Dimension, ncol=3)\n\nggsave(filename = 'chol.png', plot = chol.ci.gg, \n       scale = 1, width = 7, height = 10,\n       dpi = 300, limitsize = TRUE)\n\n\n# Creatinine CF plots\nc.creat.co=fixef(m2.creat.a2)[c(2:3,5:11)]\nm.creat.co=m.creat.a2$coefficients[c(2:3,5:11)]\nj.creat.co=mj.creat.a2$coefficients[c(2:3,5:11)]\n\nc.creat.prd = confint(m2.creat.a2, level=0.92, method=\"boot\")[c(4:5,7:13),]\nm.creat.prd = confint(m.creat.a2, level=0.92)[c(2:3,5:11),]\nj.creat.prd = confint(mj.creat.a2, level=0.92)[c(2:3,5:11),]\n\ncreat.ci = data.frame(\n  Coefficients=c(j.creat.co,m.creat.co,c.creat.co),rbind(j.creat.prd,m.creat.prd,c.creat.prd),sample_vect,Dimension=rep(rownames(m.creat.prd),3)\n)\ncolnames(creat.ci)<-c(\"Coefficients\",'lower',\"upper\",\"Sample\",\"Dimension\")\n\nlevels(creat.ci$Dimension) <- sub(\"^age$\", \"Age\", levels(creat.ci$Dimension))\nlevels(creat.ci$Dimension)[7] <- 'Age^2' # dunno why the above technique doesn't work\ncreat.ci$Dimension <- relevel(creat.ci$Dimension,'BMI')\ncreat.ci$Dimension <- relevel(creat.ci$Dimension,'Age^2')\ncreat.ci$Dimension <- relevel(creat.ci$Dimension,'Age')\n\n\ncreat.ci.gg <- ggplot(creat.ci, aes(Sample,Coefficients, color=Sample)) +\n  geom_point(aes(shape=Sample),size=4, position=pd) + \n  scale_color_manual(name=\"Sample\",values=c(\"cadetblue3\", \"royalblue1\",\"slateblue\")) + \n  theme_bw() + theme(legend.position='none') +\n  #  scale_x_continuous(\"Sample\", breaks=1:length(Sample), labels=Sample) + \n  scale_y_continuous(\"Regression coefficients\")   + \n  geom_errorbar(aes(ymin=lower,ymax=upper),width=0.1,position=pd) + facet_wrap(~ Dimension, ncol=3)\n\nggsave(filename = 'creat.png', plot = creat.ci.gg, \n       scale = 1, width = 7, height = 10,\n       dpi = 300, limitsize = TRUE)\n\n\n\n#BMI reg CF plots\n# beware - can't use this until fix the BMI lmer\nc.BMI.co=fixef(m3.BMI.a2)[c(2,4:10)]\nm.BMI.co=m.BMI.a2$coefficients[c(2,4:10)]\nj.BMI.co=mj.BMI.a2$coefficients[c(2,4:10)]\n\nc.BMI.prd = confint(m3.BMI.a2, method='Wald',level=0.95)[c(2,4:10),]\nm.BMI.prd = confint(m.BMI.a2,level=0.95)[c(2,4:10),]\nj.BMI.prd = confint(mj.BMI.a2, level=0.95)[c(2,4:10),]\n\nBMI.ci = data.frame(\n  Coefficients=c(j.BMI.co,m.BMI.co,c.BMI.co),rbind(j.BMI.prd,m.BMI.prd,c.BMI.prd),\n  c((rep(c('Japanese'),8)),(rep(c('Americans'),8)),(rep(c('Yerkes'),8))),\n  Dimension=as.character(rep(rownames(m.BMI.prd),3))\n)\ncolnames(BMI.ci)<-c(\"Coefficients\",'lower',\"upper\",\"Sample\",\"Dimension\")\n\nlevels(BMI.ci$Dimension) <- sub(\"^age$\", \"Age\", levels(BMI.ci$Dimension))\nlevels(BMI.ci$Dimension)[6] <- 'Age^2' # dunno why the above technique doesn't work\nBMI.ci$Dimension <- relevel(BMI.ci$Dimension,'Age^2')\nBMI.ci$Dimension <- relevel(BMI.ci$Dimension,'Age')\n\nBMI.ci.gg <- ggplot(BMI.ci, aes(Sample,Coefficients, color=Sample)) +\n  geom_point(aes(shape=Sample),size=4, position=pd) + \n  scale_color_manual(name=\"Sample\",values=c(\"cadetblue3\", \"royalblue1\",\"slateblue\")) + \n  theme_bw() + theme(legend.position='none') + \n  #  scale_x_continuous(\"Sample\", breaks=1:length(Sample), labels=Sample) + \n  scale_y_continuous(\"Regression coefficients\")   + \n  geom_errorbar(aes(ymin=lower,ymax=upper),width=0.1,position=pd) +\n  facet_wrap(~ Dimension, ncol=2)\n#labeller = label_parsed) # so dumb that this doesn't work\n\n#facet_wrap_labeller(BMI.cf.gg, labels = expression(paste(\"Age \", alpha), beta, gamma, delta, \"Age^2\", 'boom'))\n# fuck this, low priority, fix it later\n\n\nggsave(filename = 'BMI.png', plot = BMI.ci.gg, \n       scale = 1, width = 6, height = 10,\n       dpi = 300, limitsize = TRUE)\n\n\n\n#--- Tables for 27/03/2015 and beyond\nlibrary(texreg)\n\n#sys.tbl\n\next.m1a=extract(m1a.a2, include.aic = FALSE, include.bic=FALSE, include.dic=FALSE,\n                include.deviance=FALSE, include.loglik=FALSE,include.nobs=FALSE,\n                include.groups=FALSE,include.variance=FALSE)\n\nsys.tbl = htmlreg(list(m.sys.a2,mj.sys.a2,ext.m1a), custom.model.names=c('Americans','Japanese','Yerkes'), ci.force=TRUE,\n                  caption = \"\", groups=NULL, digits=3, ci.force.level = 0.92, ci.test=NULL,\n                  bold=TRUE, custom.note = '', reorder.coef = c(1:5,8,9,6,11,10,7),\n                  custom.coef.names=c(NA,\"Age\",\"Age<sup>2</sup>\",\"Sex\",NA,NA,NA,NA,NA,NA,NA))\nwrite(sys.tbl,\"sys.html\")\n\next.trig=extract(m2.trig.a2, include.aic = FALSE, include.bic=FALSE, include.dic=FALSE,\n                 include.deviance=FALSE, include.loglik=FALSE,include.nobs=FALSE,\n                 include.groups=FALSE,include.variance=FALSE)\ntrig.tbl = htmlreg(list(m.trig.a2,mj.trig.a2,ext.trig), custom.model.names=c('Americans','Japanese','Yerkes'), ci.force=TRUE,\n                   caption = \"\", groups=NULL, digits=3, ci.force.level = 0.92, ci.test=NULL,\n                   bold=TRUE, custom.note = '', reorder.coef = c(1:5,8,9,6,11,10,7),\n                   custom.coef.names=c(NA,\"Age\",\"Age<sup>2</sup>\",\"Sex\",NA,NA,NA,NA,NA,NA,NA))\nwrite(trig.tbl,\"trig.html\")\n\next.chol=extract(m2.chol.a2, include.aic = FALSE, include.bic=FALSE, include.dic=FALSE,\n                 include.deviance=FALSE, include.loglik=FALSE,include.nobs=FALSE,\n                 include.groups=FALSE,include.variance=FALSE)\nchol.tbl = htmlreg(list(m.chol.a2,mj.chol.a2,ext.chol), custom.model.names=c('Americans','Japanese','Yerkes'), ci.force=TRUE,\n                   caption = \"\", groups=NULL, digits=3, ci.force.level = 0.92, ci.test=NULL,\n                   bold=TRUE, custom.note = '', reorder.coef = c(1:5,8,9,6,11,10,7),\n                   custom.coef.names=c(NA,\"Age\",\"Age<sup>2</sup>\",\"Sex\",NA,NA,NA,NA,NA,NA,NA))\nwrite(chol.tbl,\"chol.html\")\n\next.m2.creat=extract(m2.creat.a2, include.aic = FALSE, include.bic=FALSE, include.dic=FALSE,\n                     include.deviance=FALSE, include.loglik=FALSE,include.nobs=FALSE,\n                     include.groups=FALSE,include.variance=FALSE)\ncreat.tbl = htmlreg(list(m.creat.a2,mj.creat.a2,ext.m2.creat), custom.model.names=c('Americans','Japanese','Yerkes'), ci.force=TRUE,\n                    caption = \"\", groups=NULL, digits=3, ci.force.level = 0.92, ci.test=NULL,\n                    bold=TRUE, custom.note = '', reorder.coef = c(1:5,8,9,6,11,10,7),\n                    custom.coef.names=c(NA,\"Age\",\"Age<sup>2</sup>\",\"Sex\",NA,NA,NA,NA,NA,NA,NA))\nwrite(creat.tbl,\"creat.html\")\n\next.m1b=extract(m1b.a2, include.aic = FALSE, include.bic=FALSE, include.dic=FALSE,\n                include.deviance=FALSE, include.loglik=FALSE,include.nobs=FALSE,\n                include.groups=FALSE,include.variance=FALSE)  \ndias.tbl = htmlreg(list(m.dias.a2,mj.dias.a2,ext.m1b), custom.model.names=c('Americans','Japanese','Yerkes'), ci.force=TRUE,\n                   caption = \"\", groups=NULL, digits=3, ci.force.level = 0.92, ci.test=NULL,\n                   bold=TRUE, custom.note = '', reorder.coef = c(1:5,8,9,6,11,10,7),\n                   custom.coef.names=c(NA,\"Age\",\"Age<sup>2</sup>\",\"Sex\",NA,NA,NA,NA,NA,NA,NA))\n                   #override.ci.low = list(c(0.1,0.1,0.1)),\n                   #override.ci.up = list(c(0.1,0.1,0.1))                                                           \n\nwrite(dias.tbl,\"dias.html\")\n\next.m3.BMI = extract(m3.BMI.a2, include.aic = FALSE, include.bic=FALSE, include.dic=FALSE,\n                                  include.deviance=FALSE, include.loglik=FALSE,include.nobs=FALSE,\n                                  include.groups=FALSE,include.variance=FALSE)\nBMI.tbl = htmlreg(list(m.BMI.a2,mj.BMI.a2,ext.m3.BMI), custom.model.names=c('Americans','Japanese','Yerkes'), ci.force=TRUE,\n                   caption = \"\", groups=NULL, digits=3, ci.force.level = 0.92, ci.test=NULL,\n                   bold=TRUE, custom.note = '', reorder.coef = c(1:4,7,8,5,10,9,6),\n                   custom.coef.names=c(NA,\"Age\",\"Age<sup>2</sup>\",\"Sex\",NA,NA,NA,NA,NA,NA)\n                  #custom.coef.names=expression(paste(\"c(NA,'Age', 'Age'\"^\"'2', 'Sex',NA,NA,NA,NA,NA,NA)\")),\n                  #custom.coef.names=coef.a2\n                   #override.ci.low = list(c(0.1,0.1,0.1)),\n                   #override.ci.up = list(c(0.1,0.1,0.1))                                                           \n)\nwrite(BMI.tbl,\"BMI.html\")\n\n",
    "created" : 1459865674779.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2625003075",
    "id" : "9D72FC9",
    "lastKnownWriteTime" : 1433858093,
    "last_content_update" : 1433858093,
    "path" : "C:/Users/s1229179/GitHub/R/Yerkes/visualize.R",
    "project_path" : "visualize.R",
    "properties" : {
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}