data = scoutput)
summary(m1a)
vif(m_1)
vif.mer(m_1)
summary(m_2a)
m_2a <- lmer(chol ~ ext + neu + con + opn + agr + age + BMI + sex + (1 | chimp),
data = scoutput)
m2a1 <- lmer(chol ~ ext + neu + con + opn + agr + age + BMI + sex + (1 | chimp),
data = scoutput)
summary(m2a1)
cor(output$neu,output$dom, use='complete')
cor(output$agr,output$dom, use='complete')
cor(output$con,output$dom, use='complete')
m2a1 <- lmer(chol ~ dom + ext + neu + con + opn + age + BMI + sex + (1 | chimp),
data = scoutput)
summary(m2a1)
m2a1 <- lmer(chol ~ dom + neu + con + opn + agr + age + BMI + sex + (1 | chimp),
data = scoutput)
summary(m2a1)
m2a1 <- lmer(chol ~ + dom:agr + dom + ext + neu + con + opn + agr + age + BMI + sex + (1 | chimp),
data = scoutput)
summary(m2a1)
AIC(m_2a,m2a1)
vif.mer(m_2a,m2a1)
vif.mer(m_2a)
vif.mer(m2a1)
m_2a <- lmer(chol ~ dom + ext + neu + con + opn + agr + age + BMI + sex + (1 | chimp),
data = scoutput)
AIC(m_2a,m2a1)
vif.mer(m_2a)
vif.mer(m2a1)
install.packages("stargazer")
library(stargazer)
source('C:/Users/s1229179/git-repos/R/blood chemistry/Drew version/shapeUp.R')
library("lmerTest", lib.loc="C:/Users/Public/R")
library("lme4", lib.loc="C:/Users/Public/R")
source('C:/Users/s1229179/git-repos/R/blood chemistry/Drew version/shapeUp.R')
age <- as.numeric(as.Date("2014-04-15")-DoB)
mmdat <- data.frame(dmdob$chimp,sex,BMI,DoB,age, # to get current age
compare_data$chimp_Dom_CZ,compare_data$chimp_Ext_CZ,compare_data$chimp_Con_CZ,
compare_data$chimp_Agr_CZ,compare_data$chimp_Neu_CZ,compare_data$chimp_Opn_CZ,
trig[,1], chol[,1], glucose[,1],
mono[,1],lymph[,1],wbc[,1],
protein[,1],albumin[,1],calcium[,1],phos[,1],sodium[,1],potas[,1],
chlor[,1],globulin[,1],GGT[,1],osmolality[,1],ALP[,1],creatinine[,1],
BUN[,1],rbc[,1],hct[,1],hgb[,1],eos[,1],systolic[,1],diastolic[,1],
trig[,2], chol[,2], glucose[,2],
mono[,2],lymph[,2],wbc[,2],
protein[,2],albumin[,2],calcium[,2],phos[,2],sodium[,2],potas[,2],
chlor[,2],globulin[,2],GGT[,2],osmolality[,2],ALP[,2],creatinine[,2],
BUN[,2],rbc[,2],hct[,2],hgb[,2],eos[,2],systolic[,2],diastolic[,2],
trig[,3], chol[,3], glucose[,3],
mono[,3],lymph[,3],wbc[,3],
protein[,3],albumin[,3],calcium[,3],phos[,3],sodium[,3],potas[,3],
chlor[,3],globulin[,3],GGT[,3],osmolality[,3],ALP[,3],creatinine[,3],
BUN[,3],rbc[,3],hct[,3],hgb[,3],eos[,3],systolic[,3],diastolic[,3]
#trig[,4], chol[,4], glucose[,4],
#apply(systolic,1,mean,na.rm=TRUE),apply(diastolic,1,mean,na.rm=TRUE)
)
colnames(mmdat) <- c('chimp','sex','BMI','DoB','age','dom','ext','con','agr','neu','opn',
'trig.1','chol.1','glucose.1','mono.1','lymph.1','wbc.1',
'protein.1','albumin.1','calcium,1','phos.1','sodium.1','potas.1',
'chlor.1','globulin.1','GGT.1','osmolality.1','ALP.1','creatinine.1',
'BUN.1','rbc.1','hct.1','hgb.1','eos.1','sys.1','dias.1',
'trig.2','chol.2','glucose.2','mono.2','lymph.2','wbc.2',
'protein.2','albumin.2','calcium,2','phos.2','sodium.2','potas.2',
'chlor.2','globulin.2','GGT.2','osmolality.2','ALP.2','creatinine.2',
'BUN.2','rbc.2','hct.2','hgb.2','eos.2','sys.2','dias.2',
'trig.3','chol.3','glucose.3','mono.3','lymph.3','wbc.3',
'protein.3','albumin.3','calcium,3','phos.3','sodium.3','potas.3',
'chlor.3','globulin.3','GGT.3','osmolality.3','ALP.3','creatinine.3',
'BUN.3','rbc.3','hct.3','hgb.3','eos.3','sys.3','dias.3'
#'trig.4','chol.4','glucose.4',
#'sys','dias'
)
detach(fulldata)
output <- reshape(mmdat,
idvar = "chimp",
#idvar=c(colnames(mmdat)[1:11],'sys','dias'),
varying=colnames(mmdat)[12:86],
v.names=c("trig","chol","glucose","wbc","mono","lymph","protein","albumin","calcium","phos","sodium","potas",
"chlor","globulin","GGT","osmolality","ALP","creatinine","BUN","rbc","hct","hgb","eos","sys","dias"
),
#sep=".",
direction="long")
scoutput <- cbind(output[,1:2],scale(output[,3]),output[4:12],scale(output[,13:37]))
colnames(scoutput)[3] <- 'BMI'
sys is a better predictor here (there's nothing to see with dias)... wonder why (see below)
m_1 <- lmer(sys ~ dom + ext + neu + con + opn + agr + age + BMI + sex + (1 | chimp),
data = scoutput)
# opn: 0.48 (+), agr: 0.001 (-)
vif.mer(m_1)
# interactions?
m1a <- lmer(sys ~ dom + ext + neu + con + agr:opn + age + BMI + sex + (1 | chimp),
data = scoutput)
# ... no, none here
# but wait, what about the direct effects on BMI?
m_1z <- lmer(BMI ~ dom + ext + neu + con + opn + agr + age +  sex + (1 | chimp),
data = scoutput)
relgrad <- with(m_1a@optinfo$derivs,solve(Hessian,gradient))
max(abs(relgrad))
# Nope.
m_2a <- lmer(chol ~ dom + ext + neu + con + opn + agr + age + BMI + sex + (1 | chimp),
data = scoutput)
# dom: 0.00866 (-), ext: 0.022 (+), agr: 0.007 (-)
# cholesterol is diet influenced, but other factors are more important
# again, interactions?
m2a1 <- lmer(chol ~ + dom:agr + dom + ext + neu + con + opn + agr + age + BMI + sex + (1 | chimp),
data = scoutput)
summary(m2a1)
AIC(m_2a,m2a1)
vif.mer(m_2a)
vif.mer(m2a1)
m_2b <- lmer(trig ~ dom + ext + neu + con + opn + agr + age + BMI + sex + (1 | chimp),
data = scoutput) # there's nothing here...
# triglycerides indicate immediate diet
m_2c <- lmer(glucose ~ dom + ext + neu + con + opn + agr + age + BMI + sex + (1 | chimp),
data = scoutput)
# neu: 0.0045 (-), con: 0.011 (+)
# ... some model fit tests
m2c1 <- lmer(glucose ~ dom + ext + neu +
opn + agr + age + BMI + sex + (1 | chimp),
data = scoutput)
m2c2 <- lmer(glucose ~ dom + ext + con +
opn + agr + age + BMI + sex + (1 | chimp),
data = scoutput)
AIC(m_2c,m2c1,m2c2)
# first model is a better fir than both... so there's something legit here
m2c3 <- lmer(glucose ~ dom + ext + con:neu +
opn + agr + age + BMI + sex + (1 | chimp),
data = scoutput)
AIC(m2c3)
# residuals and vif
# resid(m_2c) # probably not needed with vif's
# vif requires mer-utils.R
vif.mer(m_2c)
vif.mer(m2c1)
vif.mer(m2c2)
vif.mer(m2c3)
# hematology - no effect from blood factors
m_2d <- lmer(wbc ~ dom + ext + neu + con + opn + agr + age + BMI + sex + (1 | chimp),
data = scoutput)
m_2e <- lmer(lymph ~ dom + ext + neu + con + opn + agr + age + BMI + sex + (1 | chimp),
data = scoutput)
m_2f <- lmer(mono ~ dom + ext + neu + con + opn + agr + age + BMI + sex + (1 | chimp),
data = scoutput)
m_2g <- lmer(eos ~ dom + ext + neu + con + opn + agr + age + BMI + sex + (1 | chimp),
data = scoutput)
m2h <- lmer(hgb ~ dom + ext + neu + con + opn + agr + age + BMI + sex + (1 | chimp),
data = scoutput)
m2i <- lmer(hct ~ dom + ext + neu + con + opn + agr + age + BMI + sex + (1 | chimp),
data = scoutput)
m2j <- lmer(rbc ~ dom + ext + neu + con + opn + agr + age + BMI + sex + (1 | chimp),
data = scoutput)
# ions
m2k <- lmer(potas ~ dom + ext + neu + con + opn + agr + age + BMI + sex + (1 | chimp),
data = scoutput)
m2l <- lmer(calcium ~ dom + ext + neu + con + opn + agr + age + BMI + sex + (1 | chimp),
data = scoutput)
m2m <- lmer(chlor ~ dom + ext + neu + con + opn + agr + age + BMI + sex + (1 | chimp),
data = scoutput)
m2n <- lmer(sodium ~ dom + ext + neu + con + opn + agr + age + BMI + sex + (1 | chimp),
data = scoutput)
m2o <- lmer(osmolality ~ dom + ext + neu + con + opn + agr + age + BMI + sex + (1 | chimp),
data = scoutput)
m2p <- lmer(phos ~ dom + ext + neu + con + opn + agr + age + BMI + sex + (1 | chimp),
data = scoutput)
#proteins
m2q <- lmer(protein ~ dom + ext + neu + con + opn + agr + age + BMI + sex + (1 | chimp),
data = scoutput)
m2r <- lmer(BUN ~ dom + ext + neu + con + opn + agr + age + BMI + sex + (1 | chimp),
data = scoutput)
m2s <- lmer(albumin ~ dom + ext + neu + con + opn + agr + age + BMI + sex + (1 | chimp),
data = scoutput)
m2t <- lmer(GGT ~ dom + ext + neu + con + opn + agr + age + BMI + sex + (1 | chimp),
data = scoutput)
m2u <- lmer(creatinine ~ dom + ext + neu + con + opn + agr + age + BMI + sex + (1 | chimp),
data = scoutput)
m2v <- lmer(globulin ~ dom + ext + neu + con + opn + agr + age + BMI + sex + (1 | chimp),
data = scoutput)
m2w <- lmer(ALP ~ dom + ext + neu + con + opn + agr + age + BMI + sex + (1 | chimp),
data = scoutput)
# dias works better here... sort of/not really (after scaling)
m_3dias <- lmer(dias ~ trig + chol + wbc + lymph + mono + glucose +
BUN + protein + albumin + calcium + phos + sodium + potas + chlor + globulin + GGT + osmolality +
ALP + creatinine + rbc + hct + hgb + eos +
age + sex + BMI + (1 | chimp),
data = scoutput)
m_3sys <- lmer(sys ~ trig + chol + wbc + lymph + mono + glucose +
#BUN + protein + albumin + calcium + phos + sodium + potas + chlor + globulin + GGT + osmolality +
#ALP + creatinine + rbc + hct + hgb + eos +
age + sex + BMI + (1 | chimp),
data = scoutput)
m_3a <- lmer(sys ~ chol + trig + glucose + age + sex + BMI + (1 | chimp), data = scoutput)
# reverse BP biomarker
m_4a <- lmer(glucose ~ sys + BMI + age + sex + (1|chimp),
data = scoutput)
# useful correlation checks
cor(output$neu,output$dom, use='complete')
AIC(m_2c,m2c1,m2c2,m2c3)
stargazer(m_1a)
install.packages("texreg")
library(texreg)
mmdat <- data.frame(dmdob$chimp,sex,BMI,DoB,age, # to get current age
compare_data$chimp_Dom_CZ,compare_data$chimp_Ext_CZ,compare_data$chimp_Con_CZ,
compare_data$chimp_Agr_CZ,compare_data$chimp_Neu_CZ,compare_data$chimp_Opn_CZ,
trig[,1], chol[,1], glucose[,1],
mono[,1],lymph[,1],wbc[,1],
protein[,1],albumin[,1],calcium[,1],phos[,1],sodium[,1],potas[,1],
chlor[,1],globulin[,1],GGT[,1],osmolality[,1],ALP[,1],creatinine[,1],
BUN[,1],rbc[,1],hct[,1],hgb[,1],eos[,1],systolic[,1],diastolic[,1],
trig[,2], chol[,2], glucose[,2],
mono[,2],lymph[,2],wbc[,2],
protein[,2],albumin[,2],calcium[,2],phos[,2],sodium[,2],potas[,2],
chlor[,2],globulin[,2],GGT[,2],osmolality[,2],ALP[,2],creatinine[,2],
BUN[,2],rbc[,2],hct[,2],hgb[,2],eos[,2],systolic[,2],diastolic[,2],
trig[,3], chol[,3], glucose[,3],
mono[,3],lymph[,3],wbc[,3],
protein[,3],albumin[,3],calcium[,3],phos[,3],sodium[,3],potas[,3],
chlor[,3],globulin[,3],GGT[,3],osmolality[,3],ALP[,3],creatinine[,3],
BUN[,3],rbc[,3],hct[,3],hgb[,3],eos[,3],systolic[,3],diastolic[,3],
#trig[,4], chol[,4], glucose[,4],
depr.z
#apply(systolic,1,mean,na.rm=TRUE),apply(diastolic,1,mean,na.rm=TRUE)
)
attach(fulldata)
mmdat <- data.frame(dmdob$chimp,sex,BMI,DoB,age, # to get current age
compare_data$chimp_Dom_CZ,compare_data$chimp_Ext_CZ,compare_data$chimp_Con_CZ,
compare_data$chimp_Agr_CZ,compare_data$chimp_Neu_CZ,compare_data$chimp_Opn_CZ,
trig[,1], chol[,1], glucose[,1],
mono[,1],lymph[,1],wbc[,1],
protein[,1],albumin[,1],calcium[,1],phos[,1],sodium[,1],potas[,1],
chlor[,1],globulin[,1],GGT[,1],osmolality[,1],ALP[,1],creatinine[,1],
BUN[,1],rbc[,1],hct[,1],hgb[,1],eos[,1],systolic[,1],diastolic[,1],
trig[,2], chol[,2], glucose[,2],
mono[,2],lymph[,2],wbc[,2],
protein[,2],albumin[,2],calcium[,2],phos[,2],sodium[,2],potas[,2],
chlor[,2],globulin[,2],GGT[,2],osmolality[,2],ALP[,2],creatinine[,2],
BUN[,2],rbc[,2],hct[,2],hgb[,2],eos[,2],systolic[,2],diastolic[,2],
trig[,3], chol[,3], glucose[,3],
mono[,3],lymph[,3],wbc[,3],
protein[,3],albumin[,3],calcium[,3],phos[,3],sodium[,3],potas[,3],
chlor[,3],globulin[,3],GGT[,3],osmolality[,3],ALP[,3],creatinine[,3],
BUN[,3],rbc[,3],hct[,3],hgb[,3],eos[,3],systolic[,3],diastolic[,3],
#trig[,4], chol[,4], glucose[,4],
depr.z
#apply(systolic,1,mean,na.rm=TRUE),apply(diastolic,1,mean,na.rm=TRUE)
)
mmdat <- data.frame(dmdob$chimp,sex,BMI,DoB,age, # to get current age
compare_data$chimp_Dom_CZ,compare_data$chimp_Ext_CZ,compare_data$chimp_Con_CZ,
compare_data$chimp_Agr_CZ,compare_data$chimp_Neu_CZ,compare_data$chimp_Opn_CZ,
trig[,1], chol[,1], glucose[,1],
mono[,1],lymph[,1],wbc[,1],
protein[,1],albumin[,1],calcium[,1],phos[,1],sodium[,1],potas[,1],
chlor[,1],globulin[,1],GGT[,1],osmolality[,1],ALP[,1],creatinine[,1],
BUN[,1],rbc[,1],hct[,1],hgb[,1],eos[,1],systolic[,1],diastolic[,1],
trig[,2], chol[,2], glucose[,2],
mono[,2],lymph[,2],wbc[,2],
protein[,2],albumin[,2],calcium[,2],phos[,2],sodium[,2],potas[,2],
chlor[,2],globulin[,2],GGT[,2],osmolality[,2],ALP[,2],creatinine[,2],
BUN[,2],rbc[,2],hct[,2],hgb[,2],eos[,2],systolic[,2],diastolic[,2],
trig[,3], chol[,3], glucose[,3],
mono[,3],lymph[,3],wbc[,3],
protein[,3],albumin[,3],calcium[,3],phos[,3],sodium[,3],potas[,3],
chlor[,3],globulin[,3],GGT[,3],osmolality[,3],ALP[,3],creatinine[,3],
BUN[,3],rbc[,3],hct[,3],hgb[,3],eos[,3],systolic[,3],diastolic[,3],
#trig[,4], chol[,4], glucose[,4],
dmdob$depr.z
#apply(systolic,1,mean,na.rm=TRUE),apply(diastolic,1,mean,na.rm=TRUE)
)
colnames(mmdat) <- c('chimp','sex','BMI','DoB','age','dom','ext','con','agr','neu','opn',
'trig.1','chol.1','glucose.1','mono.1','lymph.1','wbc.1',
'protein.1','albumin.1','calcium,1','phos.1','sodium.1','potas.1',
'chlor.1','globulin.1','GGT.1','osmolality.1','ALP.1','creatinine.1',
'BUN.1','rbc.1','hct.1','hgb.1','eos.1','sys.1','dias.1',
'trig.2','chol.2','glucose.2','mono.2','lymph.2','wbc.2',
'protein.2','albumin.2','calcium,2','phos.2','sodium.2','potas.2',
'chlor.2','globulin.2','GGT.2','osmolality.2','ALP.2','creatinine.2',
'BUN.2','rbc.2','hct.2','hgb.2','eos.2','sys.2','dias.2',
'trig.3','chol.3','glucose.3','mono.3','lymph.3','wbc.3',
'protein.3','albumin.3','calcium,3','phos.3','sodium.3','potas.3',
'chlor.3','globulin.3','GGT.3','osmolality.3','ALP.3','creatinine.3',
'BUN.3','rbc.3','hct.3','hgb.3','eos.3','sys.3','dias.3',
'depressed'
#'trig.4','chol.4','glucose.4',
#'sys','dias'
)
output <- reshape(mmdat,
idvar = "chimp",
#idvar=c(colnames(mmdat)[1:11],'sys','dias'),
varying=colnames(mmdat)[12:86],
v.names=c("trig","chol","glucose","wbc","mono","lymph","protein","albumin","calcium","phos","sodium","potas",
"chlor","globulin","GGT","osmolality","ALP","creatinine","BUN","rbc","hct","hgb","eos","sys","dias"
),
#sep=".",
direction="long")
View(output)
scoutput <- cbind(output[,1:2],scale(output[,3]),output[4:12],scale(output[,13:37]))
colnames(scoutput)[3] <- 'BMI'
m2a2 <- lmer(chol ~ depressed + dom + ext + neu + con + opn + agr + age + BMI + sex + (1 | chimp),
data = scoutput)
summary(m2a2)
m1d <- lmer(chol ~ dom:agr + dom + ext + neu + con + opn + agr + age + BMI + sex + (1 | chimp),
data = scoutput)
summary(m1d)
m1d <- lmer(sys ~ depressed + dom + ext + neu + con + opn + agr + age + BMI + sex + (1 | chimp),
data = scoutput)
summary(m1d)
m_2b1 <- lmer(trig ~ depressed + dom + ext + neu + con + opn + agr + age + BMI + sex + (1 | chimp),
data = scoutput)
summary(m_2b1)
m2c4 <- lmer(glucose ~ depressed + dom + ext + neu + con + opn + agr + age + BMI + sex + (1 | chimp),
data = scoutput)
summary(m2c4)
m2c4 <- lmer(glucose ~ depressed + dom + ext + neu:con + opn + agr + age + BMI + sex + (1 | chimp),
data = scoutput)
summary(m2c4)
summary(m2c3)
AIC(m2c4)
vif.mer(m2c4)
AIC(m_2c,m2c1,m2c2,m2c3)
vif.mer(m2c3,m2c4)
AIC(m2c3,m2c4)
m2c5 <- lmer(glucose ~ depressed + dom + neu:con + opn + agr + age + BMI + sex + (1 | chimp),
data = scoutput)
summary(m2c5)
m1d <- lmer(sys ~ depressed + dom + neu + con + opn + agr + age + BMI + sex + (1 | chimp),
data = scoutput)
summary(m1d)
summary(m2a2)
m2a2 <- lmer(chol ~ depressed + dom + neu + con + opn + agr + age + BMI + sex + (1 | chimp),
data = scoutput)
summary(m2a2)
help(htmlreg)
htmlreg(m_1)
tbl1 = htmlreg(m_1)
print.texregTable(tbl1)
texregTable(tbl1)
summary(m_1)
tbl2c = htmlreg(m_2c,m2c1,m2c2,m2c3)
tbl2c = htmlreg(c(m_2c,m2c1,m2c2,m2c3)
)
texregTable(tbl2c)
print.texregTable(tbl2c)
m2c0 <- lmer(glucose ~ dom + ext + con:neu + con + neu
opn + agr + age + BMI + sex + (1 | chimp),
data = scoutput)
m2c0 <- lmer(glucose ~ dom + ext + con:neu + con + neu +
opn + agr + age + BMI + sex + (1 | chimp),
data = scoutput)
tbl2c = htmlreg(c(m_2c,m2c0,m2c1,m2c2,m2c3))
print.texregTable(tbl2c)
install.packages("texreg")
tbl2a = htmlreg(m_2a)
print.texregTable(tbl2a)
library(texreg)
tbl2a = htmlreg(m_2a)
print.texregTable(tbl2a)
tbl2b = htmlreg(m_2b)
print.texregTable(tbl2b)
tbl2c1 = htmlreg(cm_2c)
print.texregTable(tbl2c1)
tbl2c2 = htmlreg(c(m_2c,m2c1,m2c2))
print.texregTable(tbl2c2)
tbl2c3 = htmlreg(c(m_2c,m2c1,m2c2,m2c0))
print.texregTable(tbl2c3)
print.texregTable(tbl2c1)
tbl2c1 = htmlreg(cm_2c)
print.texregTable(tbl2c1)
tbl2c1 = htmlreg(m_2c)
print.texregTable(tbl2c1)
print.texregTable(tbl2c2)
print.texregTable(tbl2c3)
tbl2c4 = htmlreg(c(m_2c,m2c1,m2c2,m2c0,m2c3))
print.texregTable(tbl2c4)
source('~/.active-rstudio-document')
View(scoutputd)
output <- reshape(mmdat,
idvar = "chimp",
#idvar=c(colnames(mmdat)[1:11],'sys','dias'),
varying=colnames(mmdat)[12:90],
v.names=c("trig","chol","glucose","wbc","mono","lymph","protein","albumin","calcium","phos","sodium","potas",
"chlor","globulin","GGT","osmolality","ALP","creatinine","BUN","rbc","hct","hgb","eos","sys","dias"
),
#sep=".",
direction="long")
output <- reshape(mmdat,
idvar = "chimp",
#idvar=c(colnames(mmdat)[1:11],'sys','dias'),
varying=colnames(mmdat)[12:89],
v.names=c("trig","chol","glucose","wbc","mono","lymph","protein","albumin","calcium","phos","sodium","potas",
"chlor","globulin","GGT","osmolality","ALP","creatinine","BUN","rbc","hct","hgb","eos","sys","dias"
),
#sep=".",
direction="long")
Indometh
library("reshape2", lib.loc="C:/Users/Diapadion/Documents/R/win-library/3.0")
View(mmdat)
mmdat <- data.frame(dmdob$chimp,sex,BMI,DoB,age, # to get current age
compare_data$chimp_Dom_CZ,compare_data$chimp_Ext_CZ,compare_data$chimp_Con_CZ,
compare_data$chimp_Agr_CZ,compare_data$chimp_Neu_CZ,compare_data$chimp_Opn_CZ,
trig[,2], chol[,2], glucose[,2],
mono[,1],lymph[,1],wbc[,1],
protein[,1],albumin[,1],calcium[,1],phos[,1],sodium[,1],potas[,1],
chlor[,1],globulin[,1],GGT[,1],osmolality[,1],ALP[,1],creatinine[,1],
BUN[,1],rbc[,1],hct[,1],hgb[,1],eos[,1],systolic[,1],diastolic[,1],
trig[,3], chol[,3], glucose[,3],
mono[,2],lymph[,2],wbc[,2],
protein[,2],albumin[,2],calcium[,2],phos[,2],sodium[,2],potas[,2],
chlor[,2],globulin[,2],GGT[,2],osmolality[,2],ALP[,2],creatinine[,2],
BUN[,2],rbc[,2],hct[,2],hgb[,2],eos[,2],systolic[,2],diastolic[,2],
trig[,4], chol[,4], glucose[,4],
mono[,3],lymph[,3],wbc[,3],
protein[,3],albumin[,3],calcium[,3],phos[,3],sodium[,3],potas[,3],
chlor[,3],globulin[,3],GGT[,3],osmolality[,3],ALP[,3],creatinine[,3],
BUN[,3],rbc[,3],hct[,3],hgb[,3],eos[,3],systolic[,3],diastolic[,3],
#trig[,4], chol[,4], glucose[,4],
dmdob$depr.z
#apply(systolic,1,mean,na.rm=TRUE),apply(diastolic,1,mean,na.rm=TRUE)
)
colnames(mmdat) <- c('chimp','sex','BMI','DoB','age','dom','ext','con','agr','neu','opn',
'trig.1','chol.1','glucose.1','mono.1','lymph.1','wbc.1',
'protein.1','albumin.1','calcium,1','phos.1','sodium.1','potas.1',
'chlor.1','globulin.1','GGT.1','osmolality.1','ALP.1','creatinine.1',
'BUN.1','rbc.1','hct.1','hgb.1','eos.1','sys.1','dias.1',
'trig.2','chol.2','glucose.2','mono.2','lymph.2','wbc.2',
'protein.2','albumin.2','calcium,2','phos.2','sodium.2','potas.2',
'chlor.2','globulin.2','GGT.2','osmolality.2','ALP.2','creatinine.2',
'BUN.2','rbc.2','hct.2','hgb.2','eos.2','sys.2','dias.2',
'trig.3','chol.3','glucose.3','mono.3','lymph.3','wbc.3',
'protein.3','albumin.3','calcium,3','phos.3','sodium.3','potas.3',
'chlor.3','globulin.3','GGT.3','osmolality.3','ALP.3','creatinine.3',
'BUN.3','rbc.3','hct.3','hgb.3','eos.3','sys.3','dias.3',
#'trig.4','chol.4','glucose.4',
'depressed'
#'sys','dias'
)
output <- reshape(mmdat,
idvar = "chimp",
#idvar=c(colnames(mmdat)[1:11],'sys','dias'),
varying=colnames(mmdat)[12:86],
v.names=c("trig","chol","glucose","wbc","mono","lymph","protein","albumin","calcium","phos","sodium","potas",
"chlor","globulin","GGT","osmolality","ALP","creatinine","BUN","rbc","hct","hgb","eos","sys","dias"
),
#sep=".",
direction="long")
# now scale and center it
scoutputd <- cbind(output[,1:2],scale(output[,3]),output[4:12],scale(output[,13:37]))
colnames(scoutputd)[3] <- 'BMI'
gd1 <- lmer(glucose ~ dom + ext + neu + con + opn + agr + age + BMI + sex + (1 | chimp),
data = scoutputd)
summary(gd1)
gd1_d <- lmer(glucose ~ dom + ext + neu:con + opn + agr + age + BMI + sex + (1 | chimp),
data = scoutputd)
summary(gd1_d)
gd1_c <- lmer(glucose ~ dom + ext + neu+con + neu:con + opn + agr + age + BMI + sex + (1 | chimp),
data = scoutputd)
summary(gd1_c)
View(aggador)
scree(na.omit(scoutputd))
library(psych)
scree(na.omit(scoutputd))
princomp(na.omit(faggad),scores=TRUE)
fa(na.omit(faggad),nfactors = 7,rotate='oblimin')
fa(na.omit(faggad),nfactors = 7,rotate='oblimin')
install.packages("GPArotation")
library("GPArotation", lib.loc="C:/Users/Diapadion/Documents/R/win-library/3.0")
fa(na.omit(faggad),nfactors = 7,rotate='oblimin')
princomp(na.omit(faggad),scores=TRUE)
principal(na.omit(faggad),nfactors = 7,rotate='varimax')
summary(m2r)
summary(m_1)
summary(m_2c)
ranef(m_2c)
load.tsv
getwd()
setwd("C:/Users/s1229179/git-repos/R/blood chemistry/Drew version/")
midusIn <- read.tsv("29282-0001-Data.tsv")
midusIn <- read.table("29282-0001-Data.tsv")
midusIn <- read.table("midus-Data.csv")
almostCertainlyGarbage <- read.table("C:/Users/s1229179/git-repos/R/blood chemistry/Drew version/almostCertainlyGarbage.rda", quote="\"")
View(almostCertainlyGarbage)
load("C:/Users/s1229179/git-repos/R/blood chemistry/Drew version/almostCertainlyGarbage.rda")
View(blood_pressure)
View(almostCertainlyGarbage)
View(da29282.0001)
da29282.0001$B4BCHOL
library(ggplot2)
ggplot(diamonds, aes(x=cut, y=price, fill=cut)) + geom_bar(stat="identity") + facet_wrap(~clarity))
ggplot(diamonds, aes(x=cut, y=price, fill=cut)) + geom_bar(stat="identity") + facet_wrap(~clarity)
da29282.0001$B4ZBLOOD
tail(da29282.0001$B4ZBLOOD=='(3) COMPLETE')
midusIn <- da29282.0001[da29282.0001$B4ZBLOOD=='(3) COMPLETE']
View(midusIn)
midusIn$B4ZBLOOD
midusIn <- da29282.0001[,da29282.0001$B4ZBLOOD=='(3) COMPLETE']
View(midusIn)
midusIn <- da29282.0001[da29282.0001$B4ZBLOOD=='(3) COMPLETE',]
View(midusIn)
midusP1 <- read.table("midus-p1.tsv")
library(Hmisc)
setwd("C:/Users/s1229179/git-repos/R/blood chemistry/Drew version/")
midusP1 <- read.SAScii('04652-0001-Data.txt','04652-0001-Setup.sas')
library(SAScii)
midusP1 <- read.SAScii('04652-0001-Data.txt','04652-0001-Setup.sas')
warnings()
View(midusP1)
tail(midusP1$B1SNEURO,30)
Table(midusP1$B1SNEURO,30)
table(midusP1$B1SNEURO,30)
table(midusP1$B1SNEURO)
sum(table(midusP1$B1SNEURO))
