stat_summary(fun.y=median.quartile,geom='point') +
stat_summary(fun.y=median.line,geom='point') +
geom_segment(aes(x=Sample-0.1, xend=Sample+0.1, y=Value, yend=Value), colour='white')
violbio
table(midus_c$B4BTRIGL)
violbio <- ggplot(vbio, aes(x=Sample, y=Value, group=Sample)) + geom_violin(trim=TRUE, aes(fill = factor(Sample))) +
facet_wrap(~Marker, scales = "free") +
stat_summary(fun.y=median.quartile,geom='point') +
stat_summary(fun.y=median.line,geom='point') +
geom_segment(aes(x=Sample-0.1, xend=Sample+0.1, y=Value, yend=Value), colour='white')
violbio <- ggplot(vbio, aes(x=Sample, y=Value, group=Sample)) + geom_violin(trim=TRUE, aes(fill = factor(Sample))) +
facet_wrap(~Marker, scales = "free") +
stat_summary(fun.y=median.quartile,geom='point') +
stat_summary(fun.y=median.line,geom='point') +
geom_segment(aes(x=Sample-0.1, xend=Sample+0.1, y=Value, yend=Value), colour='white')
violbio
violbio <- ggplot(vbio, aes(x=Sample, y=Value, group=Sample)) + geom_violin(trim=TRUE, aes(fill = factor(Sample))) +
facet_wrap(~Marker, scales = "free_y") +
stat_summary(fun.y=median.quartile,geom='point') +
stat_summary(fun.y=median.line,geom='point') +
geom_segment(aes(x=Sample-0.1, xend=Sample+0.1, y=Value, yend=Value), colour='white')
violbio
violbio <- ggplot(vbio, aes(x=Sample, y=Value, group=Sample)) + geom_violin(trim=TRUE, aes(fill = factor(Sample))) +
stat_summary(fun.y=median.quartile,geom='point') +
stat_summary(fun.y=median.line,geom='point') +
geom_segment(aes(x=Sample-0.1, xend=Sample+0.1, y=Value, yend=Value), colour='white')
violbio
violbio +  facet_wrap(~Marker, scales = "free_y")
violbio
violbio + facet_wrap(~Marker, scales = "free_y")
table(systolic)
table(diastolic)
mean(diastolic)
sd(diastolic)
mean(systolic)
mean(systolic,na.rm)
mean(systolic,na.rm=TRUE)
sd(systolic,na.rm=TRUE)
sd(systolic,na.rm=TRUE)*3.5
sd(diastolic,na.rm=TRUE)*3.5
mean(diastolic,na.rm=TRUE)*3.5
diastolic[diastolic==8]<-NA
table(diastolic)
violbio + facet_wrap(.~Marker, scales = "free_y")
violbio + facet_wrap(Marker~, scales = "free_y")
violbio + facet_wrap(Marker ~ ., scales = "free_y")
violbio <- ggplot(vbio, aes(x=Sample, y=Value, group=Sample)) + geom_violin(trim=TRUE, aes(fill = factor(Sample))) +
stat_summary(fun.y=median.quartile,geom='point') +
stat_summary(fun.y=median.line,geom='point') +
geom_segment(aes(x=Sample-0.1, xend=Sample+0.1, y=Value, yend=Value), colour='white')
violbio
violbio + facet_grid(Marker ~ ., scales = "free_y")
violbio + facet_grid(Marker ~, scales = "free_y")
violbio + facet_grid(. ~ Marker, scales = "free_y")
violbio + facet_wrap(. ~ Marker, scales = "free_y")
violbio + facet_wrap(~ Marker, scales = "free_y")
violbio
violbio + facet_wrap(~ Marker, scales = "free_y")
violbio + facet_wrap(~ Marker, scales = "free_y") + theme_bw()
violbio <- ggplot(vbio, aes(x=Sample, y=Value, group=Sample)) + geom_violin(trim=TRUE, aes(fill = factor(Sample))) +
)
violbio <- ggplot(vbio, aes(x=Sample, y=Value, group=Sample)) + geom_violin(trim=TRUE, aes(fill = factor(Sample)))
violbio
violbio + facet_wrap(~ Marker, scales = "free_y") + theme_bw()
mtcars
head(diamonds)
violtest <- ggplot(diamonds, aes(x=Color, y=Price, group=Color)) +
geom_violin(trim=TRUE, aes(fill = factor(Color)))
violtest
violtest <- ggplot(diamonds, aes(x=color, y=price, group=color)) +
geom_violin(trim=TRUE, aes(fill = factor(color)))
violtest
violtest <- ggplot(diamonds, aes(x=color, y=price, group=color)) +
geom_violin(trim=TRUE, aes(fill = factor(color))) +
facet_wrap(~ cut, scales = "free_y") + theme_bw()
violtest
violtest <- ggplot(diamonds, aes(x=color, y=price, group=color)) +
geom_violin(trim=TRUE, aes(fill = factor(color))) +
facet_wrap(~ clarity, scales = "free_y") + theme_bw()
violtest
violtest <- ggplot(diamonds, aes(x=color, y=depth, group=color)) +
geom_violin(trim=TRUE, aes(fill = factor(color))) +
facet_wrap(~ clarity, scales = "free_y") + theme_bw()
violtest
violtest <- ggplot(diamonds, aes(x=color, y=depth, group=color)) +
geom_box(trim=TRUE, aes(fill = factor(color))) +
facet_wrap(~ clarity, scales = "free_y") + theme_bw()
violtest <- ggplot(diamonds, aes(x=color, y=depth, group=color)) +
geom_errorbar(trim=TRUE, aes(fill = factor(color))) +
facet_wrap(~ clarity, scales = "free_y") + theme_bw()
violtest
violtest <- ggplot(diamonds, aes(x=color, y=depth, group=color)) +
geom_boxplot(trim=TRUE, aes(fill = factor(color))) +
facet_wrap(~ clarity, scales = "free_y") + theme_bw()
violtest
vbpbio <- ggplot(vbio, aes(x=Sample, y=Value, group=Sample)) + geom_boxplot(trim=TRUE, aes(fill = factor(Sample)))
+ stat_summary(fun.y=median.quartile,geom='point') +
stat_summary(fun.y=median.line,geom='point') +
geom_segment(aes(x=Sample-0.1, xend=Sample+0.1, y=Value, yend=Value), colour='white')
vbpbio + facet_wrap(~ Marker, scales = "free_y") + theme_bw()
trig
diastolic
table(output$dias)
table(output$trig)
trig <- cbind(dmdob$triglicerides,dmdob$triglicerides.1,dmdob$triglicerides.2,dmdob$triglicerides.3)
summary(trig)
trig[outliers(trig,3.5)]<-NA
trig[outliers(trig,3.5)]<-NA
systolic <- cbind(systolic.1,systolic.2,systolic.3)
systolic[outliers(systolic,3.5)]<-NA
diastolic <- cbind(diastolic.1,diastolic.2,diastolic.3)
diastolic[outliers(diastolic,3.5)]<-NA
summary(systolic)
summary(diastolic)
diastolic[diastolic==8]<-NA
summary(diastolic)
age <- as.numeric(as.Date('01/01/2000')-DoB)
colnames(mmdat) <- c('chimp','sex','BMI','DoB','age','dom','extra','cons','agree','neuro','open',
'trig.1','chol.1','glucose.1','mono.1','lymph.1','wbc.1',
'protein.1','albumin.1','calcium,1','phos.1','sodium.1','potas.1',
'chlor.1','globulin.1','GGT.1','osmolality.1','ALP.1','creatinine.1',
'BUN.1','rbc.1','hct.1','hgb.1','eos.1','sys.1','dias.1',
'trig.2','chol.2','glucose.2','mono.2','lymph.2','wbc.2',
'protein.2','albumin.2','calcium,2','phos.2','sodium.2','potas.2',
'chlor.2','globulin.2','GGT.2','osmolality.2','ALP.2','creatinine.2',
'BUN.2','rbc.2','hct.2','hgb.2','eos.2','sys.2','dias.2',
'trig.3','chol.3','glucose.3','mono.3','lymph.3','wbc.3',
'protein.3','albumin.3','calcium,3','phos.3','sodium.3','potas.3',
'chlor.3','globulin.3','GGT.3','osmolality.3','ALP.3','creatinine.3',
'BUN.3','rbc.3','hct.3','hgb.3','eos.3','sys.3','dias.3',
'depressed'
#'trig.4','chol.4','glucose.4',
#'sys','dias'
)
meandat <- data.frame(dmdob$chimp,sex,age,DoB, # to get current age
compare_data$chimp_Dom_CZ,compare_data$chimp_Ext_CZ,compare_data$chimp_Opn_CZ,
compare_data$chimp_Con_CZ,compare_data$chimp_Agr_CZ,compare_data$chimp_Neu_CZ,
apply(chol,1,mean,na.rm=TRUE),
apply(creatinine,1,mean,na.rm=TRUE),
apply(trig,1,mean,na.rm=TRUE),
apply(systolic,1,mean,na.rm=TRUE),
apply(diastolic,1,mean,na.rm=TRUE),
apply(ALP,1,mean,na.rm=TRUE),
apply(glucose,1,mean,na.rm=TRUE),
apply(lymph,1,mean,na.rm=TRUE),
apply(mono,1,mean,na.rm=TRUE),
apply(wbc,1,mean,na.rm=TRUE)
)
colnames(meandat) <- c('Chimp','sex','age','DoB','Dominance','Extraversion','Openness',
'Conscientiousness','Agreeableness','Neuroticism','BMI',
'chol','creat','trig','sys','dias',
'ALP','glucose',
'lymph','mono','wbc'
)
meandat <- data.frame(dmdob$chimp,sex,age,DoB, # to get current age
compare_data$chimp_Dom_CZ,compare_data$chimp_Ext_CZ,compare_data$chimp_Opn_CZ,
compare_data$chimp_Con_CZ,compare_data$chimp_Agr_CZ,compare_data$chimp_Neu_CZ,
apply(BMI,1,mean,na.rm=TRUE),
apply(chol,1,mean,na.rm=TRUE),
apply(creatinine,1,mean,na.rm=TRUE),
apply(trig,1,mean,na.rm=TRUE),
apply(systolic,1,mean,na.rm=TRUE),
apply(diastolic,1,mean,na.rm=TRUE),
apply(ALP,1,mean,na.rm=TRUE),
apply(glucose,1,mean,na.rm=TRUE),
apply(lymph,1,mean,na.rm=TRUE),
apply(mono,1,mean,na.rm=TRUE),
apply(wbc,1,mean,na.rm=TRUE)
)
colnames(meandat) <- c('Chimp','sex','age','DoB','Dominance','Extraversion','Openness',
'Conscientiousness','Agreeableness','Neuroticism','BMI',
'chol','creat','trig','sys','dias',
'ALP','glucose',
'lymph','mono','wbc'
)
summary(BMI)
meandat <- data.frame(dmdob$chimp,sex,age,DoB, # to get current age
compare_data$chimp_Dom_CZ,compare_data$chimp_Ext_CZ,compare_data$chimp_Opn_CZ,
compare_data$chimp_Con_CZ,compare_data$chimp_Agr_CZ,compare_data$chimp_Neu_CZ,
BMI,
apply(chol,1,mean,na.rm=TRUE),
apply(creatinine,1,mean,na.rm=TRUE),
apply(trig,1,mean,na.rm=TRUE),
apply(systolic,1,mean,na.rm=TRUE),
apply(diastolic,1,mean,na.rm=TRUE),
apply(ALP,1,mean,na.rm=TRUE),
apply(glucose,1,mean,na.rm=TRUE),
apply(lymph,1,mean,na.rm=TRUE),
apply(mono,1,mean,na.rm=TRUE),
apply(wbc,1,mean,na.rm=TRUE)
)
colnames(meandat) <- c('Chimp','sex','age','DoB','Dominance','Extraversion','Openness',
'Conscientiousness','Agreeableness','Neuroticism','BMI',
'chol','creat','trig','sys','dias',
'ALP','glucose',
'lymph','mono','wbc'
)
output <- reshape(mmdat,
idvar = "chimp",
#idvar=c(colnames(mmdat)[1:11],'sys','dias'),
varying=colnames(mmdat)[12:86],
v.names=c("trig","chol","glucose","wbc","mono","lymph","protein","albumin","calcium","phos","sodium","potas",
"chlor","globulin","GGT","osmolality","ALP","creatinine","BUN","rbc","hct","hgb","eos","sys","dias"
),
#sep=".",
direction="long")
# now scale and center it
scoutput <- cbind(output[,1:2],scale(output[,3]),output[,4],scale(output[,5:12]),
output[,13],scale(output[,14:38]))
colnames(scoutput)[3] <- 'BMI'
vbio <- NULL
vbio <- rbind(
cbind(Sample="Yerkes",Marker="Diastolic BP",Value=output$dias),
cbind(Sample="Yerkes",Marker='Systolic BP',Value=output$sys),
cbind(Sample="Yerkes",Marker='BMI',Value=output$BMI),
cbind(Sample="Yerkes",Marker='Cholesterol',Value=output$chol),
cbind(Sample="Yerkes",Marker='Triglycerides',Value=output$trig),
cbind(Sample="Yerkes",Marker='Creatinine',Value=output$creatinine),
cbind(Sample="MIDUS",Marker='Diastolic BP',Value=midus_c$B4P1GD),
cbind(Sample="MIDUS",Marker='Systolic BP',Value=midus_c$B4P1GS),
cbind(Sample="MIDUS",Marker='BMI',Value=midus_c$B4PBMI),
cbind(Sample="MIDUS",Marker='Cholesterol',Value=midus_c$B4BCHOL),
cbind(Sample="MIDUS",Marker='Triglycerides',Value=midus_c$B4BTRIGL),
cbind(Sample="MIDUS",Marker='Creatinine',Value=midus_c$B4BSCREA),
cbind(Sample="MIDJA",Marker='Diastolic BP',Value=midja_c$J2CBPS23),
cbind(Sample="MIDJA",Marker='Systolic BP',Value=midja_c$J2CBPD23),
cbind(Sample="MIDJA",Marker='BMI',Value=midja_c$J2CBMI),
cbind(Sample="MIDJA",Marker='Cholesterol',Value=midja_c$J2BCHOL),
cbind(Sample="MIDJA",Marker='Triglycerides',Value=midja_c$J2CTRIG),
cbind(Sample="MIDJA",Marker='Creatinine',Value=midja_c$J2BSCREA)
)
vbio<-data.frame(Sample=vbio[,1],Marker=vbio[,2],Value=as.numeric(as.character(vbio[,3])))
vbpbio <- ggplot(vbio, aes(x=Sample, y=Value, group=Sample)) + geom_boxplot(trim=TRUE, aes(fill = factor(Sample)))
+ stat_summary(fun.y=median.quartile,geom='point') +
stat_summary(fun.y=median.line,geom='point') +
geom_segment(aes(x=Sample-0.1, xend=Sample+0.1, y=Value, yend=Value), colour='white')
vbpbio + facet_wrap(~ Marker, scales = "free_y") + theme_bw()
summary(output$dias)
diastolic
head(  apply(diastolic,1,mean,na.rm=TRUE),)
head(  apply(diastolic,1,mean,na.rm=TRUE))
head(  apply(diastolic,1,mean,na.rm=TRUE), 30)
colnames(mmdat)
head(output)
colnames(mmdat)[12:86]
tout <- reshape(data.frame(mmdat$chimp,mmdat$dom,mmdat$dias.1,mmdat$dias.2,mmdat$dias.4),
idvar="chimp",varying=c('dias.1','dias.2','dias.3'),
v.nmaes=c('dias'),
direction='long')
tout <- reshape(data.frame(mmdat$chimp,mmdat$dom,mmdat$dias.1,mmdat$dias.2,mmdat$dias.4),
idvar="chimp",varying=c('dias.1','dias.2','dias.3'),
v.names=c('dias'),
direction='long')
tout <- reshape(data.frame(mmdat$chimp,mmdat$dom,mmdat$dias.1,mmdat$dias.2,mmdat$dias.3),
idvar="chimp",varying=c('dias.1','dias.2','dias.3'),
v.names=c('dias'),
direction='long')
tout <- reshape(data.frame(mmdat$chimp,mmdat$dom,mmdat$dias.1,mmdat$dias.2,mmdat$dias.3),
idvar="chimp",varying=list('dias.1','dias.2','dias.3'),
v.names=c('dias'),
direction='long')
tout <- reshape(data.frame(mmdat$chimp,mmdat$dom,
dias.1=mmdat$dias.1,dias.2=mmdat$dias.2,dias.3=mmdat$dias.3),
idvar="chimp",varying=list('dias.1','dias.2','dias.3'),
v.names=c('dias'),
direction='long')
head(tout)
summary(tout)
install.packages("tidyr")
library(tidyr)
help(tidyr)
library(reshape2)
demo(melt)
demo(reshape2)
demo(melt.data.frame)
output <- melt(mmdat, id.vars = "chimp",
measure.vars=c("trig","chol","glucose","wbc","mono","lymph","protein","albumin","calcium","phos","sodium","potas",
"chlor","globulin","GGT","osmolality","ALP","creatinine","BUN","rbc","hct","hgb","eos","sys","dias",
'Dominance','Extraversion','Openness','Agreeableness','Conscientiousness','Neuroticism',
'age','sex','BMI')
)
output <- melt(mmdat, id.vars = c("chimp",'Dominance','Extraversion','Openness','Agreeableness','Conscientiousness','Neuroticism',
'age','sex','BMI'),
#measure.vars=c("trig","chol","glucose","wbc","mono","lymph","protein","albumin","calcium","phos","sodium","potas",
#           "chlor","globulin","GGT","osmolality","ALP","creatinine","BUN","rbc","hct","hgb","eos","sys","dias"
))
output <- melt(mmdat, id.vars = c("chimp",'Dominance','Extraversion','Openness','Agreeableness','Conscientiousness','Neuroticism',
'age','sex','BMI')
#,measure.vars=c("trig","chol","glucose","wbc","mono","lymph","protein","albumin","calcium","phos","sodium","potas",
#           "chlor","globulin","GGT","osmolality","ALP","creatinine","BUN","rbc","hct","hgb","eos","sys","dias"
))
output <- melt(mmdat, id.vars = c("chimp",'Dominance','Extraversion','Openness','Agreeableness','Conscientiousness','Neuroticism',
'age','sex','BMI')
#,measure.vars=c("trig","chol","glucose","wbc","mono","lymph","protein","albumin","calcium","phos","sodium","potas",
#           "chlor","globulin","GGT","osmolality","ALP","creatinine","BUN","rbc","hct","hgb","eos","sys","dias"
#  )
)
output <- melt(mmdat, id.vars = c("chimp",'dom','ext','neu','agr','opn','con',
'age','sex','BMI')
#,measure.vars=c("trig","chol","glucose","wbc","mono","lymph","protein","albumin","calcium","phos","sodium","potas",
#           "chlor","globulin","GGT","osmolality","ALP","creatinine","BUN","rbc","hct","hgb","eos","sys","dias"
#  )
)
output <- melt(mmdat, id.vars = c("chimp",'dom','extra','neuro','agree','open','cons',
'age','sex','BMI')
#,measure.vars=c("trig","chol","glucose","wbc","mono","lymph","protein","albumin","calcium","phos","sodium","potas",
#           "chlor","globulin","GGT","osmolality","ALP","creatinine","BUN","rbc","hct","hgb","eos","sys","dias"
#  )
)
head(output)
output <- melt(mmdat, id.vars = c("chimp",'dom','extra','neuro','agree','open','cons',
'age','sex','BMI','DoB')
#,measure.vars=c("trig","chol","glucose","wbc","mono","lymph","protein","albumin","calcium","phos","sodium","potas",
#           "chlor","globulin","GGT","osmolality","ALP","creatinine","BUN","rbc","hct","hgb","eos","sys","dias"
#  )
)
head(output)
melt_dat <- melt(mmdat, id.vars = c("chimp",'dom','extra','neuro','agree','open','cons',
'age','sex','BMI','DoB')
#,measure.vars=c("trig","chol","glucose","wbc","mono","lymph","protein","albumin","calcium","phos","sodium","potas",
#           "chlor","globulin","GGT","osmolality","ALP","creatinine","BUN","rbc","hct","hgb","eos","sys","dias"
#  )
)
head(output,20)
output <- reshape(mmdat,
idvar = "chimp",
#idvar=c(colnames(mmdat)[1:11],'sys','dias'),
varying=colnames(mmdat)[12:86],
v.names=c("trig","chol","glucose","wbc","mono","lymph","protein","albumin","calcium","phos","sodium","potas",
"chlor","globulin","GGT","osmolality","ALP","creatinine","BUN","rbc","hct","hgb","eos","sys","dias"
),
sep=".",
direction="long")
head(output)
output <- reshape(mmdat,
idvar = "chimp",
#idvar=c(colnames(mmdat)[1:11],'sys','dias'),
varying=colnames(mmdat)[12:86],
#v.names=c("trig","chol","glucose","wbc","mono","lymph","protein","albumin","calcium","phos","sodium","potas",
#          "chlor","globulin","GGT","osmolality","ALP","creatinine","BUN","rbc","hct","hgb","eos","sys","dias"
#),
sep=".",
direction="long")
View(output)
View(mmdat)
output$trig = rbind(mmdat$trig.1,mmdat$trig.2,mmdat$trig.3)
output$dias = rbind(mmdat$dias.1,mmdat$dias.2,mmdat$dias.3)
output$trig = c(mmdat$trig.1,mmdat$trig.2,mmdat$trig.3)
output$dias = c(mmdat$dias.1,mmdat$dias.2,mmdat$dias.3)
scoutput <- cbind(output[,1:2],scale(output[,3]),output[,4],scale(output[,5:12]),
output[,13],scale(output[,14:38]))
colnames(scoutput)[3] <- 'BMI'
table(output)
table(output$dias)
table(output$trig)
diastolic[diastolic==8]<-NA
mmdat <- data.frame(dmdob$chimp,sex,BMI,DoB,age, # to get current age
compare_data$chimp_Dom_CZ,compare_data$chimp_Ext_CZ,compare_data$chimp_Con_CZ,
compare_data$chimp_Agr_CZ,compare_data$chimp_Neu_CZ,compare_data$chimp_Opn_CZ,
trig[,1], chol[,1], glucose[,1],
mono[,1],lymph[,1],wbc[,1],
protein[,1],albumin[,1],calcium[,1],phos[,1],sodium[,1],potas[,1],
chlor[,1],globulin[,1],GGT[,1],osmolality[,1],ALP[,1],creatinine[,1],
BUN[,1],rbc[,1],hct[,1],hgb[,1],eos[,1],systolic[,1],diastolic[,1],
trig[,2], chol[,2], glucose[,2],
mono[,2],lymph[,2],wbc[,2],
protein[,2],albumin[,2],calcium[,2],phos[,2],sodium[,2],potas[,2],
chlor[,2],globulin[,2],GGT[,2],osmolality[,2],ALP[,2],creatinine[,2],
BUN[,2],rbc[,2],hct[,2],hgb[,2],eos[,2],systolic[,2],diastolic[,2],
trig[,3], chol[,3], glucose[,3],
mono[,3],lymph[,3],wbc[,3],
protein[,3],albumin[,3],calcium[,3],phos[,3],sodium[,3],potas[,3],
chlor[,3],globulin[,3],GGT[,3],osmolality[,3],ALP[,3],creatinine[,3],
BUN[,3],rbc[,3],hct[,3],hgb[,3],eos[,3],systolic[,3],diastolic[,3],
#trig[,4], chol[,4], glucose[,4],
dmdob$depr.z
#apply(systolic,1,mean,na.rm=TRUE),apply(diastolic,1,mean,na.rm=TRUE)
)
colnames(mmdat) <- c('chimp','sex','BMI','DoB','age','dom','extra','cons','agree','neuro','open',
'trig.1','chol.1','glucose.1','mono.1','lymph.1','wbc.1',
'protein.1','albumin.1','calcium,1','phos.1','sodium.1','potas.1',
'chlor.1','globulin.1','GGT.1','osmolality.1','ALP.1','creatinine.1',
'BUN.1','rbc.1','hct.1','hgb.1','eos.1','sys.1','dias.1',
'trig.2','chol.2','glucose.2','mono.2','lymph.2','wbc.2',
'protein.2','albumin.2','calcium,2','phos.2','sodium.2','potas.2',
'chlor.2','globulin.2','GGT.2','osmolality.2','ALP.2','creatinine.2',
'BUN.2','rbc.2','hct.2','hgb.2','eos.2','sys.2','dias.2',
'trig.3','chol.3','glucose.3','mono.3','lymph.3','wbc.3',
'protein.3','albumin.3','calcium,3','phos.3','sodium.3','potas.3',
'chlor.3','globulin.3','GGT.3','osmolality.3','ALP.3','creatinine.3',
'BUN.3','rbc.3','hct.3','hgb.3','eos.3','sys.3','dias.3',
'depressed'
#'trig.4','chol.4','glucose.4',
#'sys','dias'
)
output <- reshape(mmdat,
idvar = "chimp",
#idvar=c(colnames(mmdat)[1:11],'sys','dias'),
varying=colnames(mmdat)[12:86],
#v.names=c("trig","chol","glucose","wbc","mono","lymph","protein","albumin","calcium","phos","sodium","potas",
#          "chlor","globulin","GGT","osmolality","ALP","creatinine","BUN","rbc","hct","hgb","eos","sys","dias"
#),
sep=".",
direction="long")
output <- reshape(mmdat,
idvar = "chimp",
#idvar=c(colnames(mmdat)[1:11],'sys','dias'),
varying=colnames(mmdat)[12:86],
v.names=c("trig","chol","glucose","wbc","mono","lymph","protein","albumin","calcium","phos","sodium","potas",
"chlor","globulin","GGT","osmolality","ALP","creatinine","BUN","rbc","hct","hgb","eos","sys","dias"
),
sep=".",
direction="long")
output$trig = c(mmdat$trig.1,mmdat$trig.2,mmdat$trig.3)
output$dias = c(mmdat$dias.1,mmdat$dias.2,mmdat$dias.3)
table(output$dias)
table(output$trig)
vbio <- NULL
vbio <- rbind(
cbind(Sample="Yerkes",Marker="Diastolic BP",Value=output$dias),
cbind(Sample="Yerkes",Marker='Systolic BP',Value=output$sys),
cbind(Sample="Yerkes",Marker='BMI',Value=output$BMI),
cbind(Sample="Yerkes",Marker='Cholesterol',Value=output$chol),
cbind(Sample="Yerkes",Marker='Triglycerides',Value=output$trig),
cbind(Sample="Yerkes",Marker='Creatinine',Value=output$creatinine),
cbind(Sample="MIDUS",Marker='Diastolic BP',Value=midus_c$B4P1GD),
cbind(Sample="MIDUS",Marker='Systolic BP',Value=midus_c$B4P1GS),
cbind(Sample="MIDUS",Marker='BMI',Value=midus_c$B4PBMI),
cbind(Sample="MIDUS",Marker='Cholesterol',Value=midus_c$B4BCHOL),
cbind(Sample="MIDUS",Marker='Triglycerides',Value=midus_c$B4BTRIGL),
cbind(Sample="MIDUS",Marker='Creatinine',Value=midus_c$B4BSCREA),
cbind(Sample="MIDJA",Marker='Diastolic BP',Value=midja_c$J2CBPS23),
cbind(Sample="MIDJA",Marker='Systolic BP',Value=midja_c$J2CBPD23),
cbind(Sample="MIDJA",Marker='BMI',Value=midja_c$J2CBMI),
cbind(Sample="MIDJA",Marker='Cholesterol',Value=midja_c$J2BCHOL),
cbind(Sample="MIDJA",Marker='Triglycerides',Value=midja_c$J2CTRIG),
cbind(Sample="MIDJA",Marker='Creatinine',Value=midja_c$J2BSCREA)
)
vbio<-data.frame(Sample=vbio[,1],Marker=vbio[,2],Value=as.numeric(as.character(vbio[,3])))
vbpbio <- ggplot(vbio, aes(x=Sample, y=Value, group=Sample)) + geom_boxplot(trim=TRUE, aes(fill = factor(Sample)))
+ stat_summary(fun.y=median.quartile,geom='point') +
stat_summary(fun.y=median.line,geom='point') +
geom_segment(aes(x=Sample-0.1, xend=Sample+0.1, y=Value, yend=Value), colour='white')
vbpbio + facet_wrap(~ Marker, scales = "free_y") + theme_bw()
vbplbio
m1a <- lmer(sys ~ dom + extra + neuro + cons + open + agree + age + BMI + sex + (1 | chimp),
data = scoutput,REML=FALSE)
m2.trig <- lmer(trig ~ dom + extra + neuro + cons + open + agree + age + BMI + sex + (1 | chimp),
data = scoutput,REML=FALSE)
m2.chol <- lmer(chol ~ dom + extra + neuro + cons + open + agree + age + BMI + sex + (1 | chimp),
data = scoutput,REML=FALSE)
m2.creat <- lmer(creatinine ~ dom + extra + neuro + cons + open + agree + age + BMI + sex + (1 | chimp),
data = scoutput,REML=FALSE)
summary(m.trig)
summary(m.chol)
summary(m.creat)
summary(m1a)
Anova(m1a)
library(car)
Anova(m1a)
m1b <- lmer(dias ~ dom + extra + neuro + cons + open + agree + age + BMI + sex + (1 | chimp),
data = scoutput,REML=FALSE)
Anova(m1b)
library(texreg)
sys.tbl = htmlreg(list(m.sys,mj.sys,m1a), custom.model.names=c('Americans','Japanese','Chimpanzees'), ci.force=TRUE)
write(sys.tbl,"sys.html")
trig.tbl = htmlreg(list(m.trig,mj.trig,m2.trig), custom.model.names=c('Americans','Japanese','Chimpanzees'), ci.force=TRUE)
write(trig.tbl,"trig.html")
summary(m2.trig)
Anova(m2.trig)
confint(m2.trig)
getwd()
setwd("C:/Users/s1229179/git-repos/R/blood chemistry/Drew version/")
sys.tbl = htmlreg(list(m.sys,mj.sys,m1a), custom.model.names=c('Americans','Japanese','Chimpanzees'), ci.force=TRUE)
write(sys.tbl,"sys.html")
trig.tbl = htmlreg(list(m.trig,mj.trig,m2.trig), custom.model.names=c('Americans','Japanese','Chimpanzees'), ci.force=TRUE)
write(trig.tbl,"trig.html")
chol.tbl = htmlreg(list(m.chol,mj.chol,m2.chol), custom.model.names=c('Americans','Japanese','Chimpanzees'), ci.force=TRUE)
write(chol.tbl,"chol.html")
creat.tbl = htmlreg(list(m.creat,mj.creat,m2.creat), custom.model.names=c('Americans','Japanese','Chimpanzees'), ci.force=TRUE)
write(creat.tbl,"creat.html")
dim(midja_cs)
dim(midus_cs)
vpers<-data.frame(Sample=character(),Dimension=character(),Score=numeric())
vpers = rbind(
cbind(Sample="Yerkes", Dimension="Dominance", Score=(((output$dom - 1) / 2) + 1)),
cbind(Sample="Yerkes", Dimension="Neuroticism", Score=(((output$neuro - 1) / 2) + 1)),
cbind(Sample="Yerkes", Dimension="Extraversion", Score=(((output$extra - 1) / 2) + 1)),
cbind(Sample="Yerkes", Dimension="Agreeableness", Score=(((output$agree - 1) / 2) + 1)),
cbind(Sample="Yerkes", Dimension="Conscientiousness", Score=(((output$cons - 1) / 2) + 1)),
cbind(Sample="Yerkes", Dimension="Openness", Score=(((output$open - 1) / 2) + 1)),
cbind(Sample="MIDUS", Dimension="Neuroticism", Score=midus_c$B1SNEURO),
cbind(Sample="MIDUS", Dimension="Dominance", Score=midus_c$B1SAGENC),
cbind(Sample="MIDUS", Dimension="Agreeableness", Score=midus_c$B1SAGREE),
cbind(Sample="MIDUS", Dimension="Conscientiousness", Score=midus_c$B1SCONS2),
cbind(Sample="MIDUS", Dimension="Extraversion", Score=midus_c$B1SEXTRA),
cbind(Sample="MIDUS", Dimension="Openness", Score=midus_c$B1SOPEN),
cbind(Sample="MIDJA", Dimension="Agreeableness", Score=midja_c$J1SAGREE),
cbind(Sample="MIDJA", Dimension="Neuroticism", Score=midja_c$J1SNEURO),
cbind(Sample="MIDJA", Dimension="Conscientiousness", Score=midja_c$J1SCONS2),
cbind(Sample="MIDJA", Dimension="Extraversion", Score=midja_c$J1SEXTRA),
cbind(Sample="MIDJA", Dimension="Dominance", Score=midja_c$J1SAGENC),
cbind(Sample="MIDJA", Dimension="Openness", Score=midja_c$J1SOPEN))
vpers<-data.frame(Sample=vpers[,1],Dimension=vpers[,2],Score=as.numeric(as.character(vpers[,3])))
violpers <- ggplot(vpers, aes(x=Sample, y=Score, group=Sample)) + geom_violin(trim=TRUE, aes(fill = factor(Sample))) +
facet_wrap(~Dimension) +
stat_summary(fun.y=median.quartile,geom='point') +
stat_summary(fun.y=median.line,geom='point') +
geom_segment(aes(x=Sample-0.1, xend=Sample+0.1, y=Score, yend=Score), colour='white') + theme_bw()
violpers
vbpbio
vbpbio + facet_wrap(~ Marker, scales = "free_y") + theme_bw()
