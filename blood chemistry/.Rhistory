}
bps <- strsplit(as.character(fulldata$BP.3),"[/]")
if (!is.na(bps)[[i]]){
systolic.3[i] = as.numeric(bps[[i]][1])
diastolic.3[i] = as.numeric(bps[[i]][2])
}
else{
systolic.3[i] = NA
diastolic.3[i] = NA
}
}
systolic <- NULL
diastolic <- NULL
systolic.1 <- NULL
diastolic.1 <- NULL
systolic.2 <- NULL
diastolic.2 <- NULL
systolic.3 <- NULL
diastolic.3 <- NULL
# fucking removing the slashes from systolic diastolic
# putting them in their own vars
bps <- strsplit(as.character(fulldata$BP.1),"[/]")
for (i in 1:dim(fulldata)[1]){
bps <- strsplit(as.character(fulldata$BP.1),"[/]")
if (!is.na(bps)[[i]]){
systolic.1[i] = as.numeric(bps[[i]][1])
diastolic.1[i] = as.numeric(bps[[i]][2])
}
else{
systolic.1[i] = NA
diastolic.1[i] = NA
}
bps <- strsplit(as.character(fulldata$BP.2),"[/]")
if (!is.na(bps)[[i]]){
systolic.2[i] = as.numeric(bps[[i]][1])
diastolic.2[i] = as.numeric(bps[[i]][2])
}
else{
systolic.2[i] = NA
diastolic.2[i] = NA
}
bps <- strsplit(as.character(fulldata$BP.3),"[/]")
if (!is.na(bps)[[i]]){
systolic.3[i] = as.numeric(bps[[i]][1])
diastolic.3[i] = as.numeric(bps[[i]][2])
}
else{
systolic.3[i] = NA
diastolic.3[i] = NA
}
}
systolic <- cbind(systolic.1,systolic.2,systolic.3)
diastolic <- cbind(diastolic.1,diastolic.2,diastolic.3)
source('~/.active-rstudio-document')
search
search()
detach(fulldata)
source('~/.active-rstudio-document')
source('C:/Users/s1229179/Dropbox/R/blood chemistry/Drew version/shapeUp.R')
source('~/.active-rstudio-document')
search()
detach(fulldata)
detach(fulldata)
search()
source('~/.active-rstudio-document')
search()
dmdob$chimp
meandat <- data.frame(dmdob$chimp,dmdob$sex,dmdob$BMI,DoB,(as.Date("2014-04-15")-DoB), # to get current age
compare_data$chimp_Dom_CZ,compare_data$chimp_Ext_CZ,compare_data$chimp_Con_CZ,
compare_data$chimp_Agr_CZ,compare_data$chimp_Neu_CZ,compare_data$chimp_Opn_CZ,
apply(trig,1,mean,na.rm=TRUE),
apply(chol,1,mean,na.rm=TRUE),
apply(lymph,1,mean,na.rm=TRUE),
apply(mono,1,mean,na.rm=TRUE),
apply(wbc,1,mean,na.rm=TRUE),
apply(glucose,1,mean,na.rm=TRUE),
apply(systolic,1,mean,na.rm=TRUE),
apply(diastolic,1,mean,na.rm=TRUE)
)
View(dmdob)
source('~/.active-rstudio-document')
detach()
search()
detach(fulldata)
search()
source('~/.active-rstudio-document')
DoB
length(DoB)
compare_data$chimp_Dom_CZ
compare_data$chimp_Dom_CZ <-
(dmdob$dom.z-dmdob$subm.z-dmdob$depd.z+dmdob$indp.z-dmdob$fear.z+dmdob$decs.z-dmdob$tim.z-dmdob$caut.z+
dmdob$intll.z+dmdob$pers.z+dmdob$buly.z+dmdob$stngy.z+40)/12
compare_data$chimp_Dom_CZ
dmdob[104]
dmdob[,104]
dmdob[104,]
dmdob$sex[104]
dmdob$sex[105]
dmdob$sex[119]
dmdob$Sex.x
fulldata$pers.z
DOBrm
dmdob$pers.z
dmdob$dom.z
dmdob$lazy.z
(-dmdob$sol.z-dmdob$lazy.z+dmdob$actv.z+dmdob$play.z+dmdob$soc.z-dmdob$depr.z+dmdob$frdy.z+dmdob$affc.z+dmdob$imit.z+24)/9
(-dmdob$impl.z-dmdob$defn.z-dmdob$reckl.z-dmdob$errc.z-dmdob$irri.z+dmdob$pred.z-dmdob$aggr.z-dmdob$jeals.z-dmdob$dsor.z+64)/9
(dmdob$symp.z+dmdob$help.z+dmdob$sens.z+dmdob$prot.z+dmdob$gntl.z)/5
(-dmdob$stbl.z+dmdob$exct.z-dmdob$unem.z+16)/3
(dmdob$inqs.z+dmdob$invt.z)/2
(dmdob$dom.z-dmdob$subm.z-dmdob$depd.z+dmdob$indp.z-dmdob$fear.z+dmdob$decs.z-dmdob$tim.z-dmdob$caut.z+
dmdob$intll.z+dmdob$pers.z+dmdob$buly.z+dmdob$stngy.z+40)/12
source('C:/Users/s1229179/Dropbox/R/blood chemistry/Drew version/import.R')
search
search()
detach(fulldata)
source('C:/Users/s1229179/Dropbox/R/blood chemistry/Drew version/import.R')
fulldata$dom.z
source('C:/Users/s1229179/Dropbox/R/blood chemistry/Drew version/shapeUp.R')
compare_data$chimp_Dom_CZ
compare_data$chimp_Ext_CZ
search()
detach(fulldata0)
detach(fulldata)
source('C:/Users/s1229179/Dropbox/R/blood chemistry/Drew version/import.R')
compare_data$chimp_Dom_CZ
search()
source('~/.active-rstudio-document')
attach(meandat)
search()
detach(fulldata)
detach(meandat)
search()
attach(meandat)
BMI
model_null <- lmer(dias ~ DoB + sex + BMI + (1 | chimp), data = output)
model_a <- lmer(dias ~ DoB + sex + BMI + dom + ext + agr + neu + opn + con + (1 | chimp), data = output)
model_aa <- lmer(sys ~ DoB + sex + BMI + dom + ext + agr + neu + opn + con + (1 | chimp), data = output)
model_null <- lmer(dias ~ DoB + sex + BMI + (1 | chimp), data = meandat)
model_a <- lmer(dias ~ DoB + sex + BMI + dom + ext + agr + neu + opn + con + (1 | chimp), data = meandat)
model_aa <- lmer(sys ~ DoB + sex + BMI + dom + ext + agr + neu + opn + con + (1 | chimp), data = meandat)
summary(model_null)
View(meandat)
chimp
model_b <- lmer(chol ~  age + sex + BMI + dom + ext + agr + neu + opn + con + (1 | chimp) + glucose + wbc + mono + lymph, data = meandat)
model_c <- lmer(trig ~ time + age + sex + BMI + dom + ext + agr + neu + opn + con + (1 | chimp) + chol + glucose + wbc + mono + lymph, data = output)
model_e <- lmer(dias ~ DoB + BMI + dom + ext + agr + neu + opn + con + (1 | sex), data = output)
source('~/.active-rstudio-document')
detach(meandat)
search
search()
detach(output)
source('~/.active-rstudio-document')
sex=output$sex
model2 <- lmer (dias ~ age + time + (1 | chimp), data = output)
model4 <- lm(sys ~ age + dom + ext + con + agr + neu + opn)
summary(lm)
summary(model4)
model11 <- lmer(dias ~ age + BMI + sex
+dom+ext+agr+neu+opn+con+BMI
+(1 | chimp)
)
BMI
age
DoB
sex
search()
detach(output)
attach(output)
with(output, {
model11 <- lmer(dias ~ DoB + BMI + sex
+dom+ext+agr+neu+opn+con+BMI
+(1 | chimp)
)})
with(output, {
model11 <- lmer(dias ~ DoB + BMI + sex
+dom+ext+agr+neu+opn+con+BMI
+(1 | chimp)
)
summary(model11)
})
with(output, {
model11 <- lmer(dias ~ DoB + BMI + sex
+dom+ext+agr+neu+opn+con
+(1 | chimp)
)
Anova(model11)
})
with(output, {
model11 <- lmer(sys ~ DoB + BMI + sex
+dom+ext+agr+neu+opn+con
+(1 | chimp)
)
Anova(model11)
})
with(meandat, {
model11 <- lmer(sys ~ DoB + BMI + sex
+dom+ext+agr+neu+opn+con
+(1 | chimp)
)
Anova(model11)
})
View(output)
library(lavaan)
install.packages("lavaan")
library(lavaan)
library(lavaan)
example(cfa)
install.packages("sem")
install.packages("semPlot")
install.packages("lavaan")
install.packages("lavaan")
install.packages("lavaan")
install.packages("lavaan")
source('C:/Users/s1229179/Dropbox/R/blood chemistry/Drew version/uncompressed_make.R')
setwd("C:/Users/s1229179/Dropbox/R/blood chemistry/Drew version")
source('C:/Users/s1229179/Dropbox/R/blood chemistry/Drew version/uncompressed_make.R')
source('C:/Users/s1229179/Dropbox/R/blood chemistry/Drew version/make data.R')
source('C:/Users/s1229179/Dropbox/R/blood chemistry/Drew version/uncompressed_make.R')
View(fullcast)
source('C:/Users/s1229179/Dropbox/R/blood chemistry/Drew version/comp_models.R')
search()
detach(aggador)
View(a)
View(aggador)
library("psych", lib.loc="C:/Users/Public/Documents/R")
princomp(aggador)
principal(aggador)
scree(aggador)
View(aggador)
scree(aggador)
library(psych)
scree(aggador)
head(aggador)
head(aggador[-1:-2,])
head(aggador[,-1:-2])
head(aggador[,-1:-3])
faggad <- aggador[,-1:-3]
scree(faggad)
type(faggad)
class(faggad)
faggad <- as.numeric(aggador[,-1:-3])
faggad <- as.double(aggador[,-1:-3])
faggad <- as.integer(aggador[,-1:-3])
faggad <- as.numeric(aggador[,-1:-3])
faggad <- sapply(aggador[,-1:-3],as.numeric)
head(faggad)
scree(faggad)
principal(aggador)
principal(faggad)
princomp(faggad)
head(tester1[is.nan(tester1)])
head(faggad[is.nan(faggad)])
faggad[is.nan(faggad)] = NA
scree(faggad)
princomp(faggad)
head(faggas)
head(faggad)
princomp(faggad, na.action = na.omit)
princomp(faggad, na.action = 'na.omit'')
''
princomp(faggad, na.action = 'na.omit')
scree(na.omit(faggad))
na.omit(fagged)
na.omit(faggad)
colnames(aggador)
faggad <- sapply(aggador[c(-1,-2,-3,-46,-47,-48)],as.numeric)
faggad[is.nan(faggad)] = NA
scree(na.omit(faggad))
princomp(faggad, na.action = 'na.omit')
princomp(na.omit(faggad))
view(na.omit(faggad))
View(na.omit(faggad))
colnames(aggador)
faggad <- sapply(aggador[c(-1,-2,-3             # subject name, DoB, etc
,-39:-44             # physical characteristics stuff
,-45,-46,-47         # add. height measures & BP
#       ,-48                 # weight
,-49:-51             # group size, MomAge, etc
)],as.numeric)
faggad[52]
faggad[52,]
faggad[,52]
faggad[,51]
faggad[,53]
View(faggad)
faggad[,42]
faggad[,41]
faggad[,43]
colnames(faggad)
faggad[,37]
faggador[,52]
aggador[,52]
aggador[aggador[,52]=Nan]
aggador$chimp[,(aggador[,52]=Nan)]
aggador$chimp[,is.nan(aggador[,52])]
aggador$chimp[is.nan(aggador[,52]),]
aggador$chimp[is.nan(aggador[,52])]
is.nan(aggador[,52])
aggador$chimp[is.nan(aggador[,52])]
aggador$chimp[3]
aggador$Group.1[is.nan(aggador[,52])]
which(is.nan(aggador[,52]) %in% 'TRUE'))
which(is.nan(aggador[,52]) %in% 'TRUE')
aggador$sex[c(15,156,157)]=0
aggador$sex[c(90,107,132,134)]=1
View(aggador)
faggad <- sapply(aggador[c(-1,-2,-3             # subject name, DoB, etc
,-39:-44             # physical characteristics stuff
,-45,-46,-47         # add. height measures & BP
#       ,-48                 # weight
,-49:-51             # group size, MomAge, etc
)],as.numeric)
faggad[is.nan(faggad)] = NA
scree(na.omit(faggad))
View(is.na(faggad))
View(na.omit(faggad))
View(na.omit(faggad))
princomp(na.omit(faggad))
faggad <- sapply(aggador[c(-1,-2,-3             # subject name, DoB, etc
,-39:-44             # physical characteristics stuff
,-45,-46,-47         # add. height measures & BP
,-48                 # weight
,-49:-51             # group size, MomAge, etc
)],as.numeric)
faggad[is.nan(faggad)] = NA
scree(na.omit(faggad))
View(na.omit(faggad))
View(faggad)
faggad <- sapply(aggador[c(-1,-2,-3             # subject name, DoB, etc
,-39:-44             # physical characteristics stuff
,-45,-46,-47         # add. height measures & BP
,-48                 # weight
,-49:-51             # group size, MomAge, etc
)],as.numeric)
View(faggad)
faggad <- sapply(aggador[c(-1,-2,-3 )]            # subject name, DoB, etc
)
faggad <- sapply(aggador[c(-1,-2,-3             # subject name, DoB, etc
,-45,-46,-47         # add. height measures & BP
)],as.numeric)
head(faggad)
View(faggad)
library(psych)
#some sex bs that needs fixing
aggador$Group.1[is.nan(aggador[,52])]
which(is.nan(aggador[,52]) %in% 'TRUE')
aggador$sex[c(15,156,157)]=0
aggador$sex[c(90,107,132,134)]=1
aggador$Group.1
aggador$Group.1[is.nan(aggador[,52])]
View(aggador)
faggad <- sapply(aggador[c(-1,-2,-3             # subject name, DoB, etc
,-39:-44             # physical characteristics stuff
,-45,-46,-47         # add. height measures & BP
,-48                 # weight
,-49:-51             # group size, MomAge, etc
)],as.numeric)
View(faggad)
faggad[is.nan(faggad)] = NA
View(na.omit(faggad))
scree(na.omit(faggad))
princomp(na.omit(faggad))
colnames(aggador)
faggad <- sapply(aggador[c(-1,-2,-3             # subject name, DoB, etc
,-39:-44             # physical characteristics stuff
,-45,-46,-47         # add. height measures & BP
,-48                 # weight
,-49:-51             # group size, MomAge, etc
,-52:-95
)],as.numeric)
faggad[is.nan(faggad)] = NA
scree(na.omit(faggad))
princomp(na.omit(faggad))
princomp(na.omit(faggad),scores=TRUE)
fa(na.omit(faggad),nfactors = 6)
fa(na.omit(faggad),nfactors = 4,rotate='oblimin')
library("paran", lib.loc="C:/Users/Public/Documents/R")
paran(na.omit(faggad))
vss(na.omit(faggad))
fa(na.omit(faggad),nfactors = 7,rotate='oblimin')
colnames(faggad)
source('C:/Users/s1229179/Dropbox/R/blood chemistry/Drew version/path_analysis.R')
colnames(faggad)
fa(na.omit(faggad),nfactors = 7,rotate='oblimin')
scree(na.omit(faggad))
princomp(na.omit(faggad),scores=TRUE)
scree(na.omit(faggad))
vss(na.omit(faggad))
paran(na.omit(faggad))
principal(na.omit(faggad),nfactors = 9,rotate='varimax')
fa(na.omit(faggad),nfactors = 4,rotate='oblimin')
fa(na.omit(faggad),nfactors = 5,rotate='oblimin')
fa(na.omit(faggad),nfactors = 7,rotate='oblimin')
fa(na.omit(faggad),nfactors = 7,rotate='oblimin')
library(psych)
fa(na.omit(faggad),nfactors = 7,rotate='oblimin')
fa(na.omit(faggad),nfactors = 5,rotate='oblimin')
principal(na.omit(faggad),nfactors = 7,rotate='varimax')
library("lme4", lib.loc="C:/Users/Public/Documents/R")
model_c <- lmer(trig ~ time + age + sex + BMI + dom + ext + agr + neu + opn + con + (1 | chimp) + chol + glucose + wbc + mono + lymph, data = output)
summary(model_c)
model_c <- lmer(trig ~ dom + ext + neu + con + opn + agr + age + BMI + (1 | sex), data = meandat)
summary(model_c)
confint(model_c)
search
search()
model_b <- lmer(chol ~ dom + ext + neu + con + opn + agr + age + BMI + (1 | sex), data = meandat)
model_b <- lmer(chol ~ dom + ext + neu + con + opn + agr + age + BMI + (1 | chimp), data = meandat)
dim(chimp)
attach(meandat)
dim(chimp)
length(chimp)
length(chol)
length(trig)
model_b <- lmer(chol ~ dom + ext + neu + con + opn + agr + age + BMI + (1 | chimp), data = meandat)
model_c <- lmer(trig ~ time + age + sex + BMI + dom + ext + agr + neu + opn + con + (1 | chimp) + chol + glucose + wbc + mono + lymph, data = output)
model_b <- lmer(chol ~ time + dom + ext + neu + con + opn + agr + age + BMI + (1 | chimp), data = meandat)
model_b <- lmer(chol ~ dom + ext + neu + con + opn + agr + age + BMI + sex + (1 | chimp), data = meandat)
model_c <- lmer(trig ~ age + sex + BMI + dom + ext + agr + neu + opn + con + (1 | chimp) + chol + glucose + wbc + mono + lymph, data = output)
model_c <- lmer(trig ~ age + sex + BMI + dom + ext + agr + neu + opn + con + (1 | chimp) + chol + glucose + wbc + mono, data = output)
model_b <- lmer(chol ~ dom + ext + neu + con + opn + agr + age + BMI + sex + (1 | chimp),
data = output)
summary(model_b)
model_c <- lmer(trig ~ dom + ext + neu + con + opn + agr + age + BMI + (1 | chimp), data = output)
#data = meandat)
summary(model_c)
model_c <- lmer(trig ~ time + age + sex + BMI + dom + ext + agr + neu + opn + con + (1 | chimp) + chol + glucose + wbc + mono + lymph, data = output)
summary(model_c)
View(output)
model_c <- lmer(trig ~ age + sex + BMI + dom + ext + agr + neu + opn + con + (1 | chimp) + chol + glucose + wbc + mono + lymph, data = output)
summary(model_c)
library(car)
Anova(model_c)
model_c <- lmer(trig ~ dom + ext + neu + con + opn + agr + age + BMI + sex + (1 | chimp), data = output)
#data = meandat)
summary(model_c)
model_c(trig ~ dom + ext + neu + con + opn + agr + age + (1 | chimp), data = output)
model_c <- lmer(trig ~ dom + ext + neu + con + opn + agr + age + (1 | chimp), data = output)
summary(model_c)
model_c <- lmer(trig ~ dom + ext + neu + con + opn + agr + (1 | chimp), data = output)
summary(model_c)
model_e <- lmer(lymph ~ dom + ext + neu + con + opn + agr + age + BMI + sex + (1 | chimp), data = output)
model_d <- lmer(glucose ~ dom + ext + neu + con + opn + agr + age + BMI + sex + (1 | chimp), data = output)
summary(model_d)
summary(model_e)
model_c <- lmer(trig ~ dom + ext + neu + con + opn + agr + age + BMI + (1 | sex) + (1 | chimp), data = output)
summary(model_c)
model_c <- lmer(trig ~ dom + ext + neu + con + opn + agr + age + BMI + (1 | sex), data = output)
summary(model_c)
model_c <- lmer(trig ~ dom + ext + neu + con + opn + agr + age + BMI, data = output)
search()
detach(meandat)
search()
model_c <- lmer(trig ~ dom + ext + neu + con + opn + agr + age + BMI + sex + (1 | chimp), data = output)
summary(model_c)
attach(output)
model_c <- lmer(trig ~ dom + ext + neu + con + opn + agr + age + BMI + sex + (1 | chimp), data = output)
summary(model_c)
model_b <- lmer(chol ~  age + sex + BMI + dom + ext + agr + neu + opn + con + (1 | chimp) + glucose + wbc + mono + lymph, data = meandat)
search()
detach(output)
model_fu <- lmer(trig ~ dom + ext + neu + con + opn + agr + age + BMI + sex + (1 | chimp), data = meandat)
model_fu <- lmer(trig ~ dom + ext + neu + con + opn + agr + age + BMI + sex (1 | time), data = meandat)
search()
model_fu <- lmer(trig ~ dom + ext + neu + con + opn + agr + age + BMI + sex + (1 | time), data = meandat)
model_fu <- lmer(trig ~ dom + ext + neu + con + opn + agr + age + BMI + sex + (1 | chol), data = meandat)
summary(model
_fu)
summary(model_fu)
confint(model_fu)
model_fu <- lmer(trig ~ dom + ext + neu + con + opn + agr + age + BMI + (1 | sex), data = meandat)
summary(model_fu)
confint(model_fu)
model_a <- lmer(dias ~ DoB + sex + BMI + dom + ext + agr + neu + opn + con + (1 | chimp), data = meandat)
model_a <- lmer(dias ~ age + sex + BMI + dom + ext + agr + neu + opn + con + (1 | chimp), data = output)
summary(model_a)
model_null <- lmer(dias ~ age + sex + BMI + (1 | chimp), data = meandat)
search()
with(meandat, {
model11 <- lmer(sys ~ DoB + BMI + sex
+dom+ext+agr+neu+opn+con
+(1 | chimp)
)
Anova(model11)
})
meandat <- data.frame(dmdob$chimp,dmdob$sex,dmdob$BMI,DoB,(as.Date("2014-04-15")-DoB), # to get current age
compare_data$chimp_Dom_CZ,compare_data$chimp_Ext_CZ,compare_data$chimp_Con_CZ,
compare_data$chimp_Agr_CZ,compare_data$chimp_Neu_CZ,compare_data$chimp_Opn_CZ,
apply(trig,1,mean,na.rm=TRUE),
apply(chol,1,mean,na.rm=TRUE),
apply(lymph,1,mean,na.rm=TRUE),
apply(mono,1,mean,na.rm=TRUE),
apply(wbc,1,mean,na.rm=TRUE),
apply(glucose,1,mean,na.rm=TRUE),
apply(systolic,1,mean,na.rm=TRUE),
apply(diastolic,1,mean,na.rm=TRUE)
)
colnames(meandat) <- c('chimp','sex','BMI','DoB','age','dom','ext','con','agr','neu','opn',
'trig','chol','lymph','mono','wbc','glucose',
'sys','dias')
with(meandat, {
model11 <- lmer(sys ~ DoB + BMI + sex
+dom+ext+agr+neu+opn+con
+(1 | chimp)
)
Anova(model11)
})
3.96+1.10*1.96
3.96-1.10*1.96
-7.76+1.91*1.96
-7.76-1.91*1.96
