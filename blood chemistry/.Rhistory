open=s(B1SOPEN),agree=s(B1SAGREE),cons=s(B1SCONS2),
neuro=s(B1SNEURO),extra=s(B1SEXTRA),
dom=s(B1SAGENC),
chol=s(B4BCHOL),trig=s(B4BTRIGL),creat=s(B4BSCREA),
alp=s(B4BSBAP),glucose=s(B4BGLUC),BMI=s(B4PBMI),
sys=s(B4P1GS),dias=s(B4P1GD)))
View(midus_cs)
source('~/.active-rstudio-document')
search()
summary(m.chol)
summary(m.sys)
summary(m.trig)
m1a <- lmer(sys ~ dom + extra + neuro + cons + open + agree + age + BMI + sex + (1 | chimp),
data = scoutput,REML=FALSE)
summary(m1a)
setwd("C:/Users/s1229179/git-repos/R/blood chemistry/Drew version/")
midja <- readSAScii('30822-0001-Data.txt','30822-0001-Setup.sas')
library(SAScii)
midja <- readSAScii('30822-0001-Data.txt','30822-0001-Setup.sas')
midja <- read.SAScii('30822-0001-Data.txt','30822-0001-Setup.sas')
midjaBio <- read.SAScii('34969-0001-Data.txt','34969-0001-Setup.sas')
grep(colnames(midjaBio),'BLOOD')
grep('BLOOD',colnames(midjaBio))
View(midjaBio)
View(midja)
midjaByBio <- midja[midja$MIDJA_IDS %in% midjaBio$MIDJA_IDS,]
midjaByBio <- midjaByBio[match(midjaBio$MIDJA_IDS,midjaByBio$MIDJA_IDS),]
View(midjaByBio)
View(midjaBio)
midja_c <- cbind(midjaByBio,midjaBio)
write.csv(midja_c, file='comboMIDJApersBio.csv',sep=','))
write.csv(midja_c, file='comboMIDJApersBio.csv',sep=',')
View(midja_c)
colnames(midja_c)
midja_c$J2cBMI
midja_c$J2CBMI
rm(midja,midjaBio,midjaByBio)
midja_c$J1SQ2AGE
summary(m.creat)
attach(midja_c)
j1sq2age
table(J1sq2age)
table(J1SQ2AGE
)
J1SQ1
J1SAGENC
J1SEXTRA
J1SCONS2
J1SOPEN
J1SAGREE
J1SNEURO
J1SCBMI
J1CBMI
J2CBMI
J2BCHOL
J2BSCREA
J2BSCREA[45]
J2CTRIG
SD(J2CTRIG)
sd(J2CTRIG)
mean(J2CTRIG)
145+3*113
detach(midja_c)
midja_cs <- with(midja_c,data.frame(MIDJA_IDS, sex=J1SQ1, age=s(J1SQ2AGE),
dom=s(J1SAGENC),extra=s(J1SEXTRA),open=s(J1SOPEN),
cons=s(J1SCONS2),agree=s(J1SAGREE),neuro=s(J1SNEURO),
BMI=s(J2CBMI),chol=s(J2BCHOL),creatinine=s(J2BSCREA),trig=s(J2CTRIG),
sys=s(J2CBPS23),dias=s(J2CBPD23)))
mj.sys <- lm(sys ~ age + sex + BMI
+ dom + open + agree + cons + neuro + extra, data = midja_cs)
summary(mj.sys)
mj.chol <- lm(chol ~ age + sex + BMI
+ dom + open + agree + cons + neuro + extra, data = midja_cs)
mj.trig <- lm(trig ~ age + sex + BMI
+ dom + open + agree + cons + neuro + extra, data = midja_cs)
summary(mj.chol)
summary(mj.trig)
mj.creat <- lm(creat ~ age + sex + BMI
+ dom + open + agree + cons + neuro + extra, data = midja_cs)
mj.creat <- lm(creatinine ~ age + sex + BMI
+ dom + open + agree + cons + neuro + extra, data = midja_cs)
summary(mj.creat)
midja_cs <- with(midja_c,data.frame(MIDJA_IDS, sex=J1SQ1, age=s(J1SQ2AGE),
dom=s(J1SAGENC),extra=s(J1SEXTRA),open=s(J1SOPEN),
cons=s(J1SCONS2),agree=s(J1SAGREE),neuro=s(J1SNEURO),
BMI=s(J2CBMI),chol=s(J2BCHOL),creatinine=s(J2BSCREA),trig=s(J2CTRIG),
sys=s(J2CBPS23),dias=s(J2CBPD23)
tokyo_ch=s(J2CTCHOL)   # but also
))
midja_cs <- with(midja_c,data.frame(MIDJA_IDS, sex=J1SQ1, age=s(J1SQ2AGE),
dom=s(J1SAGENC),extra=s(J1SEXTRA),open=s(J1SOPEN),
cons=s(J1SCONS2),agree=s(J1SAGREE),neuro=s(J1SNEURO),
BMI=s(J2CBMI),chol=s(J2BCHOL),creatinine=s(J2BSCREA),trig=s(J2CTRIG),
sys=s(J2CBPS23),dias=s(J2CBPD23),
tokyo_ch=s(J2CTCHOL)   # but also
))
mj.to_chol <- lm(tokyo_ch ~ age + sex + BMI
+ dom + open + agree + cons + neuro + extra, data = midja_cs)
summary(chol)
summary(cmj.chol)
summary(mj.chol)
summary(mj.to_chol)
hist(midja_cs_$chol)
hist(midja_cs$chol)
hist(midja_cs$tokyo_ch)
cor(midja_cs$chol,midja_cs$tokyo_ch)
m2.trig <- lmer(trig ~ dom + extra + neuro + cons + open + agree + age + BMI + sex + (1 | chimp),
data = scoutput,REML=FALSE)
summary(m2.trig)
table(midja_cs$chol)
outliers(midja_cs$chol)
outliers(midja_cs$tokyo_ch)
getwd()
trig.tbl = htmlreg(list(m.trig,mj.trig,m2.trig),ci.force=TRUE)
write(trig.tbl,"trig.html")
trig.tbl = htmlreg(list(m.trig,mj.trig,m2.trig), custom.model.names=c('Americans','Japanese','Chimpanzees'), ci.force=TRUE)
write(trig.tbl,"trig.html")
sys.tbl = htmlreg(list(m.sys,mj.sys,m1a), custom.model.names=c('Americans','Japanese','Chimpanzees'), ci.force=TRUE)
write(sys.tbl,"sys.html")
m2.chol <- lmer(chol ~ dom + extra + neuro + cons + open + agree + age + BMI + sex + (1 | chimp),
data = scoutput,REML=FALSE)
m2.creat <- lmer(creat ~ dom + extra + neuro + cons + open + agree + age + BMI + sex + (1 | chimp),
data = scoutput,REML=FALSE)
m2.creat <- lmer(creatinine ~ dom + extra + neuro + cons + open + agree + age + BMI + sex + (1 | chimp),
data = scoutput,REML=FALSE)
chol.tbl = htmlreg(list(m.chol,mj.chol,m2.chol), custom.model.names=c('Americans','Japanese','Chimpanzees'), ci.force=TRUE)
write(chol.tbl,"chol.html")
creat.tbl = htmlreg(list(m.creat,mj.creat,m2.creat), custom.model.names=c('Americans','Japanese','Chimpanzees'), ci.force=TRUE)
write(creat.tbl,"creat.html")
expand.grid(2,2)
expand.grid(2,3)
expand.grid(2,3),5
expand.grid(2,3,5)
expand.grid(list(2,3,5),list(8,8,8,8)
)
mj.sys <- lm(sys ~ age + sex + BMI
+ dom + open + agree + cons + neuro + extra, data = midja_cs)
mj.chol <- lm(chol ~ age + sex + BMI
+ dom + open + agree + cons + neuro + extra, data = midja_cs)
mj.to_chol <- lm(tokyo_ch ~ age + sex + BMI
+ dom + open + agree + cons + neuro + extra, data = midja_cs)
mj.trig <- lm(trig ~ age + sex + BMI
+ dom + open + agree + cons + neuro + extra, data = midja_cs)
mj.creat <- lm(creat ~ age + sex + BMI
+ dom + open + agree + cons + neuro + extra, data = midja_cs)
midja_cs <- with(midja_c,data.frame(MIDJA_IDS, sex=J1SQ1, age=s(J1SQ2AGE),
Dominance=s(J1SAGENC),Extraversion=s(J1SEXTRA),Openness=s(J1SOPEN),
Conscientiousness=s(J1SCONS2),Agreeableness=s(J1SAGREE),Neuroticism=s(J1SNEURO),
BMI=s(J2CBMI),chol=s(J2BCHOL),creat=s(J2BSCREA),trig=s(J2CTRIG),
sys=s(J2CBPS23),dias=s(J2CBPD23),
tokyo_ch=s(J2CTCHOL)   # but also
))
mj.sys <- lm(sys ~ age + sex + BMI
+ dom + open + agree + cons + neuro + extra, data = midja_cs)
mj.chol <- lm(chol ~ age + sex + BMI
+ dom + open + agree + cons + neuro + extra, data = midja_cs)
mj.to_chol <- lm(tokyo_ch ~ age + sex + BMI
+ dom + open + agree + cons + neuro + extra, data = midja_cs)
mj.trig <- lm(trig ~ age + sex + BMI
+ dom + open + agree + cons + neuro + extra, data = midja_cs)
mj.creat <- lm(creat ~ age + sex + BMI
+ dom + open + agree + cons + neuro + extra, data = midja_cs)
summary(mj.chol)
sys.tbl = htmlreg(list(m.sys,mj.sys,m1a), custom.model.names=c('Americans','Japanese','Chimpanzees'), ci.force=TRUE)
write(sys.tbl,"sys.html")
trig.tbl = htmlreg(list(m.trig,mj.trig,m2.trig), custom.model.names=c('Americans','Japanese','Chimpanzees'), ci.force=TRUE)
write(trig.tbl,"trig.html")
chol.tbl = htmlreg(list(m.chol,mj.chol,m2.chol), custom.model.names=c('Americans','Japanese','Chimpanzees'), ci.force=TRUE)
write(chol.tbl,"chol.html")
creat.tbl = htmlreg(list(m.creat,mj.creat,m2.creat), custom.model.names=c('Americans','Japanese','Chimpanzees'), ci.force=TRUE)
write(creat.tbl,"creat.html")
library(texreg)
sys.tbl = htmlreg(list(m.sys,mj.sys,m1a), custom.model.names=c('Americans','Japanese','Chimpanzees'), ci.force=TRUE)
write(sys.tbl,"sys.html")
trig.tbl = htmlreg(list(m.trig,mj.trig,m2.trig), custom.model.names=c('Americans','Japanese','Chimpanzees'), ci.force=TRUE)
write(trig.tbl,"trig.html")
chol.tbl = htmlreg(list(m.chol,mj.chol,m2.chol), custom.model.names=c('Americans','Japanese','Chimpanzees'), ci.force=TRUE)
write(chol.tbl,"chol.html")
creat.tbl = htmlreg(list(m.creat,mj.creat,m2.creat), custom.model.names=c('Americans','Japanese','Chimpanzees'), ci.force=TRUE)
write(creat.tbl,"creat.html")
cchol.preds = confint(m2.chol)
head(cchol.preds)
cchol.d.preds = predict(m2.chol,scoutput[,6:11]
#expand.grid(scoutput[,6:11],scoutput$age,scoutput$BMI,scoutput$sex)) # BE CAREFUL
#data.frame(scoutput[,6:11],scoutput$age,scoutput$BMI,scoutput$sex)
)
cchol.d.preds = predict(m2.chol,scoutput[,6:10])
cchol.d.preds = predict(m2.chol,scoutput[,6:12])
cchol.d.preds = predict(m2.chol,scoutput[,6:9])
cchol.d.preds = predict(m2.chol,scoutput[,6:12])
colnames(scoutput)
cchol.d.preds = predict(m2.chol,scoutput[,6:11])
cchol.d.preds = predict(m2.chol,
#scoutput[,6:11])
#expand.grid(scoutput[,6:11],scoutput$age,scoutput$BMI,scoutput$sex)) # BE CAREFUL
scoutput[,6:11],scoutput$age,scoutput$BMI,scoutput$sex)
)
cchol.d.preds = predict(m2.chol,
#scoutput[,6:11])
#expand.grid(scoutput[,6:11],scoutput$age,scoutput$BMI,scoutput$sex)) # BE CAREFUL
scoutput[,6:11],scoutput$age,scoutput$BMI,scoutput$sex
)
cchol.d.preds = predict(m2.chol,
#scoutput[,6:11])
#expand.grid(scoutput[,6:11],scoutput$age,scoutput$BMI,scoutput$sex)) # BE CAREFUL
data.frame(scoutput[,6:11],scoutput$age,scoutput$BMI,scoutput$sex)
)
dim(scoutput)
cForPreds <-   data.frame(scoutput[,6:11],scoutput$age,scoutput$BMI,scoutput$sex)
dim(cForPreds)
cForPreds <-   data.frame(scoutput[,6:11],scoutput$age,scoutput$BMI,scoutput$sex)
cchol.d.preds = predict(m2.chol,
#scoutput[,6:11])
#expand.grid(scoutput[,6:11],scoutput$age,scoutput$BMI,scoutput$sex)) # BE CAREFUL
newdata=cForPreds
)
cchol.d.preds = predict(m2.chol
#scoutput[,6:11])
#expand.grid(scoutput[,6:11],scoutput$age,scoutput$BMI,scoutput$sex)) # BE CAREFUL
#, newdata=cForPreds
)
head(cchol.d.preds)
plot(cchol.d.preds)
cForPreds = data.frame(Dominance=scoutput$dom)
cchol.d.preds = predict(m2.chol
#scoutput[,6:11])
#expand.grid(scoutput[,6:11],scoutput$age,scoutput$BMI,scoutput$sex)) # BE CAREFUL
, newdata=cForPreds
)
cForPreds = data.frame(dom=scoutput$dom)
cchol.d.preds = predict(m2.chol
#scoutput[,6:11])
#expand.grid(scoutput[,6:11],scoutput$age,scoutput$BMI,scoutput$sex)) # BE CAREFUL
, newdata=cForPreds
)
cForPreds <-  data.frame(scoutput[,6:11]
#,scoutput$age,scoutput$BMI,scoutput$sex
)
cchol.d.preds = predict(m2.chol
#scoutput[,6:11])
#expand.grid(scoutput[,6:11],scoutput$age,scoutput$BMI,scoutput$sex)) # BE CAREFUL
, newdata=cForPreds
)
cchol.d.preds = predict(m2.chol
#scoutput[,6:11])
#expand.grid(scoutput[,6:11],scoutput$age,scoutput$BMI,scoutput$sex)) # BE CAREFUL
#                    , newdata=cForPreds
)
plot(cchol.d.preds)
plot(cchol.d.preds,dom)
plot(cchol.d.preds,scoutput$dom)
summary(cchol.d.preds)
dim(cchol.d.preds)
length(cchol.d.preds)
length(scoutput$dom)
length(mmdat$dom)
summary(meandat)
install.packages("mice")
dim(meandat)
library(mice)
imp_mean = mice(meandat)
View(meandat)
View(mmdat)
View(dmdob)
colnames(dmdob)
dmdob$sex
dmdob$Sex.x
sex = dmdob$Sex.x
BMI = dmdob$BMI
meandat <- data.frame(dmdob$chimp,sex,dmdob$BMI,DoB,age, # to get current age
compare_data$chimp_Dom_CZ,compare_data$chimp_Ext_CZ,compare_data$chimp_Con_CZ,
compare_data$chimp_Agr_CZ,compare_data$chimp_Neu_CZ,compare_data$chimp_Opn_CZ,
apply(trig,1,mean,na.rm=TRUE),
apply(chol,1,mean,na.rm=TRUE),
apply(lymph,1,mean,na.rm=TRUE),
apply(mono,1,mean,na.rm=TRUE),
apply(wbc,1,mean,na.rm=TRUE),
apply(glucose,1,mean,na.rm=TRUE),
apply(ALP,1,mean,na.rm=TRUE),
apply(creatinine,1,mean,na.rm=TRUE),
apply(systolic,1,mean,na.rm=TRUE),
apply(diastolic,1,mean,na.rm=TRUE)
)
View(meandat)
colnames(meandat) <- c('chimp','sex','BMI','DoB','age','dom','extra','cons','agree','neuro','open',
'trig','chol','lymph','mono','wbc','glucose',
'ALP','creatinine',
'sys','dias')
imp_mean = mice(meandat)
imp_mean = mice(meandat[,-4])
imp_mean = mice(meandat[,c(-1,-4)])
install.packages("Amelia")
library("Amelia", lib.loc="C:/Users/Diapadion/Documents/R/win-library/3.0")
imp_mean = Amelia(meandat[,c(-4)])
imp_mean = amelia(meandat[,c(-4)])
imp_mean = amelia(meandat[,c(-4)]idvars="chimp")
imp_mean = amelia(meandat[,c(-4)],idvars="chimp")
View(meandat)
imp_mean
imp_mean$imputations$imp1
imp_mean$imputations$imp5
imp_mean = amelia(meandat[,c(-4)],idvars="chimp",m=10)
imp_mean$overvalues
cor(imp_mean$imputations)
cor(imp_mean$imputations[])
cor(imp_mean$imputations$imp1,imp_mean$imputations$imp2)
cor(as.numeric(imp_mean$imputations$imp1),as.numeric(imp_mean$imputations$imp2))
midja_cs
simp_mean=apply(imp_mean$imputations$imp7, c(2), scale)
head(imp_mean$imputations$imp7)
simp_mean=apply(imp_mean$imputations$imp7[,3:20], c(2), scale)
simp_mean=cbind(simp_mean[,1:2],apply(imp_mean$imputations$imp7[,3:20], c(2), scale))
colnames(midus_cs[,1:15])
colnames(midus_cs
)
colnanes(vmregs)
colnames(vmregs)
vmregs <- melt(midus_cs[,1:15], id.vars=c('M2ID','sex','age','chol','creat','trig','BMI','sys','dias'))
vmregs$Sample = 'MIDUS'
library(reshape2)
vmregs <- melt(midus_cs[,1:15], id.vars=c('M2ID','sex','age','chol','creat','trig','BMI','sys','dias'))
source('~/GitHub/R/blood chemistry/Drew version/midusRegs.R')
source('~/GitHub/R/blood chemistry/Drew version/midusRegs.R')
source('~/GitHub/R/blood chemistry/Drew version/midjaRegs.R')
colname(midus_cs)
colnames(midus_cs)
vmregs <- melt(midus_cs[,1:15], id.vars=c('M2ID','sex','age','chol','creat','trig','BMI','sys','dias'))
vmregs$Sample = 'MIDUS'
colnames(vmregs)
colnames(simp_mean)
simp_mean=cbind(imp_mean[,1:2],apply(imp_mean$imputations$imp7[,3:20], c(2), scale))
simp_mean=cbind(imp_mean$imputations$imp7[,1:2],apply(imp_mean$imputations$imp7[,3:20], c(2), scale))
colnames(simp_mean)
meandat <- data.frame(dmdob$chimp,sex,age,DoB, # to get current age
compare_data$chimp_Dom_CZ,compare_data$chimp_Ext_CZ,compare_data$chimp_Opn_CZ,
compare_data$chimp_Con_CZ,compare_data$chimp_Agr_CZ,compare_data$chimp_Neu_CZ,
dmdob$BMI,
apply(chol,1,mean,na.rm=TRUE),
apply(creatinine,1,mean,na.rm=TRUE),
apply(trig,1,mean,na.rm=TRUE),
apply(systolic,1,mean,na.rm=TRUE),
apply(diastolic,1,mean,na.rm=TRUE),
apply(ALP,1,mean,na.rm=TRUE),
apply(glucose,1,mean,na.rm=TRUE),
apply(lymph,1,mean,na.rm=TRUE),
apply(mono,1,mean,na.rm=TRUE),
apply(wbc,1,mean,na.rm=TRUE)
)
colnames(meandat) <- c('Chimp','Sex','Age','DoB','Dominance','Extraversion','Openness',
'Conscientiousness','Agreeableness','Neuroticism','BMI',
'chol','creatinine','trig','sys','dias',
'ALP','glucose',
'lymph','mono','wbc'
)
imp_mean = amelia(meandat[,c(-4)],idvars="chimp",m=10)
imp_mean = amelia(meandat[,c(-4)],idvars="Chimp",m=10)
simp_mean=cbind(imp_mean$imputations$imp7[,1:2],apply(imp_mean$imputations$imp7[,3:20], c(2), scale))
colnames(simp_mean)
colnames(vmregs)
colnames(midus_c)
colnames(midus_cs)
colnames(vmregs)
colnames(simp_mean)
vcregs <- melt(simp_mean[,1:15], id.vars=c('Chimp','Sex','Age','chol','creatinine','trig','BMI','sys','dias'))
vmjcregs <- rbind(vmjregs,vcregs)
vmjregs <- rbind(vmregs,vjregs)
vmregs <- melt(midus_cs[,1:15], id.vars=c('M2ID','sex','age','chol','creat','trig','BMI','sys','dias'))
vmregs$Sample = 'MIDUS'
vjregs <- melt(midja_cs[,1:15], id.vars=c('MIDJA_IDS','sex','age','chol','creat','trig','BMI','sys','dias'))
vjregs$Sample = 'MIDJA'
colnames(vjregs)[1]<-'M2ID'
vmjregs <- rbind(vmregs,vjregs)
vmjcregs <- rbind(vmjregs,vcregs)
colnames(vcregs)
colnames(vmregs)
vcregs$Sample = 'Yerkes'
vmjcregs <- rbind(vmjregs,vcregs)
vpers<-data.frame(Sample=character(),Dimension=character(),Score=numeric())
vpers = rbind(
cbind(Sample="Yerkes", Dimension="Dominance", Score=(((output$dom - 1) / 2) + 1)),
cbind(Sample="Yerkes", Dimension="Neuroticism", Score=(((output$neuro - 1) / 2) + 1)),
cbind(Sample="Yerkes", Dimension="Extraversion", Score=(((output$extra - 1) / 2) + 1)),
cbind(Sample="Yerkes", Dimension="Agreeableness", Score=(((output$agree - 1) / 2) + 1)),
cbind(Sample="Yerkes", Dimension="Conscientiousness", Score=(((output$cons - 1) / 2) + 1)),
cbind(Sample="Yerkes", Dimension="Openness", Score=(((output$open - 1) / 2) + 1)),
cbind(Sample="MIDUS", Dimension="Neuroticism", Score=midus_c$B1SNEURO),
cbind(Sample="MIDUS", Dimension="Dominance", Score=midus_c$B1SAGENC),
cbind(Sample="MIDUS", Dimension="Agreeableness", Score=midus_c$B1SAGREE),
cbind(Sample="MIDUS", Dimension="Conscientiousness", Score=midus_c$B1SCONS2),
cbind(Sample="MIDUS", Dimension="Extraversion", Score=midus_c$B1SEXTRA),
cbind(Sample="MIDUS", Dimension="Openness", Score=midus_c$B1SOPEN),
cbind(Sample="MIDJA", Dimension="Agreeableness", Score=midja_c$J1SAGREE),
cbind(Sample="MIDJA", Dimension="Neuroticism", Score=midja_c$J1SNEURO),
cbind(Sample="MIDJA", Dimension="Conscientiousness", Score=midja_c$J1SCONS2),
cbind(Sample="MIDJA", Dimension="Extraversion", Score=midja_c$J1SEXTRA),
cbind(Sample="MIDJA", Dimension="Dominance", Score=midja_c$J1SAGENC),
cbind(Sample="MIDJA", Dimension="Openness", Score=midja_c$J1SOPEN))
vpers<-data.frame(Sample=vpers[,1],Dimension=vpers[,2],Score=as.numeric(as.character(vpers[,3])))
violpers <- ggplot(vpers, aes(x=Sample, y=Score, group=Sample)) + geom_violin(trim=TRUE, aes(fill = factor(Sample))) +
facet_wrap(~Dimension) +
stat_summary(fun.y=median.quartile,geom='point') +
stat_summary(fun.y=median.line,geom='point') +
geom_segment(aes(x=Sample-0.1, xend=Sample+0.1, y=Score, yend=Score), colour='white')
library(ggplot2)
violpers <- ggplot(vpers, aes(x=Sample, y=Score, group=Sample)) + geom_violin(trim=TRUE, aes(fill = factor(Sample))) +
facet_wrap(~Dimension) +
stat_summary(fun.y=median.quartile,geom='point') +
stat_summary(fun.y=median.line,geom='point') +
geom_segment(aes(x=Sample-0.1, xend=Sample+0.1, y=Score, yend=Score), colour='white')
median.quartile <- function(x){
out <- quantile(x, probs = c(0.25,0.5,0.75))
names(out) <- c("ymin","y","ymax")
return(out)
}
median.line <- function(x){
out <- quantile(x, probs = 0.5)
names(out) <- "y"
return(out)
}
violpers <- ggplot(vpers, aes(x=Sample, y=Score, group=Sample)) + geom_violin(trim=TRUE, aes(fill = factor(Sample))) +
facet_wrap(~Dimension) +
stat_summary(fun.y=median.quartile,geom='point') +
stat_summary(fun.y=median.line,geom='point') +
geom_segment(aes(x=Sample-0.1, xend=Sample+0.1, y=Score, yend=Score), colour='white')
violpers
colnames(meandat) <- c('Chimp','sex','age','DoB','Dominance','Extraversion','Openness',
'Conscientiousness','Agreeableness','Neuroticism','BMI',
'chol','creat','trig','sys','dias',
'ALP','glucose',
'lymph','mono','wbc'
)
imp_mean = amelia(meandat[,c(-4)],idvars="Chimp",m=10)
simp_mean=cbind(imp_mean$imputations$imp7[,1:2],apply(imp_mean$imputations$imp7[,3:20], c(2), scale))
vcregs <- melt(simp_mean[,1:15], id.vars=c('Chimp','sex','age','chol','create','trig','BMI','sys','dias'))
vcregs <- melt(simp_mean[,1:15], id.vars=c('Chimp','sex','age','chol','creat','trig','BMI','sys','dias'))
vcregs$Sample = 'Yerkes'
vmjcregs <- rbind(vmjregs,vcregs)
colnames(vmjregs,vcregs)
colnames(vmjregs)
colnames(vcregs)
colnames(vcregs)[1]<-'M2ID'
vmjcregs <- rbind(vmjregs,vcregs)
colnames(vmjcregs)[2:11]<-c('Sex','Age','Cholesterol','Creatinine','Triglycerides',
'BMI','Systolic BP','Diastolic BP','Personality','Score')
vregs <- ggplot(vmjregs, aes(y=Cholesterol,x=Score,colour=Sample)) +
geom_smooth(method=lm) + facet_wrap(~Personality)
vregs #+ geom_point()
colnames(vmjcregs)
View(vmjcregs)
sample(vmjcregs)
summary(vmjcregs)
table(vmjcregs$Score)
vmjcregs$Score
summary(vmcjregs$Personality)
table(vmcjregs$Personality)
table(vmjcregs$Personality)
table(vmjcregs$Sample)
1050/6
vregs <- ggplot(vmjregs, aes(y=Cholesterol,x=Score,colour=Sample)) +
geom_smooth(method=lm) + facet_wrap(~Personality)
vregs #+ geom_point()
vregs <- ggplot(vmjcregs, aes(y=Cholesterol,x=Score,colour=Sample)) +
geom_smooth(method=lm) + facet_wrap(~Personality)
vregs #+ g
vregs <- ggplot(vmjcregs, aes(y=Cholesterol,x=Score,colour=Sample)) +
geom_smooth(method=lm) + facet_wrap(~Personality)
vregs #+ g
vregs + geom_point()
vregs <- ggplot(vmjcregs, aes(y=Cholesterol,x=Score,colour=Sample)) +
geom_smooth(method=lm) + facet_wrap(~Personality)
vregs #+ geom_point()
imp_mean = amelia(meandat[,c(-4)],idvars="Chimp",m=10)
simp_mean=cbind(imp_mean$imputations$imp7[,1:2],apply(imp_mean$imputations$imp7[,3:20], c(2), scale))
vcregs <- melt(simp_mean[,1:15], id.vars=c('Chimp','sex','age','chol','creat','trig','BMI','sys','dias'))
vcregs$Sample = 'Yerkes'
colnames(vcregs)[1]<-'M2ID'
vmjcregs <- rbind(vmjregs,vcregs)
colnames(vmjcregs)[2:11]<-c('Sex','Age','Cholesterol','Creatinine','Triglycerides',
'BMI','Systolic BP','Diastolic BP','Personality','Score')
vregs <- ggplot(vmjcregs, aes(y=Cholesterol,x=Score,colour=Sample)) +
geom_smooth(method=lm) + facet_wrap(~Personality)
vregs #+ geom_point()
vregs <- ggplot(vmjcregs, aes(y=Cholesterol,x=Score,colour=Sample)) +
stat_smooth(method=lm) + facet_wrap(~Personality)
vregs #+ geom_point()
vregs <- ggplot(vmjcregs, aes(y=Cholesterol,x=Score,colour=Sample)) +
stat_smooth(method=lm,
formula=Cholesterol ~ Dominance + Neuroticism + Agreeableness + Extraversion + Conscientiousness + Openness + Sex + BMI + Age) +
facet_wrap(~Personality)
vregs #+ geom_point()
vregs <- ggplot(vmjcregs, aes(y=Cholesterol,x=Score,colour=Sample)) +
stat_smooth(method=lm,
formula="Cholesterol ~ Dominance + Neuroticism + Agreeableness + Extraversion + Conscientiousness + Openness
+ Sex + BMI + Age + 1") +
facet_wrap(~Personality)
vregs #+ geom_point()
??rq
coef(m2.chol)
coef(m.sys)
vregs <- ggplot(vmjcregs, aes(y=Cholesterol,x=Score,colour=Sample)) +
stat_smooth(method=lm,
formula="Cholesterol ~ Dominance + Neuroticism + Agreeableness + Extraversion + Conscientiousness + Openness
+ Sex + BMI + Age + 1") #+
vregs #+ geom_point()
vregs <- ggplot(vmjcregs, aes(y=Cholesterol,x=Score,colour=Sample)) +
stat_smooth(method=lm
#  , formula="Cholesterol ~ Dominance + Neuroticism + Agreeableness + Extraversion + Conscientiousness + Openness
#  + Sex + BMI + Age + 1"
) #+
vregs #+ geom_point()
vregs + geom_point()
vregs + geom_abline(aes(intercept=coef(m.chol[1])), slope = coef(m.chol[5]))
