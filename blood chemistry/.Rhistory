)
beanBio <- with(data=vbio[vbio$Marker=='BMI',], beanplot(Value ~ Sex * Sample, side = 'both', bw = 0.3,
overallline = "median", beanlines = 'median', what = c(0,1,1,0), boxwex=0.9,
col = list("cadetblue3", "cadetblue1", "royalblue3", "royalblue1","slateblue","slateblue1"))
)
beanBio <- with(data=vbio[vbio$Marker=='BMI',], beanplot(Value ~ Sex * Sample, side = 'both', bw = 0.1,
overallline = "median", beanlines = 'median', what = c(0,1,1,0), boxwex=0.9,
col = list("cadetblue3", "cadetblue1", "royalblue3", "royalblue1","slateblue","slateblue1"))
)
beanBio <- with(data=vbio[vbio$Marker=='Diastolic BP',], beanplot(Value ~ Sex * Sample, side = 'both', bw = 0.1,
overallline = "median", beanlines = 'median', what = c(0,1,1,0), boxwex=0.9,
col = list("cadetblue3", "cadetblue1", "royalblue3", "royalblue1","slateblue","slateblue1"))
)
beanBio <- with(data=vbio[vbio$Marker=='Systolic BP',], beanplot(Value ~ Sex * Sample, side = 'both', bw = 0.1,
overallline = "median", beanlines = 'median', what = c(0,1,1,0), boxwex=0.9,
col = list("cadetblue3", "cadetblue1", "royalblue3", "royalblue1","slateblue","slateblue1"))
)
beanBio <- with(data=vbio[vbio$Marker=='Cholesterol',], beanplot(Value ~ Sex * Sample, side = 'both', bw = 0.1,
overallline = "median", beanlines = 'median', what = c(0,1,1,0), boxwex=0.9,
col = list("cadetblue3", "cadetblue1", "royalblue3", "royalblue1","slateblue","slateblue1"))
)
beanBio <- with(data=vbio[vbio$Marker=='Systolic BP',], beanplot(Value ~ Sex * Sample, side = 'both', bw = 0.1,
overallline = "median", beanlines = 'median', what = c(0,1,1,0), boxwex=0.9,
col = list("cadetblue3", "cadetblue1", "royalblue3", "royalblue1","slateblue","slateblue1"))
)
beanBio <- with(data=vbio[vbio$Marker=='Cholesterol',], beanplot(Value ~ Sex * Sample, side = 'both', bw = 0.1,
overallline = "median", beanlines = 'median', what = c(0,1,1,0), boxwex=0.9,
col = list("cadetblue3", "cadetblue1", "royalblue3", "royalblue1","slateblue","slateblue1"))
)
beanBio <- with(data=vbio[vbio$Marker=='Triglycerides',], beanplot(Value ~ Sex * Sample, side = 'both', bw = 0.3,
overallline = "median", beanlines = 'median', what = c(0,1,1,0), boxwex=0.9,
col = list("cadetblue3", "cadetblue1", "royalblue3", "royalblue1","slateblue","slateblue1"))
)
beanBio <- with(data=vbio[vbio$Marker=='Cholesterol',], beanplot(Value ~ Sex * Sample, side = 'both', bw = 0.1,
overallline = "median", beanlines = 'median', what = c(0,1,1,0), boxwex=0.9,
col = list("cadetblue3", "cadetblue1", "royalblue3", "royalblue1","slateblue","slateblue1"))
)
beanBio <- with(data=vbio[vbio$Marker=='Triglycerides',], beanplot(Value ~ Sex * Sample, side = 'both', bw = 0.1,
overallline = "median", beanlines = 'median', what = c(0,1,1,0), boxwex=0.9,
col = list("cadetblue3", "cadetblue1", "royalblue3", "royalblue1","slateblue","slateblue1"))
)
beanBio <- with(data=vbio[vbio$Marker=='Creatinine',],
beanplot(Value ~ Sex * Sample, side = 'both', bw = 0.1,
overallline = "median", beanlines = 'median', what = c(0,1,1,0), boxwex=0.9,
col = list("cadetblue3", "cadetblue1", "royalblue3", "royalblue1","slateblue","slateblue1"))
)
beanBio <- with(data=vbio[vbio$Marker=='Triglycerides',], beanplot(Value ~ Sex * Sample, side = 'both', bw = 0.2,
overallline = "median", beanlines = 'median', what = c(0,1,1,0), boxwex=0.9,
col = list("cadetblue3", "cadetblue1", "royalblue3", "royalblue1","slateblue","slateblue1"))
)
beanBio <- with(data=vbio[vbio$Marker=='Creatinine',],
beanplot(Value ~ Sex * Sample, side = 'both', bw = 0.1, log = '',
overallline = "median", beanlines = 'median', what = c(0,1,1,0), boxwex=0.9,
col = list("cadetblue3", "cadetblue1", "royalblue3", "royalblue1","slateblue","slateblue1"))
)
beanBio <- with(data=vbio[vbio$Marker=='Cholesterol',], beanplot(Value ~ Sex * Sample, side = 'both', bw = 0.1, log = '',
overallline = "median", beanlines = 'median', what = c(0,1,1,0), boxwex=0.9,
col = list("cadetblue3", "cadetblue1", "royalblue3", "royalblue1","slateblue","slateblue1"))
)
beanBio <- with(data=vbio[vbio$Marker=='Cholesterol',], beanplot(Value ~ Sex * Sample, side = 'both', bw = 0.3, log = '',
overallline = "median", beanlines = 'median', what = c(0,1,1,0), boxwex=0.9,
col = list("cadetblue3", "cadetblue1", "royalblue3", "royalblue1","slateblue","slateblue1"))
)
beanBio <- with(data=vbio[vbio$Marker=='Cholesterol',], beanplot(Value ~ Sex * Sample, side = 'both', bw = 3.0, log = '',
overallline = "median", beanlines = 'median', what = c(0,1,1,0), boxwex=0.9,
col = list("cadetblue3", "cadetblue1", "royalblue3", "royalblue1","slateblue","slateblue1"))
)
beanBio <- with(data=vbio[vbio$Marker=='Cholesterol',], beanplot(Value ~ Sex * Sample, side = 'both', log = '',
#bw = 3.0,
overallline = "median", beanlines = 'median', what = c(0,1,1,0), boxwex=0.9,
col = list("cadetblue3", "cadetblue1", "royalblue3", "royalblue1","slateblue","slateblue1"))
)
beanBio <- with(data=vbio[vbio$Marker=='BMI',], beanplot(Value ~ Sex * Sample, side = 'both', log = '',
#bw = 0.1,
overallline = "median", beanlines = 'median', what = c(0,1,1,0), boxwex=0.9,
col = list("cadetblue3", "cadetblue1", "royalblue3", "royalblue1","slateblue","slateblue1"))
)
beanBio <- with(data=vbio[vbio$Marker=='Diastolic BP',], beanplot(Value ~ Sex * Sample, side = 'both', log = '',
#bw = 0.1,
overallline = "median", beanlines = 'median', what = c(0,1,1,0), boxwex=0.9,
col = list("cadetblue3", "cadetblue1", "royalblue3", "royalblue1","slateblue","slateblue1"))
)
beanBio <- with(data=vbio[vbio$Marker=='BMI',], beanplot(Value ~ Sex * Sample, side = 'both', log = '',
#bw = 0.1,
overallline = "median", beanlines = 'median', what = c(0,1,1,0), boxwex=0.9,
col = list("cadetblue3", "cadetblue1", "royalblue3", "royalblue1","slateblue","slateblue1"))
)
beanBio <- with(data=vbio[vbio$Marker=='Creatinine',],
beanplot(Value ~ Sex * Sample, side = 'both', bw = 0.1, log = '',
overallline = "median", beanlines = 'median', what = c(0,1,1,0), boxwex=0.9,
col = list("cadetblue3", "cadetblue1", "royalblue3", "royalblue1","slateblue","slateblue1"))
)
beanBio <- with(data=vbio[vbio$Marker=='Creatinine',],
beanplot(Value ~ Sex * Sample, side = 'both',
#bw = 0.1, log = '',
overallline = "median", beanlines = 'median', what = c(0,1,1,0), boxwex=0.9,
col = list("cadetblue3", "cadetblue1", "royalblue3", "royalblue1","slateblue","slateblue1"))
)
beanBio <- with(data=vbio[vbio$Marker=='Creatinine',],
beanplot(Value ~ Sex * Sample, side = 'both',
bw = 0.1, log = '',
overallline = "median", beanlines = 'median', what = c(0,1,1,0), boxwex=0.9,
col = list("cadetblue3", "cadetblue1", "royalblue3", "royalblue1","slateblue","slateblue1"))
)
beanBio <- with(data=vbio[vbio$Marker=='Creatinine',],
beanplot(Value ~ Sex * Sample, side = 'both',
bw = 0.05, log = '',
overallline = "median", beanlines = 'median', what = c(0,1,1,0), boxwex=0.9,
col = list("cadetblue3", "cadetblue1", "royalblue3", "royalblue1","slateblue","slateblue1"))
)
beanBio <- with(data=vbio[vbio$Marker=='Creatinine',],
beanplot(Value ~ Sex * Sample, side = 'both',
bw = 0.1, log = '',
overallline = "median", beanlines = 'median', what = c(0,1,1,0), boxwex=0.9,
col = list("cadetblue3", "cadetblue1", "royalblue3", "royalblue1","slateblue","slateblue1"))
)
beanBio <- with(data=vbio[vbio$Marker=='Creatinine',],
beanplot(Value ~ Sex * Sample, side = 'both',
bw = 0.1, log = '',
overallline = "median", beanlines = 'quantile', what = c(0,1,1,0), boxwex=0.9,
col = list("cadetblue3", "cadetblue1", "royalblue3", "royalblue1","slateblue","slateblue1"))
)
beanBio <- with(data=vbio[vbio$Marker=='Creatinine',],
beanplot(Value ~ Sex * Sample, side = 'both',
bw = 0.1, log = '',
overallline = "median", beanlines = 'median', what = c(0,1,1,0), boxwex=0.9,
col = list("cadetblue3", "cadetblue1", "royalblue3", "royalblue1","slateblue","slateblue1"))
)
beanpers <- with(data=vpers[vpers$Dimension=='Extraversion',],
beanplot(Score ~ Sex * Sample, side = 'both', bw = 0.3, cutmax = 4, cutmin = 1,
overallline = "median", beanlines = 'median', what = c(0,1,1,0), boxwex=0.9,
col = list("cadetblue3", "cadetblue1", "royalblue3", "royalblue1","slateblue","slateblue1"))
)
beanpers <- with(data=vpers[vpers$Dimension=='Openness',], beanplot(Score ~ Sex * Sample, side = 'both', bw = 0.3, cutmax = 4, cutmin = 1,
overallline = "median", beanlines = 'median', what = c(0,1,1,0), boxwex=0.9,
col = list("cadetblue3", "cadetblue1", "royalblue3", "royalblue1","slateblue","slateblue1"))
)
beanpers <- with(data=vpers[vpers$Dimension=='Conscientiousness',], beanplot(Score ~ Sex * Sample, side = 'both', bw = 0.3, cutmax = 4, cutmin = 1,
overallline = "median", beanlines = 'median', what = c(0,1,1,0), boxwex=0.9,
col = list("cadetblue3", "cadetblue1", "royalblue3", "royalblue1","slateblue","slateblue1"))
)
beanpers <- with(data=vpers[vpers$Dimension=='Agreeableness',], beanplot(Score ~ Sex * Sample, side = 'both', bw = 0.3, cutmax = 4, cutmin = 1,
overallline = "median", beanlines = 'median', what = c(0,1,1,0), boxwex=0.9,
col = list("cadetblue3", "cadetblue1", "royalblue3", "royalblue1","slateblue","slateblue1"))
)
beanpers <- with(data=vpers[vpers$Dimension=='Agreeableness',], beanplot(Score ~ Sex * Sample, side = 'both', bw = 0.3, cutmax = 4, cutmin = 1,
overallline = "median", beanlines = 'median', what = c(0,1,1,0), boxwex=0.9,
col = list("cadetblue3", "cadetblue1", "royalblue3", "royalblue1","slateblue","slateblue1"))
)
beanpers <- with(data=vpers[vpers$Dimension=='Openness',], beanplot(Score ~ Sex * Sample, side = 'both', bw = 0.3, cutmax = 4, cutmin = 1,
overallline = "median", beanlines = 'median', what = c(0,1,1,0), boxwex=0.9,
col = list("cadetblue3", "cadetblue1", "royalblue3", "royalblue1","slateblue","slateblue1"))
)
beanpers <- with(data=vpers[vpers$Dimension=='Conscientiousness',], beanplot(Score ~ Sex * Sample, side = 'both', bw = 0.3, cutmax = 4, cutmin = 1,
overallline = "median", beanlines = 'median', what = c(0,1,1,0), boxwex=0.9,
col = list("cadetblue3", "cadetblue1", "royalblue3", "royalblue1","slateblue","slateblue1"))
)
beanpers <- with(data=vpers[vpers$Dimension=='Dominance',], beanplot(Score ~ Sex * Sample, side = 'both', bw = 0.3, cutmax = 4, cutmin = 1,
overallline = "median", beanlines = 'median', what = c(0,1,1,0), boxwex=0.9,
col = list("cadetblue3", "cadetblue1", "royalblue3", "royalblue1","slateblue","slateblue1"))
)
beanpers <- with(data=vpers[vpers$Dimension=='Neuroticism',], beanplot(Score ~ Sex * Sample, side = 'both', bw = 0.3, cutmax = 4, cutmin = 1,
overallline = "median", beanlines = 'median', what = c(0,1,1,0), boxwex=0.9,
col = list("cadetblue3", "cadetblue1", "royalblue3", "royalblue1","slateblue","slateblue1"))
)
beanpers <- with(data=vpers[vpers$Dimension=='Extraversion',],
beanplot(Score ~ Sex * Sample, side = 'both', bw = 0.3, cutmax = 4, cutmin = 1,
overallline = "median", beanlines = 'median', what = c(0,1,1,0), boxwex=0.9,
col = list("cadetblue3", "cadetblue1", "royalblue3", "royalblue1","slateblue","slateblue1"))
)
sample_vect = c((rep(c('Japanese'),6)),(rep(c('Americans'),6)),(rep(c('Yerkes'),6)))
pd <- position_dodge(width=0.2,height=NULL)
# Systolic CF plots
c.sys.co=fixef(m1a)[2:7]
m.sys.co=m.sys$coefficients[5:10]
j.sys.co=mj.sys$coefficients[5:10]
c.sys.prd = confint(m1a, level=0.90)[4:9,]
m.sys.prd = confint(m.sys, level=0.90)[5:10,]
j.sys.prd = confint(mj.sys, level=0.90)[5:10,]
sys.ci = data.frame(
Coefficients=c(j.sys.co,m.sys.co,c.sys.co),rbind(j.sys.prd,m.sys.prd,c.sys.prd),sample_vect,Dimension=rep(rownames(m.sys.prd),3)
)
colnames(sys.ci)<-c("Coefficients",'lower',"upper","Sample","Dimension")
sys.cf.gg = ggplot(sys.ci, aes(Sample,Coefficients, color=Sample)) +
geom_point(aes(shape=Sample),size=4, position=pd) +
#  scale_color_manual(name="Sample",values=c("coral","steelblue")) +
theme_bw() + theme(legend.position='none') +
#  scale_x_continuous("Sample", breaks=1:length(Sample), labels=Sample) +
scale_y_continuous("Regression coefficients")   +
geom_errorbar(aes(ymin=lower,ymax=upper),width=0.1,position=pd) + facet_wrap(~ Dimension, ncol=2)
library(ggplot2)
sample_vect = c((rep(c('Japanese'),6)),(rep(c('Americans'),6)),(rep(c('Yerkes'),6)))
pd <- position_dodge(width=0.2,height=NULL)
# Systolic CF plots
c.sys.co=fixef(m1a)[2:7]
m.sys.co=m.sys$coefficients[5:10]
j.sys.co=mj.sys$coefficients[5:10]
c.sys.prd = confint(m1a, level=0.90)[4:9,]
m.sys.prd = confint(m.sys, level=0.90)[5:10,]
j.sys.prd = confint(mj.sys, level=0.90)[5:10,]
sys.ci = data.frame(
Coefficients=c(j.sys.co,m.sys.co,c.sys.co),rbind(j.sys.prd,m.sys.prd,c.sys.prd),sample_vect,Dimension=rep(rownames(m.sys.prd),3)
)
colnames(sys.ci)<-c("Coefficients",'lower',"upper","Sample","Dimension")
sys.cf.gg = ggplot(sys.ci, aes(Sample,Coefficients, color=Sample)) +
geom_point(aes(shape=Sample),size=4, position=pd) +
#  scale_color_manual(name="Sample",values=c("coral","steelblue")) +
theme_bw() + theme(legend.position='none') +
#  scale_x_continuous("Sample", breaks=1:length(Sample), labels=Sample) +
scale_y_continuous("Regression coefficients")   +
geom_errorbar(aes(ymin=lower,ymax=upper),width=0.1,position=pd) + facet_wrap(~ Dimension, ncol=2)
sys.cf.gg
c.dias.co=fixef(m1b)[2:7]
m.dias.co=m.dias$coefficients[5:10]
j.dias.co=mj.dias$coefficients[5:10]
c.dias.prd = confint(m1b, level=0.90)[4:9,]
m.dias.prd = confint(m.dias, level=0.90)[5:10,]
j.dias.prd = confint(mj.dias, level=0.90)[5:10,]
dias.ci = data.frame(
Coefficients=c(j.dias.co,m.dias.co,c.dias.co),rbind(j.dias.prd,m.dias.prd,c.dias.prd),sample_vect,Dimension=rep(rownames(m.dias.prd),3)
)
colnames(dias.ci)<-c("Coefficients",'lower',"upper","Sample","Dimension")
dias.cf.gg <- ggplot(dias.ci, aes(Sample,Coefficients, color=Sample)) +
geom_point(aes(shape=Sample),size=4, position=pd) +
#  scale_color_manual(name="Sample",values=c("coral","steelblue")) +
theme_bw() + theme(legend.position='none') +
#  scale_x_continuous("Sample", breaks=1:length(Sample), labels=Sample) +
scale_y_continuous("Regression coefficients")   +
geom_errorbar(aes(ymin=lower,ymax=upper),width=0.1,position=pd) + facet_wrap(~ Dimension, ncol=2)
dias.cf.gg
c.trig.co=fixef(m2.trig)[2:7]
m.trig.co=m.trig$coefficients[5:10]
j.trig.co=mj.trig$coefficients[5:10]
c.trig.prd = confint(m2.trig, level=0.90)[4:9,]
m.trig.prd = confint(m.trig, level=0.90)[5:10,]
j.trig.prd = confint(mj.trig, level=0.90)[5:10,]
trig.ci = data.frame(
Coefficients=c(j.trig.co,m.trig.co,c.trig.co),rbind(j.trig.prd,m.trig.prd,c.trig.prd),sample_vect,Dimension=rep(rownames(m.trig.prd),3)
)
colnames(trig.ci)<-c("Coefficients",'lower',"upper","Sample","Dimension")
trig.cf.gg <- ggplot(trig.ci, aes(Sample,Coefficients, color=Sample)) +
geom_point(aes(shape=Sample),size=4, position=pd) +
#  scale_color_manual(name="Sample",values=c("coral","steelblue")) +
theme_bw() + theme(legend.position='none') +
#  scale_x_continuous("Sample", breaks=1:length(Sample), labels=Sample) +
scale_y_continuous("Regression coefficients")   +
geom_errorbar(aes(ymin=lower,ymax=upper),width=0.1,position=pd) + facet_wrap(~ Dimension, ncol=2)
trig.cf.gg
c.BMI.co=fixef(m3.BMI)[2:7]
m.BMI.co=m.BMI$coefficients[4:9]
j.BMI.co=mj.BMI$coefficients[4:9]
c.BMI.prd = confint(m3.BMI, level=0.90)[4:9,]
m.BMI.prd = confint(m.BMI, level=0.90)[5:10,]
j.BMI.prd = confint(mj.BMI, level=0.90)[5:10,]
BMI.ci = data.frame(
Coefficients=c(j.BMI.co,m.BMI.co,c.BMI.co),rbind(j.BMI.prd,m.BMI.prd,c.BMI.prd),sample_vect,Dimension=rep(rownames(m.BMI.prd),3)
)
colnames(BMI.ci)<-c("Coefficients",'lower',"upper","Sample","Dimension")
j.BMI.co
m.BMI.co
c.BMI.co
c.BMI.prd = confint(m3.BMI, level=0.95)[4:9,]
m.BMI.prd = confint(m.BMI, level=0.95)[5:10,]
m3.BMI <- lmer(BMI ~ Dominance + Openness + Agreeableness + Conscientiousness + Neuroticism + Extraversion + age + sex + (1 | chimp),
data = scoutput, REML=FALSE, control=lmerControl(optCtrl=list(maxfun=10000)))
confint(m3.BMI)
tt <- getME(m3.BMI,"theta")
ll <- getME(m3.BMI,"lower")
min(tt[ll==0])
derivs1 <- m3.BMI@optinfo$derivs
sc_grad1 <- with(derivs1,solve(Hessian,gradient))
max(abs(sc_grad1))
confint(m3.BMI.a2, method='Wald')
m3.BMI.a2 <- lmer(BMI ~ Dominance + Openness + Agreeableness + Conscientiousness + Neuroticism + Extraversion + age + s(sex) + age2 + (1 | chimp),
data = scoutput, REML=FALSE, control=lmerControl(optimizer = "optimx",
optCtrl=list(maxfun=1000,
method='nlminb')))
library(optimx)
m3.BMI.a2 <- lmer(BMI ~ Dominance + Openness + Agreeableness + Conscientiousness + Neuroticism + Extraversion + age + s(sex) + age2 + (1 | chimp),
data = scoutput, REML=FALSE, control=lmerControl(optimizer = "optimx",
optCtrl=list(maxfun=1000,
method='nlminb')))
confint(m3.BMI.a2, method='Wald')
c.BMI.co=fixef(m3.BMI.a2)[2:7]
c.BMI.prd = confint(m3.BMI, level=0.95)[4:9,]
c.BMI.prd
confint(m3.BMI.a2, method='boot')
confint(m3.BMI.a2, method='Wald')
c.BMI.prd = confint(m3.BMI, level=0.95)[4:9,]
c.BMI.prd = confint(m3.BMI, method='Wald',level=0.95)[4:9,]
m.BMI.prd = confint(m.BMI,level=0.95)[5:10,]
j.BMI.prd = confint(mj.BMI, level=0.95)[5:10,]
confint(m.BMI,level=0.95)[5:10,]
confint(m.BMI,level=0.95)
m.BMI.co=m.BMI.a2$coefficients[4:9]
m.sys.a2 <- lm(sys ~ age + sex + BMI
+ Dominance + Openness + Agreeableness + Conscientiousness + Neuroticism + Extraversion + age2, data = midus_cs)
# see m_1
m.dias.a2 <- lm(dias ~ age + sex + BMI
+ Dominance + Openness + Agreeableness + Conscientiousness + Neuroticism + Extraversion + age2, data = midus_cs)
m.chol.a2 <- lm(chol ~ age + sex + BMI
+ Dominance + Openness + Agreeableness + Conscientiousness + Neuroticism + Extraversion + age2, data = midus_cs)
# see m_2a
m.trig.a2 <- lm(trig ~ age + sex + BMI
+ Dominance + Openness + Agreeableness + Conscientiousness + Neuroticism + Extraversion + age2, data = midus_cs)
# see m_2b
#leave out?
m.creat.a2 <- lm(creat ~ age + sex + BMI
+ Dominance + Openness + Agreeableness + Conscientiousness + Neuroticism + Extraversion + age2, data = midus_cs)
# see m2u
m.BMI.a2 <- lm(BMI ~ age + sex
+ Dominance + Openness + Agreeableness + Conscientiousness + Neuroticism + Extraversion + age2, data = midus_cs)
midus_c$B4ZAGE2 <- (midus_c$B4ZAGE)^2
midus_cs <- with(midus_c,data.frame(M2ID,sex=B1PRSEX, age=s(B4ZAGE), age2=s(B4ZAGE2),
Dominance=s(B1SAGENC),Extraversion=s(B1SEXTRA),Openness=s(B1SOPEN),
Conscientiousness=s(B1SCONS2),Agreeableness=s(B1SAGREE),Neuroticism=s(B1SNEURO),
BMI=s(B4PBMI),chol=s(B4BCHOL),creat=s(B4BSCREA),trig=s(B4BTRIGL),
sys=s(B4P1GS23),dias=s(B4P1GD23),
alp=s(B4BSBAP),glucose=s(B4BGLUC),
sys_all = s(B4P1GS), dias_all = s(B4P1GD)))
midja_c$J2CAGE2 = (midja_c$J2CAGE)^2
midja_cs <- with(midja_c,data.frame(MIDJA_IDS, sex=J1SQ1, age=s(J2CAGE), age2=s(J2CAGE2),
Dominance=s(J1SAGENC),Extraversion=s(J1SEXTRA),Openness=s(J1SOPEN),
Conscientiousness=s(J1SCONS2),Agreeableness=s(J1SAGREE),Neuroticism=s(J1SNEURO),
BMI=s(J2CBMI),chol=s(J2BCHOL),creat=s(J2BSCREA),trig=s(J2CTRIG),
sys=s(J2CBPS23),dias=s(J2CBPD23),
tokyo_ch=s(J2CTCHOL)   # but also
))
mj.sys.a2 <- lm(sys ~ age + sex + BMI
+ Dominance + Openness + Agreeableness + Conscientiousness + Neuroticism + Extraversion + age2, data = midja_cs)
mj.chol.a2 <- lm(chol ~ age + sex + BMI
+ Dominance + Openness + Agreeableness + Conscientiousness + Neuroticism + Extraversion + age2, data = midja_cs)
mj.trig.a2 <- lm(trig ~ age + sex + BMI
+ Dominance + Openness + Agreeableness + Conscientiousness + Neuroticism + Extraversion + age2, data = midja_cs)
mj.creat.a2 <- lm(creat ~ age + sex + BMI
+ Dominance + Openness + Agreeableness + Conscientiousness + Neuroticism + Extraversion + age2, data = midja_cs)
mj.dias.a2 <- lm(dias ~ age + sex + BMI
+ Dominance + Openness + Agreeableness + Conscientiousness + Neuroticism + Extraversion + age2, data = midja_cs)
mj.BMI.a2 <- lm(BMI ~ age + sex
+ Dominance + Openness + Agreeableness + Conscientiousness + Neuroticism + Extraversion + age2, data = midja_cs)
m.sys.a2 <- lm(sys ~ age + sex + BMI
+ Dominance + Openness + Agreeableness + Conscientiousness + Neuroticism + Extraversion + age2, data = midus_cs)
# see m_1
m.dias.a2 <- lm(dias ~ age + sex + BMI
+ Dominance + Openness + Agreeableness + Conscientiousness + Neuroticism + Extraversion + age2, data = midus_cs)
m.chol.a2 <- lm(chol ~ age + sex + BMI
+ Dominance + Openness + Agreeableness + Conscientiousness + Neuroticism + Extraversion + age2, data = midus_cs)
# see m_2a
m.trig.a2 <- lm(trig ~ age + sex + BMI
+ Dominance + Openness + Agreeableness + Conscientiousness + Neuroticism + Extraversion + age2, data = midus_cs)
# see m_2b
#leave out?
m.creat.a2 <- lm(creat ~ age + sex + BMI
+ Dominance + Openness + Agreeableness + Conscientiousness + Neuroticism + Extraversion + age2, data = midus_cs)
# see m2u
m.BMI.a2 <- lm(BMI ~ age + sex
+ Dominance + Openness + Agreeableness + Conscientiousness + Neuroticism + Extraversion + age2, data = midus_cs)
# see m3.BMIc
m.BMI.co=m.BMI.a2$coefficients[4:9]
j.BMI.co=mj.BMI.a2$coefficients[4:9]
m.BMI.co
c.BMI.prd = confint(m3.BMI.a2, method='Wald',level=0.95)[4:9,]
m.BMI.prd = confint(m.BMI.a2,level=0.95)[5:10,]
j.BMI.prd = confint(mj.BMI.a2, level=0.95)[5:10,]
j.BMI.prd
j.BMI.prd = confint(mj.BMI.a2, level=0.95)[4:9,]
m.BMI.prd = confint(m.BMI.a2,level=0.95)[4:9,]
j.BMI.prd
c.DMI.prd
c.BMI.prd
m3.BMI.a2 <- lmer(BMI ~ Dominance + Openness + Agreeableness + Conscientiousness + Neuroticism + Extraversion + age + sex + age2 + (1 | chimp),
data = scoutput, REML=FALSE, control=lmerControl(optimizer = "optimx",
optCtrl=list(maxfun=1000,
method='nlminb')))
confint(m3.BMI.a2, method='Wald')
colnames(socutput)
colnames(scoutput)
head(scoutput)
m2.chol.a2 <- lmer(chol ~ Dominance + Openness + Agreeableness + Conscientiousness + Neuroticism + Extraversion + age + BMI + sex + age2 + (1 | chimp),
data = scoutput,REML=FALSE)
confint(m2.chol.a2)
summary(scoutput)
summary(m2.trig.a2)
summary(m2.chol.a2)
m1a.a2 <- lmer(sys ~ Dominance + Openness + Agreeableness + Conscientiousness + Neuroticism + Extraversion + age + BMI + sex + age2 + (1 | chimp),
data = scoutput,REML=FALSE)
m1b.a2 <- lmer(dias ~ Dominance + Openness + Agreeableness + Conscientiousness + Neuroticism + Extraversion + age + BMI + sex + age2 + (1 | chimp),
data = scoutput,REML=FALSE)
m2.trig.a2 <- lmer(trig ~ Dominance + Openness + Agreeableness + Conscientiousness + Neuroticism + Extraversion + age + BMI + sex + age2 + (1 | chimp),
data = scoutput,REML=FALSE)
m2.chol.a2 <- lmer(chol ~ Dominance + Openness + Agreeableness + Conscientiousness + Neuroticism + Extraversion + age + BMI + sex + age2 + (1 | chimp),
data = scoutput,REML=FALSE)
m2.creat.a2 <- lmer(creatinine ~ Dominance + Openness + Agreeableness + Conscientiousness + Neuroticism + Extraversion + age + BMI + sex + age2 + (1 | chimp),
data = scoutput,REML=FALSE)
summary(m2.trig)
summary(m2.trig.a2)
m2.chol <- lmer(chol ~ Dominance + Openness + Agreeableness + Conscientiousness + Neuroticism + Extraversion + age + BMI + sex + (1 | chimp),
data = scoutput,REML=FALSE)
summary(m2.chol)
m2.chol.a2 <- lmer(chol ~ Dominance + Openness + Agreeableness + Conscientiousness + Neuroticism + Extraversion + age + BMI + sex + age2 + (1 | chimp),
data = scoutput,REML=FALSE)
summary(m2.chol.a2)
m2.chol.a2 <- lmer(chol ~ Dominance + Openness + Agreeableness + Conscientiousness + Neuroticism + Extraversion + age + BMI + sex + (1 | chimp),
data = scoutput,REML=FALSE)
summary(m2.chol.a2)
summary(m.chol.a2)
summary(mj.chol.a2)
summary(c.chol.a2)
summary(m2.chol.a2)
head(age)
head(age2)
head(output$age2)
detach("package:devtools", unload=TRUE)
install.packages("pastecs")
library(pastecs)
summary(m1b.a2)
summary(m1a.a2)
summary(m2.creat.a2)
summary(m2.trig.a2)
daystoyears(bchemt1[3]-DoB[3])
bchemt1[3]-DoB[3]
as.numeric(bchemt1[3]-DoB[3])
daystoyears(as.numeric(bchemt1[3]-DoB[3]))
daystoyears(as.numeric(bchemt1[4]-DoB[4]))
m1a.a2 <- lmer(sys ~ Dominance + Openness + Agreeableness + Conscientiousness + Neuroticism + Extraversion + age + BMI + sex + I(age^2) + (1 | chimp),
data = scoutput,REML=FALSE)
summary(m1a.a2)
m1b.a2 <- lmer(dias ~ Dominance + Openness + Agreeableness + Conscientiousness + Neuroticism + Extraversion + age + BMI + sex + I(age^2) + (1 | chimp),
data = scoutput,REML=FALSE)
m2.trig.a2 <- lmer(trig ~ Dominance + Openness + Agreeableness + Conscientiousness + Neuroticism + Extraversion + age + BMI + sex + I(age^2) + (1 | chimp),
data = scoutput,REML=FALSE)
m2.trig.a2
summary(m2.trig.a2)
# this needs to be applied in the other data sets as well
m3.BMI.a2 <- lmer(BMI ~ Dominance + Openness + Agreeableness + Conscientiousness + Neuroticism + Extraversion + age + sex + I(age^2) + (1 | chimp),
data = scoutput, REML=FALSE, control=lmerControl(optimizer = "optimx",
optCtrl=list(maxfun=1000,
method='nlminb')))
confint(m3.BMI.a2, method='Wald')
m.creat.a2 <- lm(creat ~ age + sex + BMI
+ Dominance + Openness + Agreeableness + Conscientiousness + Neuroticism + Extraversion + age2, data = midus_cs)
# see m2u
summary(m.creat.a2)
m.creat.a2 <- lm(creat ~ age + sex + BMI
+ Dominance + Openness + Agreeableness + Conscientiousness + Neuroticism + Extraversion + I(age^2), data = midus_cs)
# see m2u
summary(m.creat.a2)
c.BMI.co=fixef(m3.BMI.a2)[2:7]
m.BMI.co=m.BMI.a2$coefficients[4:9]
j.BMI.co=mj.BMI.a2$coefficients[4:9]
c.BMI.prd = confint(m3.BMI.a2, method='Wald',level=0.95)[4:9,]
m.BMI.prd = confint(m.BMI.a2,level=0.95)[4:9,]
j.BMI.prd = confint(mj.BMI.a2, level=0.95)[4:9,]
BMI.ci = data.frame(
Coefficients=c(j.BMI.co,m.BMI.co,c.BMI.co),rbind(j.BMI.prd,m.BMI.prd,c.BMI.prd),sample_vect,Dimension=rep(rownames(m.BMI.prd),3)
)
colnames(BMI.ci)<-c("Coefficients",'lower',"upper","Sample","Dimension")
BMI.cf.gg <- ggplot(BMI.ci, aes(Sample,Coefficients, color=Sample)) +
geom_point(aes(shape=Sample),size=4, position=pd) +
#  scale_color_manual(name="Sample",values=c("coral","steelblue")) +
theme_bw() +
#  scale_x_continuous("Sample", breaks=1:length(Sample), labels=Sample) +
scale_y_continuous("Regression coefficients")   +
geom_errorbar(aes(ymin=lower,ymax=upper),width=0.1,position=pd) + facet_wrap(~ Dimension, ncol=2)
BMI.cf.gg
c.BMI.prd
c.BMI.co
m.BMI.a2$coefficients
fixef(m3.BMI.a2)
m.BMI.a2 <- lm(BMI ~ age + sex
+ Dominance + Openness + Agreeableness + Conscientiousness + Neuroticism + Extraversion + I(age^2), data = midus_cs)
# see m3.BMIc
mj.BMI.a2 <- lm(BMI ~ age + sex
+ Dominance + Openness + Agreeableness + Conscientiousness + Neuroticism + Extraversion + I(age^2), data = midja_cs)
m.BMI.a2$coefficients
c.BMI.co=fixef(m3.BMI.a2)[c(2:8,10)]
m.BMI.co=m.BMI.a2$coefficients[c(2,4:10)]
j.BMI.co=mj.BMI.a2$coefficients[c(2,4:10)]
c.BMI.prd = confint(m3.BMI.a2, method='Wald',level=0.95)[c(2:8,10)],]
m.BMI.prd = confint(m.BMI.a2,level=0.95)[c(2,4:10),]
j.BMI.prd = confint(mj.BMI.a2, level=0.95)[c(2,4:10),]
c.BMI.prd = confint(m3.BMI.a2, method='Wald',level=0.95)[c(2:8,10),]
m.BMI.prd = confint(m.BMI.a2,level=0.95)[c(2,4:10),]
j.BMI.prd = confint(mj.BMI.a2, level=0.95)[c(2,4:10),]
BMI.ci = data.frame(
Coefficients=c(j.BMI.co,m.BMI.co,c.BMI.co),rbind(j.BMI.prd,m.BMI.prd,c.BMI.prd),sample_vect,Dimension=rep(rownames(m.BMI.prd),3)
)
BMI.ci = data.frame(
Coefficients=c(j.BMI.co,m.BMI.co,c.BMI.co),rbind(j.BMI.prd,m.BMI.prd,c.BMI.prd),
c((rep(c('Japanese'),6)),(rep(c('Americans'),6)),(rep(c('Yerkes'),6))),
Dimension=rep(rownames(m.BMI.prd),3)
)
c.BMI.prd
m.BMI.prd
j.BMI.prd
c.BMI.co
m.BMI.co
j.BMI.co
BMI.ci = data.frame(
Coefficients=c(j.BMI.co,m.BMI.co,c.BMI.co),rbind(j.BMI.prd,m.BMI.prd,c.BMI.prd),
c((rep(c('Japanese'),8)),(rep(c('Americans'),8)),(rep(c('Yerkes'),8))),
Dimension=rep(rownames(m.BMI.prd),3)
)
colnames(BMI.ci)<-c("Coefficients",'lower',"upper","Sample","Dimension")
BMI.cf.gg <- ggplot(BMI.ci, aes(Sample,Coefficients, color=Sample)) +
geom_point(aes(shape=Sample),size=4, position=pd) +
#  scale_color_manual(name="Sample",values=c("coral","steelblue")) +
theme_bw() +
#  scale_x_continuous("Sample", breaks=1:length(Sample), labels=Sample) +
scale_y_continuous("Regression coefficients")   +
geom_errorbar(aes(ymin=lower,ymax=upper),width=0.1,position=pd) + facet_wrap(~ Dimension, ncol=2)
BMI.cf.gg
