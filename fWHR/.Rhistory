-cPers[ind,]$Indv + 32)/10
cPers[ind,]$Con <-
(-cPers[ind,]$impl-cPers[ind,]$defn-cPers[ind,]$reckl-cPers[ind,]$errc-cPers[ind,]$irri
+cPers[ind,]$pred-cPers[ind,]$aggr-cPers[ind,]$jeals-cPers[ind,]$dsor
- cPers[ind,]$Thot - cPers[ind,]$Dist - cPers[ind,]$Unper - cPers[ind,]$Quit - cPers[ind,]$clmy + 104)/14
cPers[ind,]$Agr <-
(cPers[ind,]$symp+cPers[ind,]$help+cPers[ind,]$sens+cPers[ind,]$prot+cPers[ind,]$gntl
+ cPers[ind,]$Conv)/6
cPers[ind,]$Neu <-
(-cPers[ind,]$stbl+cPers[ind,]$exct-cPers[ind,]$unem
- cPers[ind,]$Cool + cPers[ind,]$aut + 24)/5
cPers[ind,]$Opn <-
(cPers[ind,]$inqs+cPers[ind,]$invt
+ cPers[ind,]$Cur + cPers[ind,]$Innov) / 4
cPers$Dom_CZ <- scale(cPers$Dom)
cPers$Ext_CZ <- scale(cPers$Ext)
cPers$Con_CZ <- scale(cPers$Con)
cPers$Agr_CZ <- scale(cPers$Agr)
cPers$Neu_CZ <- scale(cPers$Neu)
cPers$Opn_CZ <- scale(cPers$Opn)
View(cPers)
chFP <- merge(chFP,cPers, by.x= "ID", "chimp")
View(chFP)
library(lme4)
View(cPers)
colnames(chFP)
colnames(chFP)[8] <- 'Age'
chFP$Sex = as.factor(chFP$Sex)
source('C:/Users/s1229179/GitHub/R/fWHR/mergeFacePers.R', echo=TRUE)
m1 <- lmer(fWHR ~ Age + I(Age^2) + I(Age^3) +
(1 | ID) + (1 | Location),
data = chFP)
m1 <- lmer(fWHR ~ Age + I(Age^2) + I(Age^3) +
(1 | ID) + (1 | location),
data = chFP)
m1 <- lmer(fHWR ~ Age + I(Age^2) + I(Age^3) +
(1 | ID) + (1 | location),
data = chFP)
chFP$fHWR = as.numeric(chFP$fHWR)
m1 <- lmer(fHWR ~ Age + I(Age^2) + I(Age^3) +
(1 | ID) + (1 | location),
data = chFP)
summary(m1)
m1 <- lmer(fHWR ~ s(Age) + s(I(Age^2)) + s(I(Age^3)) +
(1 | ID) + (1 | location),
data = chFP)
s <- function(x) {scale(x)}
m1 <- lmer(fHWR ~ s(Age) + s(I(Age^2)) + s(I(Age^3)) +
(1 | ID) + (1 | location),
data = chFP)
summary(m1)
m1 <- lmer(fHWR ~ s(Age) +# s(I(Age^2)) + s(I(Age^3)) +
(1 | ID) + (1 | location),
data = chFP)
summary(m1)
m2 <- lmer(fHWR ~ Age*Sex +
(1 | ID) + (1 | location),
data = chFP)
summary(m2)
m1 <- lmer(fHWR ~ s(Age) + s(I(Age^2)) + s(I(Age^3)) +
(1 | location) #+ (1 | ID)
,data = chFP)
summary(m1)
m2 <- lmer(fHWR ~ Age*Sex +
(1 | location) #+ (1 | ID)
,data = chFP)
summary(m2)
?aggregate
cPoints = read.csv(file = "ChimpfWHR.csv")
chFP <- cPoints[cPoints$fHWR!='N/A',]
chFP = chFP[,c(1:12)]
chFP <- aggregate(fHWR ~ ID, FUN = mean, data = chFP )
View(chFP)
chFP <- aggregate(chFP, by = c('ID'), FUN = mean)
chFP <- aggregate(chFP, by = list('ID'), FUN = mean)
chFP <- aggregate(chFP, by = chFP$ID, FUN = mean)
chFP <- aggregate(chFP, by = list(chFP$ID), FUN = mean)
warnings()
cPoints = read.csv(file = "ChimpfWHR.csv")
chFP <- cPoints[cPoints$fHWR!='N/A',]
chFP = chFP[,c(1:12)]
chFP <- aggregate(chFP, by = list(chFP$ID), FUN = mean)
View(chFP)
colnames(chFP)[8] <- 'Age'
chFP$Sex = as.factor(chFP$Sex)
chFP$fHWR = as.numeric(chFP$fHWR)
cPoints = read.csv(file = "ChimpfWHR.csv")
chFP <- cPoints[cPoints$fHWR!='N/A',]
chFP = chFP[,c(1:12)]
colnames(chFP)[8] <- 'Age'
chFP$Sex = as.factor(chFP$Sex)
chFP$fHWR = as.numeric(chFP$fHWR)
chFP <- aggregate(fHWR~ID+Age+Sex+location, chFP, sum)
cPoints = read.csv(file = "ChimpfWHR.csv")
chFP <- cPoints[cPoints$fHWR!='N/A',]
chFP = chFP[,c(1:12)]
colnames(chFP)[8] <- 'Age'
chFP$Sex = as.factor(chFP$Sex)
chFP$fHWR = as.numeric(chFP$fHWR)
chFP <- aggregate(fHWR~ID+Age+Sex+location, chFP, mean)
source('C:/Users/s1229179/GitHub/R/fWHR/mergeFacePers.R', echo=TRUE)
source('C:/Users/s1229179/GitHub/R/fWHR/mergeFacePers.R')
summary(m2)
mp1 <- lmer(fHWR ~ Age*Sex + Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) #+ (1 | ID)
,data = chFP)
summary(mp1)
confint(mp1)
mp1 <- lmer(fHWR ~ Age*Sex + Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
,data = chFP)
summary(mp1)
mp2 <- lmer(fHWR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
,data = chFP)
summary(mp2)
confint(mp2)
mp2 <- lmer(fHWR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) #+ (1 | ID)
,data = chFP)
summary(mp2)
confint(mp2)
cPoints = read.csv(file = "ChimpfWHR.csv")
chFP <- cPoints[cPoints$fHWR!='N/A',]
chFP = chFP[,c(1:12)]
colnames(chFP)[8] <- 'Age'
chFP$Sex = as.factor(chFP$Sex)
head(chFP$fHWR)
head(as.character(chFP$fHWR))
head(as.numeric(as.character(chFP$fHWR)))
chFP$fHWR = as.numeric(as.character(chFP$fHWR))
source('C:/Users/s1229179/GitHub/R/fWHR/mergeFacePers.R')
m2 <- lmer(fHWR ~ Age*Sex +
(1 | location) #+ (1 | ID)
,data = chFP)
summary(m2)
m2 <- lmer(fHWR ~ Age*Sex +
(1 | location) + (1 | ID)
,data = chFP)
summary(m2)
m1 <- lmer(fHWR ~ s(Age) + s(I(Age^2)) + s(I(Age^3)) +
(1 | location) + (1 | ID)
,data = chFP)
summary(m1)
m1 <- lmer(fHWR ~ s(Age) + s(I(Age^2)) + s(I(Age^3)) +
(1 | location) #+ (1 | ID)
,data = chFP)
summary(m1)
summary(m2)
m2 <- lmer(fHWR ~ Age*Sex +
(1 | location) #+ (1 | ID)
,data = chFP)
summary(m2)
confint(m2)
mp1 <- lmer(fHWR ~ Age*Sex + Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
,data = chFP)
summary(mp1)
mp2 <- lmer(fHWR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
,data = chFP)
summary(mp2)
mp1 <- lmer(fHWR ~ Age*Sex + Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) #+ (1 | ID)
,data = chFP)
summary(mp1)
mp2 <- lmer(fHWR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) #+ (1 | ID)
,data = chFP)
summary(mp2)
confint(mp2)
confint(mp1)
chFP <- aggregate(fHWR~ID+Age+Sex+location, chFP, mean)
chFP <- cPoints[cPoints$fHWR!='N/A',]
chFP = chFP[,c(1:12)]
colnames(chFP)[8] <- 'Age'
chFP$Sex = as.factor(chFP$Sex)
chFP$fHWR = as.numeric(as.character(chFP$fHWR))
chFP <- aggregate(cbind(fHWR,Age,Sex)~ID+location, chFP, mean)
View(cPoints)
m1 <- lmer(fHWR ~ s(Age) + s(I(Age^2)) + s(I(Age^3)) +
(1 | location) #+ (1 | ID)
,data = chFP)
summary(m1)
m2 <- lmer(fHWR ~ Age*Sex +
(1 | location) #+ (1 | ID)
,data = chFP)
summary(m2)
mp1 <- lmer(fHWR ~ Age*Sex + Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) #+ (1 | ID)
,data = chFP)
source('C:/Users/s1229179/GitHub/R/fWHR/mergeFacePers.R')
mp1 <- lmer(fHWR ~ Age*Sex + Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) #+ (1 | ID)
,data = chFP)
summary(mp1)
mp2 <- lmer(fHWR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) #+ (1 | ID)
,data = chFP)
summary(mp2)
confint(mp2)
source('C:/Users/s1229179/GitHub/R/fWHR/mergeFacePers.R')
mp1 <- lmer(fHWR ~ Age*Sex + Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) #+ (1 | ID)
,data = chFP)
summary(mp1)
mp1 <- lmer(fHWR ~ Age*Sex + Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
,data = chFP)
summary(mp1)
confint(mp1)
mp2 <- lmer(fHWR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
,data = chFP)
summary(mp2)
confint(mp2)
chFP <- aggregate(cbind(fHWR,Sex)~ID+location, chFP, mean) # need Yerkes ages?
chFP <- cPoints[cPoints$fHWR!='N/A',]
chFP = chFP[,c(1:12)]
colnames(chFP)[8] <- 'Age'
chFP$Sex = as.factor(chFP$Sex)
chFP$fHWR = as.numeric(as.character(chFP$fHWR))
chFP <- aggregate(cbind(fHWR,Sex)~ID+location, chFP, mean) # need Yerkes ages?
source('C:/Users/s1229179/GitHub/R/fWHR/mergeFacePers.R')
mp2 <- lmer(fHWR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) #+ (1 | ID)
,data = chFP)
summary(mp2)
confint(mp2)
source('C:/Users/s1229179/GitHub/R/fWHR/mergeFacePers.R')
m2 <- lmer(fHWR ~ Age*Sex +
(1 | location) #+ (1 | ID)
,data = chFP)
summary(m2)
mp1 <- lmer(fHWR ~ Age*Sex + Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) #+ (1 | ID)
,data = chFP)
summary(mp1)
mp2 <- lmer(fHWR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) #+ (1 | ID)
,data = chFP)
summary(mp2)
library(car)
Anova(mp1,mp2)
anova(mp1,mp2)
confint(mp2)
library(corrplor)
library(corrplot)
colnames(chFP)
corrplot(cor(chFP[,c(3,4,5,79,80,81,82,83,84)]))
corrplot(cor(chFP[,c(3,4,5,79,80,81,82,83,84)], method = 'number')
m1 <- lmer(fHWR ~ s(Age) + s(I(Age^2)) + s(I(Age^3)) +
(1 | location) #+ (1 | ID)
,data = chFP)
summary(m1)
# No age effects. Oversampling of older individuals?
m2 <- lmer(fHWR ~ Age*Sex +
(1 | location) #+ (1 | ID)
,data = chFP)
summary(m2)
confint(m2)
### Personality
mp1 <- lmer(fHWR ~ Age*Sex + Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) #+ (1 | ID)
,data = chFP)
summary(mp1)
confint(mp1)
mp2 <- lmer(fHWR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) #+ (1 | ID)
,data = chFP)
summary(mp2)
confint(mp2)
anova(mp1,mp2)
corrplot(cor(chFP[,c(3,4,5,79,80,81,82,83,84),]),  method = 'number')
m2 <- lmer(fHWR ~ Age*Sex +
(1 | location) #+ (1 | ID)
,data = chFP)
summary(m2)
confint(m2)
m2 <- lmer(fHWR ~ Sex +
(1 | location) #+ (1 | ID)
,data = chFP)
summary(m2)
corrplot(cor(chFP[,c(3,4,5,79,80,81,82,83,84),]),  method = 'number')
library(corrplot)
corrplot(cor(chFP[,c(3,4,5,79,80,81,82,83,84),]),  method = 'number')
m2 <- lmer(fHWR ~ Age*Sex +
(1 | location) #+ (1 | ID)
,data = chFP)
library(lme4)
library(car)
summary(m2)
m2 <- lmer(fHWR ~ Age*Sex +
(1 | location) #+ (1 | ID)
,data = chFP)
summary(m2)
load("~/GitHub/R/fWHR/.RData")
library(lme4)
library(car)
library(corrplot)
install.packages(c("lme4", "car", "corrplot"))
summary(m1)
library(lme4)
library(car)
library(corrplot)
summary(m1)
m1 <- lmer(fHWR ~ s(Age) + s(I(Age^2)) + s(I(Age^3)) +
(1 | location) #+ (1 | ID)
,data = chFP)
summary(m1)
mp2 <- lmer(fHWR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) #+ (1 | ID)
,data = chFP)
summary(mp2)
summary(mp2)
summary(mp1)
anova(mp1,mp2)
summary(m2)
mp2 <- lmer(fHWR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
,data = chFP)
library(lme4)
library(car)
library(corrplot)
mp2 <- lmer(fHWR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
,data = chFP)
summary(mp2)
mp1 <- lmer(fHWR ~ Age*Sex + Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
,data = chFP)
summary(mp1)
mp1 <- lmer(fHWR ~ Age+Sex + Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
,data = chFP)
summary(mp1)
library(alphahull)
library(tidyr)
cPoints = read.csv(file = "ChimpfWHR.csv")
View(cPoints)
BcPoints = cPoints[cPoints$location=='Bastrop',]
View(BcPoints)
BcPoints = BcPoints[cPoints$A!='',]
View(BcPoints)
BcPoints = cPoints[cPoints$location=='Bastrop',]
BcPoints = BcPoints[BcPoints$A!='',]
View(BcPoints)
BcPoints = BcPoints[c(-1,-2),]
=
BcPoints = cPoints[cPoints$location=='Bastrop',]
BcPoints = BcPoints[c(-1,-2),]
View(BcPoints)
?sample
bCh = cPoints[cPoints$location=='Bastrop',]
bCh = bCh[c(-1,-2),]
rm(BcPoints)
bCh = bCh[bCh$A!='X',c(14:20)]
View(bCh)
bCh = cPoints[cPoints$location=='Bastrop',]
bCh = bCh[c(-1,-2),]
sample(bCh$ID,16)
?randint
sample(1:10,16)
sample(1:10,16, replace=T)
bCh = bCh[bCh$A!='X',c(14:20)]
bCh <- separate(data = bCh, col = A, into = c("A.x", "A.y"), sep = "\\,")
bCh <- separate(data = bCh, col = B, into = c("B.x", "B.y"), sep = "\\,")
bCh <- separate(data = bCh, col = C, into = c("C.x", "C.y"), sep = "\\,")
bCh <- separate(data = bCh, col = D, into = c("D.x", "D.y"), sep = "\\,")
bCh <- separate(data = bCh, col = E, into = c("E.x", "E.y"), sep = "\\,")
bCh <- separate(data = bCh, col = F, into = c("F.x", "F.y"), sep = "\\,")
bCh <- separate(data = bCh, col = G, into = c("G.x", "G.y"), sep = "\\,")
bCh <- data.frame(lapply(bCh, function(x) as.numeric(x)))
tabl <- bCh
fWHRc <- NULL
for (i in seq_len(dim(tabl)[1])){
points <- matrix(c(c(tabl$C.x[i], tabl$D.x[i], tabl$E.x[i], tabl$F.x[i], tabl$G.x[i]),
c(tabl$C.y[i], tabl$D.y[i], tabl$E.y[i], tabl$F.y[i], tabl$G.y[i]))
,nrow = 5, ncol = 2)
fWHRc[i] =   fWHR(points, i)
}
bCh = cPoints[cPoints$location=='Bastrop',]
bCh = bCh[c(-1,-2),]
bCh$ID[c(16, 24, 56, 60)]
bCh$ID[c(27, 28, 32, 44, 72, 74)]
library(alphahull)
library(tidyr)
cPoints = read.csv(file = "ChimpfWHR.csv")
sample(bCh$ID,16)
bCh = cPoints[cPoints$location=='Bastrop',]
bCh = bCh[c(-1,-2),]
View(bCh)
cPoints = read.csv(file = "ChimpfWHR.csv")
bCh = cPoints[cPoints$location=='Bastrop',]
bCh = bCh[c(-1,-2),]
View(bCh)
bCh = bCh[bCh$A!='X',c(14:20)]
View(bCh)
bCh = cPoints[cPoints$location=='Bastrop',]
bCh = bCh[c(-1,-2),]
bCh = bCh[bCh$A!='X',]
View(bCh)
duplicated(bCh$ID) | duplicated(bCh$ID[nrow(bCh):1, ])[nrow(bCh):1]
duplicated(bCh$ID) | duplicated(bCh$ID[nrow(bCh):1])[nrow(bCh):1]
bCh = bCh[,c(14:20)]
bCh <- separate(data = bCh, col = A, into = c("A.x", "A.y"), sep = "\\,")
bCh <- separate(data = bCh, col = B, into = c("B.x", "B.y"), sep = "\\,")
bCh <- separate(data = bCh, col = C, into = c("C.x", "C.y"), sep = "\\,")
bCh <- separate(data = bCh, col = D, into = c("D.x", "D.y"), sep = "\\,")
bCh <- separate(data = bCh, col = E, into = c("E.x", "E.y"), sep = "\\,")
bCh <- separate(data = bCh, col = F, into = c("F.x", "F.y"), sep = "\\,")
bCh <- separate(data = bCh, col = G, into = c("G.x", "G.y"), sep = "\\,")
bCh <- data.frame(lapply(bCh, function(x) as.numeric(x)))
tabl <- bCh
fWHRc <- NULL
for (i in seq_len(dim(tabl)[1])){
points <- matrix(c(c(tabl$C.x[i], tabl$D.x[i], tabl$E.x[i], tabl$F.x[i], tabl$G.x[i]),
c(tabl$C.y[i], tabl$D.y[i], tabl$E.y[i], tabl$F.y[i], tabl$G.y[i]))
,nrow = 5, ncol = 2)
fWHRc[i] =   fWHR(points, i)
}
bCH[60,]
bCh[60,]
bCh$ID[c(16, 24, 56, 60)]
bCh = cPoints[cPoints$location=='Bastrop',]
bCh = bCh[c(-1,-2),]
bCh$ID[c(16, 24, 56, 60)]
bCh = cPoints[cPoints$location=='Bastrop',]
bCh = bCh[c(-1,-2),]
cPoints = read.csv(file = "ChimpfWHR.csv")
bCh = cPoints[cPoints$location=='Bastrop',]
bCh = bCh[c(-1,-2),]
cPoints = read.csv(file = "ChimpfWHR.csv")
cPoints = read.csv(file = "ChimpfWHR.csv")
bCh = cPoints[cPoints$location=='Bastrop',]
bCh = bCh[c(-1,-2),]
View(bCh)
bCH4ID
bCH$ID
bCh$ID
bChsub = bCh[c(88:103),]
View(bChsub)
df2fWHR <- function(yCh){
yCh = yCh[yCh$A!='X',c(14:20)]
yCh <- separate(data = yCh, col = A, into = c("A.x", "A.y"), sep = "\\,")
yCh <- separate(data = yCh, col = B, into = c("B.x", "B.y"), sep = "\\,")
yCh <- separate(data = yCh, col = C, into = c("C.x", "C.y"), sep = "\\,")
yCh <- separate(data = yCh, col = D, into = c("D.x", "D.y"), sep = "\\,")
yCh <- separate(data = yCh, col = E, into = c("E.x", "E.y"), sep = "\\,")
yCh <- separate(data = yCh, col = F, into = c("F.x", "F.y"), sep = "\\,")
yCh <- separate(data = yCh, col = G, into = c("G.x", "G.y"), sep = "\\,")
yCh <- data.frame(lapply(yCh, function(x) as.numeric(x)))
tabl <- yCh
fWHRc <- NULL
for (i in seq_len(dim(tabl)[1])){
points <- matrix(c(c(tabl$C.x[i], tabl$D.x[i], tabl$E.x[i], tabl$F.x[i], tabl$G.x[i]),
c(tabl$C.y[i], tabl$D.y[i], tabl$E.y[i], tabl$F.y[i], tabl$G.y[i]))
,nrow = 5, ncol = 2)
fWHRc[i] =   fWHR(points, i)
}
return(fWHRc)
}
fWHR.Bsub = df2fWHR(bChsub)
colnanes(yCh)
colnames(yCh)
colnames(yPoints)
colnames(cPoints)
df2fWHR <- function(yCh){
yCh = yCh[yCh$A!='X',c(2,14:20)]
yCh <- separate(data = yCh, col = A, into = c("A.x", "A.y"), sep = "\\,")
yCh <- separate(data = yCh, col = B, into = c("B.x", "B.y"), sep = "\\,")
yCh <- separate(data = yCh, col = C, into = c("C.x", "C.y"), sep = "\\,")
yCh <- separate(data = yCh, col = D, into = c("D.x", "D.y"), sep = "\\,")
yCh <- separate(data = yCh, col = E, into = c("E.x", "E.y"), sep = "\\,")
yCh <- separate(data = yCh, col = F, into = c("F.x", "F.y"), sep = "\\,")
yCh <- separate(data = yCh, col = G, into = c("G.x", "G.y"), sep = "\\,")
yCh <- data.frame(lapply(yCh, function(x) as.numeric(x)))
tabl <- yCh
fWHRc <- NULL
for (i in seq_len(dim(tabl)[1])){
points <- matrix(c(c(tabl$C.x[i], tabl$D.x[i], tabl$E.x[i], tabl$F.x[i], tabl$G.x[i]),
c(tabl$C.y[i], tabl$D.y[i], tabl$E.y[i], tabl$F.y[i], tabl$G.y[i]))
,nrow = 5, ncol = 2)
fWHRc[i] =   fWHR(points, i)
}
fWHRc = cbind(yCh$ID, fWHRc)
return(fWHRc)
}
fWHR.Bsub = df2fWHR(bChsub)
View(fWHR.Bsub)
df2fWHR <- function(yCh){
yCh = yCh[yCh$A!='X',c(2,14:20)]
yCh <- separate(data = yCh, col = A, into = c("A.x", "A.y"), sep = "\\,")
yCh <- separate(data = yCh, col = B, into = c("B.x", "B.y"), sep = "\\,")
yCh <- separate(data = yCh, col = C, into = c("C.x", "C.y"), sep = "\\,")
yCh <- separate(data = yCh, col = D, into = c("D.x", "D.y"), sep = "\\,")
yCh <- separate(data = yCh, col = E, into = c("E.x", "E.y"), sep = "\\,")
yCh <- separate(data = yCh, col = F, into = c("F.x", "F.y"), sep = "\\,")
yCh <- separate(data = yCh, col = G, into = c("G.x", "G.y"), sep = "\\,")
yCh <- data.frame(lapply(yCh, function(x) as.numeric(x)))
tabl <- yCh
fWHRc <- data.frame()
for (i in seq_len(dim(tabl)[1])){
points <- matrix(c(c(tabl$C.x[i], tabl$D.x[i], tabl$E.x[i], tabl$F.x[i], tabl$G.x[i]),
c(tabl$C.y[i], tabl$D.y[i], tabl$E.y[i], tabl$F.y[i], tabl$G.y[i]))
,nrow = 5, ncol = 2)
fWHRc[i] =   fWHR(points, i)
}
fWHRc = cbind(yCh$ID, fWHRc)
return(fWHRc)
}
fWHR.Bsub = df2fWHR(bChsub)
