summary(mp3.t) # Nothing for troglodytes.
mp3.t = lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
#,data = chFP[chFP$Subspecies=='troglodytes',]
,data = chFP[adults&chFP$Subspecies=='troglodytes'&chFP$Sex==1,]
)
summary(mp3.t) # Nothing for troglodytes.
table(chFP$Subspecies,chFP$Sex)
mp3.t = lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
#(1 | location) + (1 | ID)
#,data = chFP[chFP$Subspecies=='troglodytes',]
,data = chFP[adults&chFP$Subspecies=='troglodytes'&chFP$Sex==1,]
)
mp3.t = lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ #+
#(1 | location) + (1 | ID)
#,data = chFP[chFP$Subspecies=='troglodytes',]
,data = chFP[adults&chFP$Subspecies=='troglodytes'&chFP$Sex==1,]
)
mp3.t = lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
#(1 | location) +
(1 | ID)
#,data = chFP[chFP$Subspecies=='troglodytes',]
,data = chFP[adults&chFP$Subspecies=='troglodytes'&chFP$Sex==1,]
)
summary(mp3.t) # Nothing for troglodytes.
mp3.v = lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
#,data = chFP[chFP$Subspecies=='verus',]
,data = chFP[adults&chFP$Subspecies=='verus',]
)
mp4.f = lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
,data = chFP[indx&(chFP$Subspecies=='verus'&chFP$Sex==0),]
,control=lmerControl(optimizer="Nelder_Mead")
)
mp4.m = lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
,data = chFP[indx&(chFP$Subspecies=='verus'&chFP$Sex==1),]
)
summary(mp4.f)
summary(mp4.m)
summary(mp3.v)
confint(mp4.f, method='profile')
summary(mp4.f)
set.seed(1234567)
set.seed(1234567)
mp4.f = lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
,data = chFP[indx&(chFP$Subspecies=='verus'&chFP$Sex==0),]
,control=lmerControl(optimizer="Nelder_Mead")
)
mp4.m = lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
,data = chFP[indx&(chFP$Subspecies=='verus'&chFP$Sex==1),]
)
summary(mp4.f)
confint(mp4.f, method='profile')
summary(mp4.m)
confint(mp4.m, method='profile')
summary(mp3.v)
set.seed(1234567)
mp3.t = lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) +
(1 | ID)
,data = chFP[adults&chFP$Subspecies=='troglodytes',]
#,data = chFP[adults&chFP$Subspecies=='troglodytes'&chFP$Sex==1,]
)
mp3.v = lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
#,data = chFP[chFP$Subspecies=='verus',]
,data = chFP[adults&chFP$Subspecies=='verus',]
)
summary(mp3.t) # Nothing for troglodytes.
summary(mp3.v)
confint(mp3.v, method='profile')
library(lme4)
library(car)
library(corrplot)
library(plyr)
library(numDeriv)
library(RCurl)
library(optimx)
adults = (chFP$Sex==0 & chFP$Age>7) | (chFP$Sex==1 & chFP$Age>9) | (chFP$ID == 'Gage') |
(chFP$ID == 'Lennon')
adults[is.na(adults)] = TRUE
m0 <- lmer(fWHR ~ 1 +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
,data=chFP[adults,]
)
summary(m0)
m0.0 <- lmer(fWHR ~ 1 +
(1 | location) + (1 | Subspecies)
,data=chFP[adults,]
)
summary(m0.0)
m1 <- lmer(fWHR ~ s(Age) + s(I(Age^2)) + s(I(Age^3)) +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
,data = chFP[adults,]
)
summary(m1)
m2 <- lmer(fWHR ~ Age*Sex +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
,data = chFP[adults,]
)
summary(m2)
mp1 <- lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
,data = chFP[adults,]
)
summary(mp1)
levels(chFP$ID)
levels(chFP$ID[adults])
count(chFP$ID[adults])
adults
adults = (chFP$Sex==0 & chFP$Age>7) | (chFP$Sex==1 & chFP$Age>9) | (chFP$ID == 'Gage') |
(chFP$ID == 'Lennon')
View(chFP[adults,])
adults = (chFP$Sex==0 & chFP$Age>7) | (chFP$Sex==1 & chFP$Age>9) | (chFP$ID == 'Gage') |
(chFP$ID == 'Lennon')
adults[is.na(adults)] = TRUE
View(chFP[adults,])
View(chFP)
View(chFP[adults,])
adults = (chFP$Sex==0 & chFP$Age>7) | (chFP$Sex==1 & chFP$Age>9) |
(as.character(chFP$ID) == 'Gage') |
(as.character(chFP$ID) == 'Lennon')
adults[is.na(adults)] = TRUE
View(chFP[adults,])
as.character(chFP$ID)
as.character(chFP$ID)=='Gage'
as.character(chFP$ID)=='Lennon'
(chFP$Sex==0 & chFP$Age>7) | (chFP$Sex==1 & chFP$Age>9) |
(as.character(chFP$ID) == 'Gage') |   # 75
(as.character(chFP$ID) == 'Lennon')
(chFP$Sex==0 & chFP$Age>7) | (chFP$Sex==1 & chFP$Age>9) |
(as.character(chFP$ID) != 'Gage') |   # 75
(as.character(chFP$ID) != 'Lennon')   # 130, 131
adults = (chFP$Sex==0 & chFP$Age>7) | (chFP$Sex==1 & chFP$Age>9) &
((as.character(chFP$ID) != 'Gage') |   # 75
(as.character(chFP$ID) != 'Lennon'))   # 130, 131 # This is a good place to pull out Lennon
View(chFP[adults,])
(chFP$Sex==0 & chFP$Age>7) | (chFP$Sex==1 & chFP$Age>9) &
((as.character(chFP$ID) != 'Gage') |   # 75
(as.character(chFP$ID) != 'Lennon'))
adults = (chFP$Sex==0 & chFP$Age>7) | (chFP$Sex==1 & chFP$Age>9)
adults
adults[is.na(adults)] = TRUE
adults
adults = adults & (as.character(chFP$ID) != 'Gage')
adults
count(adults)
count(adults)
adults = (chFP$Sex==0 & chFP$Age>7) | (chFP$Sex==1 & chFP$Age>9)
adults[is.na(adults)] = TRUE
count(adults)
count(adults)
adults = adults & (as.character(chFP$ID) != 'Gage')
adults = adults & (as.character(chFP$ID) != 'Lennon')
count(adults)
adults = (chFP$Sex==0 & chFP$Age>7) | (chFP$Sex==1 & chFP$Age>9)
adults[is.na(adults)] = TRUE
count(adults)
adults = adults & (as.character(chFP$ID) != 'Gage') # 75
count(adults)
adults = adults & (as.character(chFP$ID) != 'Lennon') # This is a good place to pull out Lennon (130, 131)
count(adults)
m0 <- lmer(fWHR ~ 1 +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
,data=chFP[adults,]
)
summary(m0)
m0.0 <- lmer(fWHR ~ 1 +
(1 | location) + (1 | Subspecies)
,data=chFP[adults,]
)
summary(m0.0)
m1 <- lmer(fWHR ~ s(Age) + s(I(Age^2)) + s(I(Age^3)) +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
,data = chFP[adults,]
)
summary(m1)
m2 <- lmer(fWHR ~ Age*Sex +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
,data = chFP[adults,]
)
summary(m2)
mp1 <- lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
,data = chFP[adults,]
)
summary(mp1)
mp2.f <- lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
,data = chFP[adults&chFP$Sex==0,]
)
mp2.m <- lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID:Subspecies) + (1 | Subspecies)
,data = chFP[adults&chFP$Sex==1,]
)
summary(mp2.f)
summary(mp2.m)
confint(mp2.f, method='profile')
confint(mp2.m, method='profile')
count(chFP$Subspecies)
table(chFP$Subspecies,chFP$Sex)
set.seed(1234567)
mp3.t = lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) +
(1 | ID)
,data = chFP[adults&chFP$Subspecies=='troglodytes',]
#,data = chFP[adults&chFP$Subspecies=='troglodytes'&chFP$Sex==1,]
)
mp3.v = lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
#,data = chFP[chFP$Subspecies=='verus',]
,data = chFP[adults&chFP$Subspecies=='verus',]
)
summary(mp3.t) # Nothing for troglodytes.
summary(mp3.v)
confint(mp3.v, method='profile')
confint(mp3.v, method='profile')
set.seed(1234567)
confint(mp3.v, method='profile')
set.seed(1234567)
mp4.f = lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
,data = chFP[indx&(chFP$Subspecies=='verus'&chFP$Sex==0),]
,control=lmerControl(optimizer="Nelder_Mead")
)
mp4.m = lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
,data = chFP[indx&(chFP$Subspecies=='verus'&chFP$Sex==1),]
)
summary(mp4.f)
confint(mp4.f, method='profile')
summary(mp4.m)
confint(mp4.m, method='profile')
count(adults)
adults
summary(mp3.v)
confint(mp3.v, method='profile')
confint(mp4.m, method='profile')
mean(table(chFP$ID))
sd(table(chFP$ID))
table(droplevels(chFP$ID[chFP$location=='Edinburgh']))
sum(table(droplevels(chFP$ID[chFP$location=='Bastrop'])))
table(droplevels(chFP$ID[chFP$location=='Japan'])) #
colnames(chFP)
corrplot(cor(chFP[,c(8,12,14,15,16,17,18,19),],use="pairwise.complete.obs")
,  method = 'number')
library(lme4)
library(car)
library(corrplot)
library(numDeriv)
library(plyr)
library(RCurl)
library(optimx)
corrplot(cor(chFP[,c(8,12,14,15,16,17,18,19),],use="pairwise.complete.obs")
,  method = 'number')
corrplot(cor(chFP[chFP$Sex==0,c(8,12,14,15,16,17,18,19),],use="pairwise.complete.obs"),  method = 'number')
levels(chFP$Subspecies)
chFP$Subspecies[chFP$Subspecies=='hybrid'] = 'unknown'
table(chFP$Subspecies[!duplicated(chFP$ID)])
table(chFP$Sex[!duplicated(chFP$ID)&chFP$Subspecies=='verus'])
table(chFP$Sex[!duplicated(chFP$ID)&chFP$Subspecies=='schweinfurthii'])
table(chFP$Sex[!duplicated(chFP$ID)&chFP$Subspecies=='ellioti'])
table(chFP$Sex[!duplicated(chFP$ID)&chFP$Subspecies=='troglodytes'])
table(chFP$Sex[!duplicated(chFP$ID)&chFP$Subspecies=='unknown'])
adults = (chFP$Sex==0 & chFP$Age>7) | (chFP$Sex==1 & chFP$Age>9)
adults[is.na(adults)] = TRUE
count(adults)
adults = adults & (as.character(chFP$ID) != 'Gage') # 75
count(adults)
adults = adults & (as.character(chFP$ID) != 'Lennon') # This is a good place to pull out Lennon (130, 131)
count(adults)
adults
View(chFP[adults,]
## Base: just subspecies random effects
m0 <- lmer(fWHR ~ 1 +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
,data=chFP[adults,]
)
summary(m0)
confint(m0,method='profile')
View(chFP[adults,])
count(adults)
set.seed(1234567)
m0 <- lmer(fWHR ~ 1 +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
,data=chFP[adults,]
)
summary(m0)
confint(m0,method='profile')
ranef(m0)
# Sensitivity of subspecies to individual
m0.0 <- lmer(fWHR ~ 1 +
(1 | location) + (1 | Subspecies)
,data=chFP[adults,]
)
summary(m0.0)
confint(m0.0,method='profile')
R.version
install.packages(c("backports", "BDgraph", "BH", "blavaan", "callr", "caret", "coin", "compareGroups", "curl", "dbplyr", "ddalpha", "devtools", "dfoptim", "digest", "dotCall64", "DRR", "DT", "ellipse", "fields", "forcats", "foreach", "ggeffects", "git2r", "glmmTMB", "HardyWeinberg", "haven", "hexbin", "Hmisc", "hms", "htmlTable", "htmlwidgets", "irlba", "iterators", "knitr", "lava", "lme4", "LTRCtrees", "lubridate", "MASS", "MatchIt", "matrixStats", "MCMCpack", "msm", "MuMIn", "nonnest2", "openssl", "party", "partykit", "plotrix", "powerSurvEpi", "quantreg", "recipes", "reprex", "reshape2", "rgl", "rlang", "rms", "rockchalk", "rpf", "rprojroot", "segmented", "shinyjs", "sjlabelled", "sjmisc", "sjPlot", "sjstats", "snakecase", "sp", "spam", "spatstat", "StanHeaders", "stargazer", "stringr", "survey", "survminer", "tibble", "tidyr", "tidyselect", "timeDate", "TMB", "VGAM", "viridis", "viridisLite", "visNetwork", "withr", "XML", "xml2", "yaml", "zoo"))
install.packages(c("MASS", "mgcv", "nlme", "rpart"), lib="C:/R/R-3.4.3rc/library")
install.packages(c("MASS", "mgcv", "nlme", "rpart"), lib = "C:/R/R-3.4.3rc/library")
install.packages(c("backports", "BDgraph", "BH", "blavaan", "callr", "caret", "coin", "compareGroups", "curl", "dbplyr", "ddalpha", "devtools", "dfoptim", "digest", "dotCall64", "DRR", "DT", "ellipse", "fields", "forcats", "foreach", "ggeffects", "git2r", "glmmTMB", "HardyWeinberg", "haven", "hexbin", "Hmisc", "hms", "htmlTable", "htmlwidgets", "irlba", "iterators", "knitr", "lava", "lme4", "LTRCtrees", "lubridate", "MASS", "MatchIt", "matrixStats", "MCMCpack", "msm", "MuMIn", "nonnest2", "openssl", "party", "partykit", "plotrix", "powerSurvEpi", "quantreg", "recipes", "reprex", "reshape2", "rgl", "rlang", "rms", "rockchalk", "rpf", "rprojroot", "segmented", "shinyjs", "sjlabelled", "sjmisc", "sjPlot", "sjstats", "snakecase", "sp", "spam", "spatstat", "StanHeaders", "stargazer", "stringr", "survey", "survminer", "tibble", "tidyr", "tidyselect", "timeDate", "TMB", "VGAM", "viridis", "viridisLite", "visNetwork", "withr", "XML", "xml2", "yaml", "zoo"))
library(lme4)
library(car)
library(corrplot)
library(plyr)
library(numDeriv)
library(RCurl)
library(optimx)
s <- function(x) {scale(x)}
set.seed(1234567)
chFP = read.csv('chimpFacesPersDemos.csv')
chFP = chFP[,-1]
chFP = chFP[!is.na(chFP$fWHR),]
levels(chFP$ID)
table(droplevels(chFP$ID[chFP$location=='Edinburgh'])) # Number of Edi chimps and images/chimp
sum(table(droplevels(chFP$ID[chFP$location=='Bastrop']))) # Number of Bastrop chimps
table(droplevels(chFP$ID[chFP$location=='Japan'])) # NUmber of Japanese chimps and images/
corrplot(cor(chFP[,c(8,12,14,15,16,17,18,19),],use="pairwise.complete.obs")
,  method = 'number')
corrplot(cor(chFP[chFP$Sex==0,c(8,12,14,15,16,17,18,19),],use="pairwise.complete.obs"),  method = 'number')
corrplot(cor(chFP[chFP$Sex==1,c(8,12,14,15,16,17,18,19),],use="pairwise.complete.obs"),  method = 'number')
chFP$Subspecies[chFP$Subspecies=='hybrid'] = 'unknown'
table(chFP$Subspecies[!duplicated(chFP$ID)])
table(chFP$Sex[!duplicated(chFP$ID)&chFP$Subspecies=='verus'])
table(chFP$Sex[!duplicated(chFP$ID)&chFP$Subspecies=='schweinfurthii'])
table(chFP$Sex[!duplicated(chFP$ID)&chFP$Subspecies=='ellioti'])
table(chFP$Sex[!duplicated(chFP$ID)&chFP$Subspecies=='troglodytes'])
table(chFP$Sex[!duplicated(chFP$ID)&chFP$Subspecies=='unknown'])
adults = (chFP$Sex==0 & chFP$Age>7) | (chFP$Sex==1 & chFP$Age>9)
adults[is.na(adults)] = TRUE
adults = adults & (as.character(chFP$ID) != 'Gage') # 75
adults = adults & (as.character(chFP$ID) != 'Lennon') # This is a good place to pull out Lennon (130, 131)
set.seed(1234567)
m0 <- lmer(fWHR ~ 1 +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
,data=chFP[adults,]
)
confint(m0,method='profile')
summary(m0.0)
summary(m0)
table(chFP$Subspecies[!duplicated(chFP$ID)])
s <- function(x) {scale(x)}
set.seed(1234567)
m0 <- lmer(fWHR ~ 1 +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
,data=chFP[adults,]
)
summary(m0)
confint(m0,method='profile')
ranef(m0)
# Sensitivity of subspecies to individual
m0.0 <- lmer(fWHR ~ 1 +
(1 | location) + (1 | Subspecies)
,data=chFP[adults,]
)
summary(m0.0)
confint(m0.0,method='profile')
ranef(m0.0)
set.seed(1234567)
m1 <- lmer(fWHR ~ s(Age) + s(I(Age^2)) + s(I(Age^3)) +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
,data = chFP[adults,]
)
summary(m1)
confint(m1, method='profile')
set.seed(1234567)
m2 <- lmer(fWHR ~ Age*Sex +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
,data = chFP[adults,]
)
summary(m2)
confint(m2, method='profile')
set.seed(1234567)
mp1 <- lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
,data = chFP[adults,]
)
summary(mp1)
confint(mp1, method='profile')
set.seed(1234567)
mp2.f <- lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
,data = chFP[adults&chFP$Sex==0,]
)
mp2.m <- lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID:Subspecies) + (1 | Subspecies)
,data = chFP[adults&chFP$Sex==1,]
)
summary(mp2.f)
summary(mp2.m)
confint(mp2.f, method='profile')
confint(mp2.m, method='profile')
count(chFP$Subspecies)
table(chFP$Subspecies,chFP$Sex)
set.seed(1234567)
mp3.t = lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) +
(1 | ID)
,data = chFP[adults&chFP$Subspecies=='troglodytes',]
)
mp3.v = lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
#,data = chFP[chFP$Subspecies=='verus',]
,data = chFP[adults&chFP$Subspecies=='verus',]
)
summary(mp3.t) # Nothing for troglodytes.
summary(mp3.v)
confint(mp3.t, method='profile')
confint(mp3.t, method='Wald')
confint(mp3.v, method='profile')
confint(mp3.v, method='boot')
confint(mp3.v, method='Wald')
set.seed(1234567)
mp4.f = lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
,data = chFP[indx&(chFP$Subspecies=='verus'&chFP$Sex==0),]
,control=lmerControl(optimizer="Nelder_Mead")
)
mp4.m = lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
,data = chFP[indx&(chFP$Subspecies=='verus'&chFP$Sex==1),]
)
summary(mp4.f)
confint(mp4.f, method='profile')
confint(mp4.f, method='boot')
confint(mp4.f, method='Wald')
confint(mp4.f, method='profile')
set.seed(1234567)
mp4.f = lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
,data = chFP[indx&(chFP$Subspecies=='verus'&chFP$Sex==0),]
,control=lmerControl(optimizer="Nelder_Mead")
)
mp4.m = lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
,data = chFP[indx&(chFP$Subspecies=='verus'&chFP$Sex==1),]
)
summary(mp4.f)
confint(mp4.f, method='profile')
summary(mp4.m)
confint(mp4.m, method='profile')
set.seed(123456789)
mp3.t = lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) +
(1 | ID)
,data = chFP[adults&chFP$Subspecies=='troglodytes',]
)
mp3.v = lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
#,data = chFP[chFP$Subspecies=='verus',]
,data = chFP[adults&chFP$Subspecies=='verus',]
)
summary(mp3.t) # Nothing for troglodytes.
summary(mp3.v)
confint(mp3.t, method='Wald') # Profile not optimal
confint(mp3.v, method='profile')
source('~/GitHub/R/fWHR/chimp_fWHRmodels.R')
set.seed(1234567)
mp4.f = lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
,data = chFP[indx&(chFP$Subspecies=='verus'&chFP$Sex==0),]
,control=lmerControl(optimizer="Nelder_Mead")
)
library(lme4)
library(car)
library(corrplot)
library(numDeriv)
library(plyr)
library(RCurl)
library(optimx)
set.seed(1234567)
mp4.f = lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
,data = chFP[indx&(chFP$Subspecies=='verus'&chFP$Sex==0),]
,control=lmerControl(optimizer="Nelder_Mead")
)
mp4.m = lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
,data = chFP[indx&(chFP$Subspecies=='verus'&chFP$Sex==1),]
)
summary(mp4.f)
confint(mp4.f, method='profile')
summary(mp4.m)
confint(mp4.m, method='profile')
library(psych)
library(ggplot2)
library(data.table)
library(lavaan)
library(dplyr)
library(semPlot)
library(DiagrammeR)
library(DiagrammeRsvg)
msd <- function(column){
m = mean(column, na.rm=T)
s = sd(column, na.rm=T)
paste0(format(m, digits=3), " (", format(s, digits=3), ")")
}
long.mmse.g[long.mmse.g$lbc36no %in% noms] %>%
ggplot(aes(x=hba1c+4,y=gm))+ #, colour=diab)) +
facet_grid(. ~ wave) +
#facet_wrap(facets='wave')
scale_x_log10() +
stat_density_2d(aes(fill = ..level..), geom = "polygon") +
#stat_density_2d(geom = "point", aes(size = ..density..), n = 20, contour = FALSE)
#  stat_density_2d(geom = "raster", aes(fill = ..density..), contour = FALSE)
stat_smooth(method='lm',se=F, aes(fill=hba1c), fullrange=T)
long.hb = melt(lbc, measure.vars=c('hba1c_w1','hba1c_w2','hba1c_w3','hba1c_w4') )
