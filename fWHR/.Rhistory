i = 30
points <- matrix(c(c(tabl$C.x[i], tabl$D.x[i], tabl$E.x[i], tabl$F.x[i], tabl$G.x[i]),
c(tabl$C.y[i], tabl$D.y[i], tabl$E.y[i], tabl$F.y[i], tabl$G.y[i]))
,nrow = 5, ncol = 2)
fWHR1[i] = fWHR(points)
fWHR()
fWHR1
for (i in seq_len(dim(tabl)[1])){
#i = 30
points <- matrix(c(c(tabl$C.x[i], tabl$D.x[i], tabl$E.x[i], tabl$F.x[i], tabl$G.x[i]),
c(tabl$C.y[i], tabl$D.y[i], tabl$E.y[i], tabl$F.y[i], tabl$G.y[i]))
,nrow = 5, ncol = 2)
fWHR1[i] = fWHR(points)
}
fWHR1
fWHR1 <- NULL
for (i in seq_len(dim(tabl)[1])){
#i = 30
points <- matrix(c(c(tabl$C.x[i], tabl$D.x[i], tabl$E.x[i], tabl$F.x[i], tabl$G.x[i]),
c(tabl$C.y[i], tabl$D.y[i], tabl$E.y[i], tabl$F.y[i], tabl$G.y[i]))
,nrow = 5, ncol = 2)
fWHR1[i] = fWHR(points)
}
fWHR1
i = 23
points <- matrix(c(c(tabl$C.x[i], tabl$D.x[i], tabl$E.x[i], tabl$F.x[i], tabl$G.x[i]),
c(tabl$C.y[i], tabl$D.y[i], tabl$E.y[i], tabl$F.y[i], tabl$G.y[i]))
,nrow = 5, ncol = 2)
fWHR(points)
i = 24
points <- matrix(c(c(tabl$C.x[i], tabl$D.x[i], tabl$E.x[i], tabl$F.x[i], tabl$G.x[i]),
c(tabl$C.y[i], tabl$D.y[i], tabl$E.y[i], tabl$F.y[i], tabl$G.y[i]))
,nrow = 5, ncol = 2)
fWHR(points)
i = 26
points <- matrix(c(c(tabl$C.x[i], tabl$D.x[i], tabl$E.x[i], tabl$F.x[i], tabl$G.x[i]),
c(tabl$C.y[i], tabl$D.y[i], tabl$E.y[i], tabl$F.y[i], tabl$G.y[i]))
,nrow = 5, ncol = 2)
fWHR(points)
i = 27
points <- matrix(c(c(tabl$C.x[i], tabl$D.x[i], tabl$E.x[i], tabl$F.x[i], tabl$G.x[i]),
c(tabl$C.y[i], tabl$D.y[i], tabl$E.y[i], tabl$F.y[i], tabl$G.y[i]))
,nrow = 5, ncol = 2)
fWHR(points)
i = 28
points <- matrix(c(c(tabl$C.x[i], tabl$D.x[i], tabl$E.x[i], tabl$F.x[i], tabl$G.x[i]),
c(tabl$C.y[i], tabl$D.y[i], tabl$E.y[i], tabl$F.y[i], tabl$G.y[i]))
,nrow = 5, ncol = 2)
fWHR(points)
i = 29
points <- matrix(c(c(tabl$C.x[i], tabl$D.x[i], tabl$E.x[i], tabl$F.x[i], tabl$G.x[i]),
c(tabl$C.y[i], tabl$D.y[i], tabl$E.y[i], tabl$F.y[i], tabl$G.y[i]))
,nrow = 5, ncol = 2)
fWHR(points)
tabl$monkey..photo.id[i]
View(points)
dfOHSU1 <- read.csv("ORmacaq1.csv", header=T)
dfOHSU1 <- separate(data = dfOHSU1, col = A, into = c("A.x", "A.y"), sep = "\\,")
dfOHSU1 <- separate(data = dfOHSU1, col = B, into = c("B.x", "B.y"), sep = "\\,")
dfOHSU1 <- separate(data = dfOHSU1, col = C, into = c("C.x", "C.y"), sep = "\\,")
dfOHSU1 <- separate(data = dfOHSU1, col = D, into = c("D.x", "D.y"), sep = "\\,")
dfOHSU1 <- separate(data = dfOHSU1, col = E, into = c("E.x", "E.y"), sep = "\\,")
dfOHSU1 <- separate(data = dfOHSU1, col = F, into = c("F.x", "F.y"), sep = "\\,")
dfOHSU1 <- separate(data = dfOHSU1, col = G, into = c("G.x", "G.y"), sep = "\\,")
dfOHSU1[,c(2:15)] <- as.numeric(unlist(dfOHSU1[,c(2:15)]))
tabl <- dfOHSU1
fWHR1 <- NULL
for (i in seq_len(dim(tabl)[1])){
#i = 29
points <- matrix(c(c(tabl$C.x[i], tabl$D.x[i], tabl$E.x[i], tabl$F.x[i], tabl$G.x[i]),
c(tabl$C.y[i], tabl$D.y[i], tabl$E.y[i], tabl$F.y[i], tabl$G.y[i]))
,nrow = 5, ncol = 2)
fWHR1[i] =   fWHR(points)
}
fWHR1
tabl <- dfOHSU1
fWHR1 <- NULL
for (i in seq_len(dim(tabl)[1])){
#i = 29
points <- matrix(c(c(tabl$C.x[i], tabl$D.x[i], tabl$E.x[i], tabl$F.x[i], tabl$G.x[i]),
c(tabl$C.y[i], tabl$D.y[i], tabl$E.y[i], tabl$F.y[i], tabl$G.y[i]))
,nrow = 5, ncol = 2)
fWHR1[i] =   fWHR(points)
}
library(alphahull)                                  # Exposes ashape()
for (i in seq_len(dim(tabl)[1])){
#i = 29
points <- matrix(c(c(tabl$C.x[i], tabl$D.x[i], tabl$E.x[i], tabl$F.x[i], tabl$G.x[i]),
c(tabl$C.y[i], tabl$D.y[i], tabl$E.y[i], tabl$F.y[i], tabl$G.y[i]))
,nrow = 5, ncol = 2)
fWHR1[i] =   fWHR(points)
}
fWHR1
max(fWHR1)
describe(fWHR1)
summary(fWHR1)
i = 38
points <- matrix(c(c(tabl$C.x[i], tabl$D.x[i], tabl$E.x[i], tabl$F.x[i], tabl$G.x[i]),
c(tabl$C.y[i], tabl$D.y[i], tabl$E.y[i], tabl$F.y[i], tabl$G.y[i]))
,nrow = 5, ncol = 2)
fWHR1[i] =   fWHR(points)
?xlable
?xlabel
plot(ashape(points, alpha=1000), col="Gray", pch=20,
xlim=limits[,1], ylim=limits[,2],                # The hull
xlab = i)
lines(mbr, col="Blue", lwd=3)                         # The MBR
points(points, pch=19)
limits <- apply(mbr, 2, function(x) c(min(x),max(x))) # Plotting limits
plot(ashape(points, alpha=1000), col="Gray", pch=20,
xlim=limits[,1], ylim=limits[,2],                # The hull
xlab = i)
lines(mbr, col="Blue", lwd=3)                         # The MBR
points(points, pch=19)
fWHR <- function(points, i){
# Analyze the convex hull edges
a <- ashape(points, alpha=1000)                 # One way to get a convex hull...
e <- a$edges[, 5:6] - a$edges[, 3:4]            # Edge directions
norms <- apply(e, 1, function(x) sqrt(x %*% x)) # Edge lengths
v <- diag(1/norms) %*% e                        # Unit edge directions
w <- cbind(-v[,2], v[,1])                       # Normal directions to the edges
# Find the MBR
vertices <- (points) [a$alpha.extremes, 1:2]    # Convex hull vertices
minmax <- function(x) c(min(x), max(x))         # Computes min and max
x <- apply(vertices %*% t(v), 2, minmax)        # Extremes along edges
y <- apply(vertices %*% t(w), 2, minmax)        # Extremes normal to edges
areas <- (y[1,]-y[2,])*(x[1,]-x[2,])            # Areas
k <- which.min(areas)                           # Index of the best edge (smallest area)
# Form a rectangle from the extremes of the best edge
k = 4
mbr <- cbind(x[c(1,2,2,1,1),k], y[c(1,1,2,2,1),k]) %*% rbind(v[k,], w[k,])
# Plot the hull, the MBR, and the points
limits <- apply(mbr, 2, function(x) c(min(x),max(x))) # Plotting limits
plot(ashape(points, alpha=1000), col="Gray", pch=20,
xlim=limits[,1], ylim=limits[,2],                # The hull
xlab = i)
lines(mbr, col="Blue", lwd=3)                         # The MBR
points(points, pch=19)
height = abs(limits[2,2]-limits[1,2])
width = limits[2,1]-limits[1,1]
fWHR = width/height
return(fWHR)
}
for (i in seq_len(dim(tabl)[1])){
#i = 38
points <- matrix(c(c(tabl$C.x[i], tabl$D.x[i], tabl$E.x[i], tabl$F.x[i], tabl$G.x[i]),
c(tabl$C.y[i], tabl$D.y[i], tabl$E.y[i], tabl$F.y[i], tabl$G.y[i]))
,nrow = 5, ncol = 2)
fWHR1[i] =   fWHR(points, i)
}
df.CA <- read.csv("CAmacaq1-2.xlsx", header=T)
df.CA <- read.csv("CAmacaq1-2.csv", header=T)
View(df.CA)
df.CA <- read.csv("CAmacaq1-2.csv", header=T)
df.CA <- df.CA[df.CA$A != 'X',]
View(df.CA)
df.CA[,c(2:15)] <- as.numeric(unlist(df.CA[,c(2:15)]))
View(df.CA)
df.CA <- separate(data = df.CA, col = A, into = c("A.x", "A.y"), sep = "\\,")
df.CA <- separate(data = df.CA, col = B, into = c("B.x", "B.y"), sep = "\\,")
df.CA <- separate(data = df.CA, col = C, into = c("C.x", "C.y"), sep = "\\,")
df.CA <- separate(data = df.CA, col = D, into = c("D.x", "D.y"), sep = "\\,")
df.CA <- separate(data = df.CA, col = E, into = c("E.x", "E.y"), sep = "\\,")
df.CA <- separate(data = df.CA, col = F, into = c("F.x", "F.y"), sep = "\\,")
df.CA <- separate(data = df.CA, col = G, into = c("G.x", "G.y"), sep = "\\,")
library(alphahull)
library(tidyr)
df.CA <- separate(data = df.CA, col = A, into = c("A.x", "A.y"), sep = "\\,")
df.CA <- separate(data = df.CA, col = B, into = c("B.x", "B.y"), sep = "\\,")
df.CA <- separate(data = df.CA, col = C, into = c("C.x", "C.y"), sep = "\\,")
df.CA <- separate(data = df.CA, col = D, into = c("D.x", "D.y"), sep = "\\,")
df.CA <- separate(data = df.CA, col = E, into = c("E.x", "E.y"), sep = "\\,")
df.CA <- separate(data = df.CA, col = F, into = c("F.x", "F.y"), sep = "\\,")
df.CA <- separate(data = df.CA, col = G, into = c("G.x", "G.y"), sep = "\\,")
df.CA[,c(2:15)] <- as.numeric(unlist(df.CA[,c(2:15)]))
View(df.CA)
fWHR.CA <- NULL
for (i in seq_len(dim(df.CA)[1])){
#i = 38
points <- matrix(c(c(df.CA$C.x[i], df.CA$D.x[i], df.CA$E.x[i], df.CA$F.x[i], df.CA$G.x[i]),
c(df.CA$C.y[i], df.CA$D.y[i], df.CA$E.y[i], df.CA$F.y[i], df.CA$G.y[i]))
,nrow = 5, ncol = 2)
fWHR.CA[i] =   fWHR(points, i)
}
fWHR.CA <- NULL
for (i in 1:60){
#i = 38
points <- matrix(c(c(df.CA$C.x[i], df.CA$D.x[i], df.CA$E.x[i], df.CA$F.x[i], df.CA$G.x[i]),
c(df.CA$C.y[i], df.CA$D.y[i], df.CA$E.y[i], df.CA$F.y[i], df.CA$G.y[i]))
,nrow = 5, ncol = 2)
fWHR.CA[i] =   fWHR(points, i)
}
library(alphahull)
library(tidyr)
for (i in 1:60){
#i = 38
points <- matrix(c(c(df.CA$C.x[i], df.CA$D.x[i], df.CA$E.x[i], df.CA$F.x[i], df.CA$G.x[i]),
c(df.CA$C.y[i], df.CA$D.y[i], df.CA$E.y[i], df.CA$F.y[i], df.CA$G.y[i]))
,nrow = 5, ncol = 2)
fWHR.CA[i] =   fWHR(points, i)
}
rownames(fWHR.CA) <- NULL
rownames(df.CA) <- NULL
rownames(df.CA) <- NULL
fWHR.CA <- NULL
for (i in 1:60){
#i = 38
points <- matrix(c(c(df.CA$C.x[i], df.CA$D.x[i], df.CA$E.x[i], df.CA$F.x[i], df.CA$G.x[i]),
c(df.CA$C.y[i], df.CA$D.y[i], df.CA$E.y[i], df.CA$F.y[i], df.CA$G.y[i]))
,nrow = 5, ncol = 2)
fWHR.CA[i] =   fWHR(points, i)
}
df.CA(59)
df.CA$monkey..photo.id[59]
df.CA$monkey..photo.id[50]
df.CA$monkey..photo.id[19]
df.CA$monkey..photo.id[2]
fWHR.CA <- NULL
for (i in 59:125){
#i = 38
points <- matrix(c(c(df.CA$C.x[i], df.CA$D.x[i], df.CA$E.x[i], df.CA$F.x[i], df.CA$G.x[i]),
c(df.CA$C.y[i], df.CA$D.y[i], df.CA$E.y[i], df.CA$F.y[i], df.CA$G.y[i]))
,nrow = 5, ncol = 2)
fWHR.CA[i] =   fWHR(points, i)
}
fWHR.CA <- NULL
for (i in 59:124){
#i = 38
points <- matrix(c(c(df.CA$C.x[i], df.CA$D.x[i], df.CA$E.x[i], df.CA$F.x[i], df.CA$G.x[i]),
c(df.CA$C.y[i], df.CA$D.y[i], df.CA$E.y[i], df.CA$F.y[i], df.CA$G.y[i]))
,nrow = 5, ncol = 2)
fWHR.CA[i] =   fWHR(points, i)
}
df.CA$monkey..photo.id[118]
df.CA$monkey..photo.id[119]
df.CA$monkey..photo.id[97]
df.CA$monkey..photo.id[96]
df.CA$monkey..photo.id[95]
df.CA$monkey..photo.id[94]
dfOHSU2 <- read.csv("ORmacaq2.csv", header=T)
dfOHSU2 <- dfOHSU2[dfOHSU2A$A != '?',]
dfOHSU2 <- dfOHSU2[dfOHSU2$A != '?',]
View(dfOHSU2)
dfOHSU2 <- read.csv("ORmacaq2.csv", header=T)
View(dfOHSU2)
dfOHSU2 <- dfOHSU2[dfOHSU2$A != '?',]
View(dfOHSU2)
dfOHSU2 <- read.csv("ORmacaq2.csv", header=T)
dfOHSU2 <- dfOHSU2[-dfOHSU2$A == '?',]
dfOHSU2 <- dfOHSU2[-c(dfOHSU2$A == '?'),]
View(dfOHSU2)
dfOHSU2 <- read.csv("ORmacaq2.csv", header=T)
dfOHSU2$A == '?'
dfOHSU2 <- read.csv("ORmacaq2.csv", header=T)
dfOHSU2 <- dfOHSU2[dfOHSU2$A == '?',]
View(dfOHSU2)
dfOHSU2 <- read.csv("ORmacaq2.csv", header=T)
dfOHSU2 <- dfOHSU2[dfOHSU2$A == '?',]
dfOHSU2 <- read.csv("ORmacaq2.csv", header=T)
dfOHSU2 <- dfOHSU2[dfOHSU2$A != '?',]
View(dfOHSU2)
dfOHSU2 <- separate(data = dfOHSU2, col = A, into = c("A.x", "A.y"), sep = "\\,")
dfOHSU2 <- separate(data = dfOHSU2, col = B, into = c("B.x", "B.y"), sep = "\\,")
dfOHSU2 <- separate(data = dfOHSU2, col = C, into = c("C.x", "C.y"), sep = "\\,")
dfOHSU2 <- separate(data = dfOHSU2, col = D, into = c("D.x", "D.y"), sep = "\\,")
dfOHSU2 <- separate(data = dfOHSU2, col = E, into = c("E.x", "E.y"), sep = "\\,")
dfOHSU2 <- separate(data = dfOHSU2, col = F, into = c("F.x", "F.y"), sep = "\\,")
dfOHSU2 <- separate(data = dfOHSU2, col = G, into = c("G.x", "G.y"), sep = "\\,")
dfOHSU1[,c(2:15)] <- as.numeric(unlist(dfOHSU1[,c(2:15)]))
dfOHSU2[,c(2:15)] <- as.numeric(unlist(dfOHSU2[,c(2:15)]))
rownames(dfOHSU2) <- NULL
fWHR.OHSU2 <- NULL
for (i in seq_len(dim(dfOHSU2)[1])){
#i = 38
points <- matrix(c(c(dfOHSU2$C.x[i], dfOHSU2$D.x[i], dfOHSU2$E.x[i], dfOHSU2$F.x[i], dfOHSU2$G.x[i]),
c(dfOHSU2$C.y[i], dfOHSU2$D.y[i], dfOHSU2$E.y[i], dfOHSU2$F.y[i], dfOHSU2$G.y[i]))
,nrow = 5, ncol = 2)
fWHR.OHSU2[i] =   fWHR(points, i)
}
dfOHSU2$monkey..photo.id[7]
dim(df.CA)
dim(dfOHSU1)
dim(dfOHSU2)
for (i in 59:124){
#i = 38
points <- matrix(c(c(df.CA$C.x[i], df.CA$D.x[i], df.CA$E.x[i], df.CA$F.x[i], df.CA$G.x[i]),
c(df.CA$C.y[i], df.CA$D.y[i], df.CA$E.y[i], df.CA$F.y[i], df.CA$G.y[i]))
,nrow = 5, ncol = 2)
fWHR.CA[i] =   fWHR(points, i)
}
source('C:/Users/s1229179/GitHub/R/fWHR/MBRtopEdge.R', echo=TRUE)
install.packages("alphahull")
for (i in 59:124){
#i = 38
points <- matrix(c(c(df.CA$C.x[i], df.CA$D.x[i], df.CA$E.x[i], df.CA$F.x[i], df.CA$G.x[i]),
c(df.CA$C.y[i], df.CA$D.y[i], df.CA$E.y[i], df.CA$F.y[i], df.CA$G.y[i]))
,nrow = 5, ncol = 2)
fWHR.CA[i] =   fWHR(points, i)
}
library(alphahull)                                  # Exposes ashape()
for (i in 59:124){
#i = 38
points <- matrix(c(c(df.CA$C.x[i], df.CA$D.x[i], df.CA$E.x[i], df.CA$F.x[i], df.CA$G.x[i]),
c(df.CA$C.y[i], df.CA$D.y[i], df.CA$E.y[i], df.CA$F.y[i], df.CA$G.y[i]))
,nrow = 5, ncol = 2)
fWHR.CA[i] =   fWHR(points, i)
}
dfOHSU2$monkey..photo.id[7]
df.CA$monkey..photo.id[118]
dim(df.CA)
?sample
sample(df.CA$monkey..photo.id, 10)
sample(df.CA$monkey..photo.id, 10)
rand
runif()
runif(20)
runif(20, 2, 260)
sample(c(2:260), 20)
cPoints = read.csv(file = "ChimpfWHR.csv")
View(cPoints)
cPoints$A[20]
cPoints$A[22]
cPoints$A[22] == ''
cPoints = cPoints[cPoints$A != '',]
colnames(cPoints)
tabl <- cPoints[,c(14:20)]
fWHRc <- NULL
cPoints <- cPoints[,c(14:20)]
cPoints <- separate(data = cPoints, col = A, into = c("A.x", "A.y"), sep = "\\,")
library(alphahull)
library(tidyr)
cPoints <- separate(data = cPoints, col = A, into = c("A.x", "A.y"), sep = "\\,")
cPoints <- separate(data = cPoints, col = B, into = c("B.x", "B.y"), sep = "\\,")
cPoints <- separate(data = cPoints, col = C, into = c("C.x", "C.y"), sep = "\\,")
cPoints <- separate(data = cPoints, col = D, into = c("D.x", "D.y"), sep = "\\,")
cPoints <- separate(data = cPoints, col = E, into = c("E.x", "E.y"), sep = "\\,")
cPoints <- separate(data = cPoints, col = F, into = c("F.x", "F.y"), sep = "\\,")
cPoints <- separate(data = cPoints, col = G, into = c("G.x", "G.y"), sep = "\\,")
View(cPoints)
tabl <- cPoints
fWHRc <- NULL
source('C:/Users/s1229179/GitHub/R/fWHR/MBRtopEdge.R', echo=TRUE)
for (i in seq_len(dim(tabl)[1])){
#i = 38
points <- matrix(c(c(tabl$C.x[i], tabl$D.x[i], tabl$E.x[i], tabl$F.x[i], tabl$G.x[i]),
c(tabl$C.y[i], tabl$D.y[i], tabl$E.y[i], tabl$F.y[i], tabl$G.y[i]))
,nrow = 5, ncol = 2)
fWHRc[i] =   fWHR(points, i)
}
tabl <- as.numeric(cPoints)
tabl <- data.matrix(cPoints)
fWHRc <- NULL
for (i in seq_len(dim(tabl)[1])){
#i = 38
points <- matrix(c(c(tabl$C.x[i], tabl$D.x[i], tabl$E.x[i], tabl$F.x[i], tabl$G.x[i]),
c(tabl$C.y[i], tabl$D.y[i], tabl$E.y[i], tabl$F.y[i], tabl$G.y[i]))
,nrow = 5, ncol = 2)
fWHRc[i] =   fWHR(points, i)
}
View(tabl)
View(tabl)
tabl$C.x[5]
cPoints <- lapply(cPoints, function(x) as.numeric(x))
tabl <- cPoints
fWHRc <- NULL
for (i in seq_len(dim(tabl)[1])){
#i = 38
points <- matrix(c(c(tabl$C.x[i], tabl$D.x[i], tabl$E.x[i], tabl$F.x[i], tabl$G.x[i]),
c(tabl$C.y[i], tabl$D.y[i], tabl$E.y[i], tabl$F.y[i], tabl$G.y[i]))
,nrow = 5, ncol = 2)
fWHRc[i] =   fWHR(points, i)
}
df.CA <- read.csv("CAmacaq1-2.csv", header=T)
df.CA <- df.CA[df.CA$A != 'X',]
df.CA <- separate(data = df.CA, col = A, into = c("A.x", "A.y"), sep = "\\,")
df.CA <- separate(data = df.CA, col = B, into = c("B.x", "B.y"), sep = "\\,")
df.CA <- separate(data = df.CA, col = C, into = c("C.x", "C.y"), sep = "\\,")
df.CA <- separate(data = df.CA, col = D, into = c("D.x", "D.y"), sep = "\\,")
df.CA <- separate(data = df.CA, col = E, into = c("E.x", "E.y"), sep = "\\,")
df.CA <- separate(data = df.CA, col = F, into = c("F.x", "F.y"), sep = "\\,")
df.CA <- separate(data = df.CA, col = G, into = c("G.x", "G.y"), sep = "\\,")
df.CA[,c(2:15)] <- as.numeric(unlist(df.CA[,c(2:15)]))
df.CA[,c(2:15)] <- as.numeric(unlist(df.CA[,c(2:15)]))
rownames(df.CA) <- NULL
cPoints <- data.frame(lapply(cPoints, function(x) as.numeric(x)))
View(cPoints)
tabl <- cPoints
fWHRc <- NULL
for (i in seq_len(dim(tabl)[1])){
#i = 38
points <- matrix(c(c(tabl$C.x[i], tabl$D.x[i], tabl$E.x[i], tabl$F.x[i], tabl$G.x[i]),
c(tabl$C.y[i], tabl$D.y[i], tabl$E.y[i], tabl$F.y[i], tabl$G.y[i]))
,nrow = 5, ncol = 2)
fWHRc[i] =   fWHR(points, i)
}
i = 8
points <- matrix(c(c(tabl$C.x[i], tabl$D.x[i], tabl$E.x[i], tabl$F.x[i], tabl$G.x[i]),
c(tabl$C.y[i], tabl$D.y[i], tabl$E.y[i], tabl$F.y[i], tabl$G.y[i]))
,nrow = 5, ncol = 2)
points
fWHRc[i] =   fWHR(points, i)
fWHR <- function(points, i){
# Analyze the convex hull edges
a <- ashape(points, alpha=1000)                 # One way to get a convex hull...
e <- a$edges[, 5:6] - a$edges[, 3:4]            # Edge directions
norms <- apply(e, 1, function(x) sqrt(x %*% x)) # Edge lengths
v <- diag(1/norms) %*% e                        # Unit edge directions
w <- cbind(-v[,2], v[,1])                       # Normal directions to the edges
# Find the MBR
vertices <- (points) [a$alpha.extremes, 1:2]    # Convex hull vertices
minmax <- function(x) c(min(x), max(x))         # Computes min and max
x <- apply(vertices %*% t(v), 2, minmax)        # Extremes along edges
y <- apply(vertices %*% t(w), 2, minmax)        # Extremes normal to edges
areas <- (y[1,]-y[2,])*(x[1,]-x[2,])            # Areas
k <- which.min(areas)                           # Index of the best edge (smallest area)
# Form a rectangle from the extremes of the best edge
k = 4
mbr <- cbind(x[c(1,2,2,1,1),k], y[c(1,1,2,2,1),k]) %*% rbind(v[k,], w[k,])
# Plot the hull, the MBR, and the points
limits <- apply(mbr, 2, function(x) c(min(x),max(x))) # Plotting limits
plot(ashape(points, alpha=1000), col="Gray", pch=20,
xlim=limits[,1], ylim=limits[,2],                # The hull
xlab = i)
lines(mbr, col="Blue", lwd=3)                         # The MBR
points(points, pch=19)
height = abs(limits[2,2]-limits[1,2])
width = limits[2,1]-limits[1,1]
fWHR = width/height
return(fWHR)
}
fWHRc[i] =   fWHR(points, i)
for (i in seq_len(dim(tabl)[1])){
#i = 8
points <- matrix(c(c(tabl$C.x[i], tabl$D.x[i], tabl$E.x[i], tabl$F.x[i], tabl$G.x[i]),
c(tabl$C.y[i], tabl$D.y[i], tabl$E.y[i], tabl$F.y[i], tabl$G.y[i]))
,nrow = 5, ncol = 2)
fWHRc[i] =   fWHR(points, i)
}
fWHRc
cPoints = read.csv(file = "ChimpfWHR.csv")
cPoints = cPoints[cPoints$A != '',]
carmen = cPoints$fHWR
dim(carmen)
lewngth(carmen)
length(carmen)
fWHRc = cbind(fWHRc, carmen)
View(fWHRc)
carmen = as.numeric(as.character(cPoints$fHWR))
fWHRc = cbind(fWHRc, carmen)
fWHRc <- NULL
for (i in seq_len(dim(tabl)[1])){
#i = 8
points <- matrix(c(c(tabl$C.x[i], tabl$D.x[i], tabl$E.x[i], tabl$F.x[i], tabl$G.x[i]),
c(tabl$C.y[i], tabl$D.y[i], tabl$E.y[i], tabl$F.y[i], tabl$G.y[i]))
,nrow = 5, ncol = 2)
fWHRc[i] =   fWHR(points, i)
}
fWHRc = cbind(fWHRc, carmen)
cor.test(fWHRc$fWHRc, fWHRc$carmen)
View(fWHRc)
fwHRc = fWHRc[-21,]
fWHRc = fWHRc[-21,]
View(fWHRc)
cor.test(fWHRc$fWHRc, fWHRc$carmen)
cor.test(fWHRc[,1], fWHRc[,2])
t.test(fWHRc[,1], fWHRc[,2]))
t.test(fWHRc[,1], fWHRc[,2])
plot(t.test(fWHRc[,1], fWHRc[,2]))
plot(fWHRc[,1], fWHRc[,2]))
plot(fWHRc[,1], fWHRc[,2])
plot(fWHRc[,1] ~ fWHRc[,2])
plot(fWHRc[,1], fWHRc[,2])
barplot(fWHRc[,1], fWHRc[,2])
plot(fWHRc[,1], fWHRc[,2])
t.test(fWHRc[,1], fWHRc[,2], paired=TRUE)
cor.test(fWHRc[,1], fWHRc[,2])
t.test(fWHRc[,1], fWHRc[,2], paired=TRUE)
library(alphahull)
install.packages(c("alphahull", "tidyr"))
xE = 272.7
xE = 272.7
yE = 64
xF = 352.7
yF = 65.3
euc.dist(c( xE , yE ) , c( xF , yF )) # <- Template
euc.dist <- function(x1, x2) sqrt(sum((x1 - x2) ^ 2))
euc.dist(c( xE , yE ) , c( xF , yF )) # <- Template
xE = 268.7
yE = 64
xF = 353.3
yF = 64
euc.dist(c( xE , yE ) , c( xF , yF )) # <- Template
xE = 269.3
yE = 68.7
xF = 268.7
yF = 68.7
euc.dist(c( xE , yE ) , c( xF , yF )) # <- Template
xE = 269.3
yE = 68.7
xF = 356
yF = 69.3
euc.dist(c( xE , yE ) , c( xF , yF )) # <- Template
xE = 224.7
yE = 92.7
xF = 400
yF = 88.7
euc.dist(c( xE , yE ) , c( xF , yF )) # <- Template
fWHRc
cor.test(fWHRc[,1], fWHRc[,2])
plot(fWHRc[,1], fWHRc[,2])
80+11+2+9+3+3+4+7+6+6+4+5
+4
