facet_grid(verus ~ Sex) +
stat_smooth(method='gam')
g
chAgr$verus[chAgr$Subspecies=='other'] = NA
g <- ggplot(data=chAgr, aes(x=Dom, y=fWHR)) + geom_point() +
facet_grid(verus ~ Sex) +
stat_smooth(method='gam')
g
View(chAgr)
chAgr$verus[chAgr$verus=='other'] = NA
g <- ggplot(data=chAgr, aes(x=Dom, y=fWHR)) + geom_point() +
facet_grid(verus ~ Sex) +
stat_smooth(method='gam')
g
chAgr = chFP
#chAgr$fWHR[chAgr$instrument=='Bas'] = chAgr$fWHR[chAgr$instrument=='Bas'] + 0.2313963
## Aggreagate into individuals
chAgr <- aggregate(chAgr[adults,], by=list(chAgr$ID[adults]), FUN=mean)
## Reattach subspecies
chAgr <- merge(chAgr[,c(1,8:26)],subsp[,c(1,2)], by.x='Group.1', by.y='Name')
colnames(chAgr)[1] <- 'ID'
###
plot(chAgr$fWHR ~ chAgr$Dom)
cor(chAgr$fWHR, chAgr$Dom)
xyplot(data=chAgr, fWHR ~ Dom | Sex)
##
chAgr$verus = 'other'
chAgr$verus[chAgr$Subspecies=='verus'] = 'verus'
chAgr$verus[chAgr$Subspecies=='troglodytes'] = 'troglodytes'
g <- ggplot(data=subset(chAgr, !(chAgr$verus=='other')),
aes(x=Dom, y=fWHR)) + geom_point() +
facet_grid(verus ~ Sex) +
stat_smooth(method='gam')
g
mp3.tree = lmer(fWHR ~ Sex * Dom_CZ * Neu_CZ +
(1 | location) + (1 | ID),
#data = chFP[adults&(chFP$Subspecies=='verus'|chFP$Subspecies=='schweinfurthii'|chFP$Subspecies=='unknown'),]
#data = chFP[adults&(chFP$Subspecies=='verus'|chFP$Subspecies=='schweinfurthii'),]
data = chFP[adults&(chFP$Subspecies=='verus'),]
)
summary(mp3.tree)
mp3.tree.all = lmer(fWHR ~ Sex * Dom_CZ * Neu_CZ +
(1 | location) + (1 | ID),
data = chFP[adults,]
)
summary(mp3.tree.all)
summary(mp3.tree.all)
set.seed(1234567)
confint(mp3.tree.all, method='boot')
ci.mptree = confint(mp3.tree.all, method='boot')
set.seed(1234567)
ci.mptree = confint(mp3.tree.all, method='boot')
ci.mptree
mp3.all = lmer(fWHR ~ Age + Sex + Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID),
data = chFP[adults,]
)
summary(mp3.all)
library(lme4)
library(lattice)
library(ggplot2)
g <- ggplot(data=subset(chAgr, !(chAgr$verus=='other')),
aes(x=Dom, y=fWHR)) + geom_point() +
facet_grid(verus ~ Sex) +
stat_smooth(method='gam')
g
?facet_grid
levels(chAgr$Sex)
as.factor(chAgr$Sex)
chAgr$Sex = as.factor(chAgr$Sex)
levels(chAgr$Sex)
levels(chAgr$Sex) <- c('Female','Male')
g <- ggplot(data=subset(chAgr, !(chAgr$verus=='other')),
aes(x=Dom, y=fWHR)) + geom_point() +
facet_grid(verus ~ Sex) +
stat_smooth(method='gam')
g
t.test(fWHR ~ Sex, data=chAgr)
g <- ggplot(data=subset(chAgr, !(chAgr$verus=='other')),
aes(x=Dom, y=fWHR)) + geom_point() +
facet_grid(verus ~ Sex) +
stat_smooth(method='gam') +
theme('classic')
g <- ggplot(data=subset(chAgr, !(chAgr$verus=='other')),
aes(x=Dom, y=fWHR)) + geom_point() +
facet_grid(verus ~ Sex) +
stat_smooth(method='gam') +
theme_classic()
g
g <- ggplot(data=subset(chAgr, !(chAgr$verus=='other')),
aes(x=Dom, y=fWHR)) + geom_point() +
facet_grid(verus ~ Sex) +
stat_smooth(method='gam') +
theme_minimal()
g
g <- ggplot(data=subset(chAgr, !(chAgr$verus=='other')),
aes(x=Dom, y=fWHR)) + geom_point() +
facet_grid(verus ~ Sex) +
stat_smooth(method='gam') +
theme_light()
g
g <- ggplot(data=subset(chAgr, !(chAgr$verus=='other')),
aes(x=Dom, y=fWHR)) + geom_point() +
facet_grid(verus ~ Sex) +
stat_smooth(method='gam') +
theme_bw()
g
g <- ggplot(data=subset(chAgr, !(chAgr$verus=='other')),
aes(x=Dom, y=fWHR)) + geom_point() +
facet_grid(verus ~ Sex) +
stat_smooth(method='gam') +
theme_bw() + xlab('Dominance')
g
library(lme4)
library(bbmle)
mp3.tree = lmer(fWHR ~ Sex * Dom_CZ * Neu_CZ +
(1 | location) + (1 | ID),
#data = chFP[adults&(chFP$Subspecies=='verus'|chFP$Subspecies=='schweinfurthii'|chFP$Subspecies=='unknown'),]
#data = chFP[adults&(chFP$Subspecies=='verus'|chFP$Subspecies=='schweinfurthii'),]
data = chFP[adults&(chFP$Subspecies=='verus'),]
)
summary(mp3.tree)
mp3.tree.both = lmer(fWHR ~ Sex * Dom_CZ * Neu_CZ +
(1 | location) + (1 | ID),
data = chFP[adults,]
)
mp3.tree.both = lmer(fWHR ~ Sex * Dom_CZ * Neu_CZ +
(1 | location) + (1 | ID),
data = chFP[adults,]
)
summary(mp3.tree.both)
mp3.tree = lmer(fWHR ~ Sex * Dom_CZ * Neu_CZ +
(1 | location) + (1 | ID),
#data = chFP[adults&(chFP$Subspecies=='verus'|chFP$Subspecies=='schweinfurthii'|chFP$Subspecies=='unknown'),]
#data = chFP[adults&(chFP$Subspecies=='verus'|chFP$Subspecies=='schweinfurthii'),]
data = chFP[adults&(chFP$Subspecies=='verus'),]
)
summary(mp3.tree)
set.seed(1234567)
confint(mp3.tree, method='boot')
mp3.all = lmer(fWHR ~ Age + Sex + Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID),
data = chFP[adults,]
)
summary(mp3.all)
ci.mptree
summary(mp3.tree.both)
ci.mptree
?chi
?chisq.test
chisq.test(chAgr$fWHR[chAgr$Sex=='Male'],chAgr$fWHR[chAgr$Sex=='Female'])
t.test(chAgr$fWHR[chAgr$Sex=='Male'],chAgr$fWHR[chAgr$Sex=='Female'])
library(psych)
?fa
library(polycor)
?data.matrix
?factor
?factanal
View(fwHRc)
cor.test(fWHRc[,1], fWHRc[,2])
fWHRc = fwHRc
cor.test(fWHRc[,1], fWHRc[,2])
plot(fWHRc[,1], fWHRc[,2])
t.test(fWHRc[,1], fWHRc[,2], paired=TRUE)
library(REEMtree)
?REEMtree
View(fWHRc)
?cart
?rpart
?rpart
plot(tree.p1)
print(tree.p1)
print(cit.p1$Tree)
plot(cit.p1$Tree)
table(chFP$location[!duplicated(chFP$ID)])
View(cPers)
18 + 58
which(chFP$ID=='Lennoin')
which(chFP$ID=='Lennon')
tree.p1 = REEMtree(fWHR ~ Sex + Age + I(Age^2) + I(Age^3) +
Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
Subspecies,
#data=chFP[adults,],
data=chFP[chFP$ID=='Lennon',],
#random=~1|ID/Subspecies
random = list(location =~ 1, ID =~ 1)#, Subspecies =~ 1)
,cv=TRUE, method='ML'
)
library(REEMtree)
set.seed(1234567)
tree.p1 = REEMtree(fWHR ~ Sex + Age + I(Age^2) + I(Age^3) +
Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
Subspecies,
#data=chFP[adults,],
data=chFP[chFP$ID=='Lennon',],
#random=~1|ID/Subspecies
random = list(location =~ 1, ID =~ 1)#, Subspecies =~ 1)
,cv=TRUE, method='ML'
)
print(tree.p1)
plot(tree.p1)
set.seed(12345)
tree.p1 = REEMtree(fWHR ~ Sex + Age + I(Age^2) + I(Age^3) +
Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
Subspecies,
#data=chFP[adults,],
data=chFP[chFP$ID=='Lennon',],
#random=~1|ID/Subspecies
random = list(location =~ 1, ID =~ 1)#, Subspecies =~ 1)
,cv=TRUE, method='ML'
)
print(tree.p1)
plot(tree.p1)
tree.p1 = REEMtree(fWHR ~ Sex + Age + I(Age^2) + I(Age^3) +
Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
Subspecies,
#data=chFP[adults,],
data=chFP[chFP$ID=='Lennon',],
#random=~1|ID/Subspecies
random = list(location =~ 1, ID =~ 1)#, Subspecies =~ 1)
,cv=TRUE, method='ML'
)
print(tree.p1)
tree.p1 = REEMtree(fWHR ~ Sex + Age + I(Age^2) + I(Age^3) +
Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
Subspecies,
#data=chFP[adults,],
data=chFP[chFP$ID=='Lennon',],
#random=~1|ID/Subspecies
random = list(location =~ 1, ID =~ 1)#, Subspecies =~ 1)
,cv=TRUE, method='ML'
)
print(tree.p1)
tree.p1 = REEMtree(fWHR ~ Sex + Age + I(Age^2) + I(Age^3) +
Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
Subspecies,
#data=chFP[adults,],
data=chFP[chFP$ID=='Lennon',],
#random=~1|ID/Subspecies
random = list(location =~ 1, ID =~ 1)#, Subspecies =~ 1)
,cv=TRUE, method='ML'
)
print(tree.p1)
tree.p1 = REEMtree(fWHR ~ Sex + Age + I(Age^2) + I(Age^3) +
Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
Subspecies,
#data=chFP[adults,],
data=chFP[chFP$ID=='Lennon',],
#random=~1|ID/Subspecies
random = list(location =~ 1, ID =~ 1)#, Subspecies =~ 1)
,cv=TRUE, method='ML'
)
print(tree.p1)
tree.p1 = REEMtree(fWHR ~ Sex + Age + I(Age^2) + I(Age^3) +
Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
Subspecies,
#data=chFP[adults,],
data=chFP[chFP$ID=='Lennon',],
#random=~1|ID/Subspecies
random = list(location =~ 1, ID =~ 1)#, Subspecies =~ 1)
,cv=TRUE, method='ML'
)
print(tree.p1)
tree.p1 = REEMtree(fWHR ~ Sex + Age + I(Age^2) + I(Age^3) +
Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
Subspecies,
#data=chFP[adults,],
data=chFP[chFP$ID=='Lennon',],
#random=~1|ID/Subspecies
random = list(location =~ 1, ID =~ 1)#, Subspecies =~ 1)
,cv=TRUE, method='ML'
)
print(tree.p1)
set.seed(1234567)
cit.p1 = REEMctree(fWHR ~ Sex + Age + I(Age^2) + I(Age^3) +
Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
Subspecies,
#data=chFP[adults,],
data=chFP[chFP$ID=='Lennon',],
#random=~1|ID/Subspecies
random = list(location =~ 1, ID =~ 1)#, Subspecies =~ 1)
, method='REML'
)
?where
library(party)
library(rpart)
cit.p1 = REEMctree(fWHR ~ Sex + Age + I(Age^2) + I(Age^3) +
Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
Subspecies,
#data=chFP[adults,],
data=chFP[chFP$ID=='Lennon',],
#random=~1|ID/Subspecies
random = list(location =~ 1, ID =~ 1)#, Subspecies =~ 1)
, method='REML'
)
plot(cit.p1$Tree)
print(cit.p1$Tree)
cit.p1 = REEMctree(fWHR ~ Sex + Age + I(Age^2) + I(Age^3) +
Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
Subspecies,
#data=chFP[adults,],
data=chFP[chFP$ID=='Lennon',],
#random=~1|ID/Subspecies
random = list(location =~ 1, ID =~ 1)#, Subspecies =~ 1)
, method='REML'
)
print(cit.p1$Tree)
cit.p1 = REEMctree(fWHR ~ Sex + Age + I(Age^2) + I(Age^3) +
Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
Subspecies,
#data=chFP[adults,],
data=chFP[chFP$ID=='Lennon',],
#random=~1|ID/Subspecies
random = list(location =~ 1, ID =~ 1)#, Subspecies =~ 1)
, method='REML'
)
cit.p1 = REEMctree(fWHR ~ Sex + Age + I(Age^2) + I(Age^3) +
Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
Subspecies,
#data=chFP[adults,],
data=chFP[chFP$ID=='Lennon',],
#random=~1|ID/Subspecies
random = list(location =~ 1, ID =~ 1)#, Subspecies =~ 1)
, method='REML'
)
cit.p1 = REEMctree(fWHR ~ Sex + Age + I(Age^2) + I(Age^3) +
Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
Subspecies,
#data=chFP[adults,],
data=chFP[chFP$ID=='Lennon',],
#random=~1|ID/Subspecies
random = list(location =~ 1, ID =~ 1)#, Subspecies =~ 1)
, method='REML'
)
cit.p1 = REEMctree(fWHR ~ Sex + Age + I(Age^2) + I(Age^3) +
Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
Subspecies,
#data=chFP[adults,],
data=chFP[chFP$ID=='Lennon',],
#random=~1|ID/Subspecies
random = list(location =~ 1, ID =~ 1)#, Subspecies =~ 1)
, method='REML'
)
cit.p1 = REEMctree(fWHR ~ Sex + Age + I(Age^2) + I(Age^3) +
Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
Subspecies,
#data=chFP[adults,],
data=chFP[chFP$ID=='Lennon',],
#random=~1|ID/Subspecies
random = list(location =~ 1, ID =~ 1)#, Subspecies =~ 1)
, method='REML'
)
cit.p1 = REEMctree(fWHR ~ Sex + Age + I(Age^2) + I(Age^3) +
Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
Subspecies,
#data=chFP[adults,],
data=chFP[chFP$ID=='Lennon',],
#random=~1|ID/Subspecies
random = list(location =~ 1, ID =~ 1)#, Subspecies =~ 1)
, method='REML'
)
cit.p1 = REEMctree(fWHR ~ Sex + Age + I(Age^2) + I(Age^3) +
Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
Subspecies,
#data=chFP[adults,],
data=chFP[chFP$ID=='Lennon',],
#random=~1|ID/Subspecies
random = list(location =~ 1, ID =~ 1)#, Subspecies =~ 1)
, method='REML'
)
cit.p1 = REEMctree(fWHR ~ Sex + Age + I(Age^2) + I(Age^3) +
Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
Subspecies,
#data=chFP[adults,],
data=chFP[chFP$ID=='Lennon',],
#random=~1|ID/Subspecies
random = list(location =~ 1, ID =~ 1)#, Subspecies =~ 1)
, method='REML'
)
print(cit.p1$Tree)
set.seed(12345)
tree.p1 = REEMtree(fWHR ~ Sex + Age + I(Age^2) + I(Age^3) +
Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
Subspecies,
#data=chFP[adults,],
data=chFP[chFP$ID!='Lennon',],
#random=~1|ID/Subspecies
random = list(location =~ 1, ID =~ 1)#, Subspecies =~ 1)
,cv=TRUE, method='ML'
)
print(tree.p1)
plot(tree.p1)
set.seed(12345)
set.seed(1234567)
tree.p1 = REEMtree(fWHR ~ Sex + Age + I(Age^2) + I(Age^3) +
Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
Subspecies,
#data=chFP[adults,],
data=chFP[chFP$ID!='Lennon',],
#random=~1|ID/Subspecies
random = list(location =~ 1, ID =~ 1)#, Subspecies =~ 1)
,cv=TRUE, method='ML'
)
print(tree.p1)
plot(tree.p1)
tree.p1 = REEMtree(fWHR ~ Sex + Age + I(Age^2) + I(Age^3) +
Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
Subspecies,
#data=chFP[adults,],
data=chFP[chFP$ID!='Lennon',],
#random=~1|ID/Subspecies
random = list(location =~ 1, ID =~ 1)#, Subspecies =~ 1)
,cv=TRUE, method='ML'
)
print(tree.p1)
set.seed(1234567)
tree.p1 = REEMtree(fWHR ~ Sex + Age + I(Age^2) + I(Age^3) +
Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
Subspecies,
#data=chFP[adults,],
data=chFP[chFP$ID!='Lennon',],
#random=~1|ID/Subspecies
random = list(location =~ 1, ID =~ 1)#, Subspecies =~ 1)
,cv=TRUE, method='ML'
)
print(tree.p1)
set.seed(12345678)
tree.p1 = REEMtree(fWHR ~ Sex + Age + I(Age^2) + I(Age^3) +
Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
Subspecies,
#data=chFP[adults,],
data=chFP[chFP$ID!='Lennon',],
#random=~1|ID/Subspecies
random = list(location =~ 1, ID =~ 1)#, Subspecies =~ 1)
,cv=TRUE, method='ML'
)
print(tree.p1)
plot(tree.p1)
set.seed(1234567)
set.seed(12345678)
cit.p1 = REEMctree(fWHR ~ Sex + Age + I(Age^2) + I(Age^3) +
Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
Subspecies,
#data=chFP[adults,],
data=chFP[chFP$ID!='Lennon',],
#random=~1|ID/Subspecies
random = list(location =~ 1, ID =~ 1)#, Subspecies =~ 1)
, method='REML'
)
plot(cit.p1$Tree)
print(cit.p1$Tree)
summary(m0.0)
m0 <- lmer(fWHR ~ 1 + (1|instrument) +
#(1 | location) +
(1 | Subspecies) + (1 | ID:Subspecies)
#,data=chFP[adults,]
,data=chFP[chFP$ID!='Lennon',]
)
library(lme4)
library(car)
library(corrplot)
library(plyr)
library(numDeriv)
library(RCurl)
library(optimx)
m0 <- lmer(fWHR ~ 1 + (1|instrument) +
#(1 | location) +
(1 | Subspecies) + (1 | ID:Subspecies)
#,data=chFP[adults,]
,data=chFP[chFP$ID!='Lennon',]
)
summary(m0)
ranef(m0)
m0.0 <- lmer(fWHR ~ 1 +
(1 | location) + (1 | Subspecies)
#,data=chFP[adults,]
,data=chFP[chFP$ID!='Lennon',]
)
summary(m0.0)
ranef(m0.0)
library(lme4)
library(lattice)
library(ggplot2)
g <- ggplot(data=subset(chAgr, !(chAgr$verus=='other')),
aes(x=Dom, y=fWHR)) + geom_point() +
facet_grid(verus ~ Sex) +
stat_smooth(method='gam') +
theme_bw() + xlab('Dominance')
g
g <- ggplot(data=chAgr,
aes(x=Dom, y=fWHR)) + geom_point() +
facet_grid(verus ~ Sex) +
stat_smooth(method='gam') +
theme_bw() + xlab('Dominance')
g
chAgr$verus = 'other'
chAgr$verus[chAgr$Subspecies=='verus'] = 'verus'
chAgr$verus[chAgr$Subspecies=='troglodytes'] = 'troglodytes'
chAgr$Sex = as.factor(chAgr$Sex)
levels(chAgr$Sex) <- c('Female','Male')
g <- ggplot(data=subset(chAgr, !(chAgr$verus=='other')),
aes(x=Dom, y=fWHR)) + geom_point() +
facet_grid(verus ~ Sex) +
stat_smooth(method='gam') +
theme_bw() + xlab('Dominance')
g <- ggplot(data=chAgr,
aes(x=Dom, y=fWHR)) + geom_point() +
facet_grid(verus ~ Sex) +
stat_smooth(method='gam') +
theme_bw() + xlab('Dominance')
g
table(chAgr$verus)
