levels(chFP$Subspecies)
chFP$Subspecies[chFP$Subspecies=='hybrid'] = 'unknown'
mp1 <- lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
#,data = chFP
,data = chFP[chFP$Age>7,]
)
summary(mp1)
mp1 <- lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
,data = chFP
#,data = chFP[chFP$Age>7,]
)
summary(mp1)
mp2.f <- lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
,data = chFP[chFP$Sex==0,]
#,data = chFP[chFP$Age>7&chFP$Sex==0,]
)
summary(mp2.f)
mp2.m <- lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID:Subspecies) #+ (1 | Subspecies)
,data = chFP[chFP$Sex==1,]
#
,data = chFP[chFP$Age>7&chFP$Sex==1,]
)
mp2.m <- lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID:Subspecies) + (1 | Subspecies)
,data = chFP[chFP$Sex==1,]
#
,data = chFP[chFP$Age>7&chFP$Sex==1,]
)
mp2.m <- lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID:Subspecies) + (1 | Subspecies)
,data = chFP[chFP$Sex==1,]
#,data = chFP[chFP$Age>7&chFP$Sex==1,]
)
summary(mp2.m)
mp4.f = lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
,data = chFP[(chFP$Subspecies=='verus'&chFP$Sex==0,]
#,data = chFP[(chFP$Subspecies=='verus'&chFP$Sex==0&chFP$Age>7),]
)
mp4.m = lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
,data = chFP[(chFP$Subspecies=='verus'&chFP$Sex==1,]
#,data = chFP[(chFP$Subspecies=='verus'&chFP$Sex==1&chFP$Age>7),]
)
summary(mp4.f)
summary(mp4.m)
confint(mp4.f, method='profile')
confint(mp4.m, method='profile')
mp4.f = lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
,data = chFP[(chFP$Subspecies=='verus'&chFP$Sex==0),]
#,data = chFP[(chFP$Subspecies=='verus'&chFP$Sex==0&chFP$Age>7),]
)
mp4.m = lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
,data = chFP[(chFP$Subspecies=='verus'&chFP$Sex==1),]
#,data = chFP[(chFP$Subspecies=='verus'&chFP$Sex==1&chFP$Age>7),]
)
summary(mp4.f)
summary(mp4.m)
mp4 = lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
,data = chFP[(chFP$Subspecies=='verus'),]
#,data = chFP[(chFP$Subspecies=='verus'&chFP$Sex==0&chFP$Age>7),]
)
summary(mp4)
confint(mp4, method='profile')
confint(mp4.f, method='profile')
confint(mp4.m, method='profile')
mp4 = lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
#,data = chFP[(chFP$Subspecies=='verus'),]
,data = chFP[(chFP$Subspecies=='verus'&chFP$Age>7),]
)
mp4.f = lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
#,data = chFP[(chFP$Subspecies=='verus'&chFP$Sex==0),]
,data = chFP[(chFP$Subspecies=='verus'&chFP$Sex==0&chFP$Age>7),]
)
mp4.m = lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
#,data = chFP[(chFP$Subspecies=='verus'&chFP$Sex==1),]
,data = chFP[(chFP$Subspecies=='verus'&chFP$Sex==1&chFP$Age>7),]
)
summary(mp4)
summary(mp4.f)
summary(mp4.m)
m0 <- lmer(fWHR ~ 1 +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
#,data=chFP
,data = chFP[chFP$Age>7,]
)
summary(m0)
m0 <- lmer(fWHR ~ 1 +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
,data=chFP
#,data = chFP[chFP$Age>7,]
)
summary(m0)
m1 <- lmer(fWHR ~ s(Age) + s(I(Age^2)) + s(I(Age^3)) +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
#,data = chFP
,data = chFP[chFP$Age>7,]
)
summary(m1)
m1 <- lmer(fWHR ~ s(Age) + s(I(Age^2)) + s(I(Age^3)) +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
,data = chFP
,data = chFP[chFP$Age>7,]
)
m1 <- lmer(fWHR ~ s(Age) + s(I(Age^2)) + s(I(Age^3)) +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
,data = chFP
#,data = chFP[chFP$Age>7,]
)
summary(m1)
m2 <- lmer(fWHR ~ Age*Sex +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
,data = chFP
#,data = chFP[chFP$Age>7,]
)
summary(m2)
mp1 <- lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
,data = chFP
#,data = chFP[chFP$Age>7,]
)
summary(mp1)
mp2.f <- lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
,data = chFP[chFP$Sex==0,]
#,data = chFP[chFP$Age>7&chFP$Sex==0,]
)
mp2.m <- lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID:Subspecies) + (1 | Subspecies)
,data = chFP[chFP$Sex==1,]
#,data = chFP[chFP$Age>7&chFP$Sex==1,]
)
summary(mp2.f)
summary(mp2.m)
confint(mp2.f, method='profile')
mp2.f <- lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
#,data = chFP[chFP$Sex==0,]
,data = chFP[chFP$Age>7&chFP$Sex==0,]
)
mp2.m <- lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID:Subspecies) + (1 | Subspecies)
#,data = chFP[chFP$Sex==1,]
,data = chFP[chFP$Age>7&chFP$Sex==1,]
)
summary(mp2.f)
summary(mp2.m)
summary(mp4)
summary(mp4.f)
summary(mp4.m)
summary(mp4)
summary(mp4.f)
summary(mp4)
summary(mp4.m)
summary(mp4)
mp4.f = lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
,data = chFP[(chFP$Subspecies=='verus'&chFP$Sex==0),]
#,data = chFP[(chFP$Subspecies=='verus'&chFP$Sex==0&chFP$Age>7),]
)
summary(mp4.f)
corrplot(cor(chFP[,c(8,12,13,14,15,16,17),],use="pairwise.complete.obs")
,  method = 'number')
library(corrplot)
corrplot(cor(chFP[,c(8,12,13,14,15,16,17),],use="pairwise.complete.obs")
,  method = 'number')
corrplot(cor(chFP[chFP$Sex==0,c(8,12,13,14,15,16,17),],use="pairwise.complete.obs"),  method = 'number')
corrplot(cor(chFP[chFP$Sex==1,c(8,12,13,14,15,16,17),],use="pairwise.complete.obs"),  method = 'number')
corrplot(cor(chFP[chFP$Sex==0,c(8,12,13,14,15,16,17),],use="pairwise.complete.obs"),  method = 'number')
corrplot(cor(chFP[chFP$Sex==1,c(8,12,13,14,15,16,17),],use="pairwise.complete.obs"),  method = 'number')
indx = (chFP$Sex==0 & chFP$Age>7) | (chFP$Sex==1 & chFP$Age>9)
mp2.f <- lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
#,data = chFP[chFP$Sex==0,]
,data = chFP[chFP$Age>7&chFP$Sex==0,]
)
library(lme4)
library(car)
library(corrplot)
library(plyr)
mp1 <- lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
,data = chFP
#,data = chFP[chFP$Age>7,]
)
summary(mp1)
mp2.f <- lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
#,data = chFP[chFP$Sex==0,]
,data = chFP[chFP$Age>7&chFP$Sex==0,]
)
summary(mp2.f)
mp2.f <- lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
,data = chFP[chFP$Sex==0,]
,data = chFP[chFP$Age>7&chFP$Sex==0,]
)
mp2.f <- lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
,data = chFP[chFP$Sex==0,]
#            ,data = chFP[chFP$Age>7&chFP$Sex==0,]
)
summary(mp2.f)
View(chFP)
indx = (chFP$Sex==0 & chFP$Age>7) | (chFP$Sex==1 & chFP$Age>9) | (chFP$ID == 'Gage')
View(indx)
indx
indx[is.na(indx)] = TRUE
indx
m1 <- lmer(fWHR ~ s(Age) + s(I(Age^2)) + s(I(Age^3)) +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
#,data = chFP
,data = chFP[indx,]
)
summary(m1)
m2 <- lmer(fWHR ~ Age*Sex +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
#,data = chFP
,data = chFP[indx,]
)
summary(m2)
mp1 <- lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
#,data = chFP
,data = chFP[indx,]
)
summary(mp1)
mp2.f <- lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
#,data = chFP[chFP$Sex==0,]
,data = chFP[indx&chFP$Sex==0,]
)
mp2.m <- lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID:Subspecies) + (1 | Subspecies)
#,data = chFP[chFP$Sex==1,]
,data = chFP[indx&chFP$Sex==1,]
)
summary(mp2.f)
summary(mp2.m)
corrplot(cor(chFP[,c(8,12,13,14,15,16,17),],use="pairwise.complete.obs")
,  method = 'number')
corrplot(cor(chFP[chFP$Sex==0,c(8,12,13,14,15,16,17),],use="pairwise.complete.obs"),  method = 'number')
corrplot(cor(chFP[chFP$Sex==1,c(8,12,13,14,15,16,17),],use="pairwise.complete.obs"),  method = 'number')
confint(mp2.f, method='profile')
confint(mp2.m, method='profile')
count(chFP$Subspecies)
mp3.t = lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
#,data = chFP[chFP$Subspecies=='troglodytes',]
,data = chFP[indx&chFP$Subspecies=='troglodytes',])
mp3.v = lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
#,data = chFP[chFP$Subspecies=='verus',]
,data = chFP[indx&chFP$Subspecies=='verus',]
)
summary(mp3.t)
summary(mp3.v)
confint(mp3.t, method='boot')
confint(mp3.t, method='profile')
confint(mp3.t, method='Wald')
confint(mp3.v, method='profile')
mp4.f = lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
,data = chFP[indx&(chFP$Subspecies=='verus'&chFP$Sex==0),]
)
mp4.m = lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
,data = chFP[(indx&(chFP$Subspecies=='verus'&chFP$Sex==1),]
)
summary(mp4)
summary(mp4.f)
summary(mp4.m)
confint(mp4, method='profile')
confint(mp4.f, method='profile')
confint(mp4.m, method='profile')
mp4.m = lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
,data = chFP[indx&(chFP$Subspecies=='verus'&chFP$Sex==1),]
)
summary(mp4.f)
summary(mp4.m)
summary(mp3.v)
table(chFP$Age)
summary(mp2.f)
summary(mp2.m)
summary(mp3.t) # Nothing for troglodytes.
mp5.f = lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
,data = chFP[indx&(chFP$Subspecies=='troglodytes'&chFP$Sex==0),]
)
mp5.m = lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
,data = chFP[indx&(chFP$Subspecies=='troglodytes'&chFP$Sex==1),]
)
mp5.m = lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | ID)
,data = chFP[indx&(chFP$Subspecies=='troglodytes'&chFP$Sex==1),]
)
summary(mp5.f)
summary(mp5.m)
summary(mp3.v)
summary(mp4.f)
summary(mp4.m)
confint(mp2.f, method='profile')
summary(mp2.m)
summary(mp2.f)
summary(mp3.v)
summary(mp4.f)
summary(mp4.m)
corrplot(cor(chFP[chFP$Sex==0,c(8,12,13,14,15,16,17),],use="pairwise.complete.obs"),  method = 'number')
corrplot(cor(chFP[chFP$Sex==1,c(8,12,13,14,15,16,17),],use="pairwise.complete.obs"),  method = 'number')
summary(mp4.f)
summary(mp4.m)
confint(mp4.f, method='profile')
confint(mp4.m, method='profile')
source('~/GitHub/R/fWHR/chimpModels.R')
summary(mp4.f)
summary(mp4.m)
confint(mp4.f, method='profile')
confint(mp4.m, method='profile')
confint(mp4.f, method='boot')
confint(mp4.m, method='boot')
confint(mp4.m, method='profile')
summary(mp4.f)
summary(mp4.m)
confint(mp4.f, method='profile')
confint(mp4.f, method='boot')
confint(mp4.m, method='profile')
confint(mp4.m, method='boot')
library(lme4)
library(car)
library(corrplot)
library(plyr)
s <- function(x) {scale(x)}
mp4.f = lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
,data = chFP[indx&(chFP$Subspecies=='verus'&chFP$Sex==0),]
)
mp4.m = lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
,data = chFP[indx&(chFP$Subspecies=='verus'&chFP$Sex==1),]
)
summary(mp4.f)
summary(mp4.m)
levels(chFP$Subspecies)
table(chFP$Subspecies)
table(chFP$Sex[chFP$Subspecies=='verus'])
confint(mp4.f, method='profile')
nrow(df)
length(getME(mp4.f,"theta"))
tt = getME(mp4.f,"theta")
tt <- getME(mp4.f,"theta")
ll <- getME(mp4.f,"lower")
min(tt[ll==0])
derivs1 <- mmp4.f@optinfo$derivs
derivs1 <- mp4.f@optinfo$derivs
sc_grad1 <- with(derivs1,solve(Hessian,gradient))
max(abs(sc_grad1))
max(pmin(abs(sc_grad1),abs(derivs1$gradient)))
dd <- update(mp4.f,devFunOnly=TRUE)
pars <- unlist(getME(mp4.f,c("theta","fixef")))
grad2 <- grad(dd,pars)
hess2 <- hessian(dd,pars)
dd <- update(mp4.f,devFunOnly=TRUE)
pars <- unlist(getME(mp4.f,c("theta","fixef")))
grad2 <- grad(dd,pars)
library(numDeriv)
grad2 <- grad(dd,pars)
hess2 <- hessian(dd,pars)
ss <- getME(mp4.f,c("theta","fixef"))
mp4.f.2 <- update(mp4.f,start=ss,control=glmerControl(optCtrl=list(maxfun=2e4)))
mp4.f.2 <- update(mp4.f,start=ss,control=lmerControl(optCtrl=list(maxfun=2e4)))
summary(mp4.f.2)
mp4.f.2 <- update(mp4.f,start=ss,control=lmerControl(optCtrl=list(maxfun=2e5)))
confint(mp4.f, method='profile')
confint(mp4.m, method='profile')
mp4.f.2 <- update(mp4.f,start=ss,control=lmerControl(optimizer="Nelder_Mead",
optCtrl=list(maxfun=2e5)))
confint(mp4.f, method='profile')
confint(mp4.f.2, method='profile')
library(RCurl)
install.packages("RCurl")
afurl <- "https://raw.githubusercontent.com/lme4/lme4/master/misc/issues/allFit.R"
eval(parse(text=getURL(afurl)))
?getURL
library(RCurl)
eval(parse(text=getURL(afurl)))
library(lme4)
library(car)
library(corrplot)
library(plyr)
library(numDeriv)
library(RCurl)
library(optimx)
afurl <- "https://github.com/lme4/lme4/blob/master/inst/utils/allFit.R"
eval(parse(text=getURL(afurl)))
afurl <- "https://raw.githubusercontent.com/lme4/lme4/master/inst/utils/allFit.R"
eval(parse(text=getURL(afurl)))
aa <- allFit(mp4.f)
is.OK <- sapply(aa,is,"merMod")
aa.OK <- aa[is.OK]
lapply(aa.OK,function(x) x@optinfo$conv$lme4$messages)
(lliks <- sort(sapply(aa.OK,logLik)))
mp4.f.2 <- update(mp4.f,start=ss,control=lmerControl(optimizer="nmkbw",
optCtrl=list(maxfun=2e5)))
confint(mp4.f.2, method='profile')
mp4.f.2 <- update(mp4.f,start=ss,control=lmerControl(optimizer="nlminbw",
optCtrl=list(maxfun=2e5)))
confint(mp4.f.2, method='profile')
warnings()
mp4.f.2 <- update(mp4.f,start=ss,control=lmerControl(optimizer="optimx",
optCtrl=list(method='nlminb',maxfun=2e5)))
?optCtrl
?lmerControl
mp4.f.2 <- update(mp4.f,start=ss,control=lmerControl(optimizer="optimx",
optCtrl=list(method='nlminb',maxiter=2e5)))
confint(mp4.f.2, method='profile')
mp4.f.2 <- update(mp4.f,start=ss,control=lmerControl(optimizer="nloptwrap2",
optCtrl=list(
#method = ,
maxiter=2e5)))
mp4.f.2 <- update(mp4.f,start=ss,control=lmerControl(optimizer="optimx",
optCtrl=list(
method = 'nlminb',
maxiter=2e5
)))
confint(mp4.f.2, method='profile')
mp4.f.2 <- update(mp4.f,start=ss,control=lmerControl(optimizer="optimx",
optCtrl=list(
method = 'L-BFGS-B',
maxiter=2e5
)))
mp4.f.2 <- update(mp4.f,start=ss,control=lmerControl(optimizer="optimx",
optCtrl=list(
method = 'L-BFGS-B'#,
#maxiter=2e5
)))
confint(mp4.f.2, method='profile')
mp4.f.2 <- update(mp4.f,start=ss,control=lmerControl(optimizer="optimx",
optCtrl=list(
method = 'L-BFGS-B'#,
#maxiter=2e5
)))
mp4.f.2 <- update(mp4.f,start=ss,control=lmerControl(optimizer="optimx",
optCtrl=list(
method = 'nlminb'#,
#maxiter=2e5
)))
confint(mp4.f.2, method='profile')
mp4.f.2 <- update(mp4.f,start=ss,control=lmerControl(optimizer="Nelder_Mead",
optCtrl=list(maxiter=2e5)))
mp4.f.2 <- update(mp4.f,start=ss,control=lmerControl(optimizer="Nelder_Mead"#,
#optCtrl=list(maxiter=2e5)))
confint(mp4.f.2, method='profile')
mp4.f.2 <- update(mp4.f,start=ss,control=lmerControl(optimizer="Nelder_Mead"#,
#optCtrl=list(maxiter=2e5)
))
confint(mp4.f.2, method='profile')
summary(mp4.f)
confint(mp4.f.2, method='profile')
confint(mp4.f.2, method='boot')
mp4.f = lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
,data = chFP[indx&(chFP$Subspecies=='verus'&chFP$Sex==0),]
,control=lmerControl(optimizer="Nelder_Mead"
)
# Covergence checks
tt <- getME(mp4.f,"theta")
ll <- getME(mp4.f,"lower")
min(tt[ll==0]) # not terrible, but not ideal either
derivs1 <- mp4.f@optinfo$derivs
sc_grad1 <- with(derivs1,solve(Hessian,gradient))
max(abs(sc_grad1)) # Fine
max(pmin(abs(sc_grad1),abs(derivs1$gradient))) # The same - fine.
mp4.m = lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
,data = chFP[indx&(chFP$Subspecies=='verus'&chFP$Sex==1),]
)
summary(mp4.f)
summary(mp4.m)
confint(mp4.f, method='profile')
confint(mp4.f, method='boot')
confint(mp4.m, method='profile')
confint(mp4.m, method='boot')
mp4.f = lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
,data = chFP[indx&(chFP$Subspecies=='verus'&chFP$Sex==0),]
,control=lmerControl(optimizer="Nelder_Mead")
)
tt <- getME(mp4.f,"theta")
ll <- getME(mp4.f,"lower")
min(tt[ll==0]) # not terrible, but not ideal either
derivs1 <- mp4.f@optinfo$derivs
sc_grad1 <- with(derivs1,solve(Hessian,gradient))
max(abs(sc_grad1)) # Fine
max(pmin(abs(sc_grad1),abs(derivs1$gradient))) # The same - fine.
summary(mp4.f)
confint(mp4.f, method='profile')
confint(mp4.m, method='profile')
confint(mp4.f, method='boot')
warnings()
confint(mp4.f, method='boot')
