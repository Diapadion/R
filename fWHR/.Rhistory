RFcluster(fWHR ~ Sex + Age + #I(Age^2) + I(Age^3) +
Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
Subspecies, id=ID#+location
,data=chFP,seed=1234567)
library(lme4)
library(lattice)
library(ggplot2)
g <- ggplot(data=subset(chAgr, !(chAgr$verus=='other')),
aes(x=Dom, y=fWHR)) + geom_point() +
facet_grid(verus ~ Sex) +
stat_smooth(method='gam') +
theme_bw() + xlab('Dominance')
g
plot(chAgr$fWHR ~ chAgr$Dom)
plot(chAgr$fWHR ~ chAgr$Agr)
chAgr = chFP
## Aggreagate into individuals
chAgr <- aggregate(chAgr[adults,], by=list(chAgr$ID[adults]), FUN=mean)
## Reattach subspecies
chAgr <- merge(chAgr[,c(1,8:26)],subsp[,c(1,2)], by.x='Group.1', by.y='Name')
colnames(chAgr)[1] <- 'ID'
plot(chAgr$fWHR ~ chAgr$Dom)
plot(chAgr$fWHR ~ chAgr$Agr)
cor(chAgr$fWHR, chAgr$Dom)
cor(chAgr$fWHR, chAgr$Agr)
xyplot(data=chAgr, fWHR ~ Dom | Sex)
chAgr$verus = 'other'
chAgr$verus[chAgr$Subspecies=='verus'] = 'verus'
chAgr$verus[chAgr$Subspecies=='troglodytes'] = 'troglodytes'
chAgr$Sex = as.factor(chAgr$Sex)
levels(chAgr$Sex) <- c('Female','Male')
g <- ggplot(data=subset(chAgr, !(chAgr$verus=='other')),
aes(x=Dom, y=fWHR)) + geom_point() +
facet_grid(verus ~ Sex) +
stat_smooth(method='gam') +
theme_bw() + xlab('Dominance')
g
g <- ggplot(data=subset(chAgr, !(chAgr$verus=='other')),
aes(x=Neu, y=fWHR)) + geom_point() +
facet_grid(verus ~ Sex) +
stat_smooth(method='gam') +
theme_bw() + xlab('Neuroticism')
g
## Aggreagate into individuals
chAgr <- aggregate(chAgr[adults,], by=list(chAgr$ID[adults]), FUN=mean)
View(chAgr)
chFP$verus = 0
chFP$verus[chFP$Subspecies=='verus'] = 1
## Aggreagate into individuals
chAgr <- aggregate(chAgr[adults,], by=list(chAgr$ID[adults]), FUN=mean)
## Reattach subspecies
chAgr <- merge(chAgr[,c(1,8:26)],subsp[,c(1,2)], by.x='Group.1', by.y='Name')
chAgr = chFP
## Aggreagate into individuals
chAgr <- aggregate(chAgr[adults,], by=list(chAgr$ID[adults]), FUN=mean)
## Reattach subspecies
chAgr <- merge(chAgr[,c(1,8:26)],subsp[,c(1,2)], by.x='Group.1', by.y='Name')
colnames(chAgr)[1] <- 'ID'
chAgr$Sex = as.factor(chAgr$Sex)
levels(chAgr$Sex) <- c('Female','Male')
## Aggreagate into individuals
chAgr$Sex = as.numeric(chAgr$Sex)
View(chAgr)
chAgr = chFP
## Aggreagate into individuals
chAgr$Sex = as.numeric(chAgr$Sex)
View(chAgr)
chAgr <- aggregate(chAgr[adults,], by=list(chAgr$ID[adults]), FUN=mean)
## Reattach subspecies
chAgr <- merge(chAgr[,c(1,8:26)],subsp[,c(1,2)], by.x='Group.1', by.y='Name')
colnames(chAgr)[1] <- 'ID'
chAgr$verus = 'other'
chAgr$verus[chAgr$Subspecies=='verus'] = 'verus'
chAgr$verus[chAgr$Subspecies=='troglodytes'] = 'troglodytes'
chAgr$Sex = as.factor(chAgr$Sex)
levels(chAgr$Sex) <- c('Female','Male')
g <- ggplot(data=subset(chAgr, !(chAgr$verus=='other')),
aes(x=Dom, y=fWHR)) + geom_point() +
facet_grid(verus ~ Sex) +
stat_smooth(method='gam') +
theme_bw() + xlab('Dominance')
g
g <- ggplot(data=chAgr),
aes(x=Agr, y=fWHR)) + geom_point() +
#facet_grid(verus ~ Sex) +
stat_smooth(method='gam') +
theme_bw() + xlab('Dominance')
g <- ggplot(data=chAgr, aes(x=Agr, y=fWHR)) + geom_point() +
#facet_grid(verus ~ Sex) +
stat_smooth(method='gam') +
theme_bw() + xlab('Dominance')
g
gb.tree.vs.woA = lmer(fWHR ~ Dom_CZ + Neu_CZ +
+ (1 | location) +  (1 | ID),
data=chFP[adults&(chFP$Subspecies=='verus'|chFP$Subspecies=='schweinfurthii')&Agr_CZ>=1.052,]
)
gb.tree.vs.woA = lmer(fWHR ~ Dom_CZ + Neu_CZ +
+ (1 | location) +  (1 | ID),
data=chFP[adults&(chFP$Subspecies=='verus'|chFP$Subspecies=='schweinfurthii')&chFP$Agr_CZ>=1.052,]
)
summary(gb.tree.vs.woA)
gb.tree.vs.wA = lmer(fWHR ~ Dom_CZ + Neu_CZ +
+ (1 | location) +  (1 | ID),
data=chFP[adults&(chFP$Subspecies=='verus'|chFP$Subspecies=='schweinfurthii'),]
)
summary(gb.tree.vs.wA)
confint(gb.tree.vs.woA, method='profile')
confint(gb.tree.vs.woA, method='profile')
confint(gb.tree.vs.woA, method='Wald')
confint(gb.tree.vs.woA, method='boot')
gb.tree.vs.woA = lmer(fWHR ~ Dom_CZ * Neu_CZ +
+ (1 | location) +  (1 | ID),
data=chFP[adults&(chFP$Subspecies=='verus'|chFP$Subspecies=='schweinfurthii')&chFP$Agr_CZ>=1.052,]
)
summary(gb.tree.vs.woA)
gb.tree.vs.wA = lmer(fWHR ~ Dom_CZ * Neu_CZ +
+ (1 | location) +  (1 | ID),
data=chFP[adults&(chFP$Subspecies=='verus'|chFP$Subspecies=='schweinfurthii'),]
)
summary(gb.tree.vs.wA)
gb.tree.vs.woA.sx = lmer(fWHR ~ Dom_CZ * Neu_CZ * Sex +
+ (1 | location) +  (1 | ID),
data=chFP[adults&(chFP$Subspecies=='verus'|chFP$Subspecies=='schweinfurthii')&chFP$Agr_CZ>=1.052,]
)
## Testing...
gb.tree.vs.woA.sx = lmer(fWHR ~ Dom_CZ * Neu_CZ * Sex +
+ (1 | location) +  (1 | ID),
data=chFP[adults&(chFP$Subspecies=='verus'|chFP$Subspecies=='schweinfurthii')&chFP$Agr_CZ>=1.052,]
)
summary(gb.tree.vs.wA)
## Testing...
gb.tree.vs.woA.sx = lmer(fWHR ~ Dom_CZ * Sex + Neu_CZ * Sex +
+ (1 | location) +  (1 | ID),
data=chFP[adults&(chFP$Subspecies=='verus'|chFP$Subspecies=='schweinfurthii')&chFP$Agr_CZ>=1.052,]
)
summary(gb.tree.vs.wA)
summary(gb.tree.vs.woA)
summary(gb.tree.vs.woA.sx)
## Testing...
gb.tree.vs.woA.sx = lmer(fWHR ~ Dom_CZ * Sex * Neu_CZ * Sex +
+ (1 | location) +  (1 | ID),
data=chFP[adults&(chFP$Subspecies=='verus'|chFP$Subspecies=='schweinfurthii')&chFP$Agr_CZ>=1.052,]
)
summary(gb.tree.vs.woA.sx)
gb.tree.vs.woA.sx = lmer(fWHR ~ Dom_CZ * Sex + Neu_CZ * Sex +
+ (1 | location) +  (1 | ID),
data=chFP[adults&(chFP$Subspecies=='verus'|chFP$Subspecies=='schweinfurthii'),]
)
summary(gb.tree.vs.wA.sx)
## Testing...
gb.tree.vs.woA.sx = lmer(fWHR ~ Dom_CZ * Sex + Neu_CZ * Sex +
+ (1 | location) +  (1 | ID),
data=chFP[adults&(chFP$Subspecies=='verus'|chFP$Subspecies=='schweinfurthii')&chFP$Agr_CZ>=1.052,]
)
gb.tree.vs.wA.sx = lmer(fWHR ~ Dom_CZ * Sex + Neu_CZ * Sex +
+ (1 | location) +  (1 | ID),
data=chFP[adults&(chFP$Subspecies=='verus'|chFP$Subspecies=='schweinfurthii'),]
)
summary(gb.tree.vs.wA.sx)
g <- ggplot(data=subset(chAgr, chAgr$verus),
aes(x=Neu, y=fWHR)) + geom_point() +
facet_grid(. ~ Sex) +
stat_smooth(method='gam') +
theme_bw() + xlab('Dominance')
g <- ggplot(data=subset(chAgr, chAgr$verus=='verus'),
aes(x=Neu, y=fWHR)) + geom_point() +
facet_grid(. ~ Sex) +
stat_smooth(method='gam') +
theme_bw() + xlab('Dominance')
g
g <- ggplot(data=chAgr, aes(x=Neu, y=fWHR)) + geom_point() +
facet_grid(. ~ verus) +
stat_smooth(method='gam') +
theme_bw() + xlab('Neuroticism')
g
m0.lf <- lmer(lffh ~ 1 +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
,data=chFP[adults,]
#,data = chFP[chFP$Age>7,]
)
summary(m0.lf)
m1.1.lf <- lmer(lffh ~ s(Age) +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
#,data = chFP
,data = chFP[adults,]
)
m1.2.lf <- lmer(lffh ~ s(Age) + s(I(Age^2)) +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
#,data = chFP
,data = chFP[adults,]
)
anova(m1.1.lf,m1.2.lf)
m2.lf.i0 <- lmer(lffh ~ s(Age) : Sex +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
#,data = chFP
,data = chFP[adults,]
)
summary(m2.lf.i0)
mp1.lf <- lmer(lffh ~ s(Age):Sex + Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
#,data = chFP
,data = chFP[adults,]
)
summary(mp1.lf)
mp2.f.lf <- lmer(lffh ~ Age + Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
#,data = chFP[chFP$Sex==0,]
,data = chFP[adults&chFP$Sex==0,]
)
mp2.m.lf <- lmer(lffh ~ Age + Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID:Subspecies) + (1 | Subspecies)
#,data = chFP[chFP$Sex==1,]
,data = chFP[adults&chFP$Sex==1,]
)
summary(mp2.f.lf)
summary(mp2.m.lf)
confint(mp2.f.lf, method='profile')
g <- ggplot(data=chAgr, aes(x=Agr, y=fWHR)) + geom_point() +
#facet_grid(verus ~ Sex) +
stat_smooth(method='gam') +
theme_bw() + xlab('Agreeableness')
g
g <- ggplot(data=subset(chAgr, !(chAgr$verus=='other')),
aes(x=Dom, y=fWHR)) + geom_point() +
facet_grid(verus ~ Sex) +
stat_smooth(method='gam') +
theme_bw() + xlab('Dominance')
g
gc()
summary(gb.tree.vs.woA.sx)
summary(gb.tree.vs.wA.sx)
summary(gb.tree.vs.wA)
gb.tree.vs.woA = lmer(fWHR ~ Dom_CZ * Neu_CZ +
+ (1 | location) +  (1 | ID),
data=chFP[adults&(chFP$Subspecies=='verus'|chFP$Subspecies=='schweinfurthii')&chFP$Agr_CZ>=1.052,]
)
summary(gb.tree.vs.woA)
summary(gb.tree.vs.woA)
gb.tree.vs.woA = lmer(fWHR ~ Dom_CZ + Neu_CZ +
+ (1 | location) +  (1 | ID),
data=chFP[adults&(chFP$Subspecies=='verus'|chFP$Subspecies=='schweinfurthii')&chFP$Agr_CZ>=1.052,]
)
summary(gb.tree.vs.woA)
gb.tree.vs.wA = lmer(fWHR ~ Dom_CZ + Neu_CZ +
+ (1 | location) +  (1 | ID),
data=chFP[adults&(chFP$Subspecies=='verus'|chFP$Subspecies=='schweinfurthii'),]
)
summary(gb.tree.vs.wA)
print(tree.p1)
gb.tree.vs.woA = lmer(fWHR ~ Dom_CZ + Neu_CZ +
+ (1 | location) +  (1 | ID),
data=chFP[adults&(chFP$Subspecies=='verus'|chFP$Subspecies=='schweinfurthii')&chFP$Agr_CZ<1.052,]
)
summary(gb.tree.vs.woA)
gb.tree.vs.wA = lmer(fWHR ~ Dom_CZ + Neu_CZ +
+ (1 | location) +  (1 | ID),
data=chFP[adults&(chFP$Subspecies=='verus'|chFP$Subspecies=='schweinfurthii'),]
)
summary(gb.tree.vs.wA)
## Testing...
gb.tree.vs.woA.sx = lmer(fWHR ~ Dom_CZ * Sex + Neu_CZ * Sex +
+ (1 | location) +  (1 | ID),
data=chFP[adults&(chFP$Subspecies=='verus'|chFP$Subspecies=='schweinfurthii')&chFP$Agr_CZ<1.052,]
)
summary(gb.tree.vs.woA.sx)
gb.tree.vs.wA.sx = lmer(fWHR ~ Dom_CZ * Sex + Neu_CZ * Sex +
+ (1 | location) +  (1 | ID),
data=chFP[adults&(chFP$Subspecies=='verus'|chFP$Subspecies=='schweinfurthii'),]
)
summary(gb.tree.vs.wA.sx)
summary(gb.tree.vs.woA)
print(tree.p1)
gb.tree.vs.woA = lmer(fWHR ~ Dom_CZ + Neu_CZ +
+ (1 | location) +  (1 | ID),
data=chFP[adults&(chFP$Subspecies=='verus'|chFP$Subspecies=='schweinfurthii')&chFP$Agr_CZ<1.051,]
)
summary(gb.tree.vs.woA)
gb.tree.vs.wA = lmer(fWHR ~ Dom_CZ + Neu_CZ +
+ (1 | location) +  (1 | ID),
data=chFP[adults&(chFP$Subspecies=='verus'|chFP$Subspecies=='schweinfurthii'),]
)
## Testing...
gb.tree.vs.woA.sx = lmer(fWHR ~ Dom_CZ * Sex + Neu_CZ * Sex +
+ (1 | location) +  (1 | ID),
data=chFP[adults&(chFP$Subspecies=='verus'|chFP$Subspecies=='schweinfurthii')&chFP$Agr_CZ<1.051,]
)
summary(gb.tree.vs.woA.sx)
summary(gb.tree.vs.wA.sx)
gb.tree.vs.wA = lmer(fWHR ~ Dom_CZ * Neu_CZ +
+ (1 | location) +  (1 | ID),
data=chFP[adults&(chFP$Subspecies=='verus'|chFP$Subspecies=='schweinfurthii'),]
)
summary(gb.tree.vs.wA)
gb.tree.vs.woA = lmer(fWHR ~ Dom_CZ * Neu_CZ +
+ (1 | location) +  (1 | ID),
data=chFP[adults&(chFP$Subspecies=='verus'|chFP$Subspecies=='schweinfurthii')&chFP$Agr_CZ<1.051,]
)
summary(gb.tree.vs.woA)
## Testing...
gb.tree.vs.woA.sx = lmer(fWHR ~ Dom_CZ * Sex * Neu_CZ * Sex +
+ (1 | location) +  (1 | ID),
data=chFP[adults&(chFP$Subspecies=='verus'|chFP$Subspecies=='schweinfurthii')&chFP$Agr_CZ<1.051,]
)
gb.tree.vs.wA.sx = lmer(fWHR ~ Dom_CZ * Sex * Neu_CZ * Sex +
+ (1 | location) +  (1 | ID),
data=chFP[adults&(chFP$Subspecies=='verus'|chFP$Subspecies=='schweinfurthii'),]
)
summary(gb.tree.vs.woA.sx)
summary(gb.tree.vs.wA.sx)
curve(dbeta(x,2,2), from=0, to=1)
s <- function(x) {scale(x)}
chFP = read.csv('chimpFacesPersDemos.csv')
chFP = chFP[,-1]
# colnames(chFP)
# dim(chFP)
chFP = chFP[!is.na(chFP$fWHR),]
table(droplevels(chFP$ID[chFP$location=='Edinburgh'|chFP$location=='Edinburgh.VADW'])) # Number of Edi chimps and images/chimp
sum(table(droplevels(chFP$ID[chFP$location=='Bastrop']))) # Number of Bastrop chimps
table(droplevels(chFP$ID[chFP$location=='Japan'])) # NUmber of Japanese chimps and images/
table(chFP$Sex[!duplicated(chFP$ID)]) # Number of males and females
mean(chFP$Age[!duplicated(chFP$ID)], na.rm=TRUE) # Mean age
sd(chFP$Age[!duplicated(chFP$ID)], na.rm=TRUE) # SD age
min(chFP$Age[!duplicated(chFP$ID)], na.rm=TRUE) # Min age
max(chFP$Age[!duplicated(chFP$ID)], na.rm=TRUE) # Max age
# chFP$Age[chFP$location=='Edinburgh']
# !duplicated(chFP$ID)&chFP$location=='Edinburgh'
# chFP$ID[chFP$location=='Edinburgh']
## What is the below for?
#chFP$Age[!duplicated(chFP$ID[chFP$location=='Edinburgh'])] # WRONG
chFP$Age[!duplicated(chFP$ID)&chFP$location=='Edinburgh']
#chFP$Age[!duplicated(chFP$ID=='Liberius')] # WRONG
chFP$Age[!duplicated(chFP$ID=='Liberius')&chFP$location=='Edinburgh'] # this is just the first observation of Lib...
## Aggregate age across individuals then find the mean and SD for the group
Edi = chFP$location=='Edinburgh'|chFP$location=='Edinburgh.VADW'
aggEdi = aggregate(chFP[Edi,], by=list(chFP$ID[Edi]), FUN=mean)
mean(aggEdi$Age) # Mean age
sd(aggEdi$Age) # SD age
mean(table(chFP$ID)) # Mean number of useable images
sd(table(chFP$ID))   # SD of number of useable images
mean(table(droplevels(chFP$ID[chFP$location=='Edinburgh'|chFP$location=='Edinburgh.VADW'])))
sd(table(droplevels(chFP$ID[chFP$location=='Edinburgh'|chFP$location=='Edinburgh.VADW'])))
mean(table(droplevels(chFP$ID[chFP$location=='Japan'])))
sd(table(droplevels(chFP$ID[chFP$location=='Japan'])))
mean(aggregate(chFP$fWHR, by=list(chFP$ID), FUN=mean)[,'x'], na.rm=TRUE) # Mean fWHR
sd(aggregate(chFP$fWHR, by=list(chFP$ID), FUN=mean)[,'x'], na.rm=TRUE) # SD fWHR
chFP$fWHR[chFP$ID=='Lennon']
(chFP$fWHR[chFP$ID=='Lennon'][1] - mean(chFP$fWHR[!duplicated(chFP$ID)]) ) / sd(chFP$fWHR[!duplicated(chFP$ID)])
table(chFP$location[!duplicated(chFP$ID)])
### Zero-order correlation plots
#colnames(chFP)
corrplot(cor(chFP[,c(8,9,12,13,14,15,16,17,18,19),],use="pairwise.complete.obs")
,  method = 'number')
corrplot(cor(chFP[chFP$Sex==0,c(8,12,13,14,15,16,17,18,19),],use="pairwise.complete.obs"),  method = 'number')
corrplot(cor(chFP[chFP$Sex==1,c(8,12,13,14,15,16,17,18,19),],use="pairwise.complete.obs"),  method = 'number')
### Mixed Effect Models
## Collapse subspecies random effects
#levels(chFP$Subspecies)
chFP$Subspecies[chFP$Subspecies=='hybrid'] = 'unknown'
table(chFP$Subspecies[!duplicated(chFP$ID)])
table(chFP$Sex[!duplicated(chFP$ID)&chFP$Subspecies=='verus'])
table(chFP$Sex[!duplicated(chFP$ID)&chFP$Subspecies=='schweinfurthii'])
table(chFP$Sex[!duplicated(chFP$ID)&chFP$Subspecies=='ellioti'])
table(chFP$Sex[!duplicated(chFP$ID)&chFP$Subspecies=='troglodytes'])
table(chFP$Sex[!duplicated(chFP$ID)&chFP$Subspecies=='unknown'])
# basic age,sex index:
adults = (chFP$Sex==0 & chFP$Age>7) | (chFP$Sex==1 & chFP$Age>9)
adults[is.na(adults)] = TRUE
adults = adults & (as.character(chFP$ID) != 'Gage') # 75
adults = adults & (as.character(chFP$ID) != 'Lennon') # This is a good place to pull out Lennon (130, 131)
count(adults)
#View(chFP[adults,])
chFP$ID[!adults]
chFP$Subspecies[!adults & !duplicated(chFP$ID)] # one of these is Lennon, who is verus
set.seed(1234567890)
tree.p1 = REEMtree(fWHR ~ Sex + Age + I(Age^2) + I(Age^3) +
Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
Subspecies,
data=chFP[adults,],
#data=chFP[chFP$ID!='Lennon',],
#random=~1|ID/Subspecies
random = list(location =~ 1, ID =~ 1)#, Subspecies =~ 1)
,cv=TRUE, method='ML'
)
print(tree.p1)
gb.tree.A = lmer(fWHR ~ Agr_CZ +
(1 | location) +  (1 | ID),
data=chFP[adults,])
summary(gb.tree.A)
confint(gb.tree.A, method='profile')
gb.tree.A = lmer(fWHR ~ Agr_CZ +
(1+Agr_CZ | location) +  (1+Agr_CZ | ID),
data=chFP[adults,])
summary(gb.tree.A)
confint(gb.tree.A, method='profile')
library(mgcv)
plot(gam.p3$gam)
gam.p4 <- gam(fWHR ~  s(Agr_CZ, bs='cr') + s(Agr_CZ, bs='re') +
s(Agr_CZ, location, bs='re') + s(Agr_CZ, ID, bs='re') + s(Agr_CZ, Subpecies, bs='re')
,data = chFP[adults,])
gam.p4 <- gam(fWHR ~  s(Agr_CZ, bs='cr') + s(Agr_CZ, bs='re') +
s(Agr_CZ, location, bs='re') + s(Agr_CZ, ID, bs='re') + s(Agr_CZ, Subspecies, bs='re')
,data = chFP[adults,])
plot(gam.p3$gam)
plot(gam.p4$gam)
summary(gam.p4$gam)
summary(gam.p4)
plot(gam.p4)
gam.p4 <- gam(fWHR ~  s(Agr_CZ, bs='tp') + s(Agr_CZ, bs='re') +
s(Agr_CZ, location, bs='re') + s(Agr_CZ, ID, bs='re') + s(Agr_CZ, Subspecies, bs='re')
,data = chFP[adults,])
summary(gam.p4)
plot(gam.p4)
?gam
gam.check(gam.p4)
gam.p5 <- gam(fWHR ~  ti(Neu_CZ, bs='cr') + ti(Dom_CZ, bs='cr')
+ s(Agr_CZ, bs='re') +
s(Agr_CZ, location, bs='re') + s(Agr_CZ, ID, bs='re') + s(Agr_CZ, Subspecies, bs='re')
,data = chFP[adults,])
gam.p5 <- gam(fWHR ~  ti(Neu_CZ, bs='cr') + ti(Dom_CZ, bs='cr')
+ s(Neu_CZ, bs='re') + s(Neu_CZ, location, bs='re')
+ s(Neu_CZ, ID, bs='re') + s(Neu_CZ, Subspecies, bs='re')
+ s(Dom_CZ, bs='re') + s(Dom_CZ, location, bs='re')
+ s(Dom_CZ, ID, bs='re') + s(Dom_CZ, Subspecies, bs='re')
,data = chFP[adults,])
gam.check(gam.p5)
summary(gam.p5)
plot(gam.p5)
gam.p5 <- gam(fWHR ~  ti(Neu_CZ, bs='cr') + ti(Dom_CZ, bs='cr') + ti(Neu_CZ, Dom_CZ, bs='cr')
+ s(Neu_CZ, bs='re') + s(Neu_CZ, location, bs='re')
+ s(Neu_CZ, ID, bs='re') + s(Neu_CZ, Subspecies, bs='re')
+ s(Dom_CZ, bs='re') + s(Dom_CZ, location, bs='re')
+ s(Dom_CZ, ID, bs='re') + s(Dom_CZ, Subspecies, bs='re')
,data = chFP[adults,])
gam.p5 <- gam(fWHR ~  ti(Neu_CZ, bs='cr') + ti(Dom_CZ, bs='cr') + ti(Neu_CZ, Dom_CZ, bs='cr')
+ s(Neu_CZ, bs='re') + s(Neu_CZ, location, bs='re')
+ s(Neu_CZ, ID, bs='re') + #s(Neu_CZ, Subspecies, bs='re')
+ s(Dom_CZ, bs='re') + s(Dom_CZ, location, bs='re')
+ s(Dom_CZ, ID, bs='re') + #s(Dom_CZ, Subspecies, bs='re')
,data = chFP[adults,])
gam.p5 <- gam(fWHR ~  ti(Neu_CZ, bs='cr') + ti(Dom_CZ, bs='cr') + ti(Neu_CZ, Dom_CZ, bs='cr')
+ s(Neu_CZ, bs='re') + s(Neu_CZ, location, bs='re')
+ s(Neu_CZ, ID, bs='re') #+ s(Neu_CZ, Subspecies, bs='re')
+ s(Dom_CZ, bs='re') + s(Dom_CZ, location, bs='re')
+ s(Dom_CZ, ID, bs='re') #+ s(Dom_CZ, Subspecies, bs='re')
,data = chFP[adults,])
gam.check(gam.p5)
summary(gam.p5)
plot(gam.p5)
gam.p5 <- gam(fWHR ~  ti(Neu_CZ, bs='cr') + ti(Dom_CZ, bs='cr') + ti(Neu_CZ, Dom_CZ, bs='cr')
+ s(Neu_CZ, bs='re') + s(Neu_CZ, location, bs='re')
+ s(Neu_CZ, ID, bs='re') #+ s(Neu_CZ, Subspecies, bs='re')
+ s(Dom_CZ, bs='re') + s(Dom_CZ, location, bs='re')
+ s(Dom_CZ, ID, bs='re') #+ s(Dom_CZ, Subspecies, bs='re')
,data = chFP[adults&(chFP$Subspecies=='verus'|chFP$Subspecies=='schweinfurthii'),])
##
gam.p4 <- gam(fWHR ~  s(Agr_CZ, bs='cr') + s(location, bs='re') + s(ID, bs='re') +
s(Agr_CZ, location, bs='re') + s(Agr_CZ, ID, bs='re') + s(Agr_CZ, Subspecies, bs='re')
,data = chFP[adults,])
gam.check(gam.p5)
summary(gam.p5)
gam.check(gam.p4)
summary(gam.p4)
plot(gam.p4)
plot(gb.tree.A)
set.seed(12345)
mp1 <- lmer(fWHR ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
,data = chFP[adults,]
)
summary(mp1)
gb.tree.vs = lmer(fWHR ~ Dom_CZ * Neu_CZ +
+ (1 | location) +  (1 | ID),
data=chFP[adults&(chFP$Subspecies=='verus'|chFP$Subspecies=='schweinfurthii'),]
)
summary(gb.tree.vs)
gb.tree.vs.sx = lmer(fWHR ~ Dom_CZ * Sex * Neu_CZ * Sex +
+ (1 | location) +  (1 | ID),
data=chFP[adults&(chFP$Subspecies=='verus'|chFP$Subspecies=='schweinfurthii'),]
)
summary(gb.tree.vs.sx)
gc()
print(tree.p1)
summary(gb.tree.vs.woA)
gb.tree.vs.woA = lmer(fWHR ~ Dom_CZ * Neu_CZ +
+ (1 | location) +  (1 | ID),
data=chFP[adults&(chFP$Subspecies=='verus'|chFP$Subspecies=='schweinfurthii')&chFP$Agr_CZ>=1.051,]
)
summary(gb.tree.vs.woA)
#########
library(lme4)
gb.tree.vs.woA = lmer(fWHR ~ Dom_CZ * Neu_CZ +
+ (1 | location) +  (1 | ID),
data=chFP[adults&(chFP$Subspecies=='verus'|chFP$Subspecies=='schweinfurthii')&chFP$Agr_CZ>=1.051,]
)
summary(gb.tree.vs.woA)
gc()
sort( sapply(ls(),function(x){object.size(get(x))}))
rm(b0.fw)
rm(cPoints)
rm(gbmi.test)
rm(gbm.test)
rm(gam.p5)
rm(bp1.fw)
rm(gam.p4)
gc()
sort( sapply(ls(),function(x){object.size(get(x))}))
View(sai)
?sai
rm(sai)
sort( sapply(ls(),function(x){object.size(get(x))}))
rm(gam.p1)
rm(gam.p2)
