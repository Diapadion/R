derivs1 <- mp4.f@optinfo$derivs
sc_grad1 <- with(derivs1,solve(Hessian,gradient))
max(abs(sc_grad1)) # Fine
max(pmin(abs(sc_grad1),abs(derivs1$gradient))) # The same - fine.
summary(mp4.f)
confint(mp4.f, method='profile')
confint(mp4.m, method='profile')
confint(mp4.f, method='boot')
warnings()
confint(mp4.f, method='boot')
p.val = 0.0001
qt((1-p.val/2), 16)
qt((1-p.val/2), 29)
?t.test
library(dplyr)
s <- function(x) {scale(x)}
cPoints = read.csv(file = "ChimpfWHR.csv")
chFP <- cPoints[cPoints$fHWR!='N/A',]
chFP = chFP[,c(1:12)]
colnames(chFP)[8] <- 'Age'
chFP$Sex = as.factor(chFP$Sex)
chFP$fHWR = as.numeric(as.character(chFP$fHWR))
chFP = chFP[!is.na(chFP$fHWR),]
View(chFP)
library(tidyr)
lffh <- read.csv('all-chimps-LFFH.csv')
lffh <- separate(data = lffh, col = A, into = c("A.x", "A.y"), sep = "\\,")
lffh <- separate(data = lffh, col = B, into = c("B.x", "B.y"), sep = "\\,")
lffh <- separate(data = lffh, col = G, into = c("G.x", "G.y"), sep = "\\,")
colnames(lffh)
lffh[,15:24] <- data.frame(lapply(lffh[,c('B.x','B.y','G.x','G.y')],
function(x) euc.dist(B.x, B.y, G.x, G.y)))
euc.dist <- function(x1.1, x1.2, x2.1, x2.2) sqrt(sum((c(x1.1, x1.2) - c(x2.1, x2.2)) ^ 2))
lffh[,15:24] <- data.frame(lapply(lffh[,c('B.x','B.y','G.x','G.y')],
function(x) euc.dist(B.x, B.y, G.x, G.y)))
View(lffh)
i = 0
for (i in (1:dim(lffh)[1])){
lffh$lower.face[i] = euc.dist(lffh$B.x[i],lffh$B.y[i],lffh$G.x[i],lffh$G.y[i])
}
lffh$A.x = as.numeric(lffh$A.x)
lffh$A.y = as.numeric(lffh$A.y)
lffh$B.x = as.numeric(lffh$B.x)
lffh$B.y = as.numeric(lffh$B.y)
lffh$G.x = as.numeric(lffh$G.x)
lffh$G.y = as.numeric(lffh$G.y)
i = 0
for (i in (1:dim(lffh)[1])){
lffh$lower.face[i] = euc.dist(lffh$B.x[i],lffh$B.y[i],lffh$G.x[i],lffh$G.y[i])
}
i = 0
for (i in (1:dim(lffh)[1])){
lffh$face.height[i] = euc.dist(lffh$B.x[i],lffh$B.y[i],lffh$A.x[i],lffh$A.y[i])
}
lffh$lffh = (lffh$lower.face)/(lffh$face.height)
head(lffh$lffh)
View(lffh)
cPoints = read.csv(file = 'ChimpfWHR-LFFH.csv') #"ChimpfWHR.csv")
chFP <- cPoints[cPoints$fHWR!='N/A',]
chFP = chFP[,c(1:12)]
colnames(chFP)[8] <- 'Age'
chFP$Sex = as.factor(chFP$Sex)
chFP$fHWR = as.numeric(as.character(chFP$fHWR))
colnames(chFP)
cPoints = read.csv(file = 'ChimpfWHR-LFFH.csv') #"ChimpfWHR.csv")
chFP <- cPoints[cPoints$fHWR!='N/A',]
chFP = chFP[,c(1:12)]
colnames(chFP)[8] <- 'Age'
cPoints = read.csv(file = 'ChimpfWHR-LFFH.csv') #"ChimpfWHR.csv")
colnames(chFP)
colnames(cPoints)
chFP = chFP[,c(1:12,23)]
cPoints = read.csv(file = 'ChimpfWHR-LFFH.csv') #"ChimpfWHR.csv")
chFP <- cPoints[cPoints$fHWR!='N/A',]
chFP = chFP[,c(1:12,23)]
colnames(chFP)[8] <- 'Age'
chFP$Sex = as.factor(chFP$Sex)
chFP$fHWR = as.numeric(as.character(chFP$fHWR))
chFP$lffh = as.numeric(as.character(chFP$lffh))
source('~/GitHub/R/fWHR/mergeFacePers.R')
View(chFP)
library(lme4)
library(car)
library(plyr)
library(corrplot)
library(numDeriv)
library(RCurl)
library(optimx)
s <- function(x) {scale(x)}
chFP = read.csv('chimpFacesPersDemos.csv')
chFP = chFP[,-1]
chFP = chFP[!is.na(chFP$lffh),]
View(chFP)
colnames(chFP)
corrplot(cor(chFP[,c(8,13,14,15,16,17,18),],use="pairwise.complete.obs")
,  method = 'number')
corrplot(cor(chFP[chFP$Sex==0,c(8,13,14,15,16,17,18),],use="pairwise.complete.obs"),  method = 'number')
corrplot(cor(chFP[chFP$Sex==1,c(8,13,14,15,16,17,18),],use="pairwise.complete.obs"),  method = 'number')
levels(chFP$Subspecies)
chFP$Subspecies[chFP$Subspecies=='hybrid'] = 'unknown'
table(chFP$Subspecies)
table(chFP$Sex[chFP$Subspecies=='verus'])
m0.lf <- lmer(lffh ~ 1 +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
,data=chFP
#,data = chFP[chFP$Age>7,]
)
summary(m0)
confint(m0,method='profile')
ranef(m0)
adults = (chFP$Sex==0 & chFP$Age>7) | (chFP$Sex==1 & chFP$Age>9) | (chFP$ID == 'Gage')
adults[is.na(adults)] = TRUE
m1 <- lmer(fWHR ~ s(Age) + s(I(Age^2)) + s(I(Age^3)) +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
#,data = chFP
,data = chFP[adults,]
)
summary(m1)
m2.lf <- lmer(fWHR ~ Age*Sex +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
#,data = chFP
,data = chFP[adults,]
)
summary(m2)
m2.lf <- lmer(lffh ~ Age*Sex +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
#,data = chFP
,data = chFP[adults,]
)
m2.lf <- lmer(lffh ~ Age*Sex +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
#,data = chFP
,data = chFP[adults,]
)
summary(m2.lf)
confint(m2.lf, method='profile')
mp1.lf <- lmer(lffh ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
#,data = chFP
,data = chFP[indx,]
)
summary(mp1.lf)
m2.lf <- lmer(lffh ~ Age + Sex +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
#,data = chFP
,data = chFP[adults,]
)
summary(m2.lf)
m1.lf <- lmer(fWHR ~ s(Age) + s(I(Age^2)) + s(I(Age^3)) +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
#,data = chFP
,data = chFP[adults,]
)
summary(m1.lf)
mp1.lf <- lmer(lffh ~ Age:Sex + Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
#,data = chFP
,data = chFP[indx,]
)
summary(mp1.lf)
mp2.f.lf <- lmer(lffh ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
#,data = chFP[chFP$Sex==0,]
,data = chFP[indx&chFP$Sex==0,]
)
mp2.m.lf <- lmer(lffh ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID:Subspecies) + (1 | Subspecies)
#,data = chFP[chFP$Sex==1,]
,data = chFP[indx&chFP$Sex==1,]
)
summary(mp2.f.lf)
summary(mp2.m.lf)
count(chFP$Subspecies)
mp3.t.lf = lmer(lffh ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
#,data = chFP[chFP$Subspecies=='troglodytes',]
,data = chFP[indx&chFP$Subspecies=='troglodytes',]
)
mp3.v.lf = lmer(lffh ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
#,data = chFP[chFP$Subspecies=='verus',]
,data = chFP[indx&chFP$Subspecies=='verus',]
)
mp2.f.lf <- lmer(lffh ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
#,data = chFP[chFP$Sex==0,]
,data = chFP[adults&chFP$Sex==0,]
)
mp2.m.lf <- lmer(lffh ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID:Subspecies) + (1 | Subspecies)
#,data = chFP[chFP$Sex==1,]
,data = chFP[adults&chFP$Sex==1,]
)
summary(mp2.f.lf)
summary(mp2.m.lf)
mp3.t.lf = lmer(lffh ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
#,data = chFP[chFP$Subspecies=='troglodytes',]
,data = chFP[adults&chFP$Subspecies=='troglodytes',]
)
mp3.v.lf = lmer(lffh ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
#,data = chFP[chFP$Subspecies=='verus',]
,data = chFP[adults&chFP$Subspecies=='verus',]
)
summary(mp3.t.lf) # Nothing for troglodytes.
summary(mp3.v.lf)
mp4.f.lf = lmer(lffh ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
,data = chFP[adults&(chFP$Subspecies=='verus'&chFP$Sex==0),]
,control=lmerControl(optimizer="Nelder_Mead")
)
mp4.m.lf = lmer(lffh ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
,data = chFP[adults&(chFP$Subspecies=='verus'&chFP$Sex==1),]
)
summary(mp4.f.lf)
summary(mp4.m.lf)
summary(mp3.v.lf)
summary(mp1.lf)
mp1.lf <- lmer(lffh ~ Age:Sex + Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
#,data = chFP
,data = chFP[Adults,]
)
mp1.lf <- lmer(lffh ~ Age:Sex + Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
#,data = chFP
,data = chFP[adults,]
)
summary(mp1.lf)
mp3.t.lf = lmer(lffh ~ Age:Sex + Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
#,data = chFP[chFP$Subspecies=='troglodytes',]
,data = chFP[adults&chFP$Subspecies=='troglodytes',]
)
mp3.v.lf = lmer(lffh ~ Age:Sex + Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
#,data = chFP[chFP$Subspecies=='verus',]
,data = chFP[adults&chFP$Subspecies=='verus',]
)
summary(mp3.v.lf)
chFP = read.csv('chimpFacesPersDemos.csv')
chFP = chFP[,-1]
chFP = chFP[!is.na(chFP$lffh),]
levels(chFP$Subspecies)
chFP$Subspecies[chFP$Subspecies=='hybrid'] = 'unknown'
table(chFP$Subspecies)
table(chFP$Sex[chFP$Subspecies=='verus'])
m0.lf <- lmer(lffh ~ 1 +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
,data=chFP
#,data = chFP[chFP$Age>7,]
)
summary(m0)
adults = (chFP$Sex==0 & chFP$Age>7) | (chFP$Sex==1 & chFP$Age>9) | (chFP$ID == 'Gage')
adults[is.na(adults)] = TRUE
m1.lf <- lmer(fWHR ~ s(Age) + s(I(Age^2)) + s(I(Age^3)) +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
#,data = chFP
,data = chFP[adults,]
)
summary(m1.lf)
m2.lf <- lmer(lffh ~ Age + Sex +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
#,data = chFP
,data = chFP[adults,]
)
summary(m2.lf)
mp1.lf <- lmer(lffh ~ Age:Sex + Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
#,data = chFP
,data = chFP[adults,]
)
summary(mp1.lf)
mp2.f.lf <- lmer(lffh ~ Age + Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
#,data = chFP[chFP$Sex==0,]
,data = chFP[adults&chFP$Sex==0,]
)
mp2.m.lf <- lmer(lffh ~ Age + Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID:Subspecies) + (1 | Subspecies)
#,data = chFP[chFP$Sex==1,]
,data = chFP[adults&chFP$Sex==1,]
)
summary(mp2.f.lf)
summary(mp2.m.lf)
m1.lf <- lmer(fWHR ~ s(Age) + s(I(Age^2)) + s(I(Age^3)) +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
#,data = chFP
,data = chFP[adults,]
)
summary(m1.lf)
m1.lf <- lmer(fWHR ~ s(Age)# + s(I(Age^2)) + s(I(Age^3)) +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
#,data = chFP
,data = chFP[adults,]
)
summary(m1.lf)
m1.lf <- lmer(fWHR ~ s(Age)+# s(I(Age^2)) + s(I(Age^3)) +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
#,data = chFP
,data = chFP[adults,]
)
summary(m1.lf)
m1.lf <- lmer(lffh ~ s(Age) + s(I(Age^2)) + s(I(Age^3)) +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
#,data = chFP
,data = chFP[adults,]
)
summary(m1.lf)
m1.lf <- lmer(lffh ~ s(Age) + #s(I(Age^2)) + s(I(Age^3)) +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
#,data = chFP
,data = chFP[adults,]
)
summary(m1.lf)
m1.lf <- lmer(lffh ~ s(Age) + s(I(Age^2)) + #s(I(Age^3)) +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
#,data = chFP
,data = chFP[adults,]
)
summary(m1.lf)
m2.lf <- lmer(lffh ~ Age + Sex +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
#,data = chFP
,data = chFP[adults,]
)
summary(m2.lf)
m2.lf.i <- lmer(lffh ~ Age * Sex +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
#,data = chFP
,data = chFP[adults,]
)
summary(m2.lf.i)
mp2.f.lf <- lmer(lffh ~ Age + Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
#,data = chFP[chFP$Sex==0,]
,data = chFP[adults&chFP$Sex==0,]
)
summary(mp2.f.lf)
summary(mp2.m.lf)
confint(mp2.f.lf, method='profile')
confint(mp2.m.lf, method='profile')
summary(mp2.f.lf)
colnames(chFP)
corrplot(cor(chFP[,c(8,13,14,15,16,17,18),],use="pairwise.complete.obs")
,  method = 'number')
library(lme4)
library(car)
library(corrplot)
library(plyr)
library(numDeriv)
library(RCurl)
library(optimx)
chFP = read.csv('chimpFacesPersDemos.csv')
chFP = chFP[,-1]
chFP = chFP[!is.na(chFP$lffh),]
colnames(chFP)
corrplot(cor(chFP[,c(8,13,14,15,16,17,18),],use="pairwise.complete.obs")
,  method = 'number')
corrplot(cor(chFP[chFP$Sex==0,c(8,13,14,15,16,17,18),],use="pairwise.complete.obs"),  method = 'number')
corrplot(cor(chFP[chFP$Sex==1,c(8,13,14,15,16,17,18),],use="pairwise.complete.obs"),  method = 'number')
levels(chFP$Subspecies)
chFP$Subspecies[chFP$Subspecies=='hybrid'] = 'unknown'
table(chFP$Subspecies)
table(chFP$Sex[chFP$Subspecies=='verus'])
m0.lf <- lmer(lffh ~ 1 +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
,data=chFP
#,data = chFP[chFP$Age>7,]
)
adults = (chFP$Sex==0 & chFP$Age>7) | (chFP$Sex==1 & chFP$Age>9) | (chFP$ID == 'Gage')
adults[is.na(adults)] = TRUE
m1.1.lf <- lmer(lffh ~ s(Age) +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
#,data = chFP
,data = chFP[adults,]
)
m1.2.lf <- lmer(lffh ~ s(Age) + s(I(Age^2)) +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
#,data = chFP
,data = chFP[adults,]
)
extractAIC(m.1.lf)
extractAIC(m1.1.lf)
extractAIC(m1.2.lf)
install.packages("epicalc")
?lrtest
library(lmtest)
lrtest(m1.1.lf)
?lrtest
anova(fm1,fm2)
anova(m1.1.lf,m1.2.lf)
summary(m1.1.lf)
confint(m1.1.lf, method='profile')
m2.lf <- lmer(lffh ~ s(Age) * Sex +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
#,data = chFP
,data = chFP[adults,]
)
summary(m2.lf)
m2.lf <- lmer(lffh ~ s(Age) + Sex +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
#,data = chFP
,data = chFP[adults,]
)
summary(m2.lf)
confint(m2.lf, method='profile')
m2.lf.i <- lmer(lffh ~ s(Age) * Sex +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
#,data = chFP
,data = chFP[adults,]
)
summary(m2.lf.i)
anova(m2.lf,m2.lf.i)
m2.lf.i0 <- lmer(lffh ~ s(Age) : Sex +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
#,data = chFP
,data = chFP[adults,]
)
summary(m2.lf.i0)
m2.lf.i2 <- lmer(lffh ~ s(Age) + s(Age):Sex +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
#,data = chFP
,data = chFP[adults,]
)
anova(m2.lf,m2.lf.i,m2.lf.i0,m2.lf.i2)
summary(m2.lf.i2)
anova(m2.lf.i0,m2.lf.i2)
anova(m2.lf,m2.lf.i,m2.lf.i0)#,m2.lf.i2)
anova(m2.lf,m2.lf.i,m2.lf.i0)
mp1.lf <- lmer(lffh ~ Age:Sex + Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
#,data = chFP
,data = chFP[adults,]
)
mp1.lf <- lmer(lffh ~ s(Age):Sex + Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
#,data = chFP
,data = chFP[adults,]
)
summary(mp1.lf)
mp2.f.lf <- lmer(lffh ~ Age + Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | Subspecies) + (1 | ID:Subspecies)
#,data = chFP[chFP$Sex==0,]
,data = chFP[adults&chFP$Sex==0,]
)
mp2.m.lf <- lmer(lffh ~ Age + Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID:Subspecies) + (1 | Subspecies)
#,data = chFP[chFP$Sex==1,]
,data = chFP[adults&chFP$Sex==1,]
)
summary(mp2.f.lf)
summary(mp2.m.lf)
confint(mp2.f.lf, method='profile')
confint(mp2.m.lf, method='profile')
mp3.t.lf = lmer(lffh ~ Sex:Age + Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
#,data = chFP[chFP$Subspecies=='troglodytes',]
,data = chFP[adults&chFP$Subspecies=='troglodytes',]
)
mp3.t.lf = lmer(lffh ~ Age + Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
#,data = chFP[chFP$Subspecies=='troglodytes',]
,data = chFP[adults&chFP$Subspecies=='troglodytes',]
)
mp3.t.lf = lmer(lffh ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ + #Age:Sex +
(1 | location) + (1 | ID)
#,data = chFP[chFP$Subspecies=='troglodytes',]
,data = chFP[adults&chFP$Subspecies=='troglodytes',]
)
mp3.t.lf = lmer(lffh ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ + Age:Sex +
(1 | location) + (1 | ID)
#,data = chFP[chFP$Subspecies=='troglodytes',]
,data = chFP[adults&chFP$Subspecies=='troglodytes',]
) # The Age:Sex interaction makes the model intractable
summary(mp3.t.lf) # Nothing for troglodytes.
mp3.v.lf = lmer(lffh ~ Age:Sex + Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
#,data = chFP[chFP$Subspecies=='verus',]
,data = chFP[adults&chFP$Subspecies=='verus',]
)
summary(mp3.t.lf) # Nothing for troglodytes.
mp3.t.lf = lmer(lffh ~ Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ + #Age:Sex +
(1 | location) + (1 | ID)
#,data = chFP[chFP$Subspecies=='troglodytes',]
,data = chFP[adults&chFP$Subspecies=='troglodytes',]
) # The Age:Sex interaction makes the model intractable, so it has to be omitted. Not sure what else to do about that...
summary(mp3.t.lf) # Nothing for troglodytes.
summary(mp3.v.lf)
confint(mp3.v, method='profile')
confint(mp3.v.lf, method='profile')
confint(mp3.v.lf, method='boot')
mp4.f.lf = lmer(lffh ~ Age + Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
,data = chFP[adults&(chFP$Subspecies=='verus'&chFP$Sex==0),]
,control=lmerControl(optimizer="Nelder_Mead")
)
summary(mp4.f.lf)
mp4.m.lf = lmer(lffh ~ Age + Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
(1 | location) + (1 | ID)
,data = chFP[adults&(chFP$Subspecies=='verus'&chFP$Sex==1),]
)
summary(mp4.m.lf)
confint(mp4.f.lf, method='profile')
confint(mp4.m.lf, method='profile')
warnings()
chFP = read.csv('chimpFacesPersDemos.csv')
chFP = chFP[,-1]
chFP = chFP[!is.na(chFP$lffh),]
colnames(chFP)
