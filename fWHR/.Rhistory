View(fWHRc)
?cart
?rpart
?rpart
plot(tree.p1)
print(tree.p1)
print(cit.p1$Tree)
plot(cit.p1$Tree)
table(chFP$location[!duplicated(chFP$ID)])
View(cPers)
18 + 58
which(chFP$ID=='Lennoin')
which(chFP$ID=='Lennon')
tree.p1 = REEMtree(fWHR ~ Sex + Age + I(Age^2) + I(Age^3) +
Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
Subspecies,
#data=chFP[adults,],
data=chFP[chFP$ID=='Lennon',],
#random=~1|ID/Subspecies
random = list(location =~ 1, ID =~ 1)#, Subspecies =~ 1)
,cv=TRUE, method='ML'
)
library(REEMtree)
set.seed(1234567)
tree.p1 = REEMtree(fWHR ~ Sex + Age + I(Age^2) + I(Age^3) +
Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
Subspecies,
#data=chFP[adults,],
data=chFP[chFP$ID=='Lennon',],
#random=~1|ID/Subspecies
random = list(location =~ 1, ID =~ 1)#, Subspecies =~ 1)
,cv=TRUE, method='ML'
)
print(tree.p1)
plot(tree.p1)
set.seed(12345)
tree.p1 = REEMtree(fWHR ~ Sex + Age + I(Age^2) + I(Age^3) +
Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
Subspecies,
#data=chFP[adults,],
data=chFP[chFP$ID=='Lennon',],
#random=~1|ID/Subspecies
random = list(location =~ 1, ID =~ 1)#, Subspecies =~ 1)
,cv=TRUE, method='ML'
)
print(tree.p1)
plot(tree.p1)
tree.p1 = REEMtree(fWHR ~ Sex + Age + I(Age^2) + I(Age^3) +
Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
Subspecies,
#data=chFP[adults,],
data=chFP[chFP$ID=='Lennon',],
#random=~1|ID/Subspecies
random = list(location =~ 1, ID =~ 1)#, Subspecies =~ 1)
,cv=TRUE, method='ML'
)
print(tree.p1)
tree.p1 = REEMtree(fWHR ~ Sex + Age + I(Age^2) + I(Age^3) +
Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
Subspecies,
#data=chFP[adults,],
data=chFP[chFP$ID=='Lennon',],
#random=~1|ID/Subspecies
random = list(location =~ 1, ID =~ 1)#, Subspecies =~ 1)
,cv=TRUE, method='ML'
)
print(tree.p1)
tree.p1 = REEMtree(fWHR ~ Sex + Age + I(Age^2) + I(Age^3) +
Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
Subspecies,
#data=chFP[adults,],
data=chFP[chFP$ID=='Lennon',],
#random=~1|ID/Subspecies
random = list(location =~ 1, ID =~ 1)#, Subspecies =~ 1)
,cv=TRUE, method='ML'
)
print(tree.p1)
tree.p1 = REEMtree(fWHR ~ Sex + Age + I(Age^2) + I(Age^3) +
Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
Subspecies,
#data=chFP[adults,],
data=chFP[chFP$ID=='Lennon',],
#random=~1|ID/Subspecies
random = list(location =~ 1, ID =~ 1)#, Subspecies =~ 1)
,cv=TRUE, method='ML'
)
print(tree.p1)
tree.p1 = REEMtree(fWHR ~ Sex + Age + I(Age^2) + I(Age^3) +
Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
Subspecies,
#data=chFP[adults,],
data=chFP[chFP$ID=='Lennon',],
#random=~1|ID/Subspecies
random = list(location =~ 1, ID =~ 1)#, Subspecies =~ 1)
,cv=TRUE, method='ML'
)
print(tree.p1)
tree.p1 = REEMtree(fWHR ~ Sex + Age + I(Age^2) + I(Age^3) +
Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
Subspecies,
#data=chFP[adults,],
data=chFP[chFP$ID=='Lennon',],
#random=~1|ID/Subspecies
random = list(location =~ 1, ID =~ 1)#, Subspecies =~ 1)
,cv=TRUE, method='ML'
)
print(tree.p1)
set.seed(1234567)
cit.p1 = REEMctree(fWHR ~ Sex + Age + I(Age^2) + I(Age^3) +
Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
Subspecies,
#data=chFP[adults,],
data=chFP[chFP$ID=='Lennon',],
#random=~1|ID/Subspecies
random = list(location =~ 1, ID =~ 1)#, Subspecies =~ 1)
, method='REML'
)
?where
library(party)
library(rpart)
cit.p1 = REEMctree(fWHR ~ Sex + Age + I(Age^2) + I(Age^3) +
Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
Subspecies,
#data=chFP[adults,],
data=chFP[chFP$ID=='Lennon',],
#random=~1|ID/Subspecies
random = list(location =~ 1, ID =~ 1)#, Subspecies =~ 1)
, method='REML'
)
plot(cit.p1$Tree)
print(cit.p1$Tree)
cit.p1 = REEMctree(fWHR ~ Sex + Age + I(Age^2) + I(Age^3) +
Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
Subspecies,
#data=chFP[adults,],
data=chFP[chFP$ID=='Lennon',],
#random=~1|ID/Subspecies
random = list(location =~ 1, ID =~ 1)#, Subspecies =~ 1)
, method='REML'
)
print(cit.p1$Tree)
cit.p1 = REEMctree(fWHR ~ Sex + Age + I(Age^2) + I(Age^3) +
Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
Subspecies,
#data=chFP[adults,],
data=chFP[chFP$ID=='Lennon',],
#random=~1|ID/Subspecies
random = list(location =~ 1, ID =~ 1)#, Subspecies =~ 1)
, method='REML'
)
cit.p1 = REEMctree(fWHR ~ Sex + Age + I(Age^2) + I(Age^3) +
Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
Subspecies,
#data=chFP[adults,],
data=chFP[chFP$ID=='Lennon',],
#random=~1|ID/Subspecies
random = list(location =~ 1, ID =~ 1)#, Subspecies =~ 1)
, method='REML'
)
cit.p1 = REEMctree(fWHR ~ Sex + Age + I(Age^2) + I(Age^3) +
Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
Subspecies,
#data=chFP[adults,],
data=chFP[chFP$ID=='Lennon',],
#random=~1|ID/Subspecies
random = list(location =~ 1, ID =~ 1)#, Subspecies =~ 1)
, method='REML'
)
cit.p1 = REEMctree(fWHR ~ Sex + Age + I(Age^2) + I(Age^3) +
Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
Subspecies,
#data=chFP[adults,],
data=chFP[chFP$ID=='Lennon',],
#random=~1|ID/Subspecies
random = list(location =~ 1, ID =~ 1)#, Subspecies =~ 1)
, method='REML'
)
cit.p1 = REEMctree(fWHR ~ Sex + Age + I(Age^2) + I(Age^3) +
Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
Subspecies,
#data=chFP[adults,],
data=chFP[chFP$ID=='Lennon',],
#random=~1|ID/Subspecies
random = list(location =~ 1, ID =~ 1)#, Subspecies =~ 1)
, method='REML'
)
cit.p1 = REEMctree(fWHR ~ Sex + Age + I(Age^2) + I(Age^3) +
Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
Subspecies,
#data=chFP[adults,],
data=chFP[chFP$ID=='Lennon',],
#random=~1|ID/Subspecies
random = list(location =~ 1, ID =~ 1)#, Subspecies =~ 1)
, method='REML'
)
cit.p1 = REEMctree(fWHR ~ Sex + Age + I(Age^2) + I(Age^3) +
Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
Subspecies,
#data=chFP[adults,],
data=chFP[chFP$ID=='Lennon',],
#random=~1|ID/Subspecies
random = list(location =~ 1, ID =~ 1)#, Subspecies =~ 1)
, method='REML'
)
cit.p1 = REEMctree(fWHR ~ Sex + Age + I(Age^2) + I(Age^3) +
Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
Subspecies,
#data=chFP[adults,],
data=chFP[chFP$ID=='Lennon',],
#random=~1|ID/Subspecies
random = list(location =~ 1, ID =~ 1)#, Subspecies =~ 1)
, method='REML'
)
print(cit.p1$Tree)
set.seed(12345)
tree.p1 = REEMtree(fWHR ~ Sex + Age + I(Age^2) + I(Age^3) +
Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
Subspecies,
#data=chFP[adults,],
data=chFP[chFP$ID!='Lennon',],
#random=~1|ID/Subspecies
random = list(location =~ 1, ID =~ 1)#, Subspecies =~ 1)
,cv=TRUE, method='ML'
)
print(tree.p1)
plot(tree.p1)
set.seed(12345)
set.seed(1234567)
tree.p1 = REEMtree(fWHR ~ Sex + Age + I(Age^2) + I(Age^3) +
Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
Subspecies,
#data=chFP[adults,],
data=chFP[chFP$ID!='Lennon',],
#random=~1|ID/Subspecies
random = list(location =~ 1, ID =~ 1)#, Subspecies =~ 1)
,cv=TRUE, method='ML'
)
print(tree.p1)
plot(tree.p1)
tree.p1 = REEMtree(fWHR ~ Sex + Age + I(Age^2) + I(Age^3) +
Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
Subspecies,
#data=chFP[adults,],
data=chFP[chFP$ID!='Lennon',],
#random=~1|ID/Subspecies
random = list(location =~ 1, ID =~ 1)#, Subspecies =~ 1)
,cv=TRUE, method='ML'
)
print(tree.p1)
set.seed(1234567)
tree.p1 = REEMtree(fWHR ~ Sex + Age + I(Age^2) + I(Age^3) +
Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
Subspecies,
#data=chFP[adults,],
data=chFP[chFP$ID!='Lennon',],
#random=~1|ID/Subspecies
random = list(location =~ 1, ID =~ 1)#, Subspecies =~ 1)
,cv=TRUE, method='ML'
)
print(tree.p1)
set.seed(12345678)
tree.p1 = REEMtree(fWHR ~ Sex + Age + I(Age^2) + I(Age^3) +
Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
Subspecies,
#data=chFP[adults,],
data=chFP[chFP$ID!='Lennon',],
#random=~1|ID/Subspecies
random = list(location =~ 1, ID =~ 1)#, Subspecies =~ 1)
,cv=TRUE, method='ML'
)
print(tree.p1)
plot(tree.p1)
set.seed(1234567)
set.seed(12345678)
cit.p1 = REEMctree(fWHR ~ Sex + Age + I(Age^2) + I(Age^3) +
Dom_CZ + Ext_CZ + Con_CZ + Agr_CZ + Neu_CZ + Opn_CZ +
Subspecies,
#data=chFP[adults,],
data=chFP[chFP$ID!='Lennon',],
#random=~1|ID/Subspecies
random = list(location =~ 1, ID =~ 1)#, Subspecies =~ 1)
, method='REML'
)
plot(cit.p1$Tree)
print(cit.p1$Tree)
summary(m0.0)
m0 <- lmer(fWHR ~ 1 + (1|instrument) +
#(1 | location) +
(1 | Subspecies) + (1 | ID:Subspecies)
#,data=chFP[adults,]
,data=chFP[chFP$ID!='Lennon',]
)
library(lme4)
library(car)
library(corrplot)
library(plyr)
library(numDeriv)
library(RCurl)
library(optimx)
m0 <- lmer(fWHR ~ 1 + (1|instrument) +
#(1 | location) +
(1 | Subspecies) + (1 | ID:Subspecies)
#,data=chFP[adults,]
,data=chFP[chFP$ID!='Lennon',]
)
summary(m0)
ranef(m0)
m0.0 <- lmer(fWHR ~ 1 +
(1 | location) + (1 | Subspecies)
#,data=chFP[adults,]
,data=chFP[chFP$ID!='Lennon',]
)
summary(m0.0)
ranef(m0.0)
library(lme4)
library(lattice)
library(ggplot2)
g <- ggplot(data=subset(chAgr, !(chAgr$verus=='other')),
aes(x=Dom, y=fWHR)) + geom_point() +
facet_grid(verus ~ Sex) +
stat_smooth(method='gam') +
theme_bw() + xlab('Dominance')
g
g <- ggplot(data=chAgr,
aes(x=Dom, y=fWHR)) + geom_point() +
facet_grid(verus ~ Sex) +
stat_smooth(method='gam') +
theme_bw() + xlab('Dominance')
g
chAgr$verus = 'other'
chAgr$verus[chAgr$Subspecies=='verus'] = 'verus'
chAgr$verus[chAgr$Subspecies=='troglodytes'] = 'troglodytes'
chAgr$Sex = as.factor(chAgr$Sex)
levels(chAgr$Sex) <- c('Female','Male')
g <- ggplot(data=subset(chAgr, !(chAgr$verus=='other')),
aes(x=Dom, y=fWHR)) + geom_point() +
facet_grid(verus ~ Sex) +
stat_smooth(method='gam') +
theme_bw() + xlab('Dominance')
g <- ggplot(data=chAgr,
aes(x=Dom, y=fWHR)) + geom_point() +
facet_grid(verus ~ Sex) +
stat_smooth(method='gam') +
theme_bw() + xlab('Dominance')
g
table(chAgr$verus)
# basic age,sex index:
adults = (chFP$Sex==0 & chFP$Age>=7) | (chFP$Sex==1 & chFP$Age>=9)
set.seed(1234567)
chFP = read.csv('chimpFacesPersDemos.csv')
chFP = chFP[,-1]
# colnames(chFP)
# dim(chFP)
chFP = chFP[!is.na(chFP$fWHR),]
#levels(chFP$Subspecies)
chFP$Subspecies[chFP$Subspecies=='hybrid'] = 'unknown'
table(chFP$Subspecies[!duplicated(chFP$ID)])
table(chFP$Sex[!duplicated(chFP$ID)&chFP$Subspecies=='verus'])
table(chFP$Sex[!duplicated(chFP$ID)&chFP$Subspecies=='schweinfurthii'])
table(chFP$Sex[!duplicated(chFP$ID)&chFP$Subspecies=='ellioti'])
# basic age,sex index:
adults = (chFP$Sex==0 & chFP$Age>=7) | (chFP$Sex==1 & chFP$Age>=9)
adults[is.na(adults)] = TRUE
adults = adults & (as.character(chFP$ID) != 'Gage') # 75
adults = adults & (as.character(chFP$ID) != 'Lennon') # This is a good place to pull out Lennon (130, 131)
# count(adults)
# View(chFP[adults,])
chFP$Subspecies[!adults & !duplicated(chFP$ID)] # one of these is Lennon, who is verus
mp3.tree = lmer(fWHR ~ Sex * Dom_CZ * Neu_CZ +
(1 | location) + (1 | ID),
#data = chFP[adults&(chFP$Subspecies=='verus'|chFP$Subspecies=='schweinfurthii'|chFP$Subspecies=='unknown'),]
#data = chFP[adults&(chFP$Subspecies=='verus'|chFP$Subspecies=='schweinfurthii'),]
data = chFP[adults&(chFP$Subspecies=='verus'),]
)
library(caret)
library(party)
library(rpart)
library(REEMtree)
library(lme4)
mp3.tree = lmer(fWHR ~ Sex * Dom_CZ * Neu_CZ +
(1 | location) + (1 | ID),
#data = chFP[adults&(chFP$Subspecies=='verus'|chFP$Subspecies=='schweinfurthii'|chFP$Subspecies=='unknown'),]
#data = chFP[adults&(chFP$Subspecies=='verus'|chFP$Subspecies=='schweinfurthii'),]
data = chFP[adults&(chFP$Subspecies=='verus'),]
)
summary(mp3.tree)
set.seed(1234567)
mp3.tree.both = lmer(fWHR ~ Sex * Dom_CZ * Neu_CZ +
(1 | location) + (1 | ID),
data = chFP[adults,]
)
summary(mp3.tree.both)
count(adults)
library(lme4)
library(car)
library(corrplot)
library(numDeriv)
library(plyr)
library(RCurl)
library(optimx)
count(adults)
View(chFP[adults,])
chFP$ID[!adults]
adults = (chFP$Sex==0 & chFP$Age>7) | (chFP$Sex==1 & chFP$Age>9)
adults[is.na(adults)] = TRUE
adults = adults & (as.character(chFP$ID) != 'Gage') # 75
adults = adults & (as.character(chFP$ID) != 'Lennon') # This is a good place to pull out Lennon (130, 131)
count(adults)
chFP$ID[!adults]
adults = (chFP$Sex==0 & chFP$Age>7) | (chFP$Sex==1 & chFP$Age>9)
adults[is.na(adults)] = TRUE
chFP$ID[!adults]
adults = (chFP$Sex==0 & chFP$Age>7)
count(adults)
chFP$ID[!adults]
chFP$ID[!adults&chFP$Sex==0]
adults = (chFP$Sex==1 & chFP$Age>9)
chFP$ID[!adults&chFP$Sex==1]
View(chFP)
adults = (chFP$Sex==0 & chFP$Age>7) | (chFP$Sex==1 & chFP$Age>9)
chFP$ID[!adults]
adults = (chFP$Sex==0 & chFP$Age>7) | (chFP$Sex==1 & chFP$Age>9)
adults[is.na(adults)] = TRUE
adults = adults & (as.character(chFP$ID) != 'Gage') # 75
adults = adults & (as.character(chFP$ID) != 'Lennon') # This is a good place to pull out Lennon (130, 131)
chFP$ID[!adults]
chFP$Subspecies[!adults & !duplicated(chFP$ID)] # one of these is Lennon, who is verus
install.packages("metafor")
library(metfor)
library(metafor)
demo(metafor)
?metafor
vignette("metafor_diagram")
library(psych)
?pscyh
?KMO
cor(Thurstone)
KMO(Thurstone)
cortest.bartlett(Thurstone)
head(Thurstone)
View(Thurstone)
View(cattell)
View(Chen)
View(cities)
View(epi)
View(Gorsuch
)
View(Harman.political)
View(Harman.Holzinger)
library(mgcv)
KMO(epi)
cortest.bartlett(epi)
nfactors(epi.bfi)
fa.parallel(epi.bfi)
?nfactors
nfactors(epi.bfi, rotate='oblimin')
fa.parallel(epi.bfi)
fa.parallel(epi.bfi, rotate='oblimin')
fa.parallel(epi.bfi, rotate='oblmin')
fa.parallel(epi.bfi, rotate='oblimin')
fa.parallel?
''
?fa.parallel
library(mgcv)
cor.test
?cor.test
cor.test(Thurstone)
library(psych)
?corr.test
?psych
data(epi.bfi)
View(epi.bfi)
tst1 <- gam(epilie ~ te(bfneur, bfagree), data=epi.bfi)
summary(tst1)
vis.gam(tst1)
tst2 <- gam(epilie ~ ti(bfneur, bfagree), data=epi.bfi)
summary(tst2)
vis.gam(tst2)
plot(tst1)
plot(tst2)
tst3 <- gam(epilie ~ ti(bfneur) + ti(bfagree) + ti(bfneur, bfagree), data=epi.bfi)
summary(tst3)
plot(tst3)
vis.gam(tst3)
tst3 <- gam(epilie ~ ti(bfneur) + ti(bdi) + ti(bfneur, bdi), data=epi.bfi)
summary(tst3)
tst3 <- gam(bdi ~ ti(bfneur) + ti(bfcon) + ti(bfneur, bfcon), data=epi.bfi)
summary(tst3)
plot(tst3)
vis.gam(tst3)
library(psych)
mean(table(droplevels(chFP$ID[chFP$location=='Edinburgh'])))
sd(table(droplevels(chFP$ID[chFP$location=='Edinburgh'])))
table(droplevels(chFP$ID[chFP$location=='Edinburgh'])) # Number of Edi chimps and images/chimp
library(alphahull)
library(tidyr)
library(dplyr)
table(droplevels(chFP$ID[chFP$location=='Edinburgh'])) # Number of Edi chimps and images/chimp
mean(chFP$Age[!duplicated(chFP$ID)], na.rm=TRUE) # Mean age
mean(table(droplevels(chFP$ID[chFP$location=='Edinburgh'])))
mean(chFP$fWHR[!duplicated(chFP$ID)], na.rm=TRUE) # Mean age
mean(chFP$fWHR[!duplicated(chFP$ID)], na.rm=TRUE) # Mean age
sd(chFP$fWHR[!duplicated(chFP$ID)], na.rm=TRUE) # SD age
mean(chFP$Age[!duplicated(chFP$ID[chFP$location=='Edinburgh'])], na.rm=TRUE) # Mean age
chFP$Age[!duplicated(chFP$ID[chFP$location=='Edinburgh'])]
chFP$Age[!duplicated(chFP$ID=='Liberius'])]
chFP$Age[!duplicated(chFP$ID=='Liberius')]
sd(chFP$Age[!duplicated(chFP$ID[chFP$location=='Edinburgh'])], na.rm=TRUE) # Mean age
summary(m0.0)
confint(m0.0,method='profile')
plot(tree.p1)
summary(gb.tree.vs.x)
