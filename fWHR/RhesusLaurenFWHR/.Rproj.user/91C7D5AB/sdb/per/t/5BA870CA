{
    "collab_server" : "",
    "contents" : "require(\"aod\"); require(\"car\"); require(\"doBy\"); require(\"gdata\") # to read in xls files\nrequire(\"ggplot2\")\n# Read in data set\nfWHR      <- gdata::read.xls(\"~/Dropbox/shared folders/Blake/data/Capuchin_fWHR.xlsx\")\nFFM       <- gdata::read.xls(\"~/Dropbox/shared folders/Blake/data/Capuchin_personality.xlsx\")\n# NB 'shared folders' not required when run direct from folder.\n\nFFM$ID    = as.character(FFM$ID)\nfWHR$ID   = as.character(fWHR$ID)\nfWHR$Status = as.character(fWHR$Alpha)\nfWHR$Status[fWHR$Status==\"YES \"] = \"Alpha\"\nfWHR$Status[fWHR$Status==\"NO \"] = \"nonAlpha\"\nfWHR$Status = as.factor(fWHR$Status)\nlevels(fWHR$Status)\nfWHR$DOB  = as.Date(as.character(fWHR$DOB))\nstr(fWHR)\n\n# ID            Set           DOB           Sex           Age           Year_taken    No_of_photos \n# mean_fWHR     min_fWHR      max_fWHR      phys_fWHR     SD            DominanceZ    Alpha        \n# Assertiveness Openness      Neuroticism   Sociability   Attentiveness\n\n# =====================================\n# = Old stuff to discover ID variants =\n# =====================================\n# fWHR$ID[!(fWHR$ID %in% FFM$ID)]\n# FFM$ID[!(FFM$ID %in% fWHR$ID)]\n\n# ============\n# = subjects =\n# ============\ndoBy::summaryBy(Age ~ Sex+set, data = fWHR, FUN = function(x){c(n= length(x), mean = mean(x), sd = sd(x), min=min(x), max=max(x)) })\n#      Sex Age.n  Age.mean    Age.sd\n# 1 female    29 12.965517 10.125931\n# 2   male    35  9.085714  8.671696\n# \n#      Sex set Age.n  Age.mean    Age.sd Age.min Age.max\n# 1 female GSU    13 15.307692 12.263663       4      40\n# 2 female  LL     6  8.166667  4.355074       3      14\n# 3 female NIH    10 12.800000  9.199034       2      31\n# 4   male GSU     9 10.888889  5.797509       4      22\n# 5   male  LL    10 11.400000 14.159410       2      38\n# 6   male NIH    16  6.625000  4.500000       2      20\n\n# ===========\n# = Results =\n# ===========\n\n# Are there differences in sex or age by site (called set in the datafile)?\n# http://www.ats.ucla.edu/stat/r/dae/logit.htm\nmylogit = glm(Sex ~ set, family=binomial(link=\"logit\"), na.action=na.pass, data=fWHR)\nsummary(mylogit)\naod::wald.test(b=coef(mylogit), Sigma=vcov(mylogit), Terms=2:3)\n# Χ^2(2)=2.5, p=.28\n\nanova(lm(Age ~ set, data=fWHR))\n# F(2,61)=1.4107, p=0.25\n\n# Need a reliability section early on in the paper: So something like \"For X animals multiple photos were available. Each of these were scored, and ICC computed to calculate the reliability of the mean_fWHR measure\"\n# TODO: ICCs for repeated measurements of single animals\n\nwith(fWHR,ftable(Status, Sex, Adult_status))\n# ===================================================================\n# = Hypothesis testing: Is fWHR sexually dimorphic? Are there age differences?\n# ===================================================================\n\n# Graph alpha and sex effects on fWHR × age\ncar::scatterplot(mean_fWHR ~ Age |  Status, data = fWHR[fWHR$Sex==\"male\",], ylim=c(1.9,2.6), xlim=c(0,40), legend.coords=\"topleft\", xlab= \"Age (years)\", ylab=\"Mean facial width/height ratio (fWHR)\")\ncar::scatterplot(mean_fWHR ~ Age |  Status, data = fWHR[fWHR$Sex==\"female\",], ylim=c(1.9,2.6), xlim=c(0,40), legend.coords=\"topleft\", xlab= \"Age (years)\", ylab=\"Mean facial width/height ratio (fWHR)\")\nqplot(Age, mean_fWHR, shape=Status, color=Sex, geom=c(\"point\",\"smooth\"), method=\"lm\", data = fWHR)\n\n# Age has significant effects\nm1 <- lm(fWHR ~ Age + I(Age^2) + I(Age^3), data=fWHR)\nsummary(m1); anova(m1)\n#           Df  Sum Sq  Mean Sq F value  Pr(>F)  \n# Age        1 0.00036 0.000361  0.0159 0.90001  \n# I(Age^2)   1 0.15224 0.152238  6.7185 0.01197 *\n# I(Age^3)   1 0.05694 0.056944  2.5130 0.11817  \n# Residuals 60 1.35958 0.022660                  \n\n# Linear models of age and sex\n## Full sample\nm3 <- lm(mean_fWHR ~ I(Age^2) + Age * Sex, data=fWHR); anova(m3)\n#           Df  Sum Sq Mean Sq F value    Pr(>F)    \n# I(Age^2)   1 0.00789 0.00789  0.4711  0.495158    \n# Age        1 0.14471 0.14471  8.6366  0.004696 ** \n# Sex        1 0.10172 0.10172  6.0712  0.016674 *  \n# Age:Sex    1 0.32626 0.32626 19.4722 4.404e-05 ***\n# Residuals 59 0.98854 0.01675                      \n\n# Adults age 6 and over\nm3 <- lm(mean_fWHR ~ I(Age^2) + Age * Sex, data=fWHR[fWHR$Age > 6,]); anova(m3)\n# Response: mean_fWHR\n#           Df  Sum Sq  Mean Sq F value   Pr(>F)   \n# I(Age^2)   1 0.07588 0.075882  3.7450 0.061574 . \n# Age        1 0.00068 0.000685  0.0338 0.855255   \n# Sex        1 0.23342 0.233424 11.5201 0.001807 **\n# Age:Sex    1 0.19645 0.196455  9.6956 0.003803 **\n# Residuals 33 0.66866 0.020262                    \n\n# Adults age 5 and over\nm3 <- lm(mean_fWHR ~ I(Age^2) + Age * Sex, data=fWHR[fWHR$Adult_status==\"YES\",]); anova(m3)\n# Response: mean_fWHR\n#           Df  Sum Sq Mean Sq F value    Pr(>F)    \n# I(Age^2)   1 0.03046 0.03046  1.6433 0.2067432    \n# Age        1 0.06490 0.06490  3.5011 0.0681440 .  \n# Sex        1 0.11841 0.11841  6.3877 0.0152483 *  \n# Age:Sex    1 0.33029 0.33029 17.8172 0.0001234 ***\n# Residuals 43 0.79712 0.01854          \n\n# Age is significant; sex appears to differ as a result of age\n# Effect of Sex and age for adults only\nm5 <- lm(mean_fWHR ~ Age * Sex, data=fWHR[fWHR$Adult_status==\"YES\",])\nAnova(m5)\n#            Sum Sq Df F value    Pr(>F)    \n# Age       0.00571  1  0.2889   0.59364    \n# Sex       0.09130  1  4.6173   0.03719 *  \n# Age:Sex   0.36683  1 18.5514 9.126e-05 ***\n# Residuals 0.87005 44 \nplot(mean_fWHR ~ Sex, data=fWHR)\n\n# Age sex interaction is still strong but sex is not significant for adults\nm6 <- lm(mean_fWHR ~ Age * Sex, data=fWHR[fWHR$Adult_status==\"NO\",])\nanova(m6)\n#  Response: mean_fWHR\n#            Df   Sum Sq   Mean Sq F value Pr(>F)\n# Age        1 0.009129 0.0091289  0.7501 0.4034\n# Sex        1 0.001852 0.0018525  0.1522 0.7033\n# Age:Sex    1 0.000544 0.0005439  0.0447 0.8361\n# Residuals 12 0.146049 0.0121708    \n\n## Differences in adults based on age, eg age 5 +, age 6 + .... age*sex interaction is stronger when including individuals in the age 5 bracket (classified as Adult=\"YES)\n# Sex effect is stronger in age 6 and over.\n# The age-sex classification for capuchins is Adult I = age 5 and over. Adult II = 6 and over, according to Izawa (1980). This suggests that by age 6 sexual dimporhism might begin to occur.\n\n# Age 6 and over\nm10 <- lm(mean_fWHR ~ Age * Sex, data=fWHR[fWHR$Age > 6,])\nanova(m10)\n#           Df  Sum Sq  Mean Sq F value   Pr(>F)   \n# Age        1 0.07061 0.070611  3.5448 0.068312 . \n# Sex        1 0.22349 0.223485 11.2193 0.001991 **\n# Age:Sex    1 0.20374 0.203737 10.2279 0.002989 **\n# Residuals 34 0.67727 0.019920   \n\n# Age 5 and over\nm11 <- lm(mean_fWHR ~ Age * Sex, data=fWHR[fWHR$Adult_status==\"YES\",])\nanova(m11) \n#           Df  Sum Sq Mean Sq F value    Pr(>F)    \n# Age        1 0.01300 0.01300  0.6575   0.42181    \n# Sex        1 0.09130 0.09130  4.6173   0.03719 *  \n# Age:Sex    1 0.36683 0.36683 18.5514 9.126e-05 ***\n# Residuals 44 0.87005 0.01977                      \n\n### ============================= ###\n\n# ============================\n# = Alpha & Dominance scores =\n# ============================\n\n# Effect of alpha\n# Alpha status is highly predictive of fWHR\nm7 <- lm(mean_fWHR ~ Status, data=fWHR)\nanova(m7)\n# Response: mean_fWHR\n#          Df  Sum Sq Mean Sq F value    Pr(>F)    \n# Status     1 0.38494 0.38494  20.154 3.169e-05 ***\n# Residuals 62 1.18418 0.01910                                 \n\n\n# Binary DV ALpah needs a logistic regression model\nmylogit <- glm(Status ~ DominanceZ*Sex, family=binomial(link=\"logit\"), data=fWHR, na.action=na.pass)\nanova(mylogit, test=\"Chisq\")\nconfint(mylogit)\naod::wald.test(b=coef(mylogit), Sigma=vcov(mylogit), Terms=2:2)\n# Dominance appears to have a significant interaction with Status\n#           Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    \n# NULL                          63     76.049              \n# DominanceZ  1   33.321        62     42.728 7.815e-09 ***\n# Sex         1    1.775        61     40.953    0.1828    \n# fWHR correlates with dominance\n\n\ncor.test(fWHR$mean_fWHR, fWHR$DominanceZ)\n# Pearson's product-moment correlation\n# data:  fWHR$mean_fWHR and fWHR$DominanceZ \n# t = 4.8102, df = 62, p-value = 1.001e-05\n# alternative hypothesis: true correlation is not equal to 0 \n# 95 percent confidence interval:\n# 0.3160028 0.6799901 \n# sample estimates:\n#    cor \n# 0.521318 \n\nm8 <- lm(mean_fWHR ~ Age+ I(Age^2) + Sex*Alpha, data=fWHR)\n# Response: mean_fWHR\n#           Df  Sum Sq  Mean Sq F value    Pr(>F)    \n# Age        1 0.00036 0.000361  0.0216 0.8835550    \n# I(Age^2)   1 0.15224 0.152238  9.1328 0.0037328 ** \n# Sex        1 0.10172 0.101722  6.1023 0.0164622 *  \n# Alpha      1 0.25555 0.255547 15.3303 0.0002401 ***\n# Sex:Alpha  1 0.09243 0.092425  5.5446 0.0219437 *  \n# Residuals 58 0.96683 0.016669              \n\n# Most of these not so useful: Mixes the whole same (young and old) \n# and also with dominance and alpha it confounds two overlapping traits\n\nm8 <- lm(mean_fWHR ~ Age+ I(Age^2) + Sex*Alpha + Sex*DominanceZ, data=fWHR[fWHR$Age > 6,])\nAnova(m8)\n#            Df  Sum Sq  Mean Sq F value   Pr(>F)    \n# Age         1 0.00036 0.000361  0.0230 0.880116    \n# I(Age^2)    1 0.15224 0.152238  9.6860 0.002901 ** \n# Sex         1 0.10172 0.101722  6.4720 0.013694 *  \n# Alpha       1 0.25555 0.255547 16.2589 0.000166 ***\n# DominanceZ  1 0.08149 0.081487  5.1845 0.026561 *  \n# Sex:Alpha   1 0.08187 0.081874  5.2091 0.026220 *  \n# Residuals  57 0.89589 0.015717                     \n\nm12 <- lm(mean_fWHR ~ Age+ I(Age^2) + DominanceZ*Alpha, data=fWHR)\nanova(m12)\n# Response: mean_fWHR\n#                  Df  Sum Sq Mean Sq F value    Pr(>F)    \n# Age               1 0.00036 0.00036  0.0212  0.884700    \n# I(Age^2)          1 0.15224 0.15224  8.9527  0.004064 ** \n# DominanceZ        1 0.33826 0.33826 19.8923 3.817e-05 ***\n# Alpha             1 0.05897 0.05897  3.4679  0.067640 .  \n# DominanceZ:Alpha  1 0.03302 0.03302  1.9418  0.168795    \n# Residuals        58 0.98627 0.01700                       \n\nm12 <- lm(mean_fWHR ~ Age+ I(Age^2) + DominanceZ*Sex, data=fWHR)\n# Response: mean_fWHR\n#                Df  Sum Sq Mean Sq F value    Pr(>F)    \n# Age             1 0.00036 0.00036  0.0213  0.884495    \n# I(Age^2)        1 0.15224 0.15224  8.9849  0.004003 ** \n# DominanceZ      1 0.33826 0.33826 19.9637 3.713e-05 ***\n# Sex             1 0.06706 0.06706  3.9577  0.051379 .  \n# DominanceZ:Sex  1 0.02846 0.02846  1.6795  0.200125    \n# Residuals      58 0.98274 0.01694          \n       \n\n# ==========================================================\n# = Take home message: fWHR is a function of Age^2, Sex, Status, and Sex*Status = ...needs further investigation in females??\n# ==========================================================\nm8 <- lm(mean_fWHR ~ Age+ I(Age^2) + Sex * Status, data = fWHR)\nanova(m8)\n#           Df  Sum Sq  Mean Sq F value    Pr(>F)    \n# Age        1 0.00036 0.000361  0.0216 0.8835550    \n# I(Age^2)   1 0.15224 0.152238  9.1328 0.0037328 ** \n# Sex        1 0.10172 0.101722  6.1023 0.0164622 *  \n# Status      1 0.25555 0.255547 15.3303 0.0002401 ***\n# Sex:Status  1 0.09243 0.092425  5.5446 0.0219437 *  \n# Residuals 58 0.96683 0.016669    \n\n### ================================ ###\n# Body weights for NIH\n#######################\n\nfWHR      <- gdata::read.xls(\"~/Dropbox/Blake/data/Weights.data/Weights.xlsx\")\n\n# sex diff.s in weight-fWHR correlations\ncar::scatterplot(mean_fWHR ~ Weight..kg. |  Sex, data = fWHR, legend.coords=\"topleft\", xlab= \"Body weight\", ylab=\"Mean facial width/height ratio (fWHR)\")\n\n# weight predicts fWHR... \nplot(fWHR$Weight..kg. ~ fWHR$mean_fWHR)\nm1 <- lm(mean_fWHR ~ Weight..kg., data=fWHR)\n\n# ...at NIH\n# Response: mean_fWHR\n#          Df  Sum Sq  Mean Sq F value  Pr(>F)  \n# Weight     1 0.09282 0.092824  6.1887 0.02092 *\n# Residuals 22 0.32998 0.014999      \n\n# ...and at GSU\n# Response: mean_fWHR\n#             Df  Sum Sq  Mean Sq F value   Pr(>F)   \n# Weight..kg.  1 0.27499 0.274992  11.441 0.002959 **\n# Residuals   20 0.48072 0.024036            \n\n# ...and at both sites\n# Response: mean_fWHR\n#             Df  Sum Sq Mean Sq F value    Pr(>F)    \n# Weight..kg.  1 0.37002 0.37002  20.009 5.372e-05 ***\n# Residuals   44 0.81368 0.01849    \n\n## ===== !! edit here !!\n\nscatterplot(Weight..kg. ~ Age | Sex, data=fWHR)\nplot(Weight..kg. ~ Age, data=fWHR)\nplot(mean_fWHR ~ Age, data=fWHR)\nscatterplot(mean_fWHR ~ Age | Sex, data=fWHR)\nscatterplot(mean_fWHR ~ Weight..kg. | Sex, data=fWHR)\n\nscatterplot(mean_fWHR ~ Age | Sex, data=fWHR[fWHR$Age > 8,],)\nm1 <- lm(mean_fWHR ~ Weight..kg.*Age, data=fWHR)\n\n#            Df   Sum Sq  Mean Sq F value   Pr(>F)   \n# Weight      1 0.092824 0.092824  8.1159 0.009922 **\n# Age         1 0.009495 0.009495  0.8302 0.373069   \n# Weight:Age  1 0.091737 0.091737  8.0209 0.010298 * \n# Residuals  20 0.228745 0.011437                    \n\n\nm1 <- lm(mean_fWHR ~ Weight, data=fWHR[fWHR$Age > 6,],)\nanova(m1)\n\n# Response: mean_fWHR\n#           Df  Sum Sq  Mean Sq F value Pr(>F)   \n# Weight     1 0.19033 0.190327  15.657 0.0027 **\n# Residuals 10 0.12156 0.012156                  \n\n# From the plots, it appears that fWHR correlates with body weight for both sexes.  Weight decreases in individuals over age 20. \n\nm1 <- lm(mean_fWHR ~ Weight..kg.*Sex, data=fWHR)\n\n# Response: mean_fWHR\n#            Df   Sum Sq  Mean Sq F value  Pr(>F)  \n# Weight      1 0.092824 0.092824  7.5525 0.01240 *\n# Sex         1 0.000004 0.000004  0.0003 0.98622  \n# Weight:Sex  1 0.084165 0.084165  6.8480 0.01651 *\n# Residuals  20 0.245808 0.012290                \n\nm1 <- lm(mean_fWHR ~ Weight*Sex, data=fWHR[fWHR$Age > 6,],)\n\n#            Df   Sum Sq  Mean Sq F value    Pr(>F)    \n# Weight      1 0.190327 0.190327 32.5623 0.0004511 ***\n# Sex         1 0.010586 0.010586  1.8111 0.2152711    \n# Weight:Sex  1 0.064215 0.064215 10.9864 0.0106256 *  \n# Residuals   8 0.046760 0.005845                      \n\nm1 <- lm(mean_fWHR ~ Weight*Sex, data=fWHR[fWHR$Age < 6,],)\n# Response: mean_fWHR\n#            Df   Sum Sq   Mean Sq F value Pr(>F)\n# Weight      1 0.002696 0.0026963  0.2823 0.6180\n# Sex         1 0.007228 0.0072278  0.7566 0.4242\n# Weight:Sex  1 0.013558 0.0135578  1.4192 0.2870\n# Residuals   5 0.047765 0.0095529               \n\nm1 <- lm(mean_fWHR ~ Weight*DominanceZ, data=fWHR)\n\n#                   Df   Sum Sq  Mean Sq F value   Pr(>F)   \n# Weight             1 0.092824 0.092824  10.368 0.004296 **\n# DominanceZ         1 0.033143 0.033143   3.702 0.068695 . \n# Weight:DominanceZ  1 0.117780 0.117780  13.156 0.001679 **\n# Residuals         20 0.179054 0.008953                   \n\nm1 <- lm(mean_fWHR ~ Weight..kg.*DominanceZ, data=fWHR[fWHR$Age > 5,],)\nanova(m1)\n# Response: mean_fWHR\n#                        Df  Sum Sq Mean Sq F value    Pr(>F)    \n# Weight..kg.             1 0.42881 0.42881 28.0674 1.004e-05 ***\n# DominanceZ              1 0.14118 0.14118  9.2410  0.004874 ** \n# Weight..kg.:DominanceZ  1 0.03542 0.03542  2.3186  0.138306    \n# Residuals              30 0.45833 0.01528          \n\nAnova(m1)   \n# Response: mean_fWHR\n#                         Sum Sq Df F value    Pr(>F)    \n# Weight..kg.            0.27331  1 17.8894 0.0002025 ***\n# DominanceZ             0.14118  1  9.2410 0.0048740 ** \n# Weight..kg.:DominanceZ 0.03542  1  2.3186 0.1383062    \n# Residuals              0.45833 30                          \n\nm1 <- lm(mean_fWHR ~ Weight*Alpha, data=fWHR)\n\n#              Df   Sum Sq  Mean Sq F value    Pr(>F)    \n# Weight        1 0.092824 0.092824 11.3783 0.0030225 ** \n# Alpha         1 0.037017 0.037017  4.5376 0.0457638 *  \n# Weight:Alpha  1 0.129801 0.129801 15.9110 0.0007221 ***\n# Residuals    20 0.163159 0.008158                    \n\nm1 <- lm(mean_fWHR ~ Weight*Alpha, data=fWHR[fWHR$Age > 6,],)\n\n# Response: mean_fWHR\n#              Df   Sum Sq  Mean Sq F value   Pr(>F)   \n# Weight        1 0.190327 0.190327 21.9907 0.001563 **\n# Alpha         1 0.034119 0.034119  3.9421 0.082348 . \n# Weight:Alpha  1 0.018204 0.018204  2.1033 0.185032   \n# Residuals     8 0.069239 0.008655                    \n\nm1 <- lm(Weight ~ DominanceZ, data=newdata[newdata$Age > 5,],)\n\nanova(m1)\n# Response: Weight..kg.\n#            Df Sum Sq Mean Sq F value   Pr(>F)   \n# DominanceZ  1  8.626  8.6258  8.0417 0.006883 **\n# Residuals  44 47.196  1.0726    \n\nt.test(Weight ~ Alpha, data = newdata)\n\nm2 <- lm(mean_fWHR ~ I(Age^2) + Weight + DominanceZ + Age * Sex, data=newdata)\nsummary(m2)\n# Coefficients:\n#              Estimate Std. Error t value Pr(>|t|)    \n# (Intercept)  1.9106987  0.1280677  14.919   <2e-16 ***\n# I(Age^2)    -0.0001252  0.0002659  -0.471   0.6405    \n# Weight       0.0442469  0.0225400   1.963   0.0570 .  \n# DominanceZ   0.0411643  0.0189997   2.167   0.0366 *  \n# Age         -0.0010341  0.0119171  -0.087   0.9313    \n# Sexmale     -0.0784970  0.0895755  -0.876   0.3864    \n# Age:Sexmale  0.0107363  0.0084108   1.276   0.2095    \n# Residual standard error: 0.1231 on 38 degrees of freedom\n# Multiple R-squared: 0.5134,\tAdjusted R-squared: 0.4365 \n# F-statistic: 6.681 on 6 and 38 DF,  p-value: 6.932e-05 \nanova(m2)\n# Response: mean_fWHR\n#            Df  Sum Sq Mean Sq F value    Pr(>F)    \n# I(Age^2)    1 0.11617 0.11617  7.6708  0.008633 ** \n# Weight      1 0.34220 0.34220 22.5952 2.859e-05 ***\n# DominanceZ  1 0.10734 0.10734  7.0876  0.011315 *  \n# Age         1 0.01290 0.01290  0.8516  0.361916    \n# Sex         1 0.00384 0.00384  0.2535  0.617523    \n# Age:Sex     1 0.02468 0.02468  1.6294  0.209528    \n#Residuals  38 0.57550 0.01514               \n\nm1 <- lm(Weight ~ DominanceZ, data=newdata[newdata$Age > 5,],)\nsummary(m1)\n# Coefficients:\n#             Estimate Std. Error t value Pr(>|t|)   \n# (Intercept)   2.4086     0.6672   3.610  0.00103 **\n# DominanceZ    0.2595     0.1566   1.657  0.10726   \n# Residual standard error: 1.071 on 32 degrees of freedom\n# Multiple R-squared: 0.07903,\tAdjusted R-squared: 0.05025 \n# F-statistic: 2.746 on 1 and 32 DF,  p-value: 0.1073 \n\nanova(m1)\n# Response: Weight..kg.\n#            Df Sum Sq Mean Sq F value Pr(>F)\n# DominanceZ  1  3.149  3.1494  2.7462 0.1073\n# Residuals  32 36.699  1.1468        \n\n# Weight predicts physical fWHR measurements, but only in whole sample\nm1 <- lm(phys_fWHR ~ Weight, data=fWHR)\n\n# Response: phys_fWHR\n#           Df  Sum Sq Mean Sq F value  Pr(>F)  \n# Weight     1 0.50928 0.50928  5.5754 0.02905 *\n# Residuals 19 1.73553 0.09134        \n\nm1 <- lm(phys_fWHR ~ Weight, data=fWHR[fWHR$Age > 6,],)\n\n# Response: phys_fWHR\n#           Df  Sum Sq  Mean Sq F value Pr(>F)\n# Weight     1 0.28382 0.283817  3.1282 0.1107\n# Residuals  9 0.81654 0.090727              \n\n\n\n\n###### Adding weight data to original model\n## Read in full data set:\nfWHR      <- gdata::read.xls(\"~/Dropbox/Blake/data/Capuchin_fWHR.xlsx\")\n# Original model for Age & Sex\nm1 <- lm(mean_fWHR ~ I(Age^2) + Age * Sex, data=fWHR)\n\nanova(m1)\n# Response: mean_fWHR\n#           Df  Sum Sq Mean Sq F value    Pr(>F)    \n# I(Age^2)   1 0.00789 0.00789  0.4711  0.495158    \n# Age        1 0.14471 0.14471  8.6366  0.004696 ** \n# Sex        1 0.10172 0.10172  6.0712  0.016674 *  \n# Age:Sex    1 0.32626 0.32626 19.4722 4.404e-05 ***\n# Residuals 59 0.98854 0.01675                      \n\nAnova(m1)\n# Anova Table (Type II tests)\n\n# Response: mean_fWHR\n#            Sum Sq Df F value    Pr(>F)    \n# I(Age^2)  0.12153  1  7.2535  0.009198 ** \n# Age       0.19868  1 11.8582  0.001062 ** \n# Sex       0.10172  1  6.0712  0.016674 *  \n# Age:Sex   0.32626  1 19.4722 4.404e-05 ***\n# Residuals 0.98854 59                      \n\n# Subset model for Age & Sex\n# Creating subset excluding NA Weight values\nnewdata <- subset(fWHR, Weight >= 1.5) \nm1 <- lm(mean_fWHR ~ I(Age^2) + Age * Sex, data=newdata)\nanova(m1)\n\n# Response: mean_fWHR\n#           Df  Sum Sq  Mean Sq F value  Pr(>F)  \n# I(Age^2)   1 0.11617 0.116171  6.2231 0.01684 *\n# Age        1 0.13295 0.132950  7.1220 0.01095 *\n# Sex        1 0.06130 0.061298  3.2836 0.07749 .\n# Age:Sex    1 0.12549 0.125493  6.7225 0.01323 *\n# Residuals 40 0.74671 0.018668                \n\n# Original model for Age & Sex: over 5s\nm1 <- lm(mean_fWHR ~ I(Age^2) + Age * Sex, data=fWHR[fWHR$Age > 5,],)\nanova(m1)\n# Response: mean_fWHR\n#           Df  Sum Sq  Mean Sq F value  Pr(>F)  \n# I(Age^2)   1 0.04774 0.047744  2.4593 0.125124   \n# Age        1 0.02606 0.026058  1.3422 0.253869   \n# Sex        1 0.19884 0.198841 10.2421 0.002771 **\n# Age:Sex    1 0.23382 0.233818 12.0438 0.001310 **\n# Residuals 38 0.73773 0.019414                    \n\nAnova(m1)\n# Response: mean_fWHR\n#            Sum Sq Df F value  Pr(>F)  \n# I(Age^2)  0.04483  1  2.3090 0.136901   \n# Age       0.03762  1  1.9378 0.172001   \n# Sex       0.19884  1 10.2421 0.002771 **\n# Age:Sex   0.23382  1 12.0438 0.001310 **\n# Residuals 0.73773 38              \n\n# Subset model for Age & Sex: over 5s\nm1 <- lm(mean_fWHR ~ I(Age^2) + Age * Sex, data=newdata[newdata$Age > 5,],)\n\nanova(m1)\n# Response: mean_fWHR\n#           Df  Sum Sq  Mean Sq F value  Pr(>F)  \n# I(Age^2)   1 0.15377 0.153768  7.0195 0.01291 *\n# Age        1 0.09364 0.093643  4.2748 0.04771 *\n# Sex        1 0.11448 0.114483  5.2262 0.02974 *\n# Age:Sex    1 0.06658 0.066578  3.0393 0.09187 .\n# Residuals 29 0.63527 0.021906               \n\n\n# Add weight to model using subset\nm2 <- lm(mean_fWHR ~ I(Age^2) + Weight + Age * Sex, data=newdata)\nsummary(m2)\n# Coefficients:\n#               Estimate Std. Error t value Pr(>|t|)    \n# (Intercept)  2.076e+00  9.243e-02  22.459   <2e-16 ***\n# I(Age^2)    -1.853e-05  2.518e-04  -0.074   0.9417    \n# Weight       5.612e-02  2.236e-02   2.510   0.0162 *  \n# Age         -6.357e-03  1.101e-02  -0.577   0.5670    \n# Sexmale     -1.320e-01  8.100e-02  -1.630   0.1109    \n# Age:Sexmale  1.624e-02  7.675e-03   2.115   0.0407 *  \n# Residual standard error: 0.1271 on 40 degrees of freedom\n# Multiple R-squared: 0.4537,\tAdjusted R-squared: 0.3855 \n# F-statistic: 6.645 on 5 and 40 DF,  p-value: 0.0001371 \n\ninstall.packages(\"QuantPsyc\")\nrequire(\"QuantPsyc\")\nlm.beta(m2)\n# output with warning messages!\n#    I(Age^2)      Weight         Age     Sexmale Age:Sexmale \n# -0.04017063  0.38538179 -0.34134826          NA 35.20309843 \n\nanova(m2)\n# Response: mean_fWHR\n#             Df  Sum Sq Mean Sq F value    Pr(>F)    \n# I(Age^2)   1 0.11617 0.11617  7.0071   0.01165 *  \n# Weight     1 0.34220 0.34220 20.6402 5.231e-05 ***\n# Age        1 0.01332 0.01332  0.8036   0.37552    \n# Sex        1 0.00298 0.00298  0.1798   0.67388    \n# Age:Sex    1 0.06136 0.06136  3.7010   0.06170 .  \n# Residuals 39 0.64659 0.01658                          \n\nAnova(m2)\n# Anova Table (Type II tests)\n# Response: mean_fWHR\n#            Sum Sq Df F value  Pr(>F)  \n# I(Age^2)  0.00010  1  0.0058 0.93963  \n# Weight    0.10012  1  6.0388 0.01854 *\n# Age       0.01617  1  0.9753 0.32945  \n# Sex       0.00298  1  0.1798 0.67388  \n# Age:Sex   0.06136  1  3.7010 0.06170 .\n# Residuals 0.64659 39                             \n\n# Add weight to model using subset: for > 5s\nm3 <- lm(mean_fWHR ~ I(Age^2) + Weight + Age * Sex, data=newdata[newdata$Age > 5,])\nsummary(m3)\n# Coefficients:\n#               Estimate Std. Error t value Pr(>|t|)    \n# (Intercept)  1.9005174  0.1530096  12.421 6.58e-13 ***\n# I(Age^2)    -0.0002888  0.0003223  -0.896   0.3778    \n# Weight       0.0728532  0.0275012   2.649   0.0131 *  \n# Age          0.0073133  0.0148668   0.492   0.6266    \n# Sexmale     -0.1048538  0.1210316  -0.866   0.3937    \n# Age:Sexmale  0.0125647  0.0100969   1.244   0.2237    \n# Residual standard error: 0.1347 on 28 degrees of freedom\n# Multiple R-squared: 0.5225,\tAdjusted R-squared: 0.4372 \n# F-statistic: 6.127 on 5 and 28 DF,  p-value: 0.0005931 \n\nlm.beta(m3)\n# Output with warning messages!\n#   I(Age^2)      Weight         Age     Sexmale Age:Sexmale \n# -0.6290739   0.4458983   0.3604742          NA  27.3707509 \n \nanova(m3)\n# Response: mean_fWHR\n#             Df  Sum Sq Mean Sq F value    Pr(>F)    \n# I(Age^2)   1 0.15377 0.15377  8.4761 0.0069859 ** \n# Weight     1 0.32145 0.32145 17.7194 0.0002391 ***\n# Age        1 0.04815 0.04815  2.6541 0.1144814    \n# Sex        1 0.00432 0.00432  0.2381 0.6294113    \n# Age:Sex    1 0.02809 0.02809  1.5486 0.2236645    \n# Residuals 28 0.50796 0.01814                            \n  \n\n# Which model is best fit?\n# Make new data subset which drops NA cases of Weight: use new subset to compare model fit.\nnewdata <- fWHR[ which(fWHR$Weight > 1.5), ]\n\nm1 <- lm(mean_fWHR ~ I(Age^2) + Age * Sex, data= newdata[newdata$Age > 5,],)\nm3 <- lm(mean_fWHR ~ I(Age^2) + Weight + Age * Sex, data= newdata[newdata$Age > 5,])\nanova(m1, m3)\n\n# Analysis of Variance Table\n# Model 1: mean_fWHR ~ I(Age^2) + Age * Sex\n# Model 2: mean_fWHR ~ I(Age^2) + Weight..kg. + Age * Sex\n#   Res.Df     RSS Df Sum of Sq      F  Pr(>F)  \n# 1     29 0.63527                              \n# 2     28 0.50796  1   0.12731 7.0177 0.01312 *\n\n## Model 3 - including weight - is a better fit.\n\n\n\n\n###################\nm3 <- lm(mean_fWHR ~ Weight + DominanceZ, data=fWHR[fWHR$Age > 6,])\nanova\nResponse: mean_fWHR\n           Df  Sum Sq Mean Sq F value   Pr(>F)    \nWeight      1 0.40060 0.40060 23.5915  4.9e-05 ***\nDominanceZ  1 0.16137 0.16137  9.5028 0.004811 ** \nResiduals  26 0.44150 0.01698                     \n\nAnova Table (Type II tests)\n\nResponse: mean_fWHR\n            Sum Sq Df F value   Pr(>F)   \nWeight     0.21971  1 12.9390 0.001324 **\nDominanceZ 0.16137  1  9.5028 0.004811 **\nResiduals  0.44150 26                    \n\nm3 <- lm(mean_fWHR ~ Weight + Alpha, data=fWHR[fWHR$Age > 6,])\n\nAnova(m3)\nAnova Table (Type II tests)\n\nResponse: mean_fWHR\n           Sum Sq Df F value  Pr(>F)   \nWeight    0.26028  1 13.0140 0.00129 **\nAlpha     0.08286  1  4.1429 0.05212 . \nResiduals 0.52001 26                   \n\nanova(m3)\nAnalysis of Variance Table\n\nResponse: mean_fWHR\n          Df  Sum Sq Mean Sq F value    Pr(>F)    \nWeight     1 0.40060 0.40060 20.0298 0.0001342 ***\nAlpha      1 0.08286 0.08286  4.1429 0.0521215 .  \nResiduals 26 0.52001 0.02000                      \n\n\n\n### Running age-sex model for: 6 < age > 20\n\nm3 <- lm(mean_fWHR ~ I(Age^2) + Age * Sex, data=fWHR[fWHR$Age <= 20 & fWHR$Age > 6,])\n\nanova(m3)\n\nResponse: mean_fWHR\n          Df  Sum Sq  Mean Sq F value  Pr(>F)  \nI(Age^2)   1 0.06478 0.064776  3.4030 0.07696 .\nAge        1 0.00359 0.003586  0.1884 0.66799  \nSex        1 0.07652 0.076524  4.0202 0.05590 .\nAge:Sex    1 0.09912 0.099124  5.2075 0.03127 *\nResiduals 25 0.47587 0.019035                  \n\nm3 <- lm(mean_fWHR ~ I(Age^2) + Weight + Age * Sex, data=fWHR[fWHR$Age <= 20 & fWHR$Age > 6,])\nanova(m3)\nResponse: mean_fWHR\n          Df  Sum Sq  Mean Sq F value  Pr(>F)  \nI(Age^2)   1 0.06804 0.068036  3.0427 0.09815 .\nWeight     1 0.18383 0.183833  8.2212 0.01024 *\nAge        1 0.00040 0.000400  0.0179 0.89506  \nSex        1 0.01280 0.012802  0.5725 0.45904  \nAge:Sex    1 0.03082 0.030821  1.3784 0.25568  \nResiduals 18 0.40249 0.022361               \n\nscatterplot(mean_fWHR ~ Age | Sex, data=fWHR[fWHR$Age <= 20 & fWHR$Age > 6,])\n\n### Compute icc.s\n\nsource (\"icc.R\")\nphotos <- read.csv(\"Photo-iccs.csv\", header = T)\nsummary(photos)\nItems <- photos$fWHR\nicc.reliability <- icc3.reliability (photos, Items, \"Monkey\", \"Rater\")\n",
    "created" : 1495809609711.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1863552373",
    "id" : "5BA870CA",
    "lastKnownWriteTime" : 1494844780,
    "last_content_update" : 1494844780,
    "path" : "C:/Users/s1229179/GitHub/R/fWHR/1. Sex Diffs Paper.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 11,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}