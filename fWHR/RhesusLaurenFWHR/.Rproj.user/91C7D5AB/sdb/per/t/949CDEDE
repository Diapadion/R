{
    "collab_server" : "",
    "contents" : "### Rhesus macaque face analysis\n\nlibrary(lme4)\nlibrary(car)\nlibrary(ggplot2)\nlibrary(glmnet)\n\n\n\nmSexbyLoc = glm(Sex ~ Facility.x, family=binomial(link=\"logit\"), na.action=na.pass, data=fWHR)\nsummary(mSexbyLoc)\n# ZX has more females\n\nsummary(lm(agenum ~ Facility.x, data=fWHR))\n# ZX is older\n\n# (ZX is Davis)\n\n\n### Optionals\n\n# rm this heinously old male, GT684998\nfWHR$fWHR[fWHR$Rhesus=='GT684998'] = NA\nfWHR$LFFH[fWHR$Rhesus=='GT684998'] = NA\n\n\n# ===================================================================\n# = untested correlations\n# ===================================================================\n\nlibrary(arm)\ncor(fWHR[,c(16:17,32:34,93:102)],use='pairwise.complete.obs')\ncorrplot(fWHR[,c(16:17,32:34,93:102)])\n\n\n\n# ===================================================================\n# = Hypothesis testing: Is fWHR sexually dimorphic? Are there age differences?\n# ===================================================================\n\nplot(fWHR ~ agenum, data=fWHR)\nplot(fWHR ~ Dominance.status, data=fWHR)\n\nplot(fWHR ~ agenum, data=fWHR[fWHR$Sex=='M',])\nplot(fWHR ~ Dominance.status, data=fWHR[fWHR$Sex=='M',])\n\nplot(fWHR ~ agenum, data=fWHR[fWHR$Sex=='F',])\nplot(fWHR ~ Dominance.status, data=fWHR[fWHR$Sex=='F',])\n\n\n### 1. Test age effects\nm1 <- lmer(fWHR ~ s(agenum) + s(I(agenum^2)) + s(I(agenum^3)) + (1|Facility.x/Rhesus)\n             , data=fWHR)\n\nsummary(m1)\nAnova(m1)\n# Looks like we probably should include all 3.\n\n\n\n### Test sex, age x sex effects\nm2 <- lmer(fWHR ~ s(I(agenum^3)) + s(I(agenum^2)) + s(agenum) * Sex + (1|Facility.x/Rhesus)\n           , data=fWHR)\n\nsummary(m2)\nAnova(m2)\n# Sex yes, age x sex, no.\n\n\n\n### Test David score inclusiong\nm3 <- lmer(fWHR ~ s(I(agenum^3)) + s(I(agenum^2)) + s(agenum) + Sex + Dominance.status\n           + (1|Facility.x/Rhesus)\n           , data=fWHR)\nsummary(m3)\nAnova(m3)\n# David scores don't appear to be implicated.\n# Split by sex?\n# Let's leave it out for now\n\n\n\n### Testing HPQ - 6 dimensions\nm4 <- lmer(fWHR ~ s(I(agenum^3)) + s(I(agenum^2)) + s(agenum) + Sex \n           + Confidence + Openness + Dominance + Friendliness + Activity + Anxiety\n           + (1|Rhesus), data=fWHR[fWHR$Facility.x=='ZX6012',])\nsummary(m4)\nAnova(m4)\n### ... Activity? Most of the other chi-sq values have been blasted away\n\n\n\n### Testing short form personality\nm5 <- lmer(fWHR ~ s(I(agenum^3)) + s(I(agenum^2)) + \n             s(agenum) + Sex \n           + Short.con + Short.opn + Short.dom + Short.anx\n           + (1|Facility.x/Rhesus)\n           , data=fWHR)\nsummary(m5)\nAnova(m5)\n\n\n\n### All item modelling\n\nfWHRmat = as.matrix(as.data.frame(lapply(fWHR\n  #aggregate(fWHR,by=list(fWHR$Rhesus),FUN=mean,na.action=na.omit)\n                                         , as.numeric)))\n#fWHRmat=fWHRmat[,-1]\nfWHRmat = cbind(1,fWHRmat)\n\nalp = 0.5\n\n# indices need to be fixed\nm6 <- glmnet(fWHRmat[!is.na(fWHRmat[,16]),c(32:34,39:50)],fWHRmat[!is.na(fWHRmat[,16]),16],\n             family='gaussian',standardize=T,nlambda=1000,alpha=alp\n             )\ncv.m6 = cv.glmnet(fWHRmat[!is.na(fWHRmat[,16]),c(32:34,39:50)],fWHRmat[!is.na(fWHRmat[,16]),16],\n                  family='gaussian',nfolds=100,alpha=alp)\nplot(cv.m6)\ncoef(m6,s=cv.m6$lambda.min)\n\n\nm6 <- lmer(fWHR ~ s(agenum) + s(I(agenum^3)) + s(I(agenum^2)) + Sex \n           + Fearful + Dominant + Cautious + Curious + Innovative + Bullying \n           + Submissive + Cool + Quitting + Erratic + Anxious + Socially.withdrawn\n           + (1|Facility.x/Rhesus)\n           , data=fWHR)\nsummary(m6)\n\n\n\n### Testing mixed LASSO\n\nlibrary(lmmlasso)\n\nm7 <- lmmlasso(x=fWHRmat[!is.na(fWHRmat[,17]),c(1,25,33:35,40:51)],\n               y=fWHRmat[!is.na(fWHRmat[,17]),17],\n               z=as.matrix(fWHRmat[!is.na(fWHRmat[,17]),c(1)]),\n               grp=fWHRmat[!is.na(fWHRmat[,17]),c(2)], # this is the grouping var, e.g. individual\n               lambda=100\n)\nsummary(m7)\nplot(m7)\n\n\n# library(MMS)\n# \n# m7 <- lassop(data=fWHRmat[!is.na(fWHRmat[,17]),c(1,25,33:35,40:51)],\n#              Y=fWHRmat[!is.na(fWHRmat[,17]),17],\n#              z=fWHRmat[!is.na(fWHRmat[,17]),c(1)],\n#              grp=fWHRmat[!is.na(fWHRmat[,17]),c(2)], # this is the grouping var, e.g. individual\n#              alpha=alp, D=F, rand=c(1)\n#              )\n             \n\n\n\n# m7 <- Pen.LME(y=fWHRmat[!is.na(fWHRmat[,16]),16],\n#               X=fWHRmat[!is.na(fWHRmat[,16]),c(24,32:34,39:50)],\n#               Z=fWHRmat[!is.na(fWHRmat[,16]),c(26)],\n#               subject=fWHRmat[!is.na(fWHRmat[,16]),c(1)]\n#               )\n\n\n\n\n\n\n\n\n\n\n\n\n### Same stuff for LFFH ###\n\n\nplot(LFFH ~ agenum, data=fWHR)\nplot(LFFH ~ Dominance.status, data=fWHR)\n\nplot(LFFH ~ agenum, data=fWHR[fWHR$Sex=='M',])\nplot(LFFH ~ Dominance.status, data=fWHR[fWHR$Sex=='M',])\n\nplot(LFFH ~ agenum, data=fWHR[fWHR$Sex=='F',])\nplot(LFFH ~ Dominance.status, data=fWHR[fWHR$Sex=='F',])\n\n\n### 1. Test age effects\nm1.LF <- lmer(LFFH ~ s(agenum) + s(I(agenum^2)) + s(I(agenum^3)) + (1|Facility.x/Rhesus)\n           , data=fWHR)\n\nsummary(m1.LF)\nAnova(m1.LF)\n# Again, looks like we probably should include all 3, but effect is driven by that old guy.\n\n\n\n### Test sex, age x sex effects\nm2.LF <- lmer(LFFH ~ s(I(agenum^3)) + s(I(agenum^2)) + s(agenum) * Sex + (1|Facility.x/Rhesus)\n           , data=fWHR)\n\nsummary(m2)\nAnova(m2)\n# Sex yes, age x sex, no.\n\n\n\n### Test David score inclusiong\nm3.LF <- lmer(LFFH ~ s(I(agenum^3)) + s(I(agenum^2)) + s(agenum) + Sex + Dominance.status\n              + (1|Facility.x/Rhesus)\n           , data=fWHR)\nsummary(m3.LF)\nAnova(m3.LF)\n# David scores again don't appear to be implicated.\n\n\n\n### Testing HPQ - 6 dimensions\nm4.LF <- lmer(LFFH ~ s(I(agenum^3)) + s(I(agenum^2)) + s(agenum) + Sex \n           + Confidence + Openness + Dominance + Friendliness + Activity + Anxiety\n           + (1|Rhesus), data=fWHR[fWHR$Facility.x=='ZX6012',])\nsummary(m4.LF)\nAnova(m4.LF)\n### Nothing.\n\n\n\n### Testing short form personality\nm5.LF <- lmer(LFFH ~ s(I(agenum^3)) + s(I(agenum^2)) + \n             s(agenum) + Sex \n           + Short.con + Short.opn + Short.dom + Short.anx\n           + (1|Facility.x/Rhesus)\n           , data=fWHR)\nsummary(m5.LF)\nAnova(m5.LF)\n### Nothing clear, but maybe Dominance.\n\n\n\n\n### All item modelling\n\nalp = 0.5\n\nm6.LF <- glmnet(fWHRmat[!is.na(fWHRmat[,17]),c(24,32:34,39:50)],fWHRmat[!is.na(fWHRmat[,17]),17],\n             family='gaussian',standardize=T,nlambda=1000,alpha=alp\n)\ncv.m6lf = cv.glmnet(fWHRmat[!is.na(fWHRmat[,17]),c(24,32:34,39:50)],fWHRmat[!is.na(fWHRmat[,17]),17],\n                  family='gaussian',nfolds=100,alpha=alp)\nplot(cv.m6lf)\ncoef(m6.LF,s=cv.m6lf$lambda.min)\n\n\n\n\nm6.LF <- lmer(LFFH ~ Age + Age2 + Age3 + Sex \n           + Fearful + Dominant + Cautious + Curious + Innovative + Bullying \n           + Submissive + Cool + Quitting + Erratic + Anxious + Socially.withdrawn\n           + (1|Facility.x/Rhesus)\n           , data=fWHR)\nsummary(m6.LF)\n\n\n\n\n### mixed LASSO\n\nm7.LF <- lmmlasso(x=fWHRmat[!is.na(fWHRmat[,18]),c(1,25,33:35,40:51)],\n               y=fWHRmat[!is.na(fWHRmat[,18]),18],\n               z=as.matrix(fWHRmat[!is.na(fWHRmat[,18]),c(1)]),\n               grp=fWHRmat[!is.na(fWHRmat[,18]),c(2)], # this is the grouping var, e.g. individual\n               lambda=100\n)\nsummary(m7.LF)\nplot(m7.LF)\n",
    "created" : 1495806944991.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3706502815",
    "id" : "949CDEDE",
    "lastKnownWriteTime" : 1495987166,
    "last_content_update" : 1495987166015,
    "path" : "C:/Users/s1229179/GitHub/R/fWHR/RhesusLaurenFWHR/rhesusModels.R",
    "project_path" : "rhesusModels.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}