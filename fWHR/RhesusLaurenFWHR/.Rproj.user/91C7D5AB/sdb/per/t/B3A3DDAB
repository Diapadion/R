{
    "collab_server" : "",
    "contents" : "# install.packages(\"QuantPsyc\")\nrequire(\"QuantPsyc\")\nrequire(\"aod\"); require(\"car\"); require(\"doBy\"); require(\"gdata\") # to read in xls files\nrequire(\"ggplot2\")\nlibrary(\"visreg\") # (for anova plots)\n\n# ========================\n# = Paper 2: Personality =\n# ========================\n# Several measures of the face known.\n# Among these, fWHR is related to dominance [cite paper 1]\n# Two hypotheses\n# 1. Is this associated with one or more personality traits?\n# 2. Does some other measure of the face relate to personality?\n\n# Read in data set\nfWHR <- gdata::read.xls(\"~/Dropbox/shared folders/Blake/data/Capuchin_fWHR.xlsx\")\n# OR if dropbox is open\nfWHR <- gdata::read.xls(\"Capuchin_fWHR.xlsx\")\n# rename DominanceZ to Dominance\nfWHR <- plyr::rename(fWHR, replace=c(\"DominanceZ\" = \"Dominance\")) \n\n# ===========\n# = Results =\n# ===========\n\n# ============\n# = Subjects =\n# ============\ndoBy::summaryBy(Age ~ Sex, data = fWHR, FUN = function(x){c(n= length(x), mean = round(mean(x),2), sd = round(sd(x),1), min=min(x), max=max(x)) })\n#      Sex Age.n Age.mean Age.sd Age.min Age.max\n# 1 female    29    12.97   10.1       2      40\n# 2   male    35     9.09    8.7       2      38\n\ndoBy::summaryBy(Age ~ Sex+set, data = fWHR, FUN = function(x){c(n= length(x), mean = round(mean(x),2), sd = round(sd(x),1), min=min(x), max=max(x)) })\n#      Sex set Age.n Age.mean Age.sd Age.min Age.max\n# 1 female GSU    13    15.31   12.3       4      40\n# 2 female  LL     6     8.17    4.4       3      14\n# 3 female NIH    10    12.80    9.2       2      31\n# 4   male GSU     9    10.89    5.8       4      22\n# 5   male  LL    10    11.40   14.2       2      38\n# 6   male NIH    16     6.62    4.5       2      20\n\n# Descriptives\nsapply(fWHR[fWHR$Sex == \"female\",], mean, na.rm=TRUE)\nsapply(fWHR[fWHR$Sex == \"female\",], sd, na.rm=TRUE)\n\n# Add correlations to descriptives section\n# Add correlations to descriptives section\n# TODO the two width meausre correlate (,45 - may both be linked to assertiveness. the lower hight measure is largely independent (r = .02 and ))\ncor.prob(fWHR[,c(\"fWHR\", \"face_lowerwidth_to_height\", \"face_lower_to_whole_height\")])\n\n#                                  fWHR face_lowerwidth_to_height face_lower_to_whole_height\n# fWHR                               NA               <0.001                  p = 0.90\n# face_lowerwidth_to_height  0.45                        NA                  p = 0.37\n# face_lower_to_whole_height 0.02              -0.11                         NA\n\n\ncor.prob <- function (X, dfr = nrow(X) - 2, digits=2) {\n  R <- cor(X, use=\"pairwise.complete.obs\")\n  above <- row(R) < col(R)\n  r2 <- R[above]^2\n  Fstat <- r2 * dfr/(1 - r2)\n  R[above] <- 1 - pf(Fstat, 1, dfr)\n  R[row(R) == col(R)] <- NA\n  return(R)\n}\n\n# Make correlation table for: Age, Age2, Sex, Dominance, Openness, Neuroticism, Sociability & Attentiveness, fWHR, face_lowerwidth_to_height, face_lower_to_whole_height\n\n\n# Test Hypothesis 1: fWHR is specific for dominance, and will not correlate with personality\n# traits other than dominance\n\n# The remaining personality domains are: Openness + Neuroticism + Sociability + Attentiveness\n# No link to these traits\n\nm1 <- lm(fWHR ~ Age * Sex + I(Age^2) + Dominance + Openness + Neuroticism + Sociability + Attentiveness, data = fWHR); \nAnova(m1); summary(m1)\n\n# Coefficients:\n#                 Estimate Std. Error t value Pr(>|t|)    \n# (Intercept)    2.2876103  0.3286531   6.961 4.77e-09 ***\n# Age            0.0042239  0.0075856   0.557 0.579942    \n# Sexmale       -0.0699298  0.0497658  -1.405 0.165696    \n# I(Age^2)      -0.0002932  0.0001632  -1.796 0.078041 .  \n# Dominance      0.0580897  0.0162918   3.566 0.000770 ***\n# Openness      -0.0079257  0.0324700  -0.244 0.808085    \n# Neuroticism   -0.0527590  0.0406849  -1.297 0.200224    \n# Sociability    0.0181401  0.0315065   0.576 0.567171    \n# Attentiveness -0.0394313  0.0358984  -1.098 0.276897    \n# Age:Sexmale    0.0130861  0.0034537   3.789 0.000382 ***\n\n# Residual standard error: 0.1173 on 54 degrees of freedom\n# Multiple R-squared: 0.5266,\tAdjusted R-squared: 0.4477 \n# F-statistic: 6.675 on 9 and 54 DF,  p-value: 2.347e-06 \n\nm1 <- lm(fWHR ~ Age * Sex + I(Age^2) + Dominance + Openness + Neuroticism + Sociability + Attentiveness, data = fWHR[fWHR$Age > 5,]); \n\n# Reportable result down to here is that personality does not explain the link between dominance to fWHR?\n# (or perhaps it does when controlling age and sex?): Sociability? Bit of Neuroticism\n\n\n# =============================\n# face width/lower height: main models\n# =============================\n# Model 1: Full sample\nm1 <- lm(face_lowerwidth_to_height ~ I(Age^2) + Age*Sex + Dominance + Openness + Attentiveness + Neuroticism + Sociability, data = fWHR); Anova(m1)\n# Model 2: Adults only\nm1 <- lm(face_lowerwidth_to_height ~ I(Age^2) + Age*Sex + Dominance + Openness + Attentiveness + Neuroticism + Sociability, data = fWHR[fWHR$Age > 5,]); Anova(m1)\n# Model 3: Juveniles only\nm1 <- lm(face_lowerwidth_to_height ~ I(Age^2) + Age*Sex + Dominance + Openness + Attentiveness + Neuroticism + Sociability, data = fWHR[fWHR$Age < 6,]); Anova(m1)\n# Model 3: old age only\nm1 <- lm(face_lowerwidth_to_height ~ I(Age^2) + Age*Sex, data = fWHR[fWHR$Age > 19,]); Anova(m1)\nsummary(m1)\n\n# Model 4: Controlling for fWHR in full sample\nm1 <- lm(face_lowerwidth_to_height ~ I(Age^2) + Age*Sex + Dominance + Openness + Attentiveness + Neuroticism + Sociability + fWHR, data = fWHR); Anova(m1)\n\n## Table 3 for model 1, analysed using Type II Anova.\n\nfWHR$FWHR_plus_lower_face = scale(fWHR$fWHR) + scale(fWHR$face_lowerwidth_to_height)\nm1 <- lm(FWHR_plus_lower_face ~ I(Age^2) + Age*Sex + Dominance + Openness + Attentiveness + Neuroticism + Sociability, data = fWHR); Anova(m1)\n\n# Response: FWHR_plus_lower_face\n#               Sum Sq Df F value    Pr(>F)    \n# I(Age^2)       0.173  1  0.1037 0.7486863    \n# Age            0.062  1  0.0370 0.8481890    \n# Sex           12.109  1  7.2469 0.0094372 ** \n# Dominance     23.758  1 14.2190 0.0004052 ***\n# Openness       3.152  1  1.8867 0.1752468    \n# Attentiveness  0.340  1  0.2033 0.6538893    \n# Neuroticism    4.803  1  2.8745 0.0957518 .  \n# Sociability    0.109  1  0.0651 0.7995647    \n# Age:Sex       24.355  1 14.5764 0.0003489 ***\n# Residuals     90.227 54\n\n# ============================================================================================\n# = In a simple model predicting dominance, without controlling neuroticism, fWHR kicks ass. =\n# ============================================================================================\nm1 <- lm(Dominance ~ I(Age^2) + Age*Sex + fWHR                     , data = fWHR) ; Anova(m1)\nm2 <- lm(Dominance ~ I(Age^2) + Age*Sex + face_lowerwidth_to_height, data = fWHR) ; Anova(m2)\nm3 <- lm(Dominance ~ I(Age^2) + Age*Sex + FWHR_plus_lower_face     , data = fWHR) ; Anova(m3)\n\n## Plot\nqplot(Age, face_lowerwidth_to_height, data=fWHR, geom=c(\"point\", \"smooth\"), method=\"lm\", formula=y~x, color=Sex, xlab=\"Age\", ylab=\"Face width to lower-height ratio\")\n\n\n## Plot\nscatterplot(face_lowerwidth_to_height ~ Age | Sex, smooth = FALSE, spread = TRUE, grid = FALSE, ylab = \"face width/lower face height\")\n \n   xlab=\"Age\", ylab=\"Miles Per Gallon \", pch=19)\nabline(lm(mpg~wt), col=\"red\") # regression line (y~x)\n\n# ======================================\n# Lower to whole face height: main models\n# ======================================\n# Model 1: Full sample\nm1 <- lm(face_lower_to_whole_height ~ Age*Sex + I(Age^2) + set + Dominance + Openness +  Neuroticism + Attentiveness + Sociability, data = fWHR); Anova(m1)\n\nm1 <- lm(face_lower_to_whole_height ~ set + Sex * Age , data = fWHR)\n\nmx <- lm(m1$residuals ~ fWHR$Dominance + fWHR$Openness + fWHR$Neuroticism + fWHR$Attentiveness + fWHR$Sociability)\n\n# males only\nm1 <- lm(face_lower_to_whole_height ~ I(Age^2) + Age + Dominance + Openness +  Neuroticism + Attentiveness + Sociability, data = fWHR[fWHR$Sex == \"male\" | fWHR$Age > 5,])\nAnova(m1)\n\n# females only\nm1 <- lm(face_lower_to_whole_height ~ I(Age^2) + Age + Dominance + Openness +  Neuroticism + Attentiveness + Sociability, data = fWHR[fWHR$Sex == \"female\" | fWHR$Age > 5,])\nAnova(m1)\n\n\nm1 <- lm(Neuroticism ~ I(Age^2) + Age * Sex + Openness, data = fWHR); Anova(m1)\n\n## Plot Neuroticism with Face length\nvisreg(m1, ylab=\"Face lower-height to whole height ratio\")\n# Model 2: Adults only\nm1 <- lm(face_lower_to_whole_height ~ I(Age^2) + Age*Sex + Dominance + Openness + Attentiveness + Neuroticism + Sociability, data = fWHR[fWHR$Age > 5,])\n\n\nattach(fWHR)\nplot(face_lower_to_whole_height, Neuroticism, xlab=\"Mean face lower to whole height ratio\", ylab=\"Neuroticism\", pch=19)\n# Add regression line (y~x) \nabline(lm(Neuroticism~face_lower_to_whole_height), col=\"red\") \n\nm1 <- lm(Neuroticism ~ Sex, data = fWHR)\nAnova(m1)\n\n\n## DIMORPHISM of fWLHR & fLHR\n\n# fWLHR not dimorphic\nm1 <- lm(face_lowerwidth_to_height ~ Sex, data = fWHR)\n# Coefficients:\n#             Estimate Std. Error t value Pr(>|t|)    \n# (Intercept)  1.41079    0.01625  86.833   <2e-16 ***\n# Sexmale      0.03857    0.02197   1.756   0.0841 .  \n\n# but dimorphic in adults\nm1 <- lm(face_lowerwidth_to_height ~ Sex, data = fWHR[fWHR$Age > 5,])# Coefficients:\n#             Estimate Std. Error t value Pr(>|t|)    \n# (Intercept)  1.41026    0.01759  80.171   <2e-16 ***\n# Sexmale      0.05523    0.02646   2.087   0.0431 *  \n\n# fLHR not dimorphic\nm1 <- lm(face_lower_to_whole_height ~ Sex, data = fWHR)\n# Coefficients:\n#             Estimate Std. Error t value Pr(>|t|)    \n# (Intercept)  0.74776    0.00744 100.500   <2e-16 ***\n# Sexmale     -0.01234    0.01006  -1.227    0.225    \n\n# adults\nm1 <- lm(face_lower_to_whole_height ~ Sex, data = fWHR[fWHR$Age > 5,])\n# Coefficients:\n#              Estimate Std. Error t value Pr(>|t|)    \n# (Intercept)  0.753663   0.008091  93.145   <2e-16 ***\n# Sexmale     -0.008295   0.012172  -0.681    0.499    \n\n# ======================\n###  site differences ###\n# ======================\n\n## fWLHR: not sign. diff between sites\nm1 <- lm(face_lowerwidth_to_height ~ set, data = fWHR)\nanova(m1)\nsummary(m1)\nplot(face_lowerwidth_to_height ~ set, data = fWHR)\nm1 <- lm(face_lowerwidth_to_height ~ I(Age^2) + Age*Sex + set + Dominance + Openness + Attentiveness + Neuroticism + Sociability, data = fWHR); Anova(m1)\n\n\n## fLHR\nm1 <- lm(face_lower_to_whole_height ~ set, data = fWHR)\nm1 <- lm(face_lower_to_whole_height ~ set, data = fWHR[fWHR$Age > 5,])\n\nm1 <- lm(Neuroticism ~ set, data = fWHR)\n\nplot(face_lower_to_whole_height ~ set, data = fWHR)\nplot(face_lower_to_whole_height ~ set, data = fWHR[fWHR$Age > 5,])\n\nm1 <- lm(face_lower_to_whole_height ~ I(Age^2) + Age * Sex + set + Dominance + Openness +  Neuroticism + Attentiveness + Sociability, data = fWHR); Anova(m1)\n\nm1 <- lm(face_lower_to_whole_height ~ I(Age^2) + Age * Sex + set + Neuroticism, data = fWHR); Anova(m1)\n\n# Model 2: Adults only\nm1 <- lm(face_lower_to_whole_height ~ I(Age^2) + Age*Sex + set + Dominance + Openness + Attentiveness + Neuroticism + Sociability, data = fWHR[fWHR$Age > 5,]); Anova(m1)\n\n# fLHR\nm1 <- lm(Neuroticism ~ I(Age^2) + Age * Sex + set +face_lower_to_whole_height, data = fWHR); Anova(m1)\n\nthat also makes reporting them a lot simpler - ditch the big tables?\nthen just say “lower face/height ratio was not a significant predictor of (list dimensions), min p-value = X from a series of models like this:\n\nm1 <- lm(Attentiveness ~ I(Age^2) + Age * Sex + set +face_lower_to_whole_height, data = fWHR); Anova(m1) \nm1 <- lm(Sociability ~ I(Age^2) + Age * Sex + set +face_lower_to_whole_height, data = fWHR); Anova(m1) \nm1 <- lm(Dominance ~ I(Age^2) + Age * Sex + set +face_lower_to_whole_height, data = fWHR); Anova(m1)\nm1 <- lm(Openness ~ I(Age^2) + Age * Sex + set +face_lower_to_whole_height, data = fWHR); Anova(m1)\n\n\nm1 = lm(Neuroticism ~ face_lower_to_whole_height, data = fWHR); Anova(m1)\n# p = 0.1445\nm2 = lm(Attentiveness ~ face_lower_to_whole_height, data = fWHR)\nAnova(m2) # p = 0.0121\nm3 = lm(Neuroticism ~ Attentiveness + face_lower_to_whole_height, data = fWHR); Anova(m3) # fLHR p = 0.8613\nm4 = lm(Attentiveness ~ Neuroticism + face_lower_to_whole_height, data = fWHR); Anova(m4) # fLHR p = 0.0422\n## In these 4 models, Attentiveness predicts N and fLHR, but N does not predict fLHR\n\n# Add age & sex controls\nm1 <- lm(Attentiveness ~ I(Age^2) + Age * Sex + set + face_lower_to_whole_height, data = fWHR); Anova(m1) # p = 0.0004\nm2 <- lm(Neuroticism ~ I(Age^2) + Age * Sex + set + face_lower_to_whole_height, data = fWHR); Anova(m2) # p = 0.0059\nm1 <- lm(Neuroticism ~ Attentiveness + I(Age^2) + Age * Sex + set + face_lower_to_whole_height, data = fWHR); Anova(m1) # p = 0.4457\nm1 <- lm(Attentiveness ~ Neuroticism + I(Age^2) + Age * Sex + set + face_lower_to_whole_height, data = fWHR); Anova(m1) # p = 0.0179\n\nscatterplot(Attentiveness ~ face_lower_to_whole_height | Sex, data = fWHR)\n\n\n# fWLHR\nm1 <- lm(Neuroticism ~ I(Age^2) + Age * Sex + set +face_lower_to_whole_height, data = fWHR); Anova(m1)\n\nthat also makes reporting them a lot simpler - ditch the big tables?\nthen just say “lower face/height ratio was not a significant predictor of (list dimensions), min p-value = X from a series of models like this:\n\nm1 <- lm(Attentiveness ~ I(Age^2) + Age * Sex + set +face_lower_to_whole_height, data = fWHR); Anova(m1) \nm1 <- lm(Sociability ~ I(Age^2) + Age * Sex + set +face_lower_to_whole_height, data = fWHR); Anova(m1) \nm1 <- lm(DominanceZ ~ I(Age^2) + Age * Sex + set +face_lower_to_whole_height, data = fWHR); Anova(m1)\nm1 <- lm(Openness ~ I(Age^2) + Age * Sex + set +face_lower_to_whole_height, data = fWHR); Anova(m1)\n\n\n## multi-level model??\n## or differentially-weighted factor scores?\n# add weight to models?\n\n\n\n## check for weight as a correlate of fLHR & fLWHR\n# fLHR\nm1 <- lm(face_lower_to_whole_height ~ Sex * Age + Weight + Dominance + Openness +  Neuroticism + Attentiveness + Sociability, data = fWHR); Anova(m1)\n# Weight is  significant predictor of fLHR, related I believe to age - age falls out when you add weight in; N remains significant when adding weight as a co-variate. \n\nm1 <- lm(face_lower_to_whole_height ~ Weight, data = fWHR); Anova(m1)\nscatterplot(face_lower_to_whole_height ~ Weight | Sex, data = fWHR)\n\n# fLWHR\nm1 <- lm(face_lowerwidth_to_height ~ I(Age^2) + Weight + Age*Sex + Dominance + Openness + Attentiveness + Neuroticism + Sociability, data = fWHR); Anova(m1)\n# Adding weight to this model shows Neuroticism as significant and Assertiveness approaching significance.\n\nm1 <- lm(face_lowerwidth_to_height ~ Weight, data = fWHR); Anova(m1)\nscatterplot(face_lower_to_whole_height ~ Weight | Sex, data = fWHR)\n\n\ncor.test(fWHR$Attentiveness, fWHR$Neuroticism) -0.5\ncor.test(fWHR$Sociability, fWHR$Neuroticism) -0.4\ncor.test(fWHR$Dominance, fWHR$Neuroticism)  -0.001\ncor.test(fWHR$Openness, fWHR$Neuroticism)  0.34\n\n\n",
    "created" : 1495811272707.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2005394252",
    "id" : "B3A3DDAB",
    "lastKnownWriteTime" : 1494844780,
    "last_content_update" : 1494844780,
    "path" : "C:/Users/s1229179/GitHub/R/fWHR/2. Personality_condensed.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 13,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}