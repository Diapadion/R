{
    "contents" : "### Importation and Processing\n\nall <- read.csv(\"long_all.csv\")\n\nall[,c(7:60)] <- lapply((all[,c(7:60)]), as.character)\nall[,c(7:60)] <- lapply((all[,c(7:60)]), as.numeric)\n\nall$status[(all$status == '') & (all$sample == 'AZA')] <- 'Alive'\nall$status[(all$status == 'LTF') & (all$sample == 'AZA')] <- 'rm'\n\nall$status[(all$status == 'LTF') & (all$sample == 'Taronga')] <- 'Alive'\n\nall$status[(all$status == 'LTF') & (all$sample == 'Yerkes')] <- 'Alive'\n\n#levels(all$sample)\n\n# remove the 'rm's until a better situation is realized\nall <- all[!all$status == 'rm',]\n\n\n# Dating shenanigans\n\nall$DoB <- as.Date(all$DoB,format='%m/%d/%Y')\nall$lastDate <- as.Date(all$lastDate, format='%d/%m/%Y')\n\n\n### Ageing\n# ... should also be age at Personality rating\n\n# age at last known date\n#head(all$lastDate - all$DoB)\nall$age = as.numeric(difftime(all$lastDate, all$DoB, units = \"weeks\"))/52.25 \n# The above is super useful. Remember that (it is here).\n\n# making age at DOPR for Yerkes\n# see other files - there may be an issue with death dates overlapping\nall$DOPR = as.Date(all$DOPR,format='%m/%d/%Y')\nall$DOPR2 = as.Date(all$DOPR2,format='%m/%d/%Y')\nall$DOPRmin = pmin(all$DOPR, all$DOPR2, na.rm = TRUE)\n\n# some death dates cut off\nall$DOPRmin = pmin(all$DOPRmin, all$lastDate)\n\n\nall$age_pr[all$sample == 'Yerkes'] = as.numeric(difftime(\n  all$DOPRmin[all$sample == 'Yerkes'], all$DoB[all$sample == 'Yerkes'], units = \"weeks\"))/52.25 \n\nlibrary(lubridate)\nall$DOPRmin[(all$sample == 'AZA') | (all$sample == 'Taronga')] <- \n  all$DoB[(all$sample == 'AZA') | (all$sample == 'Taronga')] + all$age_pr[(all$sample == 'AZA') | (all$sample == 'Taronga')]\n\nyr = year(all$DoB[(all$sample == 'AZA') | (all$sample == 'Taronga')]) +\n  all$age_pr[(all$sample == 'AZA') | (all$sample == 'Taronga')]\n\nall$DOPRmin[(all$sample == 'AZA') | (all$sample == 'Taronga')] <- (as.Date(date_decimal(yr)))\n\n# Some animals died before being rated.\n# Test: moving their rating date to a month or year back from DoD\n\nall$age_pr_adj = all$age_pr\nall$age_pr_adj[all$age <= all$age_pr & (all$sample %in% c('Taronga', 'Yerkes', 'AZA'))] <-\n  (all$age_pr_adj[all$age <= all$age_pr & (all$sample %in% c('Taronga', 'Yerkes', 'AZA'))] - 5)\n\n\n### Origin\nall$origin[all$sample == 'AZA' & all$origin == 'UNKNOWN'] <- 'CAPTIVE' # is this appropriate?\n\nall$origin[(all$sample == 'Yerkes' | all$sample == 'Taronga') & all$origin == ''] <- 'CAPTIVE'\nall$origin[(all$sample == 'Yerkes' | all$sample == 'Taronga') & all$origin == 'W'] <- 'WILD'\n\ntable(all$origin)\n# library(dplyr) # needed?\nall$origin = droplevels(all$origin)\n\n### Lab vs. Zoo\n\nall$LvZ[all$sample == 'AZA'] <- 'zoo'\nall$LvZ[all$sample == 'Yerkes'] <- 'lab'\nall$LvZ[all$sample == 'Taronga'] <- 'zoo'\n\n###\n# there're rearing styles in the AZA file...\n# and the Yerkes hematology file...\n\n\n\n### creating personality scores\n\n\n# right now this is being applied to all\n# will need to create HPQ composites later\n# and compare the possibilities\n\nall$Dom_CZ <-\n  scale((all$dom-all$subm-all$depd+all$indp-all$fear+all$decs-all$tim-all$caut+\n     all$intll+all$pers+all$buly+all$stngy+40)/12)\n\nall$Ext_CZ <-\n  scale((-all$sol-all$lazy+all$actv+all$play+all$soc-all$depr+all$frdy+all$affc+all$imit+24)/9)\n\nall$Con_CZ <-\n  scale((-all$impl-all$defn-all$reckl-all$errc-all$irri+all$pred-all$aggr-all$jeals-all$dsor+64)/9)\n\nall$Agr_CZ <-\n  scale((all$symp+all$help+all$sens+all$prot+all$gntl)/5)\n\nall$Neu_CZ <-\n  scale((-all$stbl+all$exct-all$unem+16)/3)\n\nall$Opn_CZ <-\n  scale((all$inqs+all$invt)/2)\n\n",
    "created" : 1448268337902.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3791802358",
    "id" : "DE0CD847",
    "lastKnownWriteTime" : 1448280449,
    "path" : "C:/Users/s1229179/GitHub/R/longevity/importProcess.R",
    "project_path" : "importProcess.R",
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "type" : "r_source"
}