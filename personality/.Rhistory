)
nlm.dat = groupedData(Error ~ Trial | Subject, data=trial.dat)
View(nlm.dat)
levels(nlm.dat$Subject)
nlm.dat = groupedData(Error ~ Trial | Subject, data=trial.dat, order.groups=0)
nlm.o <- nlme(Progress ~ SSlogis(Trial, Asym, xmid, scal),
data = trial.dat,
fixed = list(Asym ~ Openness, xmid ~ Openness, scal ~ 1),
random = Asym + xmid ~ 1|Subject,
#groups = ~ Subject
#start = initVals
)
nlm.dat = groupedData(Error ~ Trial | Subject, data=trial.dat #, order.groups=0
)
nlm.o <- nlme(Progress ~ SSlogis(Trial, Asym, xmid, scal),
data = trial.dat,
fixed = list(Asym ~ Openness, xmid ~ Openness, scal ~ 1),
random = Asym + xmid ~ 1|Subject,
#groups = ~ Subject
#start = initVals
)
nlm.o <- nlme(Progress ~ SSlogis(Trial, Asym, xmid, scal),
data = nlm.dat,
fixed = list(Asym ~ Openness, xmid ~ Openness, scal ~ 1),
random = Asym + xmid ~ 1|Subject,
#groups = ~ Subject
#start = initVals
)
nlm.dat = groupedData(Error ~ Trial | Subject, data=trial.dat , order.groups=0
)
nlm.o <- nlme(Progress ~ SSlogis(Trial, Asym, xmid, scal),
data = nlm.dat,
fixed = list(Asym ~ Openness, xmid ~ Openness, scal ~ 1),
random = Asym + xmid ~ 1|Subject,
#groups = ~ Subject
#start = initVals
)
summary(nlm.o)
nlm.o <- update(nlm.0, fixed=list(Asym ~ Openness, xmid ~ Openness, scal ~ 1))
nlm.0 <- nlme(Progress ~ SSlogis(Trial, Asym, xmid, scal),
data = nlm.dat,
fixed = list(Asym ~ 1, xmid ~ 1, scal ~ 1),
random = Asym + xmid ~ 1|Subject,
#groups = ~ Subject
#start = initVals
)
summary(nlm.0)
nlm.0.o <- update(nlm.0, fixed=list(Asym ~ Openness, xmid ~ Openness, scal ~ 1))
trial.dat$Prog.t = e^(trial.dat$Progress)
trial.dat$Prog.t = exp(trial.dat$Progress)
View(trial.dat)
gg.p.tr <-  ggplot(trial.dat, aes(Trial,Prog.t))+geom_point()+
facet_wrap(~Subject)
gg.p.tr
gg.p.tr + stat_summary(fun.data="mean_cl_boot",colour='green') + stat_smooth(method='lm')
nlm.o <- nlme(Progress ~ SSlogis(Trial, Asym, xmid, scal),
data = nlm.dat,
fixed = list(Asym ~ I(Openness), xmid ~ I(Openness), scal ~ 1),
random = Asym + xmid ~ 1|Subject,
#groups = ~ Subject
#start = initVals
)
summary(nlm.o)
summary(nlm.0)
nlm.dat$ran = runif(length(nlm.dat$Subject))
View(nlm.dat)
nlm.r <- nlme(Progress ~ SSlogis(Trial, Asym, xmid, scal),
data = nlm.dat,
fixed = list(Asym ~ ran, xmid ~ ran, scal ~ 1),
random = Asym + xmid ~ 1|Subject,
#groups = ~ Subject
#start = initVals
)
summary(nlm.r)
nlm.o <- nlme(Progress ~ SSlogis(Trial, Asym, xmid, scal),
data = nlm.dat,
fixed = list(Asym ~ 1 + I(Openness), xmid ~ I(Openness), scal ~ 1),
random = Asym + xmid ~ 1|Subject,
#groups = ~ Subject
#start = initVals
)
summary(nlm.o)
tSS = SSlogis(Trial, Asym, xmid, scal)
thurstone <- function(x, L, P, R) (L*(x + P)/(x + P + R))
LETTERS
[]
thurstone <- deriv(~(4*(x + P)/(x + P + R)),
+ c('P','R'), function(x, P, R){})
thurstone <- deriv(~(4*(x + P)/(x + P + R)),
c('P','R'), function(x, P, R){})
summary(thurstone)
nlm.0 <- nlme(Progress ~ thurstone(Trial, P, R),
data=nlm.dat,
fixed=list(P ~ 1, R ~ 1),
random = random = R + R ~ 1|Subject
#,
)
nlm.0 <- nlme(Progress ~ thurstone(Trial, P, R),
data=nlm.dat,
fixed=list(P ~ 1, R ~ 1),
random = R + R ~ 1|Subject
#,
)
nlm.0 <- nlme(Progress ~ thurstone(Trial, P, R),
data=nlm.dat,
fixed=list(P ~ 1, R ~ 1),
random = R + R ~ 1|Subject
, start = c(0,0)
)
nlm.0 <- nlme(Progress ~ thurstone(Trial, P, R),
data=nlm.dat,
fixed=list(P ~ 1, R ~ 1),
random = R + R ~ 1|Subject
, start = c(0.1,0.1)
)
summary(nlm.0)
nlm.o <- nlme(Progress ~ thurstone(Trial, P, R),
data=nlm.dat,
fixed=list(P ~ 1 + Openness, R ~ 1 + Openness),
random = R + R ~ 1|Subject
, start = c(0.1,0.1)
)
nlm.o <- nlme(Progress ~ thurstone(Trial, P, R),
data=nlm.dat,
fixed=list(P ~ 1 + Openness, R ~ 1 + Openness),
random = R + R ~ 1|Subject
, start = c(0.1,0.1,0.1)
)
nlm.o <- nlme(Progress ~ thurstone(Trial, P, R),
data=nlm.dat,
fixed=list(P ~ 1 + Openness, R ~ 1 + Openness),
random = R + R ~ 1|Subject
, start = c(0.1,0.1,0.1,0.1)
)
summary(nlm.o)
nlm.o <- nlme(Progress ~ thurstone(Trial, P, R),
data=nlm.dat,
fixed=list(P ~ 1 + Openness, R ~ 1 + Openness),
random = R + R ~ 1|Subject
, start = c(0.01,0.01,0.01,0.01)
)
summary(nlm.o)
nlm.f <- nlme(Progress ~ thurstone(Trial, P, R),
data=nlm.dat,
fixed=list(P ~ 1 + Friendliness, R ~ 1 + Friendliness),
random = R + R ~ 1|Subject
, start = c(0.01,0.01,0.01,0.01)
)
summary(nlm.f)
nlm.o <- nlme(Progress ~ SSlogis(Trial, Asym, xmid, scal),
data = nlm.dat,
fixed = list(Asym ~ 1 + I(Openness), xmid ~ 1 + I(Openness), scal ~ 1),
random = Asym + xmid ~ 1|Subject,
#groups = ~ Subject
#start = initVals
)
summary(nlm.o)
fixef(nlm.0)
fixef(nlm.0)[3]
nlm.0.o <- update(nlm.0, fixed=list(Asym ~ Openness, xmid ~ Openness, scal ~ 1))
, start = c(fixef(nlm.0)[1], 0, fixef(nlm.0)[2], fixef(nlm.0)[3]))
nlm.0 <- nlme(Progress ~ SSlogis(Trial, Asym, xmid, scal),
data = nlm.dat,
fixed = list(Asym ~ 1, xmid ~ 1, scal ~ 1),
random = Asym + xmid ~ 1|Subject,
#groups = ~ Subject
#start = initVals
)
fixef(nlm.0)
nlm.0.o <- update(nlm.0, fixed=list(Asym ~ Openness, xmid ~ Openness, scal ~ 1))
, start = c(fixef(nlm.0)[1], 0, fixef(nlm.0)[2], fixef(nlm.0)[3]))
nlm.0.o <- update(nlm.0, fixed=list(Asym ~ Openness, xmid ~ Openness, scal ~ 1)
, start = c(fixef(nlm.0)[1], 0, fixef(nlm.0)[2], fixef(nlm.0)[3]))
nlm.0.o <- update(nlm.0, fixed=list(Asym ~ Openness, xmid ~ Openness, scal ~ 1)
, start = c(fixef(nlm.0)))
nlm.0.o <- update(nlm.0, fixed=list(Asym ~ Openness, xmid ~ Openness, scal ~ 1)
, start = c(fixef(nlm.0),fixef(nlm.0)))
nlm.0.o <- update(nlm.0, fixed=list(Asym ~ Openness, xmid ~ Openness, scal ~ 1)
, start = c(fixef(nlm.0),fixef(nlm.0),fixef(nlm.0)))
fixef(nlm.0)
nlm.0.o <- update(nlm.0, fixed=list(Asym ~ Openness, xmid ~ Openness, scal ~ 1)
#, start = c(fixef(nlm.0),fixef(nlm.0),fixef(nlm.0)))
start = c(1,1,1,1,1))
nlm.0.o <- update(nlm.0, fixed=list(Asym ~ Openness, xmid ~ Openness, scal ~ 1)
#, start = c(fixef(nlm.0),fixef(nlm.0),fixef(nlm.0)))
, start = c(1,1,1,1,1))
summary(nlm.0.o)
nlm.o$dims
nlm.o$contrasts
nlm.o$groups
nlm.o$map
nlm.0.f <- update(nlm.0, fixed=list(Asym ~ Friendliness, xmid ~ Friendliness, scal ~ 1)
#, start = c(fixef(nlm.0),fixef(nlm.0),fixef(nlm.0)))
, start = c(fixef,1,1,1,1))
nlm.0.o <- update(nlm.0, fixed=list(Asym ~ Openness, xmid ~ Openness, scal ~ 1)
#, start = c(fixef(nlm.0),fixef(nlm.0),fixef(nlm.0)))
, start = c(fixef,1,1,1,1))
nlm.0.f <- update(nlm.0, fixed=list(Asym ~ Friendliness, xmid ~ Friendliness, scal ~ 1)
#, start = c(fixef(nlm.0),fixef(nlm.0),fixef(nlm.0)))
, start = c(1,1,1,1,1))
summary(nlm.0.o)
summary(nlm.0.f)
nlm.0.o <- update(nlm.0, fixed=list(Asym ~ Openness, xmid ~ Openness, scal ~ 1)
#, start = c(fixef(nlm.0),fixef(nlm.0),fixef(nlm.0)))
, start = c(10,10,10,10,10))
nlm.0.o <- update(nlm.0, fixed=list(Asym ~ Openness, xmid ~ Openness, scal ~ 1)
#, start = c(fixef(nlm.0),fixef(nlm.0),fixef(nlm.0)))
, start = c(0.1,0.1,0.1,0.1,0.1))
fixef(nlm.0)
nlm.0.o <- update(nlm.0, fixed=list(Asym ~ Openness, xmid ~ Openness, scal ~ 1)
#, start = c(fixef(nlm.0),fixef(nlm.0),fixef(nlm.0)))
, start = C(Asym = fixef(nlm.0)[1],xmid = fixef(nlm.0)[2], scal = fixef(nlm.0)[3],0))
nlm.0.o <- update(nlm.0, fixed=list(Asym ~ Openness, xmid ~ Openness, scal ~ 1)
#, start = c(fixef(nlm.0),fixef(nlm.0),fixef(nlm.0)))
, start = c(Asym = fixef(nlm.0)[1],xmid = fixef(nlm.0)[2], scal = fixef(nlm.0)[3],0))
nlm.0.o <- update(nlm.0, fixed=list(Asym ~ Openness, xmid ~ Openness, scal ~ 1)
#, start = c(fixef(nlm.0),fixef(nlm.0),fixef(nlm.0)))
, start = c(Asym = fixef(nlm.0)[1],xmid = fixef(nlm.0)[2], scal = fixef(nlm.0)[3],0,0))
nlm.0.o <- update(nlm.0, fixed=list(Asym ~ Openness, xmid ~ Openness, scal ~ 1)
#, start = c(fixef(nlm.0),fixef(nlm.0),fixef(nlm.0)))
, start = c(Asym = fixef(nlm.0)[1],xmid = fixef(nlm.0)[2], scal = fixef(nlm.0)[3],1,1))
fixef(nlm.0.o)
summary(nlm.0.o)
nlm.0.o <- update(nlm.0, fixed=list(Asym ~ Openness, xmid ~ Openness, scal ~ 1)
#, start = c(fixef(nlm.0),fixef(nlm.0),fixef(nlm.0)))
, start = c(Asym = fixef(nlm.0)[1],xmid = fixef(nlm.0)[2], scal = fixef(nlm.0)[3],4,4))
fixef(nlm.0.o)
summary(nlm.0.o)
ranef(nlm.0.o)
nlm.0.f <- update(nlm.0, fixed=list(Asym ~ Friendliness, xmid ~ Friendliness, scal ~ 1)
#, start = c(fixef(nlm.0),fixef(nlm.0),fixef(nlm.0)))
, start = c(Asym = fixef(nlm.0)[1],xmid = fixef(nlm.0)[2], scal = fixef(nlm.0)[3],4,4))
summary(nlm.0.f)
nlm.0.c <- update(nlm.0, fixed=list(Asym ~ Confidence, xmid ~ Confidence, scal ~ 1)
#, start = c(fixef(nlm.0),fixef(nlm.0),fixef(nlm.0)))
, start = c(Asym = fixef(nlm.0)[1],xmid = fixef(nlm.0)[2], scal = fixef(nlm.0)[3],4,4))
summary(nlm.0.c)
nlm.0.fo<- update(nlm.0, fixed=list(Asym ~ Friendliness + Openness, xmid ~ Friendliness + Openness, scal ~ 1)
#, start = c(fixef(nlm.0),fixef(nlm.0),fixef(nlm.0)))
, start = c(Asym = fixef(nlm.0)[1],xmid = fixef(nlm.0)[2], scal = fixef(nlm.0)[3],4,4,4,4))
summary(nlm.0.fo)
nlm.0.fo$logLik
nlm.0.f$logLik
nlm.0.o$logLik
plot(nlm.0)
ranef(nlm.0.o)
fixef(nlm.0.o)
fixef(nlm.0.fo)
ranef(nlm.0.fo)
plot(nlm.0.fo)
plot(nlm.0)
coefplot(nlm.0)
library(coefplot)
coefplot(nlm.0)
nlm.0.fxo <- update(nlm.0, fixed=list(Asym ~ Friendliness * Openness, xmid ~ Friendliness * Openness, scal ~ 1)
#, start = c(fixef(nlm.0),fixef(nlm.0),fixef(nlm.0)))
, start = c(Asym = fixef(nlm.0)[1],xmid = fixef(nlm.0)[2], scal = fixef(nlm.0)[3],4,4,4,4))
nlm.0.fxo <- update(nlm.0, fixed=list(Asym ~ Friendliness * Openness, xmid ~ Friendliness * Openness, scal ~ 1)
#, start = c(fixef(nlm.0),fixef(nlm.0),fixef(nlm.0)))
, start = c(Asym = fixef(nlm.0)[1],xmid = fixef(nlm.0)[2], scal = fixef(nlm.0)[3],4,4,4,4,4,4))
vif(nlm.0.fo)
??vif
library(car)
vif(nlm.0.fo)
fixef(nlm.0)
plot(nlm.dat$Trial, nlm.dat$Progress)
lines(nlm.dat$Trial,predict(nlm.0))
ran.prog = ranef(nlm.0,drop=TRUE)
ran.prog
cor.test(unlist(ran.prog$Subject[1]),mtrim$Friendliness)
cor.test(unlist(ran.prog[1]),mtrim$Friendliness)
cor.test(unlist(ran.prog[1]),mtrim$Openness)
cor.test(unlist(ran.prog[1]),mtrim$Anxiety)
cor.test(unlist(ran.prog[1]),mtrim$Activity)
cor.test(unlist(ran.prog[1]),mtrim$Dominance)
cor.test(unlist(ran.prog[1]),mtrim$Confidence)
cor.test(unlist(ran.prog[2]),mtrim$Friendliness)
cor.test(unlist(ran.prog[2]),mtrim$Openness)
cor.test(unlist(ran.prog[2]),mtrim$Confidence)
coef(lmn.0)
coef(nlm.0)
yPred = fixef(nlm.0)
yPred
lines(nlm.dat$Trial,
(yPred[1]/(1 + exp((yPred[2]-nlm.dat$Trial)/yPred[3])))
)
plot(nlm.dat$Trial, nlm.dat$Progress)
lines(nlm.dat$Trial,
(yPred[1]/(1 + exp((yPred[2]-nlm.dat$Trial)/yPred[3])))
)
plot(nlm.dat$Trial,
(yPred[1]/(1 + exp((yPred[2]-nlm.dat$Trial)/yPred[3])))
)
plot(nlm.dat$Trial,
(yPred[1]/(1 + exp((yPred[2]-nlm.dat$Trial)/(2+yPred[3])))
)
plot(nlm.dat$Trial,
(yPred[1]/(1 + exp((yPred[2]-nlm.dat$Trial)/(2+yPred[3]))))
)
plot(nlm.dat$Trial,
yPred[1]/(1 + exp((yPred[2]-nlm.dat$Trial)/(2+yPred[3])))
)
plot(nlm.dat$Trial,
yPred[1]/(1 + exp((yPred[2]-nlm.dat$Trial)/(0+yPred[3])))
)
par(mfrow=c(2,2))
plot(nlm.dat$Trial, nlm.dat$Progress)
plot(nlm.dat$Trial,
yPred[1]/(1 + exp((yPred[2]-nlm.dat$Trial)/(0+yPred[3])))
)
plot(nlm.dat$Trial,
yPred[1]/(1 + exp((yPred[2]-nlm.dat$Trial)/(2*yPred[3])))
)
plot(nlm.dat$Trial,
yPred[1]/(1 + exp((yPred[2]-nlm.dat$Trial)/(1/2*yPred[3])))
)
#xmid
par(mfrow=c(2,2))
plot(nlm.dat$Trial, nlm.dat$Progress)
yPred = fixef(nlm.0)
plot(nlm.dat$Trial,
yPred[1]/(1 + exp((yPred[2]-nlm.dat$Trial)/(yPred[3])))
)
plot(nlm.dat$Trial,
yPred[1]/(1 + exp((2*yPred[2]-nlm.dat$Trial)/(yPred[3])))
)
plot(nlm.dat$Trial,
yPred[1]/(1 + exp((1/2*yPred[2]-nlm.dat$Trial)/(yPred[3])))
)
nlm.0 <- nlme(Progress ~ SSlogis(Trial, Asym, xmid, scal),
data = nlm.dat,
fixed = list(Asym ~ 1, xmid ~ 1, scal ~ 1),
random = Asym + xmid + scal ~ 1|Subject,
#groups = ~ Subject
#start = initVals
)
nlm.0.o <- update(nlm.0, fixed=list(Asym ~ Openness, xmid ~ Openness, scal ~ 1)
#, start = c(fixef(nlm.0),fixef(nlm.0),fixef(nlm.0)))
, start = c(Asym = fixef(nlm.0)[1],xmid = fixef(nlm.0)[2], scal = fixef(nlm.0)[3],4,4))
nlm.0.f <- update(nlm.0, fixed=list(Asym ~ Friendliness, xmid ~ Friendliness, scal ~ 1)
#, start = c(fixef(nlm.0),fixef(nlm.0),fixef(nlm.0)))
, start = c(Asym = fixef(nlm.0)[1],xmid = fixef(nlm.0)[2], scal = fixef(nlm.0)[3],4,4))
nlm.0.fo<- update(nlm.0, fixed=list(Asym ~ Friendliness + Openness, xmid ~ Friendliness + Openness, scal ~ 1)
#, start = c(fixef(nlm.0),fixef(nlm.0),fixef(nlm.0)))
, start = c(Asym = fixef(nlm.0)[1],xmid = fixef(nlm.0)[2], scal = fixef(nlm.0)[3],4,4,4,4))
summary(nlm.0)
summary(nlm.0.o)
summary(nlm.0.f)
summary(nlm.0.fo)
nlm.0.fo<- update(nlm.0.f, fixed=list(Asym ~ Friendliness + Openness, xmid ~ Friendliness + Openness, scal ~ 1)
#, start = c(fixef(nlm.0),fixef(nlm.0),fixef(nlm.0)))
, start = c(Asym = fixef(nlm.0)[1],xmid = fixef(nlm.0)[2], scal = fixef(nlm.0)[3],4,4,4,4))
control = nlmeControl(pnlsTol = 0.01, msVerbose = TRUE)
nlm.0.fo<- update(nlm.0, fixed=list(Asym ~ Friendliness + Openness, xmid ~ Friendliness + Openness, scal ~ 1)
#, start = c(fixef(nlm.0),fixef(nlm.0),fixef(nlm.0)))
, start = c(Asym = fixef(nlm.0)[1],xmid = fixef(nlm.0)[2], scal = fixef(nlm.0)[3],4,4,4,4))
nlm.0.fo<- update(nlm.0, fixed=list(Asym ~ Friendliness + Openness, xmid ~ Friendliness + Openness, scal ~ 1)
#, start = c(fixef(nlm.0),fixef(nlm.0),fixef(nlm.0)))
, start = c(Asym = fixef(nlm.0)[1],xmid = fixef(nlm.0)[2], scal = fixef(nlm.0)[3],1,1,1,1))
summary(nlm.0.fo)
nlm.0.fo2<- update(nlm.0, fixed=list(Asym ~ Friendliness + Openness, xmid ~ Friendliness + Openness, scal ~ 1)
#, start = c(fixef(nlm.0),fixef(nlm.0),fixef(nlm.0)))
, start = c(Asym = fixef(nlm.0)[1],xmid = fixef(nlm.0)[2], scal = fixef(nlm.0)[3],2,2,2,2))
summary(nlm.0.fo2)
nlm.0.fo2<- update(nlm.0, fixed=list(Asym ~ Friendliness + Openness, xmid ~ Friendliness + Openness, scal ~ 1)
#, start = c(fixef(nlm.0),fixef(nlm.0),fixef(nlm.0)))
, start = c(Asym = fixef(nlm.0)[1],xmid = fixef(nlm.0)[2], scal = fixef(nlm.0)[3],4,4,4,4))
nlm.0.fo2<- update(nlm.0, fixed=list(Asym + xmid ~ Friendliness + Openness, scal ~ 1)
#, start = c(fixef(nlm.0),fixef(nlm.0),fixef(nlm.0)))
, start = c(Asym = fixef(nlm.0)[1],xmid = fixef(nlm.0)[2], scal = fixef(nlm.0)[3],4,4,4,4))
control = nlmeControl(pnlsTol = 0.001, msVerbose = TRUE)
nlm.0.fo2<- update(nlm.0, fixed=list(Asym + xmid ~ Friendliness + Openness, scal ~ 1)
#, start = c(fixef(nlm.0),fixef(nlm.0),fixef(nlm.0)))
, start = c(Asym = fixef(nlm.0)[1],xmid = fixef(nlm.0)[2], scal = fixef(nlm.0)[3],4,4))
nlm.0.o3 <- update(nlm.0, fixed=list(Asym ~ Openness, xmid ~ Openness, scal ~ 1)
#, start = c(fixef(nlm.0),fixef(nlm.0),fixef(nlm.0)))
, start = c(Asym = fixef(nlm.0)[1],xmid = fixef(nlm.0)[2], scal = fixef(nlm.0)[3],3,3))
nlm.o3
summary(nlm.0.o3)
summary(nlm.0.o)
nlm.0.o <- update(nlm.0, fixed=list(Asym ~ Openness, xmid ~ Openness, scal ~ 1)
#, start = c(fixef(nlm.0),fixef(nlm.0),fixef(nlm.0)))
, start = c(Asym = fixef(nlm.0)[1],xmid = fixef(nlm.0)[2], scal = fixef(nlm.0)[3],1,-1))
nlm.0.o <- update(nlm.0, fixed=list(Asym ~ Openness, xmid ~ Openness, scal ~ 1)
#, start = c(fixef(nlm.0),fixef(nlm.0),fixef(nlm.0)))
, start = c(Asym = fixef(nlm.0)[1],xmid = fixef(nlm.0)[2], scal = fixef(nlm.0)[3],-1,-1))
nlm.0.o <- update(nlm.0, fixed=list(Asym ~ Openness, xmid ~ Openness, scal ~ 1)
#, start = c(fixef(nlm.0),fixef(nlm.0),fixef(nlm.0)))
, start = c(Asym = fixef(nlm.0)[1],xmid = fixef(nlm.0)[2], scal = fixef(nlm.0)[3],
Openness=c(1,-1)))
control = nlmeControl(pnlsTol = 0.01, msVerbose = TRUE)
nlm.0.o <- update(nlm.0, fixed=list(Asym ~ Openness, xmid ~ Openness, scal ~ 1)
#, start = c(fixef(nlm.0),fixef(nlm.0),fixef(nlm.0)))
, start = c(Asym = fixef(nlm.0)[1],xmid = fixef(nlm.0)[2], scal = fixef(nlm.0)[3],
Openness=c(1,-1)))
nlm.0.o <- update(nlm.0, fixed=list(Asym ~ Openness, xmid ~ Openness, scal ~ 1)
#, start = c(fixef(nlm.0),fixef(nlm.0),fixef(nlm.0)))
, start = c(Asym = fixef(nlm.0)[1],xmid = fixef(nlm.0)[2], scal = fixef(nlm.0)[3],
Openness=c(0.1,-0.1)))
nlm.0.o <- update(nlm.0, fixed=list(Asym ~ Openness, xmid ~ Openness, scal ~ 1)
#, start = c(fixef(nlm.0),fixef(nlm.0),fixef(nlm.0)))
, start = c(Asym = fixef(nlm.0)[1],xmid = fixef(nlm.0)[2], scal = fixef(nlm.0)[3],
Openness=c(0.1,0.1)))
control = nlmeControl(pnlsTol = 0.001, msVerbose = TRUE)
control = nlmeControl(pnlsTol = 0.001, msVerbose = TRUE)
nlm.0.o <- update(nlm.0, fixed=list(Asym ~ Openness, xmid ~ Openness, scal ~ 1)
#, start = c(fixef(nlm.0),fixef(nlm.0),fixef(nlm.0)))
, start = c(Asym = fixef(nlm.0)[1],xmid = fixef(nlm.0)[2], scal = fixef(nlm.0)[3],
Openness=c(1,1)))
summary(nlm.0.o3)
summary(nlm.0.o)
nlm.0.f <- update(nlm.0, fixed=list(Asym ~ Friendliness, xmid ~ Friendliness, scal ~ 1)
#, start = c(fixef(nlm.0),fixef(nlm.0),fixef(nlm.0)))
, start = c(Asym = fixef(nlm.0)[1],xmid = fixef(nlm.0)[2], scal = fixef(nlm.0)[3],1,1))
summary(nlm.0.f)
fixef(nlm.0.o)
fixef(nlm.0.o)[2,4]
fixef(nlm.0.o)[c(2,4)]
fixef(nlm.0.f)[c(2,4)]
nlm.0.fo<- update(nlm.0, fixed=list(Asym ~ Friendliness + Openness, xmid ~ Friendliness + Openness, scal ~ 1)
#, start = c(fixef(nlm.0),fixef(nlm.0),fixef(nlm.0)))
, start = c(Asym = fixef(nlm.0)[1],xmid = fixef(nlm.0)[2], scal = fixef(nlm.0)[3],
Openness=fixef(nlm.0.o)[c(2,4)],Friendliness=fixef(nlm.0.o)[c(2,4)]))
nlm.0.fo<- update(nlm.0, fixed=list(Asym ~ Friendliness + Openness, xmid ~ Friendliness + Openness, scal ~ 1)
#, start = c(fixef(nlm.0),fixef(nlm.0),fixef(nlm.0)))
, start = list(Asym = fixef(nlm.0)[1],xmid = fixef(nlm.0)[2], scal = fixef(nlm.0)[3],
Openness=fixef(nlm.0.o)[c(2,4)],Friendliness=fixef(nlm.0.f)[c(2,4)]))
nlm.0.fo<- update(nlm.0, fixed=list(Asym ~ Friendliness + Openness, xmid ~ Friendliness + Openness, scal ~ 1)
#, start = c(fixef(nlm.0),fixef(nlm.0),fixef(nlm.0)))
, start = c(Asym = fixef(nlm.0)[1],xmid = fixef(nlm.0)[2], scal = fixef(nlm.0)[3],
Openness=fixef(nlm.0.o)[c(2,4)],Friendliness=fixef(nlm.0.f)[c(2,4)]))
control = nlmeControl(pnlsTol = 0.01, msVerbose = TRUE)
nlm.0.fo<- update(nlm.0, fixed=list(Asym ~ Friendliness + Openness, xmid ~ Friendliness + Openness, scal ~ 1)
#, start = c(fixef(nlm.0),fixef(nlm.0),fixef(nlm.0)))
, start = c(Asym = fixef(nlm.0)[1],xmid = fixef(nlm.0)[2], scal = fixef(nlm.0)[3],
Openness=fixef(nlm.0.o)[c(2,4)],Friendliness=fixef(nlm.0.f)[c(2,4)]))
control = nlmeControl(pnlsTol = 0.02, msVerbose = TRUE)
nlm.0.fo<- update(nlm.0, fixed=list(Asym ~ Friendliness + Openness, xmid ~ Friendliness + Openness, scal ~ 1)
#, start = c(fixef(nlm.0),fixef(nlm.0),fixef(nlm.0)))
, start = c(Asym = fixef(nlm.0)[1],xmid = fixef(nlm.0)[2], scal = fixef(nlm.0)[3],
Openness=fixef(nlm.0.o)[c(2,4)],Friendliness=fixef(nlm.0.f)[c(2,4)]))
nlm.0.fo<- update(nlm.0, fixed=list(Asym ~ Friendliness + Openness, xmid ~ Friendliness + Openness, scal ~ 1)
#, start = c(fixef(nlm.0),fixef(nlm.0),fixef(nlm.0)))
, start = c(Asym = fixef(nlm.0)[1],xmid = fixef(nlm.0)[2], scal = fixef(nlm.0)[3],
fixef(nlm.0.f)[2],fixef(nlm.0.o)[2],fixef(nlm.0.f)[4],fixef(nlm.0.o)[4]))
warnings()
nlm.0.fo<- update(nlm.0, fixed=list(Asym ~ Friendliness + Openness, xmid ~ Friendliness + Openness, scal ~ 1)
#, start = c(fixef(nlm.0),fixef(nlm.0),fixef(nlm.0)))
, start = c(Asym = fixef(nlm.0)[1],xmid = fixef(nlm.0)[2], scal = fixef(nlm.0)[3],
#fixef(nlm.0.f)[2],fixef(nlm.0.o)[2],fixef(nlm.0.f)[4],fixef(nlm.0.o)[4]))
1,1,1,1,))
nlm.0.fo<- update(nlm.0, fixed=list(Asym ~ Friendliness + Openness, xmid ~ Friendliness + Openness, scal ~ 1)
#, start = c(fixef(nlm.0),fixef(nlm.0),fixef(nlm.0)))
, start = c(Asym = fixef(nlm.0)[1],xmid = fixef(nlm.0)[2], scal = fixef(nlm.0)[3],
#fixef(nlm.0.f)[2],fixef(nlm.0.o)[2],fixef(nlm.0.f)[4],fixef(nlm.0.o)[4]))
1,1,1,1))
summary(nlm.0.fo)
anova(nlm.0,nlm.0.o,nlm.0.f,nlm.0.fo)
library(bblme)
library(blme)
library(bbmle)
AICctab(nlm.0)
nlm.0 <- nlme(Progress ~ SSlogis(Trial, Asym, xmid, scal),
data = nlm.dat,
fixed = list(Asym ~ 1, xmid ~ 1, scal ~ 1),
random = Asym + xmid ~ 1|Subject,
#groups = ~ Subject
#start = initVals
)
nlm.0rs <- nlme(Progress ~ SSlogis(Trial, Asym, xmid, scal),
data = nlm.dat,
fixed = list(Asym ~ 1, xmid ~ 1, scal ~ 1),
random = Asym + xmid + scal ~ 1|Subject,
#groups = ~ Subject
#start = initVals
)
control = nlmeControl(pnlsTol = 0.001, msVerbose = TRUE)
nlm.0.o <- update(nlm.0, fixed=list(Asym ~ Openness, xmid ~ Openness, scal ~ 1)
#, start = c(fixef(nlm.0),fixef(nlm.0),fixef(nlm.0)))
, start = c(Asym = fixef(nlm.0)[1],xmid = fixef(nlm.0)[2], scal = fixef(nlm.0)[3],
Openness=c(1,1)))
nlm.0.f <- update(nlm.0, fixed=list(Asym ~ Friendliness, xmid ~ Friendliness, scal ~ 1)
#, start = c(fixef(nlm.0),fixef(nlm.0),fixef(nlm.0)))
, start = c(Asym = fixef(nlm.0)[1],xmid = fixef(nlm.0)[2], scal = fixef(nlm.0)[3],1,1))
nlm.0.fo<- update(nlm.0, fixed=list(Asym ~ Friendliness + Openness, xmid ~ Friendliness + Openness, scal ~ 1)
#, start = c(fixef(nlm.0),fixef(nlm.0),fixef(nlm.0)))
, start = c(Asym = fixef(nlm.0)[1],xmid = fixef(nlm.0)[2], scal = fixef(nlm.0)[3],
#fixef(nlm.0.f)[2],fixef(nlm.0.o)[2],fixef(nlm.0.f)[4],fixef(nlm.0.o)[4]))
1,1,1,1))
nlm.0rs.o <- update(nlm.0rs, fixed=list(Asym ~ Openness, xmid ~ Openness, scal ~ 1)
#, start = c(fixef(nlm.0),fixef(nlm.0),fixef(nlm.0)))
, start = c(Asym = fixef(nlm.0)[1],xmid = fixef(nlm.0)[2], scal = fixef(nlm.0)[3],
Openness=c(1,1)))
nlm.0rs.f <- update(nlm.0rs, fixed=list(Asym ~ Friendliness, xmid ~ Friendliness, scal ~ 1)
#, start = c(fixef(nlm.0),fixef(nlm.0),fixef(nlm.0)))
, start = c(Asym = fixef(nlm.0)[1],xmid = fixef(nlm.0)[2], scal = fixef(nlm.0)[3],1,1))
nlm.0rs.fo<- update(nlm.0rs, fixed=list(Asym ~ Friendliness + Openness, xmid ~ Friendliness + Openness, scal ~ 1)
#, start = c(fixef(nlm.0),fixef(nlm.0),fixef(nlm.0)))
, start = c(Asym = fixef(nlm.0)[1],xmid = fixef(nlm.0)[2], scal = fixef(nlm.0)[3],
#fixef(nlm.0.f)[2],fixef(nlm.0.o)[2],fixef(nlm.0.f)[4],fixef(nlm.0.o)[4]))
1,1,1,1))
anova(nlm.0,nlm.0rs)
anova(nlm.0,nlm.0rs,nlm.0.fo,nlm.0rs.fo)
anova(nlm.0,nlm.0rs,nlm.0.fo,nlm.0rs.fo,nlm.0.o,nlm.0rs.o,nlm.0.f,nlm.0rs.f)
yPred = coef(nlm.0)
plot(nlm.dat$Trial,
yPred[1]/(1 + exp((yPred[2]-nlm.dat$Trial)/(yPred[3])))
)
library(ggplot2)
gg.p <- ggplot(trial.dat, aes(Trial,Progress))+stat_summary(fun.data="mean_cl_boot",colour='green')+
facet_wrap(~Subject)
gg.p + facet_wrap(~Subject)
